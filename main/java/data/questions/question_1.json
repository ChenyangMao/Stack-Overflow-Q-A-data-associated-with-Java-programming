{
  "items": [
    {
      "tags": [
        "java",
        "android",
        "kotlin",
        "dependencies"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 4355877,
            "display_name": "Mick"
          },
          "edited": false,
          "comment_id": 133467228,
          "body": "I thought I was the only one who got this error while having had no use of Kotlin anywhere in my large project.. Then I came across this very-obvious-to-me-now answer and it solved it very simply for me... <a href=\"https://stackoverflow.com/a/75315276/4355877\">stackoverflow.com/a/75315276/4355877</a>"
        },
        {
          "owner": {
            "user_id": 355456,
            "display_name": "Hong"
          },
          "edited": false,
          "comment_id": 133823622,
          "body": "@Mick Thank you so much for the tip, a lifesaver for those shunning Kotlin."
        },
        {
          "owner": {
            "user_id": 16765223,
            "display_name": "M DEV"
          },
          "edited": false,
          "comment_id": 133999648,
          "body": "@midnighthowlers Try this solution once: <a href=\"https://stackoverflow.com/a/75974885/16765223\">stackoverflow.com/a/75974885/16765223</a>"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 5699461,
            "display_name": "Luiz Rodrigo"
          },
          "up_vote_count": 4,
          "is_accepted": false,
          "creation_date": 1674878616,
          "answer_id": 75265284,
          "body": "<p>According to the release notes of Kotlin 1.8.0 (<a href=\"https://kotlinlang.org/docs/whatsnew18.html#updated-jvm-compilation-target\" rel=\"nofollow noreferrer\">https://kotlinlang.org/docs/whatsnew18.html#updated-jvm-compilation-target</a>), you shouldn't specify <code>kotlin-stdlib-jdk7</code> nor <code>kotlin-stdlib-jdk8</code> as dependencies anymore and, instead, just use <code>kotlin-stdlib</code>.</p>\n"
        },
        {
          "owner": {
            "user_id": 21099549,
            "display_name": "Jurpro"
          },
          "up_vote_count": 186,
          "is_accepted": false,
          "creation_date": 1674913560,
          "answer_id": 75268089,
          "body": "<p>Simply. For me just change this gradle plugins from 1.7.10 to 1.8.0 Then sync. =&gt; invalidate caches =&gt; build</p>\n<p>From:</p>\n<pre><code>plugins {\n....\nid 'org.jetbrains.kotlin.android' version '1.7.10' apply false\n}\n</code></pre>\n<p>To:</p>\n<pre><code>plugins {\n....\nid 'org.jetbrains.kotlin.android' version '1.8.0' apply false\n}\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 6628335,
            "display_name": "Mohamed Medhat"
          },
          "up_vote_count": 16,
          "is_accepted": false,
          "creation_date": 1674914557,
          "answer_id": 75268204,
          "body": "<p>I solved the problem by changing kotlin class path dependency in the root <code>build.gradle</code> file from</p>\n<pre><code>classpath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:1.7.20-RC&quot;\n</code></pre>\n<p>to</p>\n<pre><code>classpath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:1.8.0&quot;\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 12899712,
            "display_name": "Gregory"
          },
          "up_vote_count": 4,
          "is_accepted": false,
          "creation_date": 1675008057,
          "answer_id": 75276293,
          "body": "<p>It is maybe some updated version dependency. In my new compose app, when i updated</p>\n<blockquote>\n<p>implementation 'androidx.compose.material3:material3:*'(new version)\nfrom 1.0.0-alpha11</p>\n</blockquote>\n<p>I will got this error. Try revert updated dependency.</p>\n<p>Also I was getting this error when <code>android studio</code> add in my gradle modules <code>ktx:+</code> dependency</p>\n"
        },
        {
          "owner": {
            "user_id": 20269135,
            "display_name": "Macbook Air"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1675055848,
          "answer_id": 75280491,
          "body": "<p>for compose, use stable-version of material3</p>\n<p><code>androidx.compose.material3:material3:1.0.1</code></p>\n<p>and than</p>\n<p><code>id 'org.jetbrains.kotlin.android' version '1.7.0' apply false</code></p>\n"
        },
        {
          "owner": {
            "user_id": 15989534,
            "display_name": "Flochocinco"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1675083559,
          "answer_id": 75284751,
          "body": "<p>I had same issue while it was working 2 days ago...</p>\n<p>I changed to</p>\n<pre><code>composeOptions {\n        kotlinCompilerExtensionVersion '1.3.2'\n}\n</code></pre>\n<p>and\n<code>id 'org.jetbrains.kotlin.android' version '1.7.20' apply false</code>\nin build.gradle (Project)</p>\n<p>Then clean and rebuild project.</p>\n"
        },
        {
          "owner": {
            "user_id": 120398,
            "display_name": "David Fraser"
          },
          "up_vote_count": 96,
          "is_accepted": false,
          "creation_date": 1675174777,
          "answer_id": 75298544,
          "body": "<p><em>See <a href=\"https://kotlinlang.org/docs/whatsnew18.html#obligatory-check-for-jvm-targets-of-related-kotlin-and-java-compile-tasks\" rel=\"nofollow noreferrer\">this note</a> in the official kotlin docs for an explanation of how alignment works with these dependencies and build flags. The below original answer is an alternative approach which doesn't take this into account.</em></p>\n<p>This is because <code>kotlin-stdlib-jdk7</code> and <code>kotlin-stdlib-jdk8</code> are older dependencies that should be replaced by <code>kotlin-stdlib</code> (As @MrPNG pointed out from <a href=\"https://kotlinlang.org/docs/whatsnew18.html#updated-jvm-compilation-target\" rel=\"nofollow noreferrer\">the what's new docs for kotlin 1.8</a>). However, other libraries may still declare a dependency on them, which needs to be replaced with a dependency on <code>kotlin-stdlib</code>.</p>\n<p>You can override how the jdk7 and jdk8 versions are resolved like this (in your <code>app/build.gradle</code>):</p>\n<pre><code>dependencies {\n    constraints {\n        implementation(&quot;org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.8.0&quot;) {\n            because(&quot;kotlin-stdlib-jdk7 is now a part of kotlin-stdlib&quot;)\n        }\n        implementation(&quot;org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.8.0&quot;) {\n            because(&quot;kotlin-stdlib-jdk8 is now a part of kotlin-stdlib&quot;)\n        }\n    }\n}\n</code></pre>\n<p>The <code>constraints</code> section above can be added in alongside your other dependencies. Choose the version (here <code>1.8.0</code>) to match the one you actually want to be used, which should be the one that your non-jdkN-named version is in the duplicate class error (e.g. <code>(org.jetbrains.kotlin:kotlin-stdlib:1.8.0)</code>)</p>\n<p>If you have <code>apply plugin: 'kotlin-android'</code> in this file, then it doesn't need to separately also say to depend on the stdlib in dependencies, so remove any lines that look like this:</p>\n<pre><code>    implementation &quot;org.jetbrains.kotlin:kotlin-stdlib-jdk8:$kotlin_version&quot;\n</code></pre>\n<p>(thanks to <a href=\"https://dev.to/retyui/fix-react-native-android-builds-duplicate-class-kotlincollections-found-in-modules-jetified-kotlin-stdlib-180-2ca7\" rel=\"nofollow noreferrer\">this blog</a>)</p>\n"
        },
        {
          "owner": {
            "user_id": 1291714,
            "display_name": "riggaroo"
          },
          "up_vote_count": 9,
          "is_accepted": false,
          "creation_date": 1675254676,
          "answer_id": 75310229,
          "body": "<p>If you are using Compose you need to update the Compose Compiler (<a href=\"https://developer.android.com/jetpack/androidx/releases/compose-compiler\" rel=\"noreferrer\">https://developer.android.com/jetpack/androidx/releases/compose-compiler</a>) to 1.4.2 and Kotlin to 1.8.10 at the same time.</p>\n"
        },
        {
          "owner": {
            "user_id": 12076847,
            "display_name": "atanasi charle"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1675365957,
          "answer_id": 75328068,
          "body": "<p>I had the same error in my project but mine was caused by different jetpack compose libraries having different versions and I put the specific version number <code>&quot;1.3.3&quot;</code> which caused other libraries that have later version numbers to not be found. I fix this by using compose BOM which provides the latest version to each library</p>\n"
        },
        {
          "owner": {
            "user_id": 7839518,
            "display_name": "Tonnie"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1676195613,
          "answer_id": 75426135,
          "body": "<p>I noted the issue specifically after upgrading to these 2 libraries:</p>\n<ul>\n<li><p><strong><code>Material3</code></strong> version <strong><code>1.1.0-alpha05</code></strong></p>\n</li>\n<li><p><strong><code>Runtime-livedata</code></strong> version <strong><code>1.4.0-beta01</code></strong></p>\n</li>\n</ul>\n<p>This is are full dependencies:</p>\n<pre><code>implementation 'androidx.compose.runtime:runtime-livedata:1.4.0-beta01'\nimplementation 'androidx.compose.material3:material3:1.1.0-alpha04'\n</code></pre>\n<p>This is the error I was getting with <strong><code>Jdk-18.0.2</code></strong></p>\n<blockquote>\n<p>Duplicate class kotlin.collections.jdk8.CollectionsJDK8Kt found in\nmodules kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0)\nand kotlin-stdlib-jdk8-1.7.20</p>\n</blockquote>\n<p>The way around it for the time being is to downgrade these 2 libraries until the bug is corrected or updates are made.</p>\n<pre><code>implementation 'androidx.compose.material3:material3:1.1.0-alpha04'\nimplementation 'androidx.compose.runtime:runtime-livedata:1.4.0-alpha01'\n</code></pre>\n<p>Mind you there may be other dependencies that are affected and if you have recently upgraded the dependencies, you may need to rollback the updates and eliminate the library one by one to identify the troublesome one.</p>\n"
        },
        {
          "owner": {
            "user_id": 1928149,
            "display_name": "Prasannjeet Singh"
          },
          "up_vote_count": 2,
          "is_accepted": false,
          "creation_date": 1676245174,
          "answer_id": 75430864,
          "body": "<h3>Update 2023</h3>\n<p>Recently, I had the same issue where most of the duplicate classes belonged to Kotlin. One of the errors was something like this:</p>\n<pre><code>Duplicate class kotlin.collections.jdk8.CollectionsJDK8Kt found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.21 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.21)\n</code></pre>\n<p>I had this issue because I was using a buggy kotlin version. Upgrade your kotlin version to <code>1.8.0-Beta</code>. Follow this:</p>\n<p>in your <code>android/build.gradle</code>, first add this in the <code>ext</code> section:</p>\n<pre><code>kotlinVersion = &quot;1.8.0-Beta&quot;\n</code></pre>\n<p>Now, go down to the dependencies section and add this:</p>\n<pre><code>classpath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlinVersion&quot;\n</code></pre>\n<p>Finally, make sure your <code>JAVA_HOME</code> points to a JDK11.</p>\n<p>Doing these fixed my problem. Hope it helps!</p>\n"
        },
        {
          "owner": {
            "user_id": 15530167,
            "display_name": "Tran Chien"
          },
          "up_vote_count": 27,
          "is_accepted": false,
          "creation_date": 1677185936,
          "answer_id": 75550269,
          "body": "<p>Upgrade kotlin android plugin and kotlin compiler</p>\n<pre><code>plugins {\n    id 'org.jetbrains.kotlin.android' version '1.8.10'\n}\nandroid {\n    composeOptions {\n        kotlinCompilerExtensionVersion = &quot;1.4.3&quot;\n    }\n}\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 6078825,
            "display_name": "Prashanth"
          },
          "up_vote_count": 43,
          "is_accepted": false,
          "creation_date": 1677350919,
          "answer_id": 75567658,
          "body": "<p>I was getting same error after upgrading android annotation libray from ver 1.4.0 to 1.6.0,</p>\n<pre><code>implementation 'androidx.annotation:annotation:1.6.0'\n</code></pre>\n<p>So I downgraded to 1.5.0 and error gone</p>\n<pre><code>implementation 'androidx.annotation:annotation:1.5.0'\n</code></pre>\n<p>Hope this helps you too</p>\n"
        },
        {
          "owner": {
            "user_id": 7234479,
            "display_name": "leo"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1677532112,
          "answer_id": 75585591,
          "body": "<p>The accepted answer worked for me, but the Kotlin DSL syntax is:</p>\n<pre><code>kotlin(&quot;android&quot;).version(&quot;1.8.10&quot;).apply(false)\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 6007077,
            "display_name": "guenter47"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1677834638,
          "answer_id": 75625126,
          "body": "<p>I first tried David Fraser's solution (constraints {...}) and it worked fine, but I found it strange and discarded it.\nInstead I changed the plugins as follows:</p>\n<pre><code>id 'org.jetbrains.kotlin.multiplatform' version '1.8.0' apply false // before 1.7.10\n</code></pre>\n<p>This also fixed the error.</p>\n"
        },
        {
          "owner": {
            "user_id": 11418896,
            "display_name": "Mawuli"
          },
          "up_vote_count": 4,
          "is_accepted": false,
          "creation_date": 1678016575,
          "answer_id": 75641974,
          "body": "<p>I had the same errors in my project. What finally helped me was the following steps</p>\n<p>1-I have updated the buildScript: as below</p>\n<pre><code>buildscript {\n    ext {\n        compose_ui_version = '1.3.3'\n    }\n}\nthen change pluggin \nFrom\n\nplugins {\n....\nid 'org.jetbrains.kotlin.android' version '1.7.10' apply false\n\n}\n\nTo\n\nplugins {\n....\nid 'org.jetbrains.kotlin.android' version '1.8.10' apply false\n}\n</code></pre>\n<p>lastly updated in build.grade(app)</p>\n<p>Change in android scope {}</p>\n<pre><code>    android {\n    ......\n    composeOptions {\n            kotlinCompilerExtensionVersion '1.2.0'\n        }\n    .......\n    }\n</code></pre>\n<p>To the following and the errors were gone</p>\n<pre><code> composeOptions {\n        kotlinCompilerExtensionVersion = &quot;1.4.3&quot;\n    }\n\nHope it helps someone else \n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 4233715,
            "display_name": "Rodrigo Castrillon"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1678198741,
          "answer_id": 75663164,
          "body": "<p>Replace this</p>\n<pre><code>implementation(&quot;androidx.navigation:navigation-compose:2.6.0-alpha06&quot;)\n</code></pre>\n<p>With</p>\n<pre><code>implementation(&quot;androidx.navigation:navigation-compose:2.6.0-alpha04&quot;)\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 6832328,
            "display_name": "patel dhruval"
          },
          "up_vote_count": 8,
          "is_accepted": false,
          "creation_date": 1678207468,
          "answer_id": 75664860,
          "body": "<p>I was using <code>org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.6.10</code> before in our SDK and then I updated kotlin to v1.8.0 and that's when I started getting the above error in our Android Java front end application.\nUsing <code>org.jetbrains.kotlin:kotlin-bom</code> resolved the issue with transitive dependencies and might be a cleaner approach since it doesn't leak Kotlin details into the Java application.</p>\n<p>so I just replaced</p>\n<pre><code>implementation &quot;org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.6.10&quot;\n</code></pre>\n<p>with below which solved the problem for me.</p>\n<pre><code>// Align versions of all Kotlin components\nimplementation(platform(&quot;org.jetbrains.kotlin:kotlin-bom:1.8.0&quot;))\nimplementation &quot;org.jetbrains.kotlin:kotlin-stdlib:1.8.0&quot;\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 8552748,
            "display_name": "Zakaria Bin Abdur Rouf"
          },
          "up_vote_count": 26,
          "is_accepted": false,
          "creation_date": 1678697339,
          "answer_id": 75719642,
          "body": "<p>I have tried all the previous solutions but after adding the below code it was working.</p>\n<pre><code>dependencies {\n   ... ... ...\n   implementation(platform(&quot;org.jetbrains.kotlin:kotlin-bom:1.8.0&quot;))\n   ... ... ...\n}\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 3036320,
            "display_name": "Ahamadullah Saikat"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1678881039,
          "answer_id": 75744310,
          "body": "<p>Replace</p>\n<p><code>classpath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:1.7.20&quot;</code></p>\n<p>With</p>\n<p><code>classpath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:1.8.10&quot;</code></p>\n<p>And then If you used <code>kotlin-android-extensions</code> plugin, then remove this line. And use <code>View binding</code> to whole project.</p>\n"
        },
        {
          "owner": {
            "user_id": 7232295,
            "display_name": "Uddhav P. Gautam"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1679100401,
          "answer_id": 75773243,
          "body": "<p>Duplicate id detected is because there is a duplicate id you defined. For example, you defined the id in project level build.gradle file and if you define the same id in your module-level build.gradle file then it is simply a duplicate id problem.</p>\n"
        },
        {
          "owner": {
            "user_id": 2057782,
            "display_name": "AouledIssa"
          },
          "up_vote_count": 4,
          "is_accepted": false,
          "creation_date": 1679350673,
          "answer_id": 75795808,
          "body": "<p>I ran into this issue today and I fixed it by upgrading both <code>Kotlin</code> <code>std-lib</code> for android and the <code>std-lib</code> itself.\nAlso it's worth mentioning that if you're using compose, you have upgrade the  <code>kotlinCompilerExtensionVersion</code></p>\n<p>Here is the final setup</p>\n<ul>\n<li>gradle file at Module level</li>\n</ul>\n<pre><code>composeOptions {\n    kotlinCompilerExtensionVersion '1.4.3'\n}\n</code></pre>\n<ul>\n<li>root project gradle file</li>\n</ul>\n<pre><code>plugins {\n    id 'com.android.application' version '7.3.1' apply false\n    id 'com.android.library' version '7.3.1' apply false\n    id 'org.jetbrains.kotlin.android' version '1.8.10' apply false\n    id 'org.jetbrains.kotlin.jvm' version '1.8.10' apply false\n}\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 5725819,
            "display_name": "Ranajit Sawant"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1680173792,
          "answer_id": 75887353,
          "body": "<p>If you are upgrading to 1.8.0\nthen you should add</p>\n<pre><code>    implementation &quot;org.jetbrains.kotlin:kotlin-stdlib-jdk8:$kotlin_version&quot;\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 15083327,
            "display_name": "Liubomyr Pavlyk"
          },
          "up_vote_count": 2,
          "is_accepted": false,
          "creation_date": 1680267400,
          "answer_id": 75898804,
          "body": "<p>Downgrade these deps to</p>\n<pre><code>implementation 'androidx.lifecycle:lifecycle-runtime-ktx:2.3.1'\nimplementation 'androidx.activity:activity-compose:1.5.1'\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 4150337,
            "display_name": "MichaÅ‚ Dobi DobrzaÅ„ski"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1680507400,
          "answer_id": 75917014,
          "body": "<p>Such problem occurred after upgrading jetpack compose from <code>1.3.0</code> to <code>1.4.0</code>.</p>\n<p>If you find this problem, please refer to the <a href=\"https://developer.android.com/jetpack/androidx/releases/compose-kotlin\" rel=\"nofollow noreferrer\">Kotlin Compose compatibility map</a> in order to find <strong>matching Kotlin/Compose Compiler</strong> versions.</p>\n<p>When you have found them, you need to make sure that:</p>\n<ul>\n<li>Gradle plugin has the right version (in <code>buildSrc</code>: <code>build.gradle.kts</code> for KTX gradle or in regular Gradle the root <code>build.gradle</code> one: <code>implementation(&quot;org.jetbrains.kotlin:kotlin-gradle-plugin:&lt;KOTLIN_VERSION&gt;&quot;)</code>)</li>\n<li>Kotlin dependency has right version (if you use multi-module app and use Kotlin directly (<code>implementation(&quot;org.jetbrains.kotlin:kotlin-stdlib:&lt;KOTLIN_VERSION&gt;&quot;)</code>)</li>\n<li><code>kotlinCompilerExtensionVersion = &lt;COMPOSE_VERSION&gt;</code> is matching</li>\n</ul>\n"
        },
        {
          "owner": {
            "user_id": 2514902,
            "display_name": "Ashana.Jackol"
          },
          "up_vote_count": 5,
          "is_accepted": false,
          "creation_date": 1680805229,
          "answer_id": 75952607,
          "body": "<p>I had the same error on my Kotlin project. When I add Ktor to my project and upgraded the library versions, and then I got the wired long error. This is how I fixed it.</p>\n<p>I used compose version 1.4.0</p>\n<pre><code>ext {\n    compose_ui_version = '1.4.0'\n}\n</code></pre>\n<p>kotlin version <code>1.8.0</code>, the latest one <code>1.8.10</code> not compatible with compose <code>1.4.0</code> So I used,</p>\n<pre><code>id 'org.jetbrains.kotlin.android' version '1.8.0' apply false\n</code></pre>\n<p>Then, adjust the <code>composeOptions</code> on app level build.gradle file, like</p>\n<pre><code>composeOptions {\n    kotlinCompilerExtensionVersion '1.4.0'\n}\n</code></pre>\n<p>These are the three changes that I have done and I got escaped from the wired error. Hope this will help someone.</p>\n"
        },
        {
          "owner": {
            "user_id": 4592448,
            "display_name": "Fortran"
          },
          "up_vote_count": 2,
          "is_accepted": false,
          "creation_date": 1681231991,
          "answer_id": 75988375,
          "body": "<p>kotlinCompilerExtensionVersion(compose) -&gt; kotlin_version</p>\n<p>1.4.4 -&gt; 1.8.10</p>\n<p>1.4.3 -&gt; 1.8.10</p>\n<p>1.4.2 -&gt; 1.8.10</p>\n<p>1.4.1 -&gt; 1.8.0</p>\n<p>1.4.0 -&gt; 1.8.0</p>\n<p>1.4.0-alpha02 -&gt; 1.7.21</p>\n<p>1.4.0-alpha01 -&gt; 1.7.20</p>\n<p>1.3.2 -&gt;1.7.20</p>\n<p>...</p>\n<p>Other versions: <a href=\"https://developer.android.com/jetpack/androidx/releases/compose-kotlin\" rel=\"nofollow noreferrer\">https://developer.android.com/jetpack/androidx/releases/compose-kotlin</a></p>\n"
        },
        {
          "owner": {
            "user_id": 12272687,
            "display_name": "Mori"
          },
          "up_vote_count": 2,
          "is_accepted": false,
          "creation_date": 1681375297,
          "answer_id": 76003404,
          "body": "<p>As I checked all ways, if there is a alpha version like this :</p>\n<pre><code> implementation 'androidx.appcompat:appcompat:1.7.0-alpha02'\n</code></pre>\n<p><strong>change it to</strong></p>\n<pre><code>implementation 'androidx.appcompat:appcompat:1.6.1'\n</code></pre>\n<p>then <strong>Add</strong> class path in <code>build.gradle()</code></p>\n<pre><code> dependencies {\n     \n        classpath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:1.8.0&quot;\n...\n    }\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 5595926,
            "display_name": "Arda KazancÄ±"
          },
          "up_vote_count": 3,
          "is_accepted": false,
          "creation_date": 1681907256,
          "answer_id": 76054519,
          "body": "<pre><code>lifecycle-viewmodel-ktx-2.6.1\n</code></pre>\n<p>down</p>\n<pre><code>lifecycle-viewmodel-ktx-2.5.1\n</code></pre>\n<p>I managed to get it working by lowering the dependency values.</p>\n"
        },
        {
          "owner": {
            "user_id": 6576302,
            "display_name": "C.F.G"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1682071192,
          "answer_id": 76072071,
          "body": "<p>By <a href=\"https://stackoverflow.com/a/76054519/6576302\">@ArdaKazancÄ± answer</a>, I did a similar change: (agp:7.4.2, gradle: 7.5)</p>\n<pre><code>implementation 'androidx.recyclerview:recyclerview:1.3.1'\nimplementation 'androidx.core:core:1.10.0'\n</code></pre>\n<p>to</p>\n<pre><code>implementation 'androidx.recyclerview:recyclerview:1.2.1'\nimplementation 'androidx.core:core:1.9.0' \n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 12975134,
            "display_name": "ycannot"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1682452649,
          "answer_id": 76104959,
          "body": "<p>it is because of <strong>Compose Compiler Version</strong> and <strong>Kotlin Version</strong> incompability. when I posting this answer, most updated compatible versions were:</p>\n<p><strong>Compose Compiler Version:</strong> 1.4.6\n<strong>Kotlin Version:</strong> 1.8.20</p>\n<p>you can always find most updated compatible versions in this page: <a href=\"https://developer.android.com/jetpack/androidx/releases/compose-kotlin\" rel=\"nofollow noreferrer\">https://developer.android.com/jetpack/androidx/releases/compose-kotlin</a></p>\n<p>you can set this versions in app level gradle file like this:</p>\n<pre><code>composeOptions {\n    kotlinCompilerExtensionVersion = &quot;1.4.3&quot;\n}\n</code></pre>\n<p>and</p>\n<pre><code>plugins {\n    id 'org.jetbrains.kotlin.android' version '1.8.10'\n}\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 7799462,
            "display_name": "Halil Ozel"
          },
          "up_vote_count": 2,
          "is_accepted": false,
          "creation_date": 1682709489,
          "answer_id": 76132651,
          "body": "<p>I'm getting similar error. These settings worked for me.</p>\n<p>Note: I'm using <code>Android Studio Flamingo | 2022.2.1</code></p>\n<p><code>build.gradle(:project)</code> settings</p>\n<p>Old use:</p>\n<pre><code>buildscript {\n    ext.kotlin_version = &quot;1.7.20&quot;\n    repositories {\n        google()\n        mavenCentral()\n    }\n    dependencies {\n        classpath 'com.android.tools.build:gradle:7.4.2'\n        classpath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version&quot;\n    }\n}\n...\n</code></pre>\n<p>New use:</p>\n<pre><code>buildscript {\n    ext.kotlin_version = &quot;1.8.0&quot;\n    repositories {\n        google()\n        mavenCentral()\n    }\n    dependencies {\n        classpath 'com.android.tools.build:gradle:8.0.2'\n        classpath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version&quot;\n    }\n}\n...\n</code></pre>\n<p><code>build.gradle(:app)</code> settings</p>\n<p>Old use:</p>\n<pre><code>...\ncompileOptions {\n        sourceCompatibility JavaVersion.VERSION_1_8\n        targetCompatibility JavaVersion.VERSION_1_8\n    }\n    kotlinOptions {\n        jvmTarget = '1.8'\n    }\n...\n</code></pre>\n<p>New use:</p>\n<pre><code>...\ncompileOptions {\n        sourceCompatibility JavaVersion.VERSION_17\n        targetCompatibility JavaVersion.VERSION_17\n    }\n    kotlinOptions {\n        jvmTarget = '17'\n    }\n...\n</code></pre>\n<p>Gradle Projects Settings</p>\n<p><a href=\"https://i.stack.imgur.com/427JG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/427JG.png\" alt=\"enter image description here\" /></a></p>\n"
        },
        {
          "owner": {
            "user_id": 4485256,
            "display_name": "Jacksonsox"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1683060513,
          "answer_id": 76158759,
          "body": "<p>On my Mac.  I hadn't worked on my app in a while 6-12 months maybe.  I was just checking in to make sure that Android Studio and the dependencies weren't too out of date.  I received the same error as noted in the question.</p>\n<ol>\n<li><p>When I tried to change my <code>ext.kotlin_version = &quot;1.7.20&quot;</code> to 1.8.x, I received a warning about <code>classpath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version&quot;</code> being inconsistent with my Kotlin version.</p>\n</li>\n<li><p>When I went into <code>Tools</code>-&gt;<code>Kotlin</code>-&gt;<code>Configure Kotlin Updates</code> and noticed that I couldn't get the the recent 1.8.20 version.</p>\n</li>\n</ol>\n<p><a href=\"https://i.stack.imgur.com/fpcHb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fpcHb.png\" alt=\"Tool Menu\" /></a>\n<a href=\"https://i.stack.imgur.com/2um1v.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2um1v.png\" alt=\"Kotlin Config Window\" /></a></p>\n<ol start=\"3\">\n<li><p>Then went to see if I needed an <code>Android Studio</code>-&gt;<code>Check for updates...</code>\n<a href=\"https://i.stack.imgur.com/IZzPQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IZzPQ.png\" alt=\"enter image description here\" /></a></p>\n</li>\n<li><p>I in fact did need a major release update arctic fox to flamingo.\nAfter upgrading to Flamingo, I was able to update both locations of Kotlin Version to 1.8.20.  <code>Tools</code>-&gt;<code>Kotlin</code>-&gt;<code>Configure Kotlin Updates</code> and <code>ext.kotlin_version = &quot;1.8.20&quot;</code></p>\n</li>\n<li><p>Did <code>File</code>-&gt;<code>Invalidate Cache</code> and reboot</p>\n</li>\n<li><p>Did <code>Build</code>-&gt;<code>Clean Project</code></p>\n</li>\n<li><p>I updated whatever else needed to be updated with Flamingo</p>\n</li>\n<li><p>Built and ran -&gt; and ...\n<code>BUILD SUCCESSFUL in 1m 6s</code>\n<code>38 actionable tasks: 38 executed</code></p>\n</li>\n</ol>\n"
        },
        {
          "owner": {
            "user_id": 11033789,
            "display_name": "Alexander Dyagel"
          },
          "up_vote_count": 3,
          "is_accepted": false,
          "creation_date": 1683361856,
          "answer_id": 76187916,
          "body": "<p><strong>Workaround for earlier KGP versions now is:</strong><br>\n*<strong>file</strong> <em>app/build.gradle</em></p>\n<pre><code>dependencies {\nconstraints {\n    implementation(&quot;org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.8.0&quot;) {\n        because(&quot;kotlin-stdlib-jdk7 is now a part of kotlin-stdlib&quot;)\n    }\n    implementation(&quot;org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.8.0&quot;) {\n        because(&quot;kotlin-stdlib-jdk8 is now a part of kotlin-stdlib&quot;)\n    }\n}\n</code></pre>\n<p>}</p>\n"
        },
        {
          "owner": {
            "user_id": 11267840,
            "display_name": "Fakhriddin Umarov"
          },
          "up_vote_count": 3,
          "is_accepted": false,
          "creation_date": 1684068968,
          "answer_id": 76247603,
          "body": "<p>I fixed it by making Compose Compiler and JetBrains Kotlin plugins compatible</p>\n<p>First, make sure are you using <strong>org.jetbrains.kotlin.android</strong> plugin version above 1.8.0.</p>\n<p><strong>build.gradle(Project)</strong></p>\n<pre><code>plugins {\n  ...\n  id 'org.jetbrains.kotlin.android' version '1.8.21' apply false\n}\n</code></pre>\n<p>Then check compatible version of Compose Compiler from below link and update <strong>build.gradle(app)</strong>:<br />\n<a href=\"https://developer.android.com/jetpack/androidx/releases/compose-kotlin#pre-release_kotlin_compatibility\" rel=\"nofollow noreferrer\">https://developer.android.com/jetpack/androidx/releases/compose-kotlin#pre-release_kotlin_compatibility</a></p>\n<pre><code>android {\n  ...\n  composeOptions {\n    kotlinCompilerExtensionVersion '1.4.7'\n  }\n}\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 9910265,
            "display_name": "Mohamed Ben Romdhane"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1684404183,
          "answer_id": 76279693,
          "body": "<p>This duplication happens because some of the libraries still use module <code>org.jetbrains.kotlin:kotlin-stdlib-jdk8</code> or <code>org.jetbrains.kotlin:kotlin-stdlib-jdk7</code> instead of the new module <code>org.jetbrains.kotlin:kotlin-stdlib</code>, therefore the class duplication accure.</p>\n<p>To fix this we need to replace this module by ourselves:</p>\n<pre><code>modules {\n        module('org.jetbrains.kotlin:kotlin-stdlib-jdk8')\n                { replacedBy 'org.jetbrains.kotlin:kotlin-stdlib', 'kotlin fixes' }\n        module('org.jetbrains.kotlin:kotlin-stdlib-jdk7')\n                { replacedBy 'org.jetbrains.kotlin:kotlin-stdlib', 'kotlin fixes' }\n    }\n</code></pre>\n"
        }
      ],
      "owner": {
        "user_id": 21058541,
        "display_name": "midnighthowlers"
      },
      "view_count": 75414,
      "up_vote_count": 210,
      "answer_count": 36,
      "score": 210,
      "creation_date": 1674851299,
      "question_id": 75263047,
      "body": "<p><img src=\"https://i.stack.imgur.com/ugp7v.png\" alt=\"Image Example\" /></p>\n<p>I kept on getting error that there is duplicate error in classes.\n<a href=\"https://i.stack.imgur.com/92lfH.png\" rel=\"noreferrer\">This is what i have under org.jetbrains.kotlin folder</a>\n<a href=\"https://i.stack.imgur.com/Q0zHs.png\" rel=\"noreferrer\">.idea/libraries</a></p>\n<p>it seems like the problem is because there is two different dependencies for the kotlin, from stdlib and stdlibjdk8 but I don't know how to remove either one from my module/project dependencies. Please help :(</p>\n<p>Here's the full error code :</p>\n<pre><code>Duplicate class kotlin.collections.jdk8.CollectionsJDK8Kt found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.0)\nDuplicate class kotlin.internal.jdk7.JDK7PlatformImplementations found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk7-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.6.0)\nDuplicate class kotlin.internal.jdk8.JDK8PlatformImplementations found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.0)\nDuplicate class kotlin.io.path.ExperimentalPathApi found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk7-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.6.0)\nDuplicate class kotlin.io.path.PathRelativizer found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk7-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.6.0)\nDuplicate class kotlin.io.path.PathsKt found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk7-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.6.0)\nDuplicate class kotlin.io.path.PathsKt__PathReadWriteKt found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk7-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.6.0)\nDuplicate class kotlin.io.path.PathsKt__PathUtilsKt found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk7-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.6.0)\nDuplicate class kotlin.jdk7.AutoCloseableKt found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk7-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.6.0)\nDuplicate class kotlin.jvm.jdk8.JvmRepeatableKt found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.0)\nDuplicate class kotlin.random.jdk8.PlatformThreadLocalRandom found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.0)\nDuplicate class kotlin.streams.jdk8.StreamsKt found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.0)\nDuplicate class kotlin.streams.jdk8.StreamsKt$asSequence$$inlined$Sequence$1 found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.0)\nDuplicate class kotlin.streams.jdk8.StreamsKt$asSequence$$inlined$Sequence$2 found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.0)\nDuplicate class kotlin.streams.jdk8.StreamsKt$asSequence$$inlined$Sequence$3 found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.0)\nDuplicate class kotlin.streams.jdk8.StreamsKt$asSequence$$inlined$Sequence$4 found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.0)\nDuplicate class kotlin.text.jdk8.RegexExtensionsJDK8Kt found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.0)\nDuplicate class kotlin.time.jdk8.DurationConversionsJDK8Kt found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.0)\n</code></pre>\n<p>I've tried deleting the files from the org.jetbrains.kotlin but whenever i build the app in Android Studio, the files will be re-downloaded again.</p>\n<p>this is my module app gradle code</p>\n<pre><code>\nplugins {\n    id 'com.android.application'\n    id 'com.google.gms.google-services'\n}\n\nandroid {\n    compileSdk 33\n\n    defaultConfig {\n        applicationId &quot;com.example.umfs&quot;\n        minSdk 21\n        targetSdk 32\n        versionCode 1\n        versionName &quot;1.0&quot;\n\n        testInstrumentationRunner &quot;androidx.test.runner.AndroidJUnitRunner&quot;\n    }\n\n    buildTypes {\n        release {\n            minifyEnabled false\n            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'\n        }\n    }\n    compileOptions {\n        sourceCompatibility JavaVersion.VERSION_1_8\n        targetCompatibility JavaVersion.VERSION_1_8\n    }\n\n    buildFeatures {\n        viewBinding true\n    }\n\n    namespace 'com.example.umfs'\n}\n\ndependencies {\n\n\n    implementation 'androidx.appcompat:appcompat:1.5.1'\n    implementation 'com.google.android.material:material:1.7.0'\n    implementation 'androidx.constraintlayout:constraintlayout:2.1.4'\n    implementation 'com.google.firebase:firebase-database:20.1.0'\n    implementation 'androidx.preference:preference:1.2.0'\n    implementation 'com.google.firebase:firebase-auth:21.1.0'\n    implementation 'com.google.firebase:firebase-core:21.1.1'\n    implementation 'androidx.navigation:navigation-fragment:2.5.3'\n    implementation 'androidx.navigation:navigation-ui:2.5.3'\n    implementation 'com.google.firebase:firebase-firestore:24.4.1'\n    implementation 'androidx.recyclerview:recyclerview:1.2.1'\n    testImplementation 'junit:junit:4.13.2'\n    androidTestImplementation 'androidx.test.ext:junit:1.1.4'\n    androidTestImplementation 'androidx.test.espresso:espresso-core:3.5.0'\n    implementation 'de.hdodenhof:circleimageview:3.1.0'\n    implementation &quot;androidx.cardview:cardview:1.0.0&quot;\n    implementation 'com.google.firebase:firebase-firestore:24.4.1'\n    implementation 'com.google.firebase:firebase-storage:20.1.0'\n    implementation 'com.google.firebase:firebase-database'\n    implementation platform('com.google.firebase:firebase-bom:28.4.0')\n    implementation 'com.squareup.picasso:picasso:2.71828'\n    implementation 'com.makeramen:roundedimageview:2.3.0'\n    implementation 'com.github.bumptech.glide:glide:4.14.2'\n    implementation 'com.github.marlonlom:timeago:4.0.3'\n    implementation &quot;androidx.core:core-ktx:+&quot;\n\n}\n\napply plugin: 'com.google.gms.google-services'\n</code></pre>\n"
    },
    {
      "tags": [
        "java",
        "selenium-webdriver",
        "selenide"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 368907,
            "display_name": "nicholas"
          },
          "edited": false,
          "comment_id": 133513318,
          "body": "I had disable the firewall but still cannot. This happen after i invalidate the caches."
        },
        {
          "owner": {
            "user_id": 368907,
            "display_name": "nicholas"
          },
          "edited": false,
          "comment_id": 133513485,
          "body": "Im using Centos 9 Stream OS"
        },
        {
          "owner": {
            "user_id": 13898258,
            "display_name": "David Marquardt"
          },
          "edited": false,
          "comment_id": 133926216,
          "body": "why arent you using ws?"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 5615517,
            "display_name": "Egor Stepanov"
          },
          "up_vote_count": 51,
          "is_accepted": false,
          "creation_date": 1678352718,
          "answer_id": 75682422,
          "body": "<p>I managed to solve it by adding an option:</p>\n<pre><code>options.addArguments(&quot;--remote-allow-origins=*&quot;);\n</code></pre>\n<p>There is a discussion about it in google group\n<a href=\"https://groups.google.com/g/chromedriver-users/c/xL5-13_qGaA\" rel=\"noreferrer\">https://groups.google.com/g/chromedriver-users/c/xL5-13_qGaA</a></p>\n"
        },
        {
          "owner": {
            "user_id": 6678690,
            "display_name": "PhuocThua"
          },
          "up_vote_count": 10,
          "is_accepted": false,
          "creation_date": 1678526952,
          "answer_id": 75703971,
          "body": "<p>This solution worked for me (I'm using Selenium WebDriver).\nI downloaded the newest chromedriver.exe with 111.0.5563.64 version.\nThen I added one more dependency:</p>\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.seleniumhq.selenium&lt;/groupId&gt;\n    &lt;artifactId&gt;selenium-http-jdk-client&lt;/artifactId&gt;\n    &lt;version&gt;4.5.0&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>and added this code line at the first line into @BeforeTest method:</p>\n<pre><code>System.setProperty(&quot;webdriver.http.factory&quot;, &quot;jdk-http-client&quot;);\n</code></pre>\n<p>Hope this help! Thanks Phaneesh Kashyap!!!\nIf this is not work for you. You can keep searching on this (<a href=\"https://groups.google.com/g/chromedriver-users/c/xL5-13_qGaA\" rel=\"noreferrer\">https://groups.google.com/g/chromedriver-users/c/xL5-13_qGaA</a>)</p>\n"
        },
        {
          "owner": {
            "user_id": 4531941,
            "display_name": "Sadik Ali"
          },
          "up_vote_count": 21,
          "is_accepted": false,
          "creation_date": 1678599536,
          "answer_id": 75711246,
          "body": "<p>Create chrome option class object and pass into your ChromeDriver class like below:</p>\n<pre><code>ChromeOptions options = new ChromeOptions();\noptions.addArguments(&quot;--remote-allow-origins=*&quot;);\nChromeDriver driver = new ChromeDriver(options);\n</code></pre>\n<p>Now Selenium 4.8.2 version release and can resolve this issue by using this version without using above code</p>\n"
        },
        {
          "owner": {
            "user_id": 7502769,
            "display_name": "KESHAV KUMAR"
          },
          "up_vote_count": 3,
          "is_accepted": false,
          "creation_date": 1678887362,
          "answer_id": 75745470,
          "body": "<p>Add --remote-allow-origins=* while initializing the driver instance.</p>\n<pre><code> ChromeOptions chromeOptions = new ChromeOptions();\n chromeOptions.addArguments(&quot;--remote-allow-origins=*&quot;);\n ChromeDriver driver = new ChromeDriver(chromeOptions);\n</code></pre>\n<p>Also add below dependency or corresponding jar to project class path.</p>\n<pre><code> &lt;dependency&gt;\n        &lt;groupId&gt;org.seleniumhq.selenium&lt;/groupId&gt;\n        &lt;artifactId&gt;selenium-http-jdk-client&lt;/artifactId&gt;\n        &lt;version&gt;4.8.1&lt;/version&gt;\n &lt;/dependency&gt;\n \n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 15019592,
            "display_name": "Chandan Bhagat"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1678951596,
          "answer_id": 75753183,
          "body": "<p>Change the selenium java version on the pom file. like</p>\n<pre><code>&lt;dependency&gt;\n        &lt;groupId&gt;org.seleniumhq.selenium&lt;/groupId&gt;\n        &lt;artifactId&gt;selenium-java&lt;/artifactId&gt;\n        &lt;version&gt;3.141.59&lt;/version&gt;\n    &lt;/dependency&gt;\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 418057,
            "display_name": "Craigo"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1682298483,
          "answer_id": 76088005,
          "body": "<p>Upgrading the Selenium lib worked for me (was on version 4.4.0):</p>\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.seleniumhq.selenium&lt;/groupId&gt;\n    &lt;artifactId&gt;selenium-java&lt;/artifactId&gt;\n    &lt;version&gt;4.9.0&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>I suspect they now just add the <code>--remote-allow-origins=*</code> arg by default. ðŸ™‚</p>\n"
        },
        {
          "owner": {
            "user_id": 7210433,
            "display_name": "beaucequebec"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1682624212,
          "answer_id": 76124048,
          "body": "<p>Java 11 + selenium 4.8.2 and above is working without adding the chrome options. Selenium 4.8.2 + Java 8 is not and generate the websocket exception.</p>\n"
        },
        {
          "owner": {
            "user_id": 8965380,
            "display_name": "Saad"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1683096345,
          "answer_id": 76161099,
          "body": "<p>For Edge Browser you can use below code it worked for me</p>\n<pre><code>EdgeOptions options = new EdgeOptions();\n        options.setCapability(CapabilityType.ACCEPT_INSECURE_CERTS, true);\n        options.addArguments(&quot;--remote-allow-origins=*&quot;);\n        options.setCapability(&quot;ignore-certificate-errors&quot;, true);\n         \nWebDriverManager.edgedriver().avoidResolutionCache().proxy(PROXY).setup();\n        driver.set(new EdgeDriver(options));\n        driver.get().manage().window().maximize();\n        driver.get().manage().deleteAllCookies();\n</code></pre>\n"
        }
      ],
      "owner": {
        "user_id": 368907,
        "display_name": "nicholas"
      },
      "view_count": 42043,
      "up_vote_count": 30,
      "answer_count": 8,
      "score": 29,
      "creation_date": 1678331933,
      "question_id": 75680149,
      "body": "<p>I had coded automation testing in selenide but strange time comes up.</p>\n<p>The browser window not able to establish websocket connection to http://localhost:2757/devtools/browser/uuid</p>\n<pre><code>&gt; [ERROR] Tests run: 97, Failures: 1, Errors: 0, Skipped: 96, Time\n&gt; elapsed: 3.945 s &lt;&lt;&lt; FAILURE! - in\n&gt; com.rev.testManager.GenericTestManager [ERROR]\n&gt; com.rev.testManager.GenericTestManager.openPage  Time elapsed: 3.727 s\n&gt; &lt;&lt;&lt; FAILURE!\n&gt; org.openqa.selenium.remote.http.ConnectionFailedException: Unable to\n&gt; establish websocket connection to\n&gt; http://localhost:2757/devtools/browser/d5f72b05-f030-41ee-88b2-5823e7d0f35c\n&gt; Build info: version: '4.4.0', revision: 'e5c75ed026a' System info:\n&gt; host: 'localhost', ip: '127.0.0.1', os.name: 'Linux', os.arch:\n&gt; 'amd64', os.version: '5.14.0-283.el9.x86_64', java.version: '18.0.2'\n&gt; Driver info: driver.version: SelenideDriver selenide.url:\n&gt; https://www.buletintv3.my/ selenide.baseUrl:\n&gt; https://www.buletintv3.my/    at\n&gt; org.openqa.selenium.remote.http.netty.NettyWebSocket.&lt;init&gt;(NettyWebSocket.java:102)\n&gt;   at\n&gt; org.openqa.selenium.remote.http.netty.NettyWebSocket.lambda$create$3(NettyWebSocket.java:128)\n&gt;   at\n&gt; org.openqa.selenium.remote.http.netty.NettyClient.openSocket(NettyClient.java:106)\n&gt;   at org.openqa.selenium.devtools.Connection.&lt;init&gt;(Connection.java:77)\n&gt;   at\n&gt; org.openqa.selenium.chromium.ChromiumDriver.lambda$new$2(ChromiumDriver.java:116)\n&gt;   at java.base/java.util.Optional.map(Optional.java:260)  at\n&gt; org.openqa.selenium.chromium.ChromiumDriver.&lt;init&gt;(ChromiumDriver.java:114)\n&gt;   at\n&gt; org.openqa.selenium.chrome.ChromeDriver.&lt;init&gt;(ChromeDriver.java:81)\n&gt;   at\n&gt; com.codeborne.selenide.webdriver.ChromeDriverFactory.create(ChromeDriverFactory.java:42)\n&gt;   at\n&gt; com.codeborne.selenide.webdriver.WebDriverFactory.createWebDriverInstance(WebDriverFactory.java:109)\n&gt;   at\n&gt; com.codeborne.selenide.webdriver.WebDriverFactory.createWebDriver(WebDriverFactory.java:69)\n&gt;   at\n&gt; com.codeborne.selenide.drivercommands.CreateDriverCommand.lambda$createDriver$0(CreateDriverCommand.java:76)\n&gt;   at\n&gt; com.codeborne.selenide.logevents.SelenideLogger.get(SelenideLogger.java:166)\n&gt;   at\n&gt; com.codeborne.selenide.drivercommands.CreateDriverCommand.createDriver(CreateDriverCommand.java:52)\n&gt;   at\n&gt; com.codeborne.selenide.impl.WebDriverThreadLocalContainer.createDriver(WebDriverThreadLocalContainer.java:180)\n&gt;   at\n&gt; com.codeborne.selenide.impl.WebDriverThreadLocalContainer.getAndCheckWebDriver(WebDriverThreadLocalContainer.java:149)\n&gt;   at\n&gt; com.codeborne.selenide.WebDriverRunner.getAndCheckWebDriver(WebDriverRunner.java:130)\n&gt;   at\n&gt; com.codeborne.selenide.impl.StaticDriver.getAndCheckWebDriver(StaticDriver.java:65)\n&gt;   at\n&gt; com.codeborne.selenide.SelenideDriver.getAndCheckWebDriver(SelenideDriver.java:220)\n&gt;   at\n&gt; com.codeborne.selenide.drivercommands.Navigator.lambda$navigateTo$0(Navigator.java:72)\n&gt;   at\n&gt; com.codeborne.selenide.logevents.SelenideLogger.run(SelenideLogger.java:153)\n&gt;   at\n&gt; com.codeborne.selenide.drivercommands.Navigator.navigateTo(Navigator.java:70)\n&gt;   at\n&gt; com.codeborne.selenide.drivercommands.Navigator.open(Navigator.java:32)\n&gt;   at\n&gt; com.codeborne.selenide.SelenideDriver.open(SelenideDriver.java:101)\n&gt;   at com.codeborne.selenide.Selenide.open(Selenide.java:52)   at\n&gt; com.rev.testManager.GenericTestManager.openPage(GenericTestManager.java:27)\n&gt;   at\n&gt; java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)\n&gt;   at java.base/java.lang.reflect.Method.invoke(Method.java:577)   at\n&gt; org.testng.internal.invokers.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:139)\n&gt;   at\n&gt; org.testng.internal.invokers.MethodInvocationHelper.invokeMethodConsideringTimeout(MethodInvocationHelper.java:69)\n&gt;   at\n&gt; org.testng.internal.invokers.ConfigInvoker.invokeConfigurationMethod(ConfigInvoker.java:361)\n&gt;   at\n&gt; org.testng.internal.invokers.ConfigInvoker.invokeConfigurations(ConfigInvoker.java:296)\n&gt;   at\n&gt; org.testng.internal.invokers.TestInvoker.runConfigMethods(TestInvoker.java:816)\n&gt;   at\n&gt; org.testng.internal.invokers.TestInvoker.invokeMethod(TestInvoker.java:590)\n&gt;   at\n&gt; org.testng.internal.invokers.TestInvoker.invokeTestMethod(TestInvoker.java:221)\n&gt;   at\n&gt; org.testng.internal.invokers.MethodRunner.runInSequence(MethodRunner.java:50)\n&gt;   at\n&gt; org.testng.internal.invokers.TestInvoker$MethodInvocationAgent.invoke(TestInvoker.java:962)\n&gt;   at\n&gt; org.testng.internal.invokers.TestInvoker.invokeTestMethods(TestInvoker.java:194)\n&gt;   at\n&gt; org.testng.internal.invokers.TestMethodWorker.invokeTestMethods(TestMethodWorker.java:148)\n&gt;   at\n&gt; org.testng.internal.invokers.TestMethodWorker.run(TestMethodWorker.java:128)\n&gt;   at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)   at\n&gt; org.testng.TestRunner.privateRun(TestRunner.java:806)     at\n&gt; org.testng.TestRunner.run(TestRunner.java:601)    at\n&gt; org.testng.SuiteRunner.runTest(SuiteRunner.java:433)  at\n&gt; org.testng.SuiteRunner.runSequentially(SuiteRunner.java:427)  at\n&gt; org.testng.SuiteRunner.privateRun(SuiteRunner.java:387)   at\n&gt; org.testng.SuiteRunner.run(SuiteRunner.java:330)  at\n&gt; org.testng.SuiteRunnerWorker.runSuite(SuiteRunnerWorker.java:52)  at\n&gt; org.testng.SuiteRunnerWorker.run(SuiteRunnerWorker.java:95)   at\n&gt; org.testng.TestNG.runSuitesSequentially(TestNG.java:1256)     at\n&gt; org.testng.TestNG.runSuitesLocally(TestNG.java:1176)  at\n&gt; org.testng.TestNG.runSuites(TestNG.java:1099)     at\n&gt; org.testng.TestNG.run(TestNG.java:1067)   at\n&gt; org.apache.maven.surefire.testng.TestNGExecutor.run(TestNGExecutor.java:151)\n&gt;   at\n&gt; org.apache.maven.surefire.testng.TestNGDirectoryTestSuite.executeSingleClass(TestNGDirectoryTestSuite.java:111)\n&gt;   at\n&gt; org.apache.maven.surefire.testng.TestNGDirectoryTestSuite.execute(TestNGDirectoryTestSuite.java:98)\n&gt;   at\n&gt; org.apache.maven.surefire.testng.TestNGProvider.invoke(TestNGProvider.java:155)\n&gt;   at\n&gt; org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:456)\n&gt;   at\n&gt; org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:169)\n&gt;   at\n&gt; org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:595)\n&gt;   at\n&gt; org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:581)\n</code></pre>\n"
    },
    {
      "tags": [
        "java",
        "annotations",
        "javac"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 5050667,
            "display_name": "Yassin Hajaj"
          },
          "edited": false,
          "comment_id": 133816629,
          "body": "Why do you think the problem lies in javac and not java itself ? I mean, you only used javac to compile it in the beginning, java is the one that worked with different contexts."
        },
        {
          "owner": {
            "user_id": 521799,
            "display_name": "Lukas Eder"
          },
          "edited": false,
          "comment_id": 133816697,
          "body": "@YassinHajaj: I asserted (just like that!) that the Right Thingâ„¢ to do here is to ignore this missing enum reference. A user of <code>x</code> (running <code>java</code>) can&#39;t really do much about it anyway, whereas a user of <code>q</code> (running <code>javac</code>) might still be able to fix things by adding a dependency."
        },
        {
          "owner": {
            "user_id": 5050667,
            "display_name": "Yassin Hajaj"
          },
          "edited": false,
          "comment_id": 133817993,
          "body": "Indeed, I read through some of the information here. Thanks for the additional information, it indeed can only be <code>javac</code>"
        },
        {
          "owner": {
            "user_id": 5639961,
            "display_name": "yyyy"
          },
          "edited": false,
          "comment_id": 133841351,
          "body": "I found a probably related bug report <a href=\"https://bugs.openjdk.org/browse/JDK-6550655\" rel=\"nofollow noreferrer\">bugs.openjdk.org/browse/JDK-6550655</a> mentioned &quot;If a completion failure is thrown when entering an annotation through ClassReader, a <b>warning</b> is issued.&quot;. So the warning is intentional. I don&#39;t think JLS said anything about warnings during compiling."
        },
        {
          "owner": {
            "user_id": 521799,
            "display_name": "Lukas Eder"
          },
          "edited": false,
          "comment_id": 133841489,
          "body": "@yyyy: Great finding! I wonder if it was implemented wrongly. There&#39;s a claim that <i>&quot;but C.java is successfully compiled, and C.class correctly seems to contain the @B annotation. Probably some added warning is in order in case A.class could be found but A$E.class could not.&quot;</i> - The test in your linked issue only removed the enum, not the annotation, in case of which I agree with the warning. If both are removed, then I don&#39;t see the point of the warning."
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 521799,
            "display_name": "Lukas Eder"
          },
          "up_vote_count": 2,
          "is_accepted": true,
          "creation_date": 1680182156,
          "answer_id": 75888750,
          "body": "<p>As <a href=\"https://stackoverflow.com/questions/75864102/how-to-avoid-javac-warning-unknown-enum-constant-reason-class-file-not-found?noredirect=1#comment133841351_75864102\">commented by user yyyy</a> and also on the <a href=\"https://github.com/jOOQ/jOOQ/issues/14865#issuecomment-1489310283\" rel=\"nofollow noreferrer\">library bug tracker</a>, the current behaviour is defined by a fix <a href=\"https://bugs.openjdk.org/browse/JDK-6550655\" rel=\"nofollow noreferrer\">JDK-6550655</a>, which introduced the warning in Java 7 (before, this annotation/enum usage resulted in a compilation error).</p>\n<p><a href=\"https://bugs.openjdk.org/browse/JDK-6550655\" rel=\"nofollow noreferrer\">JDK-6550655</a> is slightly different. The warning was introduced for cases where only the enum <code>p.E</code> is absent, not the annotation <code>p.A</code>, in case of which, indeed, undesired runtime errors will occur when accessing <code>p.A</code> using reflection API. Warning developers of this situation is certainly desired. In this case here, however, all content of the <code>p</code> package is absent, meaning there can't be any runtime errors, and the absence should be fine as per the design of annotations, which are allowed to be absent.</p>\n<p>In my opinion, this is a bug in javac, which I've reported: <a href=\"https://bugs.openjdk.org/browse/JDK-8305250\" rel=\"nofollow noreferrer\">JDK-8305250</a>. It may or may not be accepted or fixed.</p>\n"
        }
      ],
      "owner": {
        "user_id": 521799,
        "display_name": "Lukas Eder"
      },
      "view_count": 777,
      "up_vote_count": 20,
      "accepted_answer_id": 75888750,
      "answer_count": 1,
      "score": 20,
      "creation_date": 1679993215,
      "question_id": 75864102,
      "body": "<p>I have this example setup:</p>\n<p><strong><code>p.E</code></strong></p>\n<pre class=\"lang-java prettyprint-override\"><code>package p;\n\npublic enum E { E }\n</code></pre>\n<p><strong><code>p.A</code></strong></p>\n<pre class=\"lang-java prettyprint-override\"><code>package p;\n\nimport java.lang.annotation.*;\n\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface A {\n    p.E e();\n}\n</code></pre>\n<p><strong><code>q.Test</code></strong></p>\n<pre class=\"lang-java prettyprint-override\"><code>package q;\n\nimport p.*;\n\n@A(e = E.E)\npublic class Test {\n    public static void main(String[] args) {\n        System.out.println(&quot;Test.main()&quot;);\n    }\n}\n</code></pre>\n<p>So, I can now do this:</p>\n<pre class=\"lang-none prettyprint-override\"><code>$ javac q/Test.java\n$ rm p/*.class\n$ ll */*\n-rw-r--r-- 1 lukas 197609 118 Mar 28 10:21 p/A.java\n-rw-r--r-- 1 lukas 197609  32 Mar 28 09:43 p/E.java\n-rw-r--r-- 1 lukas 197609 486 Mar 28 10:22 q/Test.class\n-rw-r--r-- 1 lukas 197609 153 Mar 28 09:55 q/Test.java\n$ java q/Test\nTest.main()\n</code></pre>\n<p>No problem, the annotations are optional and ignored by the runtime, no <code>NoClassDefFoundError</code></p>\n<p>However, when I remove the source files of <code>p</code> as well, keeping the compiled <code>Test.class</code>:</p>\n<pre><code>$ rm -Rf p\n</code></pre>\n<p>And then create:</p>\n<p><strong><code>x.Test2</code></strong></p>\n<pre class=\"lang-java prettyprint-override\"><code>package x;\n\npublic class Test2 {\n    q.Test test;\n}\n</code></pre>\n<p>Compiling that class gives a warning:</p>\n<pre class=\"lang-none prettyprint-override\"><code>$ javac x/Test2.java\nwarning: unknown enum constant E.E\n  reason: class file for p.E not found\n1 warning\n</code></pre>\n<h2>Alternatives, that don't produce such a warning</h2>\n<h3>No enum</h3>\n<p>I don't get this warning for an annotation that doesn't depend on any enums. I.e. repeat the procedure for these, and there's no warning:</p>\n<p><strong><code>p.A</code></strong></p>\n<pre class=\"lang-java prettyprint-override\"><code>package p;\n\nimport java.lang.annotation.*;\n\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface A {}\n</code></pre>\n<p><strong><code>q.Test</code></strong></p>\n<pre class=\"lang-java prettyprint-override\"><code>package q;\n\nimport p.*;\n\n@A\npublic class Test {\n    public static void main(String[] args) {\n        System.out.println(&quot;Test.main()&quot;);\n    }\n}\n</code></pre>\n<h3>Class reference</h3>\n<p>When <code>A</code> references <code>Class&lt;E&gt;</code> instead of an <code>E.E</code> enum value, I still don't get any warnings:</p>\n<p><strong><code>p.A</code></strong></p>\n<pre class=\"lang-java prettyprint-override\"><code>package p;\n\nimport java.lang.annotation.*;\n\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface A {\n    Class&lt;?&gt; a();\n}\n</code></pre>\n<p><strong><code>q.Test</code></strong></p>\n<pre class=\"lang-java prettyprint-override\"><code>package q;\n\nimport p.*;\n\n@A(a = E.class)\npublic class Test {\n    public static void main(String[] args) {\n        System.out.println(&quot;Test.main()&quot;);\n    }\n}\n</code></pre>\n<h2>My questions:</h2>\n<ol>\n<li>Is this a correct warning according to the JLS? It seems like a bug in javac to me, given the annotation is optional and doesn't produce a warning if there's no <code>enum</code> type involved, but I may be missing something.</li>\n<li>Is there any way to work around this warning in client code?</li>\n</ol>\n<p><strong>For context: the real world use-case is:</strong></p>\n<ul>\n<li>The <code>p</code> package containing the annotations are from JAXB</li>\n<li>The <code>q</code> package containing library code that references the annotations is a library whose dependency on <code>p</code> is optional. (jOOQ to be specific, <a href=\"https://github.com/jOOQ/jOOQ/issues/14865\" rel=\"noreferrer\">more details here</a>)</li>\n<li>The <code>x</code> package is client code, depending on the <code>q</code> package, which has an optional dependency on <code>p</code>, meaning, the dependency is effectively missing by default.</li>\n</ul>\n"
    },
    {
      "tags": [
        "java",
        "java-11",
        "timezone-offset",
        "tzdata"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 5133585,
            "display_name": "Sweeper"
          },
          "edited": false,
          "comment_id": 132973333,
          "body": "On OpenJDK 17, I get the expected output."
        },
        {
          "owner": {
            "user_id": 466862,
            "display_name": "Mark Rotteveel"
          },
          "edited": false,
          "comment_id": 132973418,
          "body": "@Sweeper Which exact version? This might very well have to do with timezone DB changes, which can vary by point release (e.g. I have the &quot;wrong&quot; output with Temurin 17.0.6.10)."
        },
        {
          "owner": {
            "user_id": 1641860,
            "display_name": "JeroenHoek"
          },
          "edited": false,
          "comment_id": 132973475,
          "body": "Timezone database versions per JDK version: <a href=\"https://www.oracle.com/java/technologies/tzdata-versions.html\" rel=\"nofollow noreferrer\">oracle.com/java/technologies/tzdata-versions.html</a>"
        },
        {
          "owner": {
            "user_id": 1641860,
            "display_name": "JeroenHoek"
          },
          "edited": false,
          "comment_id": 132974471,
          "body": "@OleV.V. The thing here though is that a <i>newer</i> version of the JDK, and the timezone database are giving different behaviour."
        },
        {
          "owner": {
            "user_id": 5133585,
            "display_name": "Sweeper"
          },
          "edited": false,
          "comment_id": 132974723,
          "body": "I checked a few versions of the tzdb and found that the amsterdam zone got moved from the europe file to the backzone file. Other than that, I couldn&#39;t find any significant changes on the versions I checked (all 2020a+). It might be helpful if you can <a href=\"https://stackoverflow.com/a/41775223/5133585\">specify what version of tzdb you are using.</a>"
        },
        {
          "owner": {
            "user_id": 21156710,
            "display_name": "Bastiaan Sanders"
          },
          "edited": false,
          "comment_id": 132975305,
          "body": "@Sweeper, I&#39;ve edited the question with extra information regarding timezone database versions."
        },
        {
          "owner": {
            "user_id": 5133585,
            "display_name": "Sweeper"
          },
          "edited": false,
          "comment_id": 132975545,
          "body": "Okay, I found it. It is <a href=\"https://github.com/eggert/tz/commit/0b925f6d8aaf927ac20049ae0ff3b527684b60c7#diff-b11f203e8e6ce90d0ab5a01a37ac248669987afb2a50fe0224fa8b8c5c985a73R964\" rel=\"nofollow noreferrer\">this line in this commit</a>. They basically made Amsterdam an alias of Brussels because they share the same times post-1970. 2022b was the first version this change was applied to, it seems."
        },
        {
          "owner": {
            "user_id": 1641860,
            "display_name": "JeroenHoek"
          },
          "edited": false,
          "comment_id": 132975625,
          "body": "@Sweeper We (I&#39;m a colleague of Bastiaan) suspected that that change might be relevant, but I figured that the move of that data to <code>backzone</code> was just administrative; not that it would actually change behaviour downstream! It seems like rather an impactful thing if it is."
        },
        {
          "owner": {
            "user_id": 1641860,
            "display_name": "JeroenHoek"
          },
          "edited": false,
          "comment_id": 132975769,
          "body": "I&#39;ve found a related issue thread for the Corretto JDK here: <a href=\"https://github.com/corretto/corretto-17/issues/100\" rel=\"nofollow noreferrer\">github.com/corretto/corretto-17/issues/100</a>"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 1641860,
            "display_name": "JeroenHoek"
          },
          "up_vote_count": 17,
          "is_accepted": true,
          "creation_date": 1675686664,
          "answer_id": 75361346,
          "body": "<p><em>Disclaimer: I'm a colleague of OP. This issue has half the office baffled.</em></p>\n<p>Helped along by comments by @Sweeper below the question, I think we've found the cause.</p>\n<h1>Background</h1>\n<p>The venerable Timezone Database <a href=\"https://github.com/eggert/tz/commit/0b925f6d8aaf927ac20049ae0ff3b527684b60c7#diff-b11f203e8e6ce90d0ab5a01a37ac248669987afb2a50fe0224fa8b8c5c985a73R964\" rel=\"nofollow noreferrer\">did some housecleaning</a> in 2022, and archived a lot of pre-1970 timezone data in their <code>backzone</code> file for version <code>2022b</code>. This allowed them to merge, for example, <code>Europe/Brussels</code> and <code>Europe/Amsterdam</code> in the leaner post-1970 database (because after 1970, these are in fact equal).</p>\n<p>They also introduced a special option (<code>PACKRATLIST</code>) for building the timezone database <strong>with</strong> the historic timezones intact.</p>\n<p>OpenJDK updated to the new version of the Timezone Database, but chose to use the version without historical data, and subsequently, <a href=\"https://github.com/corretto/corretto-17/issues/100\" rel=\"nofollow noreferrer\">some developers noticed things breaking</a>.</p>\n<p><a href=\"https://bugs.openjdk.org/browse/JDK-8292223\" rel=\"nofollow noreferrer\">The relevant OpenJDK bug</a> however currently lists supporting the <code>backzone</code> as <strong>won't fix</strong>.</p>\n<h1>Affected JDK's</h1>\n<ul>\n<li>Java 11 from 11.0.17 onwards.</li>\n<li>Java 17 from 17.0.5 onwards.</li>\n</ul>\n<h1>Possible solutions</h1>\n<ul>\n<li>Perhaps newer JDK's will fix this after all? <a href=\"https://bugs.openjdk.org/browse/JDK-8303899\" rel=\"nofollow noreferrer\">Unknown at this moment.</a></li>\n<li>Alternatively, use the newer JDK's, but apply <a href=\"https://github.com/corretto/corretto-17/issues/100#issuecomment-1287485126\" rel=\"nofollow noreferrer\">this workaround</a> to install an older version (<code>2022a</code>) of the Timezone Database instead.</li>\n<li>Or, rewrite all code that depends on this historical data, possibly by hardcoding the relevant timezone offsets if it is a limited set.</li>\n</ul>\n"
        }
      ],
      "owner": {
        "user_id": 21156710,
        "display_name": "Bastiaan Sanders"
      },
      "view_count": 567,
      "up_vote_count": 16,
      "accepted_answer_id": 75361346,
      "answer_count": 1,
      "score": 16,
      "creation_date": 1675676935,
      "question_id": 75359690,
      "body": "<p>I found a weird java discrepancy while testing some timezones with the use of <code>ZonedDateTime</code>. I was trying to parse a date before 1970 and saw that the result changes between java versions. The offset for Netherlands in 1932 is <code>+00:19</code>. Does anyone know why this happens? I feel this might be related with the bundling of european timezones in the time zone database project (<a href=\"https://github.com/eggert/tz\" rel=\"noreferrer\">https://github.com/eggert/tz</a>), but i'm not sure. Is there a way to get the old behavior in java? Like with a setting?</p>\n<pre class=\"lang-java prettyprint-override\"><code>\nZonedDateTime zdt = LocalDateTime.parse(&quot;1932-10-20T10:19:32.000&quot;).atZone(ZoneId.of(&quot;Europe/Amsterdam&quot;));\nSystem.out.println(zdt);\n    \nDateTimeFormatter formatter = new DateTimeFormatterBuilder()\n    .append(ISO_LOCAL_DATE)\n    .appendLiteral('T')\n    .appendValue(HOUR_OF_DAY, 2)\n    .appendLiteral(':')\n    .appendValue(MINUTE_OF_HOUR, 2)\n    .optionalStart()\n    .appendLiteral(':')\n    .appendValue(SECOND_OF_MINUTE, 2)\n    .optionalStart()\n    .appendFraction(NANO_OF_SECOND, 3, 3, true)\n    .appendOffset(&quot;+HH:MM&quot;, &quot;Z&quot;)\n    .toFormatter();\n\nSystem.out.println(formatter.format(zdt));\n\nSystem.out.println(\n    java.time.zone.ZoneRulesProvider\n                  .getVersions(&quot;UTC&quot;)\n                  .lastEntry()\n                  .getKey()\n);\n</code></pre>\n<p>Result in Temurin (java jdk) 11.0.16 (expected output), last line showing timezone database version:</p>\n<pre><code>1932-10-20T10:19:32+00:19:32[Europe/Amsterdam]\n1932-10-20T10:19:32.000+00:19\n2022a\n</code></pre>\n<p>Result in Temurin 11.0.17:</p>\n<pre><code>1932-10-20T10:19:32Z[Europe/Amsterdam]\n1932-10-20T10:19:32.000Z\n2022c\n</code></pre>\n<p><strong>Edit</strong>: Also an issue in JDK 17 starting from 17.0.5:</p>\n<p>Temurin 17.0.4:</p>\n<pre><code>1932-10-20T10:19:32+00:19:32[Europe/Amsterdam]\n1932-10-20T10:19:32.000+00:19\n2022a\n</code></pre>\n<p>Temurin 17.0.5:</p>\n<pre><code>1932-10-20T10:19:32Z[Europe/Amsterdam]\n1932-10-20T10:19:32.000Z\n2022c\n</code></pre>\n"
    },
    {
      "tags": [
        "java",
        "probability",
        "uuid",
        "birthday-paradox"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 7696223,
            "display_name": "Scotty Jamison"
          },
          "edited": false,
          "comment_id": 134200849,
          "body": "...no idea. One fun test to try, would be to through up a quick code sample that uses <code>UUID.randomUUID()</code> to generate 50,000 7-digit IDs. Do you see collsions 99% of the time you run this program? Perhaps the pseudo-random-number generator behind <code>UUID.randomUUID()</code> is skewing the probability somehow."
        },
        {
          "owner": {
            "user_id": 1553851,
            "display_name": "shmosel"
          },
          "edited": false,
          "comment_id": 134200959,
          "body": "I did a quick test and got 49993 uniques. Can you share a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>?"
        },
        {
          "owner": {
            "user_id": 721855,
            "display_name": "aled"
          },
          "edited": false,
          "comment_id": 134200972,
          "body": "Are you sure you are calculating the formula right, and using the right formula at it? 16^7=268435456, which is way more than 50000. You should not have too much collisions. Unlike the traditional birthday problem where the number of days is just 365 and number of people is usually higher."
        },
        {
          "owner": {
            "user_id": 12299000,
            "display_name": "kaya3"
          },
          "edited": false,
          "comment_id": 134200974,
          "body": "Given that your arithmetic is correct, there are four plausible explanations: (1) you got lucky, (2) the IDs are not actually truncated to 7 digits, (3) the uniqueness constraint is not being applied properly, (4) the code doing the insertions had some logic to check and retry when it generated a duplicate. There is not really any way for us to know what happened for sure with just the information in your question."
        },
        {
          "owner": {
            "user_id": 73226,
            "display_name": "Martin Smith"
          },
          "edited": false,
          "comment_id": 134201455,
          "body": "This site agrees with your 99.05% calculation <a href=\"https://www.bdayprob.com/\" rel=\"nofollow noreferrer\">bdayprob.com</a> <a href=\"https://i.stack.imgur.com/HvtnG.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/HvtnG.png</a>"
        },
        {
          "owner": {
            "user_id": 765091,
            "display_name": "slothrop"
          },
          "edited": false,
          "comment_id": 134201518,
          "body": "@aled <i>16^7=268435456, which is way more than 50000.</i> True, but it&#39;s not way more than 50000 <i>squared</i>, which is what matters. The probability of a collision is approximately <code>1 - exp(-n^2&#47;2d)</code> - see <a href=\"https://en.wikipedia.org/wiki/Birthday_problem#Approximations\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Birthday_problem#Approximations</a>"
        },
        {
          "owner": {
            "user_id": 721855,
            "display_name": "aled"
          },
          "edited": false,
          "comment_id": 134201535,
          "body": "that proves that we can not trust common sense related to cryptography"
        },
        {
          "owner": {
            "user_id": 765091,
            "display_name": "slothrop"
          },
          "edited": false,
          "comment_id": 134201572,
          "body": "@aled yes indeed, that&#39;s why they call it a paradox :) It makes mathematical sense but it surprises our everyday intuitions"
        },
        {
          "owner": {
            "user_id": 7696223,
            "display_name": "Scotty Jamison"
          },
          "edited": false,
          "comment_id": 134201697,
          "body": "99% is a fairly high probability, but a 1-in-100 chance is still fairly plausible. Given that there doesn&#39;t seem to be any alternative explanation (especially since example runs were made that produced similar probabilities), and assuming you&#39;ve read the code right and there&#39;s nothing else funky going on, you may just have to say that this was crazy luck. But, if you don&#39;t fix the issue soon, you&#39;re going to run into a collection fairly quickly - chances of collisions just get higher the more you stick in there!"
        },
        {
          "owner": {
            "user_id": 7696223,
            "display_name": "Scotty Jamison"
          },
          "edited": false,
          "comment_id": 134201708,
          "body": "(or, maybe collisions have occurred - do you have a way of knowing when a collision has happened and caused an insertion to fail?)"
        },
        {
          "owner": {
            "user_id": 765091,
            "display_name": "slothrop"
          },
          "edited": false,
          "comment_id": 134201741,
          "body": "Stepping back a bit, if the requirement is to give each DB row a key which is guaranteed unique but doesn&#39;t need to be meaningful - the DBMS should be able to take care of that for you if you define the column appropriately."
        },
        {
          "owner": {
            "user_id": 925913,
            "display_name": "Andrew Cheong"
          },
          "edited": false,
          "comment_id": 134201895,
          "body": "Thanks for everyone for thoughts and ideas. I&#39;ve edited in a mini test. I inherited this service recentlyâ€”the successful 50,000-insert happened in 3 months agoâ€”we don&#39;t keep GCP logs more than 30 days old unfortunately. This code is used for generating 1-time use promo codes, <i>e.g.</i> SUMMER23-65ACFF9, so it needs some randomization, can&#39;t just be an incremented field in the DB. I checked the code in Github history back to Januaryâ€”I see nothing that would have aided the success. But of course I agree with everyone that I haven&#39;t given enough info for a definitive answerâ€”I was looking for ideas."
        },
        {
          "owner": {
            "user_id": 252218,
            "display_name": "BoppreH"
          },
          "edited": false,
          "comment_id": 134201975,
          "body": "Reproduced in Python: <code>from uuid import uuid4; [len({uuid4().hex[:7] for i in range(50000)}) for i in range(100)]</code>. I got one collision-free set in 200 trials."
        },
        {
          "owner": {
            "user_id": 925913,
            "display_name": "Andrew Cheong"
          },
          "edited": false,
          "comment_id": 134207811,
          "body": "I finally have an explanation. I&#39;ve self-answered this question. Thank you to everyone who contributed possibilities (some of you <i>e.g.</i> @kaya3 hit the nail on the head or were very close)."
        },
        {
          "owner": {
            "user_id": 8681,
            "display_name": "Jorn"
          },
          "edited": false,
          "comment_id": 134209688,
          "body": "Your image is black on a dark gray background (in dark mode). It&#39;s nearly impossible to read."
        },
        {
          "owner": {
            "user_id": 925913,
            "display_name": "Andrew Cheong"
          },
          "edited": false,
          "comment_id": 134210176,
          "body": "@Jorn - Oh, thanks for pointing that out. I copied the image directly from Wikipedia. It must have been a transparent PNG. I&#39;ve replaced it with a screenshot."
        },
        {
          "owner": {
            "user_id": 4294399,
            "display_name": "General Grievance"
          },
          "edited": false,
          "comment_id": 134234452,
          "body": "@AndrewCheong If you want to get fancy, you can use Google&#39;s allegedly-deprecated Charts API too. Short version of what you used, <a href=\"https://chart.googleapis.com/chart?cht=tx&amp;chl=p%28n%3Bd%29%20%5Capprox%201%20-%20%5C%28%5Cfrac%7Bd-1%7D%7Bd%7D%5C%29%5E%7B%5Cfrac%7Bn%28n-1%29%7D%7B2%7D%7D\" rel=\"nofollow noreferrer\">here</a>"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 768644,
            "display_name": "rzwitserloot"
          },
          "up_vote_count": 2,
          "is_accepted": false,
          "creation_date": 1682377796,
          "answer_id": 76096696,
          "body": "<p>Running the exact code you pasted, I get <code>false</code>, 10 times. Which means: Yes, collision occurs, quite reliably. Continuing to run until a 'true' is returned, I get:</p>\n<pre><code>7685\n27479\n15262\n46177\n18297\n17230\n14050\n12091\n39249\n8921\n</code></pre>\n<p>Which seems to match the math, that's about what you expect (these numbers represent: The 39249th id I added collided with an already existing ID).</p>\n<p>I assume that you have asked this question because you didn't actually run this code on your machine or misinterpreted what 'false' means.</p>\n<p>If truly you run the EXACT code you pasted  and you get anything but 10x <code>false</code> (well, 1 in 120 or so would be a true by happenstance), then something very, very bizarre is going wrong, most likely related to exactly how random number generation works on your bizarro JVM. But, that sounds <em>very</em> farfetched indeed.</p>\n<p>Here is the slightly adjusted code to print point-of-duplication:</p>\n<pre><code>        final int N = 20000;\n        for (int trial = 0; trial &lt; 10; trial++) {\n            HashSet&lt;String&gt; strings = new HashSet&lt;&gt;();\n            int i = 0;\n            while (true) {\n                i++;\n                String uuid = UUID.randomUUID().toString();\n                String id = uuid.substring(uuid.length() - 7);\n                if (strings.contains(id)) {\n                    success = false;\n                    System.out.println(i);\n                    break;\n                }\n                strings.add(id);\n            }\n//            System.out.println(success);\n        }\n</code></pre>\n<p>Some explanations for what your friend has observed. These are wild stabs in the dark:</p>\n<ul>\n<li>They do have collisions and misconstrued the situation: Whatever checks they did to ensure there are no collisions was done erroneously.</li>\n<li>Their code will pick up on a collision and 'reroll the dice'. In which case your application will grind to a halt over time, as you get closer and closer to 16^7 entries in the database, the amount of rerolls on the random UUID until you luck into one that doesn't collide grows exponentionally near the end. Your friend didn't tell you this, or forgot that their code does this.</li>\n<li>The query as designed doesn't <em>actually</em> insert the last 7 characters of the UUID, but instead inserts the whole UUID.</li>\n<li>The query as designed doesn't <em>actually</em> insert the last 7 characters of the UUID, but instead the db default which is e.g. an auto increment (a db SEQUENCE).</li>\n<li>The UUID generator your friend uses isn't a 'normal' one (that randoms it up) but a modified variant; various such variants exist; they could for example have their own UUID generator that just generates 000001, 000002, and so on. In which case you won't get a collision until 16^7 records are added.</li>\n</ul>\n"
        },
        {
          "owner": {
            "user_id": 925913,
            "display_name": "Andrew Cheong"
          },
          "up_vote_count": 6,
          "is_accepted": true,
          "creation_date": 1682415376,
          "answer_id": 76099679,
          "body": "<p>Finally I have an explanation. Thank you everyone for helpful ideas.</p>\n<p><strong>tl;dr</strong> - I thought there had <em>had</em> to have been a unique constraint at the time of insert, by the fact that indeed there were 50,000 distinct codes in the database. But it turned out there was <em>not</em> a constraint at that time. There indeed were duplicates among the 50,000 originally, that a month later were found and modified via a one-time SQL statement (modified by appending a &quot;1&quot;).</p>\n<p><strong>Full explanation:</strong></p>\n<p>This code was about generating one-time use promo codes such as SUMMER23-65ACFF9. This is how I reasoned that indeed 50,000 <em>distinct</em> codes had been inserted into the database:</p>\n<p><a href=\"https://i.stack.imgur.com/6J2Ob.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6J2Ob.png\" alt=\"enter image description here\" /></a></p>\n<p>This table didn't have a timestamp field (<em>e.g.</em> last_modified) or I might have had a hint sooner. I only knew that the <em>batch</em> of 50,000 promo codes were inserted on January 6th, 2023â€”3 months ago.</p>\n<p><a href=\"https://i.stack.imgur.com/5fUoT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5fUoT.png\" alt=\"enter image description here\" /></a></p>\n<p>I browsed the repo at the last commit before January 6th, 2023 to see if something about the code back then might have allowed 50,000 codes to succeed. The relevant code was this:</p>\n<p><a href=\"https://i.stack.imgur.com/XNY7Y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XNY7Y.png\" alt=\"enter image description here\" /></a></p>\n<p>I believed that, because of the calls to .rollback(), the insert of 50,000 rows was being done atomically. In other words, if a single insert failed, all the inserts up until then should have been rolled back.</p>\n<p>(So one possibility was that my colleague(s) just kept retrying and retrying until they hit the 1% jackpot. But when I asked them, that didn't seem to be the case. They did not recall having to retry at all.)</p>\n<p>I did wonder if the constraint for unique promo_code_id existed at the time of insertion. I checked that it did exist:</p>\n<p><a href=\"https://i.stack.imgur.com/u9Xlt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/u9Xlt.png\" alt=\"enter image description here\" /></a></p>\n<p>I was hoping to find a timestamp for when this constraint was created but didn't immediately see one. I should have pursued that a little further, but I didn't because: I had already queried for a count of <em>distinct</em> promo_code_ids and gotten 50,000 (see first screenshot above). Constraint or no constraint, the probability of ending up with 50,000 distinct codes was still less than 1%. <strong>This is where I made a faulty assumption: that the codes hadn't been tampered with <em>since</em>.</strong></p>\n<p>Today I came across a Liquibase XML change in February (a month after the &quot;successful&quot; 50,000 inserts) where we apparently added the constraint:</p>\n<p><a href=\"https://i.stack.imgur.com/MEMlr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MEMlr.png\" alt=\"enter image description here\" /></a></p>\n<p>But notice the SQL that comes with that change, besides adding the unique constraint. <strong>We essentially ran a script to add a &quot;1&quot; to the end of all duplicate codes.</strong> So <em>that</em> is how the &quot;insert of 50,000 codes without duplicates&quot; succeeded: It didn'tâ€”it was without constraint in the first place, and corrected afterward.</p>\n"
        },
        {
          "owner": {
            "user_id": 3279222,
            "display_name": "OldFrank"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1682462371,
          "answer_id": 76105929,
          "body": "<p>Interesting statistics - I'm missing the &quot;business-side-view&quot; in this discussion.\nAssume that 2% - 5% of targeted customers are effectively using the promo code: What is the chance of a customer getting a message &quot;your promo code already used&quot; AND going to competition? Rate of customer loss is probably not worth the effort of all this complex dual-platform uniqueness-enhancement.\nFrom a statistical viewpoint: adding a &quot;1&quot; at DB-level won't fix a triple occurence, but as stated above: it won't matter.</p>\n"
        }
      ],
      "owner": {
        "user_id": 925913,
        "display_name": "Andrew Cheong"
      },
      "view_count": 534,
      "up_vote_count": 17,
      "accepted_answer_id": 76099679,
      "answer_count": 3,
      "score": 16,
      "creation_date": 1682364771,
      "question_id": 76095452,
      "body": "<p>I've encountered some code that generates a number of UUIDs via <code>UUID.randomUUID()</code>, takes the last 7 digits of each (recent versions of UUID are uniformly distributed in terms of entropy), and uses that as a key to insert rows into a database.</p>\n<p>I wondered what the probability of collision was. I remembered <a href=\"https://en.wikipedia.org/wiki/Birthday_problem\" rel=\"noreferrer\">the Birthday Problem</a>. This is an instance of that problem, is it not? Instead of 365 days in a year, there are 16^7 possible strings. Then according to that Wikipedia page, the probability of collision given <em>n</em> strings is</p>\n<p><a href=\"https://i.stack.imgur.com/Kc4IF.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/Kc4IF.png\" alt=\"enter image description here\" /></a></p>\n<p>where <em>d</em> is 16^7.</p>\n<p>A colleague asserted that they were able to insert 50,000 rows without an issue. I doubted this because the probably of collision with <em>n=50,000</em> and <em>d=16^7</em> is</p>\n<pre><code>1-((16^7-1)/16^7)^(50000*(50000-1)/2) = 99.05%\n</code></pre>\n<p>But then I checked our database. Indeed the 50,000 inserts succeeded.</p>\n<p>How was that possible? (Besides that they got really lucky.) Am I misapplying the Birthday Problem?</p>\n<hr />\n<p><strong>Edit</strong></p>\n<p>Here's a minimal test that shows there <em>should</em> have been collisions.</p>\n<pre><code>import java.util.UUID;\nimport java.util.HashSet;\n\npublic class MyClass {\n    public static void main(String args[]) {\n        final int N = 50000;\n        for (int trial = 0; trial &lt; 10; trial++) {\n            HashSet&lt;String&gt; strings = new HashSet&lt;&gt;();\n            Boolean success = true;\n            for (int i = 0; i &lt; N; i++) {\n                String uuid = UUID.randomUUID().toString();\n                String id = uuid.substring(uuid.length() - 7);\n                if (strings.contains(id)) {\n                    success = false;\n                    // System.out.println(id);\n                    break;\n                }\n                strings.add(id);\n            }\n            System.out.println(success);\n        }\n    }\n}\n</code></pre>\n<p>For N=50,000, 10 out of 10 attempts had a collisionâ€”which would be expected of a 99% collision rate. For N=10,000, I see 0, 1, 2, or 3 out of 10 attempts with collisions, which all fall within expectations for a 17% collision rate.</p>\n"
    },
    {
      "tags": [
        "java",
        "android",
        "android-studio",
        "kotlin"
      ],
      "answers": [
        {
          "owner": {
            "user_id": 1540854,
            "display_name": "jeprubio"
          },
          "up_vote_count": 13,
          "is_accepted": false,
          "creation_date": 1681504465,
          "answer_id": 76018755,
          "body": "<p>I can see it, probably you have chosen the templates for a compose activity which now are the default ones, if the app is in compose it can only use kotlin and I guess that's why if the compose option is selected it doesn't allow you to choose java then.</p>\n<p>After selecting <strong>Empty Activity</strong> (in compose):</p>\n<p><a href=\"https://i.stack.imgur.com/3LUvsm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3LUvsm.png\" alt=\"enter image description here\" /></a></p>\n<p>After selecting one of the traditional views options like the <strong>Basic Views Activity</strong>:</p>\n<p><a href=\"https://i.stack.imgur.com/xJMtRm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xJMtRm.png\" alt=\"enter image description here\" /></a></p>\n"
        },
        {
          "owner": {
            "user_id": 17781834,
            "display_name": "Yohannes Masterous"
          },
          "up_vote_count": 13,
          "is_accepted": true,
          "creation_date": 1681700496,
          "answer_id": 76031445,
          "body": "<p>On <strong>Android Studio Flamingo | 2022.2.1</strong>, you can select <strong>Empty Views Activity</strong> when creating a new project as shown below.\n<a href=\"https://i.stack.imgur.com/czhZ6.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/czhZ6.png\" alt=\"enter image description here\" /></a></p>\n<p>And you can still choose the <strong>Java</strong> or <strong>Kotlin</strong> language as usual.\n<a href=\"https://i.stack.imgur.com/j8SuR.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/j8SuR.png\" alt=\"enter image description here\" /></a></p>\n"
        }
      ],
      "owner": {
        "user_id": 21644444,
        "display_name": "oneuromancer"
      },
      "view_count": 4271,
      "up_vote_count": 12,
      "accepted_answer_id": 76031445,
      "answer_count": 2,
      "score": 12,
      "creation_date": 1681503966,
      "question_id": 76018702,
      "body": "<p>I updated my android studio to the flamingo version today, and I found it strange that there is no longer an option to select languages on the new project screen. Is this a bug? did I do something wrong? Or is there really no more support for the java language in Flamingo? How can I resolve this?</p>\n<p>Thanks for any help! Unfortunately I didn't find any answer to this problem on the internet.</p>\n<p><img src=\"https://i.stack.imgur.com/QEFqg.png\" alt=\"new project options\" /></p>\n<p>I do not know what to do.</p>\n"
    },
    {
      "tags": [
        "java",
        "multithreading",
        "spring-boot",
        "spring-webflux",
        "project-loom"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 6051176,
            "display_name": "Martin Tarj&#225;nyi"
          },
          "edited": false,
          "comment_id": 132935977,
          "body": "There is an open issue for the loom integration in Reactor: <a href=\"https://github.com/reactor/reactor-core/issues/3084\" rel=\"nofollow noreferrer\">github.com/reactor/reactor-core/issues/3084</a> Probably it should be followed for further developments in this topic."
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 10871900,
            "display_name": "dan1st"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1677164331,
          "answer_id": 75546539,
          "body": "<h2>Blocking in Reactive code</h2>\n<p>You can also block in Reactive code, it's just normally not a good idea.</p>\n<p>Without virtual threads, doing a blocking operation would also block the platform thread so you'd essentially be wasting the platform thread if you block in reactive code.</p>\n<h3>with Project Loom</h3>\n<p>If you are using <code>Executors.newVirtualThreadPerTaskExecutor()</code>, this is not a problem any more (at least in most cases, there are some exceptions for e.g. native-code and operations requiring a platform thread).</p>\n<h3>The problems</h3>\n<p>An issue with that is that you are breaking the paradigm. While your project is reactive, some of your code isn't and you are ending up with a codebase that uses reactive code for some parts and doesn't for other parts. However, that might be fine temporarily if you are in the process of migrating an existing Reactive project to synchronous code using virtual threads and you are planning to remove the reactive framework from your project (you could do so incrementally).</p>\n<p>However, note that Virtual Threads are (at the time of writing this) still a preview feature so there may be breaking changes to it. So, you might not want to migrate to virtual threads yet and wait until virtual threads go out of preview as switching back might be pretty difficult.</p>\n<p>In any way, don't start a project using a Reactive framework but blocking inside Reactive code just because you are using Loom's virtual threads. Instead, either choose the Reactive style of programming or use virtual threads and write it synchronously. If you have specific work that should be done in a platform-thread (e.g. CPU-intensive work), nothing stops you from creating a platform thread for that.</p>\n<p>After all, the entire purpose of Reactive programming is not to block threads. If you want to block (virtual) threads, there's no point in using reactive frameworks (at least in my opinion).</p>\n"
        }
      ],
      "owner": {
        "user_id": 14183092,
        "display_name": "kerbermeister"
      },
      "view_count": 2578,
      "up_vote_count": 11,
      "answer_count": 1,
      "score": 11,
      "creation_date": 1675278058,
      "question_id": 75314973,
      "body": "<h1>Java Virtual Threads</h1>\n<p>In Java 19 were introduced Virtual Threads <a href=\"https://openjdk.org/jeps/425\" rel=\"nofollow noreferrer\">JEP-425</a> as a preview feature.</p>\n<p>After some investigation of concept of <em>Java Virtual Threads (Project Loom)</em>, called sometimes <em>lightweight</em> threads (or sometimes <em>fibers</em> or <em>green threads</em>), I'm pretty interested in potential usage of them with reactive libraries, like, for example, with Spring WebFlux based on Project Reactor (reactive streams implementation) and Netty, for making <strong>blocking</strong> calls efficiently.</p>\n<p>Most JVM implementations today implement Java threads as thin direct wrappers around operating system threads, called sometimes <em>heavyweight</em>, OS-managed threads <em>platform</em> threads.</p>\n<p>While a <em>platform</em> thread can only execute a single thread at a time, the <em>virtual</em> threads have the ability to switch to executing a different <em>virtual</em> thread when the currently executed <em>virtual</em> thread makes a <strong>blocking</strong> call (e.g. network, file system, database call).</p>\n<h1>How do we deal with blocking calls in Reactor?</h1>\n<p>So, when dealing with <strong>blocking</strong> calls in Reactor we use <a href=\"https://projectreactor.io/docs/core/release/reference/#faq.wrap-blocking\" rel=\"nofollow noreferrer\">the following construct</a>:</p>\n<pre><code>Mono.fromCallable(() -&gt; {\n     return blockingOperation();\n}).subscribeOn(Schedulers.boundedElastic());\n</code></pre>\n<p>In <code>subcribeOn()</code> we provide a <code>Scheduler</code> that creates a dedicated thread for executing that blocking operation. However, it means that the thread will eventually be blocked, so, as we are still on the old-fashioned threading model, we'll actually block the <em>platform</em> thread, which is still not really efficient way of dealing with CPU resources.</p>\n<h1>Here is the question:</h1>\n<p>So, the question is, could we use the <em>virtual</em> threads with reactive frameworks directly for making blocking calls like this, using, for example, <a href=\"https://docs.oracle.com/en/java/javase/19/docs/api/java.base/java/util/concurrent/Executors.html#newVirtualThreadPerTaskExecutor()\" rel=\"nofollow noreferrer\">Executors.newVirtualThreadPerTaskExecutor()</a> :</p>\n<blockquote>\n<p>Creates an Executor that starts a new virtual Thread for each task.\nThe number of threads created by the Executor is unbounded.</p>\n</blockquote>\n<pre><code>Mono.fromCallable(() -&gt; {\n    return blockingOperation();\n}).subscribeOn(Schedulers.fromExecutorService(Executors.newVirtualThreadPerTaskExecutor()));\n</code></pre>\n<p>Would it work out of the box? Will we actually get the benefits from this approach, in terms of dealing with our CPU-resources more efficiently and increase performance of our application? Does it mean that we can easily integrate reactive library with any blocking library/framework, for example, Spring Data JPA (which is based on JDBC) and millions of others and magically turn them to non-blocking?</p>\n"
    },
    {
      "tags": [
        "java",
        "android",
        "flutter"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 1521370,
            "display_name": "bongo"
          },
          "edited": false,
          "comment_id": 132919386,
          "body": "So it looks that you have java 8 installed (class version 52) but this flutter version requires java 11 ( version 55) so easiest solution would be to update java on your machine."
        },
        {
          "owner": {
            "user_id": 18540229,
            "display_name": "Daniil"
          },
          "edited": false,
          "comment_id": 132969725,
          "body": "I faced the same problem, please help me find a solution"
        },
        {
          "owner": {
            "user_id": 16017956,
            "display_name": "Ajay Jha"
          },
          "edited": false,
          "comment_id": 132970236,
          "body": "Maybe there are two java versions installed on your system."
        },
        {
          "owner": {
            "user_id": 16017956,
            "display_name": "Ajay Jha"
          },
          "edited": false,
          "comment_id": 132970244,
          "body": "export JAVA_HOME=$(/usr/libexec/java_home -v&quot;YOUR_VERSION&quot;) use this command it will be resolved"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 4234055,
            "display_name": "pddthinh"
          },
          "up_vote_count": 7,
          "is_accepted": false,
          "creation_date": 1675532080,
          "answer_id": 75347026,
          "body": "<p><strong>UPDATE</strong></p>\n<p>It turns out there are 2 JDK installed in my environment, you can check by using</p>\n<pre><code>/usr/libexec/java_home -V\n</code></pre>\n<p>so after removing the older JDK version, the issue is fixed.</p>\n<hr />\n<p>Having the same error, although here is my <code>java --version</code> output</p>\n<pre><code>java 19.0.1 2022-10-18\nJava(TM) SE Runtime Environment (build 19.0.1+10-21)\nJava HotSpot(TM) 64-Bit Server VM (build 19.0.1+10-21, mixed mode, sharing)\n</code></pre>\n<p>this happens after I upgrade to flutter 3.7.1</p>\n"
        },
        {
          "owner": {
            "user_id": 3317358,
            "display_name": "marc_"
          },
          "up_vote_count": 6,
          "is_accepted": false,
          "creation_date": 1675641118,
          "answer_id": 75356327,
          "body": "<p>I've had the same error, I haven't specify JAVA_HOME env, and flutter used my 1.8 java.</p>\n<p>For macOS:\nCheck your JAVA_HOME env\nin terminal with</p>\n<pre><code>printenv\n</code></pre>\n<p>if env not existed, list installed java version</p>\n<pre><code>/usr/libexec/java_home -V\n</code></pre>\n<p>choose one and execute</p>\n<pre><code>export JAVA_HOME=$(/usr/libexec/java_home -v&quot;YOUR_VERSION&quot;)\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 14601783,
            "display_name": "Joseph Yang"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1675663645,
          "answer_id": 75357852,
          "body": "<p>You can run the following command to see if you have multiple java versions:</p>\n<pre><code>/usr/libexec/java_home -V\n</code></pre>\n<p>In my case, I had 2 versions on my mac: java 8 and java 19. I followed the official <a href=\"https://www.java.com/en/uninstall/uninstall_instructions.html#:%7E:text=Windows%20ME-,Click%20Start%2C%20point%20to%20Settings%2C%20and%20then%20click%20the%20Control,with%20the%20Uninstall%2C%20click%20Yes.\" rel=\"nofollow noreferrer\">java website</a> to remove my older version:</p>\n<pre><code>sudo rm -fr /Library/Internet\\ Plug-Ins/JavaAppletPlugin.plugin\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 17387530,
            "display_name": "AyeshaA"
          },
          "up_vote_count": 11,
          "is_accepted": false,
          "creation_date": 1675796362,
          "answer_id": 75377828,
          "body": "<p>I'm on MacOS Ventura. I installed Android Studio today. This is how I solved the problem:</p>\n<ol>\n<li>Downloaded <a href=\"https://www.oracle.com/java/technologies/downloads/#jdk19-mac\" rel=\"noreferrer\">JDK19</a></li>\n<li>Followed the steps mentioned at this <a href=\"https://mkyong.com/java/how-to-set-java_home-environment-variable-on-mac-os-x/#what-is-usrlibexecjava-home\" rel=\"noreferrer\">link</a></li>\n<li>Since I'm running Android Studio Electric Eel, opened Terminal and ran this command <code>cd /Applications/Android\\ Studio.app/Contents/jbr</code></li>\n<li>Then ran this command after <code>ln -s ../jbr jdk</code></li>\n<li>And finally, <code>ln -s &quot;/Library/Internet Plug-Ins/JavaAppletPlugin.plugin&quot; jdk</code></li>\n<li>Went to Finder -&gt; Applications -&gt; Android Studio. Right-click Android Studio and select 'Show Package Contents'</li>\n<li>Created new folder 'jre' in folder 'Contents'</li>\n<li>Copied contents from the 'jbr' folder to the 'jre' folder</li>\n<li>Ran <code>flutter doctor</code> again</li>\n<li>Ran <code>flutter doctor --android-licenses</code>.</li>\n</ol>\n<p>I was able to agree to the licenses successfully after.</p>\n<p>All the steps are also mentioned <a href=\"https://stackoverflow.com/questions/51281702/unable-to-find-bundled-java-version-on-flutter/68575967#68575967\">here</a> and <a href=\"https://levelup.gitconnected.com/how-to-install-flutter-on-macos-6e65dc592449\" rel=\"noreferrer\">here</a></p>\n"
        },
        {
          "owner": {
            "user_id": 15924696,
            "display_name": "Thura Khant Thein"
          },
          "up_vote_count": 3,
          "is_accepted": false,
          "creation_date": 1676007313,
          "answer_id": 75407320,
          "body": "<p>Try This (For Windows)</p>\n<ol>\n<li>Uncheck Android SDK command-line Tools (latest)</li>\n<li>Check Android SDK command-line Tools 8.0</li>\n<li>Click Apply</li>\n<li>In Windows go to\nâ€œC:\\Users\\USERNAME\\AppData\\Local\\Android\\Sdk\\cmdline-toolsâ€<br />\nand rename the 8.0 folder to â€œlatestâ€</li>\n<li>Run Flutter doctor again.</li>\n</ol>\n"
        },
        {
          "owner": {
            "user_id": 2196513,
            "display_name": "Abhay"
          },
          "up_vote_count": 2,
          "is_accepted": false,
          "creation_date": 1677129449,
          "answer_id": 75540818,
          "body": "<p>There is a simple way to resolve this issue.</p>\n<ul>\n<li>Check java version you installed on your machine. If it is version 8, Installed Android SDK Command-line Tools 8.0 &amp; uninstalled latest version.\n<a href=\"https://i.stack.imgur.com/bZXeD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bZXeD.png\" alt=\"enter image description here\" /></a></li>\n</ul>\n"
        },
        {
          "owner": {
            "user_id": 21315757,
            "display_name": "ABI"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1677726118,
          "answer_id": 75610959,
          "body": "<p>The problem seems to be when the android studio installed is <strong>Android Studio Electric Eel</strong></p>\n<p>All you have to do is:</p>\n<ol>\n<li>Follow this link and ddownload - install this jdk <a href=\"https://www.oracle.com/java/technologies/downloads/#jdk19-mac\" rel=\"nofollow noreferrer\">https://www.oracle.com/java/technologies/downloads/#jdk19-mac</a></li>\n<li>After installing, goto <strong>Finder -&gt; Applications -&gt; Android Studio. Right-click on Android Studio and select 'Show Package Contents'</strong></li>\n<li>Open the <strong>Contents</strong> folder and create new folder and name it <strong>jre</strong></li>\n<li>There's a folder named <strong>jbr</strong> open it and copy the folder inside it and paste it into your newly created folder on step 3 (jre).</li>\n<li>You can now be able to accept the licences by running- <strong>flutter doctor --android-licences</strong></li>\n</ol>\n"
        }
      ],
      "owner": {
        "user_id": 16017956,
        "display_name": "Ajay Jha"
      },
      "view_count": 8286,
      "up_vote_count": 10,
      "answer_count": 7,
      "score": 10,
      "creation_date": 1675365835,
      "question_id": 75328050,
      "body": "<p>I am trying to accept flutter doctor --android-licenses but I am getting this error:</p>\n<pre><code>Error: A JNI error has occurred, please check your installation and try again\nException in thread &quot;main&quot; java.lang.UnsupportedClassVersionError: com/android/prefs/AndroidLocationsProvider has been compiled by a more recent version of the Java Runtime (class file version 55.0), this version of the Java Runtime only recognizes class file versions up to 52.0\n</code></pre>\n"
    },
    {
      "tags": [
        "java",
        "android",
        "gradle",
        "kapt"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 1797912,
            "display_name": "Chriki"
          },
          "edited": false,
          "comment_id": 132576448,
          "body": "Can you maybe provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> or at least more details on your Gradle setup that results in the quoted message?"
        },
        {
          "owner": {
            "user_id": 436417,
            "display_name": "Uli"
          },
          "edited": false,
          "comment_id": 132942462,
          "body": "This would not even be a problem if Jetbrains hadn&#39;t broken the kotlinOptions.jvmTarget configuration support for kapt in Kotlin 1.8.0 and refuses to fix it: <a href=\"https://youtrack.jetbrains.com/issue/KT-55947/Unable-to-set-kapt-jvm-target-version\" rel=\"nofollow noreferrer\">youtrack.jetbrains.com/issue/KT-55947/&hellip;</a>"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 253468,
            "display_name": "TWiStErRob"
          },
          "up_vote_count": 11,
          "is_accepted": true,
          "creation_date": 1674040807,
          "answer_id": 75158443,
          "body": "<h2>Repro</h2>\n<p>(note: the Google issuetracker doesn't allow downloading the ZIP, did you check some checkbox there to hide it? There's nothing secret in the zip ðŸ˜‰)</p>\n<p>So, using the example provided in the <a href=\"https://github.com/gradle/gradle/issues/18935#issuecomment-1386765542\" rel=\"noreferrer\">semi-related Gradle issue</a> I was able to reproduce with <code>gradlew assemble</code>.</p>\n<h2>Investigation</h2>\n<p>At this point I'm looking for how kapt task gets the Java version, because it should pick up <code>kotlinOptions { jvmTarget = '17' }</code> without question.</p>\n<h3>Source code</h3>\n<p>For this I'll need sources, which are not available when using .gradle files. Konversion of a build.gradle file is necessary so that Android Studio imports the JARs on the plugin classpath under &quot;External Libraries &gt; Kotlin Script dependencies&quot;. This means we can browse the sources of Kotlin, AGP, Gradle. So I changed the root <code>build.gradle</code> to <code>build.gradle.kts</code> (which imports all related plugins) so it reads:</p>\n<pre><code>plugins {\n    id(&quot;com.android.application&quot;) version &quot;8.0.0-alpha11&quot; apply false\n    id(&quot;org.jetbrains.kotlin.android&quot;) version &quot;1.8.0&quot; apply false\n}\n</code></pre>\n<p>(Tip: one AGP plugin declaration is enough to lock in the version of all <code>com.android.*</code> plugins.)</p>\n<h3>Reading code</h3>\n<p>The problematic task is <code>kaptGenerateStubsDebugKotlin</code>, so the task class name should contain <code>GenStub</code> in it, and indeed there's <code>org.jetbrains.kotlin.gradle.internal.KaptGenerateStubsTask</code>, which extends <code>KotlinCompile</code>, hello old friend! <code>KaptGenerateStubsTask.setupCompilerArgs</code> looks like a good place to start.</p>\n<h3>Debug setup</h3>\n<p>At this point it's easier to read the code while executing as well to see the values, so I started a debugging session:</p>\n<pre class=\"lang-bash prettyprint-override\"><code>gradlew cleanKaptGenerateStubsDebugKotlin assemble --no-daemon -Dorg.gradle.debug=true\n</code></pre>\n<p>Then in Android Studio &gt; Run &gt; Edit Configurations... &gt; + &gt; Remote JVM Debug (defaults are good) &gt; OK. And then select the just-created &quot;Unnamed&quot; run config and press the green bug (Debug) button.</p>\n<h3>Debugging notes</h3>\n<p>Behavior of <code>setupCompilerArgs</code>:</p>\n<ul>\n<li><code>contributeArguments</code> does a lot of setup\n<ul>\n<li><code>args.jvmTarget</code> is null initially</li>\n<li><code>compilerOptions.jvmTarget.get()</code> is 17 (compilerOptions in this case is kotlinc task)</li>\n<li><code>(compilerOptions as KotlinJvmCompilerOptionsDefault).fillDefaultValues(args)</code> clears <code>args.jvmTarget</code> (was already cleared)</li>\n<li><code>compilerOptions.fillCompilerArguments(args)</code> sets <code>args.jvmTarget = compilerOptions.jvmTarget.orNull?.target</code> (wohoo, we have 17!)</li>\n</ul>\n</li>\n<li><code>(compilerOptions as KotlinJvmCompilerOptionsDefault).fillCompilerArguments(args)</code>\n<ul>\n<li>sets <code>args.jvmTarget = compilerOptions.jvmTarget.orNull?.target</code> (wtf, we are on <code>null</code> again)</li>\n</ul>\n</li>\n</ul>\n<h3>Conclusion</h3>\n<p>So at this point we know that the problem is that Kapt's <code>jvmTarget</code> doesn't inherit from the global <code>kotlinOptions</code>, this sounds like a KGP bug that only manifests with different targets as in your repro.</p>\n<p>I was curious where this is set, and searching for <code>jvmTarget.set</code> yielded <code>AndroidProjectHandler</code> which sounds pretty relevant. Looking at the calls to <code>wireExtensionOptionsToCompilation</code> they only set up the kotlinCompile, not the kapt task.</p>\n<h2>Workaround</h2>\n<p>Armed with this knowledge the only option I see is</p>\n<pre><code>// TODO remove this once https://youtrack.jetbrains.com/issue/KT-.... is fixed\ntasks.withType(org.jetbrains.kotlin.gradle.internal.KaptGenerateStubsTask).configureEach {\n    kotlinOptions.jvmTarget = '17'\n}\n</code></pre>\n<p>(If you don't want to reference <code>internal</code> classes use the Kapt tasks's superclass <code>KotlinCompile</code> instead; that will configure more though, not just the problematic part.)</p>\n<h2>Report</h2>\n<p>Please report this to YouTrack! Only JetBrains is able to fix this at the moment. Sadly I don't have high hopes for a fix, because Google is in the process of taking over the Android part of KGP (early stages); fingers crossed they won't reimplement the same problem.</p>\n<h2>Fix</h2>\n<p>Following the <a href=\"https://youtrack.jetbrains.com/issue/KTIJ-24311/task-current-target-is-17-and-kaptGenerateStubsProductionDebugKotlin-task-current-target-is-1.8-jvm-target-compatibility-should#focus=Comments-27-6798448.0-0\" rel=\"noreferrer\">suggestion from JetBrains</a>, this will also solve the issue, however it forces users to use the same JDK and target bytecode version:</p>\n<pre class=\"lang-kotlin prettyprint-override\"><code>kotlin {\n    jvmToolchain(17)\n}\n</code></pre>\n<h2>Note</h2>\n<p>Kotlin 1.8 added new DSL for setting these things, but only to tasks, it's not supporting the module level yet, see <a href=\"https://kotlinlang.org/docs/whatsnew18.html#limitations\" rel=\"noreferrer\">https://kotlinlang.org/docs/whatsnew18.html#limitations</a> and the big green note above that section.</p>\n"
        },
        {
          "owner": {
            "user_id": 423199,
            "display_name": "Hector"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1674141683,
          "answer_id": 75174487,
          "body": "<p>I have updated my version Android Studio to</p>\n<pre><code>Android Studio Giraffe | 2022.3.1 Canary 1\nBuild #AI-223.4884.69.2231.9486165, built on January 13, 2023\nRuntime version: 17.0.5+0-17.0.5b653.23-9410051 x86_64\nVM: OpenJDK 64-Bit Server VM by JetBrains s.r.o.\nmacOS 12.6.1\nGC: G1 Young Generation, G1 Old Generation\nMemory: 4096M\nCores: 12\nMetal Rendering is ON\nRegistry:\n    external.system.auto.import.disabled=true\n    ide.text.editor.with.preview.show.floating.toolbar=false\n    ide.images.show.chessboard=true\n\nNon-Bundled Plugins:\n    com.android.aas (3.5.1)\n</code></pre>\n<p>and upgraded to gradle</p>\n<pre><code>plugins {\n    id 'com.android.application' version '8.1.0-alpha01' apply false\n    id 'com.android.library' version '8.1.0-alpha01' apply false\n    id 'org.jetbrains.kotlin.android' version '1.8.0' apply false\n    id 'com.google.dagger.hilt.android' version '2.44.2' apply false\n}\n\ntasks.register('clean') {\n    delete rootProject.buildDir\n}\n</code></pre>\n<p>and gradle wrapper</p>\n<pre><code>#Tue Oct 25 07:38:32 BST 2022\ndistributionBase=GRADLE_USER_HOME\ndistributionPath=wrapper/dists\ndistributionUrl=https\\://services.gradle.org/distributions/gradle-8.0-rc-1-bin.zip\nzipStoreBase=GRADLE_USER_HOME\nzipStorePath=wrapper/dists\n</code></pre>\n<p>all these actions have resulted in the resolution of my issue</p>\n"
        },
        {
          "owner": {
            "user_id": 17953936,
            "display_name": "Eugene Myname"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1682607350,
          "answer_id": 76121853,
          "body": "<p>I fixed this problem this way:\nin project module build.gradle I have this plugins:</p>\n<pre><code>plugins {\n    id 'com.android.application' version '8.0.0' apply false\n    id 'com.android.library' version '8.0.0' apply false\n    id 'org.jetbrains.kotlin.android' version '1.8.0' apply false\n    id 'com.google.dagger.hilt.android' version '2.44' apply false\n}\n</code></pre>\n<p>Those plugins just for information. I didn't do anything with them.\n<br> In <strong>app module</strong> <em>build.gradle</em>\n<br> I didn't touched this compileOptions</p>\n<pre><code>compileOptions {\n        sourceCompatibility JavaVersion.VERSION_1_8\n        targetCompatibility JavaVersion.VERSION_1_8\n    }\n</code></pre>\n<p>I Just added this annotation</p>\n<pre><code>        kotlin {\n                // Or shorter:\n                jvmToolchain(8)\n        }\n</code></pre>\n<p>And commented this annotation</p>\n<pre><code>//    kotlinOptions {\n//        jvmTarget = '1.8'\n//    }\n</code></pre>\n<p>And in settings.gradle\nI added this code in the middle of file:</p>\n<pre><code>plugins {\n    id 'org.gradle.toolchains.foojay-resolver-convention' version '0.4.0'\n}\n</code></pre>\n<p>Found this pieces of code in different sources</p>\n"
        }
      ],
      "owner": {
        "user_id": 423199,
        "display_name": "Hector"
      },
      "view_count": 2565,
      "up_vote_count": 10,
      "accepted_answer_id": 75158443,
      "answer_count": 3,
      "score": 10,
      "creation_date": 1673615839,
      "question_id": 75109742,
      "body": "<p>My current Android project is displaying the following build messages:-</p>\n<pre><code>&gt; Task :shared:resource:kaptGenerateStubsProductionDebugKotlin\n'compileProductionDebugJavaWithJavac' task (current target is 17) and 'kaptGenerateStubsProductionDebugKotlin' task (current target is 1.8) jvm target compatibility should be set to the same Java version.\nBy default will become an error since Gradle 8.0+! Read more: https://kotl.in/gradle/jvm/target-validation\nConsider using JVM toolchain: https://kotl.in/gradle/jvm/toolchain\n</code></pre>\n<p>How do you configure kapt to generate stubs in a specific version of java?</p>\n<p>I have tried...</p>\n<pre><code>tasks.withType(org.jetbrains.kotlin.gradle.tasks.KaptGenerateStubs).configureEach {\n    kotlinJavaToolchain.jdk.use(\n            &quot;/usr/local/opt/openjdk@17/libexec/openjdk.jdk/Contents/Home&quot;,\n            JavaVersion.VERSION_17\n    )\n}\n</code></pre>\n<p>and</p>\n<pre><code>kapt {\n    javacOptions {\n        option(&quot;--target&quot;, 17)\n    }\n}\n</code></pre>\n<p>none of which made any difference</p>\n<p>Is it possible to control the java version for stubs generated by kapt in an Android project?</p>\n<p>Having enabled verbose logging in kapt3 I can now see I have configure target correctly</p>\n<pre><code>Javac options: {--target=17, --source=17}\n</code></pre>\n<p>and in addition</p>\n<pre><code>[INFO] All Javac options: {-Adagger.fastInit=enabled=-Adagger.fastInit=enabled, -Adagger.hilt.android.internal.disableAndroidSuperclassValidation=true=-Adagger.hilt.android.internal.disableAndroidSuperclassValidation=true, -Adagger.hilt.android.internal.projectType=LIBRARY=-Adagger.hilt.android.internal.projectType=LIBRARY, -ASomeKaptArgument=ArgumentValue=-ASomeKaptArgument=ArgumentValue, -Akapt.kotlin.generated=/Users/frank/github/mobile-android-practiceupdate/shared/resource/build/generated/source/kaptKotlin/productionDebug=-Akapt.kotlin.generated=/Users/frank/github/mobile-android-practiceupdate/shared/resource/build/generated/source/kaptKotlin/productionDebug, -Adagger.hilt.internal.useAggregatingRootProcessor=false=-Adagger.hilt.internal.useAggregatingRootProcessor=false, --target=17, --source=17, -proc:=only, accessInternalAPI=true,.....\n</code></pre>\n<p>however I still see the above build message</p>\n<p>why is kapt ignoring my <code>javacOptions</code>?</p>\n<p>To recreate this issue:-</p>\n<p>Main project gradle</p>\n<pre><code>plugins {\n    id 'com.android.application' version '8.0.0-alpha11' apply false\n    id 'com.android.library' version '8.0.0-alpha11' apply false\n    id 'org.jetbrains.kotlin.android' version '1.8.0' apply false\n    id 'com.google.dagger.hilt.android' version '2.44.2' apply false\n}\n\ntask clean(type: Delete) {\n    delete rootProject.buildDir\n}\n</code></pre>\n<p>gradle wrapper</p>\n<pre><code>#Tue Oct 25 07:38:32 BST 2022\ndistributionBase=GRADLE_USER_HOME\ndistributionPath=wrapper/dists\ndistributionUrl=https\\://services.gradle.org/distributions/gradle-7.6-bin.zip\nzipStoreBase=GRADLE_USER_HOME\nzipStorePath=wrapper/dists\n</code></pre>\n<p>Gradle JDK</p>\n<p><a href=\"https://i.stack.imgur.com/sxcwH.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/sxcwH.png\" alt=\"enter image description here\" /></a></p>\n<p>then use kapt for say room or hilt in any app or sub module in your project with java version set to 17</p>\n<pre><code>    plugins {\n        id 'com.android.application'\n        id 'org.jetbrains.kotlin.android'\n        id 'dagger.hilt.android.plugin'\n        id &quot;org.jetbrains.kotlin.kapt&quot;\n    }\n    \n    android {\n        kapt {\n            javacOptions {\n                option(&quot;--target&quot;, &quot;17&quot;)\n            }\n        }\n        kotlinOptions {\n            jvmTarget = '17'\n            freeCompilerArgs += [\n                    &quot;-Xcontext-receivers&quot;,\n                    &quot;-opt-in=androidx.compose.material3.windowsizeclass.ExperimentalMaterial3WindowSizeClassApi&quot;,\n                    &quot;-opt-in=kotlinx.coroutines.ObsoleteCoroutinesApi&quot;]\n        }\n        compileOptions {\n            sourceCompatibility JavaVersion.VERSION_17\n            targetCompatibility JavaVersion.VERSION_17\n            coreLibraryDesugaringEnabled true\n        }\n        namespace 'com.my.app'\n        compileSdk 33\n        buildToolsVersion &quot;33.0.1&quot;\n    \n        defaultConfig {\n            applicationId &quot;com.my.app&quot;\n            minSdk 26\n            targetSdk 33\n            versionCode 3\n            versionName &quot;3.0&quot;\n    \n            testInstrumentationRunner &quot;androidx.test.runner.AndroidJUnitRunner&quot;\n            vectorDrawables {\n                useSupportLibrary true\n            }\n        }\n\n    buildTypes {\n        release {\n            minifyEnabled false\n            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'\n        }\n    }\n    flavorDimensions &quot;default&quot;\n    productFlavors {\n        development {\n            dimension &quot;default&quot;\n        }\n        staging {\n            dimension &quot;default&quot;\n        }\n        production {\n            dimension &quot;default&quot;\n        }\n    }\n     buildFeatures {\n        compose true\n    }\n    composeOptions {\n        kotlinCompilerExtensionVersion '1.4.0-dev-k1.8.0-33c0ad36f83'\n    }\n    packagingOptions {\n        resources {\n            excludes += '/META-INF/{AL2.0,LGPL2.1}'\n        }\n    }\n}\n\ndependencies {\n\n    coreLibraryDesugaring 'com.android.tools:desugar_jdk_libs:2.0.0'\n\n    implementation 'org.conscrypt:conscrypt-android:2.5.2'\n\n    implementation 'com.google.dagger:hilt-android:2.44.2'\n    kapt 'com.google.dagger:hilt-android-compiler:2.44.2'\n    kapt 'androidx.hilt:hilt-compiler:1.0.0'\n\n}\n</code></pre>\n<p>these are my gradle.properties</p>\n<pre><code># Project-wide Gradle settings.\n# IDE (e.g. Android Studio) users:\n# Gradle settings configured through the IDE *will override*\n# any settings specified in this file.\n# For more details on how to configure your build environment visit\n# http://www.gradle.org/docs/current/userguide/build_environment.html\n# Specifies the JVM arguments used for the daemon process.\n# The setting is particularly useful for tweaking memory settings.\norg.gradle.jvmargs=-Xmx8192m -Dfile.encoding=UTF-8\n# When configured, Gradle will run in incubating parallel mode.\n# This option should only be used with decoupled projects. More details, visit\n# http://www.gradle.org/docs/current/userguide/multi_project_builds.html#sec:decoupled_projects\n# org.gradle.parallel=true\n# AndroidX package structure to make it clearer which packages are bundled with the\n# Android operating system, and which are packaged with your app's APK\n# https://developer.android.com/topic/libraries/support-library/androidx-rn\nandroid.useAndroidX=true\nandroid.enableJetifier=true\n# Kotlin code style for this project: &quot;official&quot; or &quot;obsolete&quot;:\nkotlin.code.style=official\n# Enables namespacing of each library's R class so that its R class includes only the\n# resources declared in the library itself and none from the library's dependencies,\n# thereby reducing the size of the R class for that library\nandroid.nonTransitiveRClass=true\nandroid.defaults.buildfeatures.buildconfig=true\nkapt.verbose=true\n# positive value will enable caching\n# use the same value as the number of modules that use kapt\nkapt.classloaders.cache.size=5\n\n# disable for caching to work\nkapt.include.compile.classpath=false\nkapt.incremental.apt=false\n</code></pre>\n<p>the version of android studio is</p>\n<pre><code>Android Studio Flamingo | 2022.2.1 Canary 11\nBuild #AI-222.4459.24.2221.9445173, built on December 30, 2022\nRuntime version: 17.0.4.1+0-17.0.4.1b469.62-9127311 x86_64\nVM: OpenJDK 64-Bit Server VM by JetBrains s.r.o.\nmacOS 12.6.1\nGC: G1 Young Generation, G1 Old Generation\nMemory: 4096M\nCores: 12\nMetal Rendering is ON\nRegistry:\n    external.system.auto.import.disabled=true\n    ide.text.editor.with.preview.show.floating.toolbar=false\n    gradle.version.catalogs.dynamic.support=true\n    ide.images.show.chessboard=true\n\nNon-Bundled Plugins:\n    com.android.aas (3.5.1)\n    com.jetbrains.kmm (0.5.1(222)-30)\n</code></pre>\n<p>I have created this bug <a href=\"https://issuetracker.google.com/issues/265653154\" rel=\"noreferrer\">report</a> with attached example android project</p>\n<p><strong>UPDATE</strong></p>\n<p>by adding this to my project level <code>build.gradle</code> file the messages disappeared:-</p>\n<pre><code>subprojects {\n    tasks.withType(org.jetbrains.kotlin.gradle.tasks.KotlinCompile) {\n        kotlinOptions.jvmTarget = &quot;17&quot;\n    }\n}\n</code></pre>\n"
    },
    {
      "tags": [
        "java",
        "enums",
        "nullpointerexception",
        "jls",
        "cyclic-reference"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 80901,
            "display_name": "mjn"
          },
          "edited": false,
          "comment_id": 132669470,
          "body": "See also: <a href=\"https://stackoverflow.com/questions/56661077/null-pointer-exception-in-java-enum\" title=\"null pointer exception in java enum\">stackoverflow.com/questions/56661077/&hellip;</a>"
        },
        {
          "owner": {
            "user_id": 12302982,
            "display_name": "Igor Flakiewicz"
          },
          "edited": false,
          "comment_id": 132670025,
          "body": "What&#39;s the error given when they fail?"
        },
        {
          "owner": {
            "user_id": 80901,
            "display_name": "mjn"
          },
          "edited": false,
          "comment_id": 132670077,
          "body": "@IgorFlakiewicz the second <code>assertThat( ... ).isNotNull()</code> fails with &quot;Expecting actual not to be null&quot;, which means that the <code>get...()</code> returns null."
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 1374678,
            "display_name": "rolve"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1675339112,
          "answer_id": 75322845,
          "body": "<h2>Explanation</h2>\n<p>Enum constants are initialized like static fields, so you get a similar outcome as described <a href=\"https://stackoverflow.com/a/6416481/1374678\">here</a>. Basically, to initialize one enum correctly, the other already needs to be fully initialized, and vice versa. Obviously, this is a circular dependency and cannot work.</p>\n<p>As a result, the constants of the <code>Shape</code> enum are initialized before the initialization of <code>Color</code> is complete. Therefore, the fields corresponding to the <code>Color</code> constants <code>RED</code>, <code>GREEN</code>, and <code>BLUE</code> are still <code>null</code> when <code>Shape</code> accesses them during initialization.</p>\n<p>By the way, it seems like any of the two enums could be the one that ends up incorrectly initialized, because the two form a symmetric cycle. However, <a href=\"https://docs.oracle.com/javase/specs/jls/se18/html/jls-12.html#jls-12.4\" rel=\"nofollow noreferrer\">the order of initialization is determined by the order in which a class is first used</a> in the program code. In your tests, the <code>Color</code> enum is used first, and so its initialization is started first. Hence, the JVM loads the code of <code>Color</code>, which references <code>Shape</code>. Before the initalization of <code>Color</code> continues, the code of <code>Shape</code> is loaded. <code>Shape</code> in turn references <code>Color</code>, but since <code>Color</code> is already in the process of being intialized, <code>Shape</code>'s initialization continues, using the uninitialized fields of <code>Color</code>. Finally, <code>Color</code>'s initialization completes, and by now the fields of <code>Shape</code> contain the <code>Shape</code> constants, so <code>Color</code> initializes correctly.</p>\n<h2>Solution</h2>\n<p>I would replace one of the getters, e.g., the one in <code>Shape</code> with something like this:</p>\n<pre><code>Color getColor() {\n    for (Color c : Color.values()) {\n        if (c.getShape() == this) {\n            return c;\n        }\n    }\n    throw new AssertionError();\n}\n</code></pre>\n<p>This way, you don't need the <code>color</code> field in <code>Shape</code> and the circular dependency is avoided.</p>\n<p>An added benefit is that the two enums are guaranteed to be consistent. A change in the <code>Color</code> enum will automatically be reflected in <code>Shape</code>.</p>\n<p>And if you worry about performance (<a href=\"https://softwareengineering.stackexchange.com/q/80084/366400\">I wouldn't</a>), you could also keep the <code>color</code> field in <code>Shape</code> and initialize it the first time <code>getColor</code> is called:</p>\n<pre><code>Color getColor() {\n    if (color == null) {\n        for (Color c : Color.values()) {\n            if (c.getShape() == this) {\n                color = c;\n                return color;\n            }\n        }\n        throw new AssertionError();\n    }\n    return color;\n}\n</code></pre>\n<p>Regarding thread-safety, it's not necessary to have any sort of synchronization here or to make the <code>color</code> field <code>volatile</code>. In case some thread does not see the initialization performed by another thread, it will simply redo the bit of work, but the result will be the same.</p>\n"
        },
        {
          "owner": {
            "user_id": 262683,
            "display_name": "Costi Ciudatu"
          },
          "up_vote_count": 6,
          "is_accepted": true,
          "creation_date": 1675596378,
          "answer_id": 75351871,
          "body": "<p>One way to break the cycle is to make the evaluation lazy in at least one of the enums, thus allowing the other to get initialised before being used. E.g.:</p>\n<pre><code>enum Color {\n    RED(() -&gt; Shape.CIRCLE),\n    GREEN(() -&gt; Shape.TRIANGLE),\n    BLUE(() -&gt; Shape.SQUARE);\n\n    private final Supplier&lt;Shape&gt; shape;\n\n    Color(Supplier&lt;Shape&gt; shape) {\n        this.shape = shape;\n    }\n\n    Shape getShape() {\n        return shape.get();\n    }\n}\n\nenum Shape {\n    CIRCLE(Color.RED),\n    TRIANGLE(Color.GREEN),\n    SQUARE(Color.BLUE);\n\n    private final Color color;\n\n    Shape(Color color) {\n        this.color = color;\n    }\n\n    Color getColor() {\n        return color;\n    }\n}\n</code></pre>\n<p>But I would strongly advice that you revisit your design, as cyclic dependencies are usually a code smell. If shapes are not of a certain color by their nature and the other way around, you probably need a separate abstraction that defines &quot;red circles&quot; and &quot;blue squares&quot;, which has nothing to do with merely being a &quot;circle/square&quot; or being &quot;red/blue&quot;.</p>\n<pre><code>enum Color { RED, GREEN, BLUE }\nenum Shape { CIRCLE, TRIANGLE, SQUARE }\n\nenum ColoredShape {\n\n    RED_CIRCLE(Shape.CIRCLE, Color.RED),\n    GREEN_TRIANGLE(Shape.TRIANGLE, Color.GREEN),\n    MAGENTA_TRIANGLE(...) // because why not? :)\n    // ......\n\n    private final Shape shape;\n    private final Color color;\n\n\n    ColoredShape(Shape shape, Color color) {\n        this.shape = shape;\n        this.color = color;\n    }\n\n    Color color() { return color; }\n    Shape shape() { return shape; }\n\n}\n</code></pre>\n<p>This makes it all explicit and renders colors and shapes reusable in contexts other than this very specific one.</p>\n<hr />\n<p>Another major defect of your aproach is that it does not enforce that the pair choices match both ways. I.e. nothing stops me from defining e.g. <code>Color.RED(Shape.CIRCLE)</code> and <code>Shape.CIRCLE(Color.BLUE)</code>. So if you want this mapping to be consistent, you should define it in a single place and infer/reuse it the second time (or add some validation logic to ensure consistency).</p>\n"
        },
        {
          "owner": {
            "user_id": 436560,
            "display_name": "Lajos Arpad"
          },
          "up_vote_count": 3,
          "is_accepted": false,
          "creation_date": 1675598576,
          "answer_id": 75352069,
          "body": "<p>The reason for the problem is that when <code>Color</code> was being initialized, <code>Shape</code> was not initialized yet, hence the shape of the color ends up being <code>null</code>. Circular dependencies are signs of bad design, so I would fix the error in the plan. Instead, you could use the same numeric values for the pairs, like this:</p>\n<pre><code>enum Color {\n    RED,\n    GREEN,\n    BLUE;\n\n    Shape getShape() {\n        return Shape.values()[ordinal()];\n    }\n}\n\nenum Shape {\n    CIRCLE,\n    TRIANGLE,\n    SQUARE;\n\n    Color getColor() {\n        return Color.values()[ordinal()];\n    }\n}\n</code></pre>\n<p>This way you have a reliable mapping and you can get the shape of the color or the color of the shape.</p>\n"
        }
      ],
      "owner": {
        "user_id": 80901,
        "display_name": "mjn"
      },
      "view_count": 310,
      "up_vote_count": 10,
      "accepted_answer_id": 75351871,
      "answer_count": 3,
      "score": 10,
      "creation_date": 1674208703,
      "question_id": 75182408,
      "body": "<p>Consider these enum declarations:</p>\n<pre><code>enum Color {\n    RED(Shape.CIRCLE),\n    GREEN(Shape.TRIANGLE),\n    BLUE(Shape.SQUARE);\n\n    private final Shape shape;\n\n    Color(Shape shape) {\n        this.shape = shape;\n    }\n\n    Shape getShape() {\n        return shape;\n    }\n}\n\nenum Shape {\n    CIRCLE(Color.RED),\n    TRIANGLE(Color.GREEN),\n    SQUARE(Color.BLUE);\n\n    private final Color color;\n\n    Shape(Color color) {\n        this.color = color;\n    }\n\n    Color getColor() {\n        return color;\n    }\n}\n</code></pre>\n<p>There are cyclic dependencies between the enum fields. There are no compiler warnings (using Java 8).</p>\n<p>However, all these tests will fail in the second line:</p>\n<pre><code>@Test\npublic void testRedAndCircle() {\n    assertThat(Color.RED.getShape()).isNotNull();\n    assertThat(Shape.CIRCLE.getColor()).isNotNull(); // fails\n}\n\n@Test\npublic void testCircleAndRed() {\n    assertThat(Shape.CIRCLE.getColor()).isNotNull();\n    assertThat(Color.RED.getShape()).isNotNull(); // fails\n}\n\n@Test\npublic void testGreenAndTriangle() {\n    assertThat(Color.GREEN.getShape()).isNotNull();\n    assertThat(Shape.TRIANGLE.getColor()).isNotNull(); // fails\n}\n\n@Test\npublic void testBlueAndSquare() {\n    assertThat(Color.BLUE.getShape()).isNotNull();\n    assertThat(Shape.SQUARE.getColor()).isNotNull(); // fails\n}\n</code></pre>\n<p>How can the null value in the enum field be explained?</p>\n<p>It seems that the enum object in the private final fields is not yet completely instantiated.</p>\n"
    },
    {
      "tags": [
        "java",
        "android",
        "admob",
        "ads"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 5709159,
            "display_name": "Sirop4ik"
          },
          "edited": false,
          "comment_id": 133150070,
          "body": "Did you find the solution finally?"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 17628164,
            "display_name": "Karina"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1675284902,
          "answer_id": 75316088,
          "body": "<p>I have the same issue, and added</p>\n<pre><code>@SuppressLint(&quot;VisibleForTests&quot;)\nAdRequest adRequest = new AdRequest.Builder().build();\n</code></pre>\n<p>It is NOT a good solution, but it made the warning go away and the adds seem to work.</p>\n"
        },
        {
          "owner": {
            "user_id": 615217,
            "display_name": "McFarlane"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1677151035,
          "answer_id": 75544087,
          "body": "<p>This warning disappeared after updating to version <code>21.5.0</code> of the Google Ads SDK.</p>\n<pre><code>implementation 'com.google.android.gms:play-services-ads:21.5.0'\n</code></pre>\n"
        }
      ],
      "owner": {
        "user_id": 20543919,
        "display_name": "sacacorchos"
      },
      "view_count": 429,
      "up_vote_count": 10,
      "answer_count": 2,
      "score": 10,
      "creation_date": 1674431408,
      "question_id": 75204726,
      "body": "<p>I have seen that recently a new warning has appeared in mi project in the following line:</p>\n<pre><code>    AdRequest adRequest = new AdRequest.Builder().build();\n</code></pre>\n<p>The warning is in &quot;new AdRequest.Builder().build();&quot;</p>\n<p>This is the warning:</p>\n<blockquote>\n<p>This method should only be accessed from tests or within private scope</p>\n</blockquote>\n<p>I don't understand why this warning is showing, could it be a bug or something like that?</p>\n"
    },
    {
      "tags": [
        "java",
        "spring",
        "maven"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 6395627,
            "display_name": "Slaw"
          },
          "edited": false,
          "comment_id": 132556193,
          "body": "What if you try the latest version of Spring Boot, which <a href=\"https://spring.io/projects/spring-boot\" rel=\"nofollow noreferrer\">appears to be 3.0.1</a>?"
        },
        {
          "owner": {
            "user_id": 2978502,
            "display_name": "dhanyn10"
          },
          "edited": false,
          "comment_id": 132556277,
          "body": "@Slaw JpaRepository not working from tutorial. it will need different code."
        },
        {
          "owner": {
            "user_id": 7338170,
            "display_name": "P.Sanjay"
          },
          "edited": false,
          "comment_id": 132556596,
          "body": "Please refer <a href=\"https://stackoverflow.com/questions/68117860/eclipse-2021-06-classformaterror-accessible-module-java-base-does-not-opens-j\" title=\"eclipse 2021 06 classformaterror accessible module java base does not opens j\">stackoverflow.com/questions/68117860/&hellip;</a>"
        },
        {
          "owner": {
            "user_id": 2978502,
            "display_name": "dhanyn10"
          },
          "edited": false,
          "comment_id": 132556926,
          "body": "@P.Sanjay still not working"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 21034601,
            "display_name": "Kappa97"
          },
          "up_vote_count": 15,
          "is_accepted": false,
          "creation_date": 1674036410,
          "answer_id": 75157549,
          "body": "<p>I had the same issue. It was because my project was written in Java 8 but I tried to start in Java 17. I just changed the configuration for Build&amp;Run  in IntelliJ from SDK 17 to the correct Java Version 8 and it worked. Maybe you used another Java version for building the project in IntelliJ.</p>\n<p>Here's the configuration screenshot.</p>\n<p><a href=\"https://i.stack.imgur.com/xMw3o.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/xMw3o.png\" alt=\"configuration screen\" /></a></p>\n"
        }
      ],
      "owner": {
        "user_id": 2978502,
        "display_name": "dhanyn10"
      },
      "view_count": 11604,
      "up_vote_count": 8,
      "answer_count": 1,
      "score": 8,
      "creation_date": 1673674595,
      "question_id": 75116023,
      "body": "<p>currently i follow course video from this youtube:<a href=\"https://www.youtube.com/watch?v=BHoiNd64w0c&amp;list=PLQag1tT77Ben3dupVMgYtoi_PVVQVRdD6&amp;index=13\" rel=\"noreferrer\">https://www.youtube.com/watch?v=BHoiNd64w0c&amp;list=PLQag1tT77Ben3dupVMgYtoi_PVVQVRdD6&amp;index=13</a><br />\neverything works fine, i run my project by clicking play button in eclipse, a little different by instructor because he used sts tool. But the error happen when trying to <code>right click &gt; run as &gt; maven install</code><br />\nbased on this question <a href=\"https://stackoverflow.com/questions/68221781/how-to-fix-unable-to-make-protected-final-java-lang-class-java-lang-classloader\">How to fix &quot;Unable to make protected final java.lang.Class java.lang.ClassLoader.defineClass?</a>, im already used the newer spring version. Here's my pom.xml:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n    xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;2.7.7&lt;/version&gt;\n        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;\n    &lt;/parent&gt;\n    &lt;groupId&gt;java-login-security&lt;/groupId&gt;\n    &lt;artifactId&gt;login-system&lt;/artifactId&gt;\n    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n    &lt;name&gt;login-system&lt;/name&gt;\n    &lt;description&gt;login system&lt;/description&gt;\n    &lt;properties&gt;\n        &lt;java.version&gt;17&lt;/java.version&gt;\n    &lt;/properties&gt;\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;\n            &lt;scope&gt;runtime&lt;/scope&gt;\n            &lt;optional&gt;true&lt;/optional&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.mysql&lt;/groupId&gt;\n            &lt;artifactId&gt;mysql-connector-j&lt;/artifactId&gt;\n            &lt;scope&gt;runtime&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-security-test&lt;/artifactId&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.tomcat&lt;/groupId&gt;\n            &lt;artifactId&gt;tomcat-jasper&lt;/artifactId&gt;\n            &lt;version&gt;9.0.70&lt;/version&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n\n&lt;/project&gt;\n\n</code></pre>\n<p>and here more error log:</p>\n<pre><code> .   ____          _            __ _ _\n /\\\\ / ___'_ __ _ _(_)_ __  __ _ \\ \\ \\ \\\n( ( )\\___ | '_ | '_| | '_ \\/ _` | \\ \\ \\ \\\n \\\\/  ___)| |_)| | | | | || (_| |  ) ) ) )\n  '  |____| .__|_| |_|_| |_\\__, | / / / /\n =========|_|==============|___/=/_/_/_/\n :: Spring Boot ::                (v2.7.7)\n\n2023-01-14 12:19:00.834  INFO 2373 --- [           main] j.l.LoginSystemApplicationTests          : Starting LoginSystemApplicationTests using Java 17.0.4.1 on dna with PID 2373 (started by dna in /media/dna/data/koding/java/login-system)\n2023-01-14 12:19:00.835  INFO 2373 --- [           main] j.l.LoginSystemApplicationTests          : No active profile set, falling back to 1 default profile: &quot;default&quot;\n2023-01-14 12:19:01.333  INFO 2373 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.\n2023-01-14 12:19:01.380  INFO 2373 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 41 ms. Found 1 JPA repository interfaces.\n2023-01-14 12:19:01.530 ERROR 2373 --- [           main] o.s.boot.SpringApplication               : Application run failed\n\norg.springframework.cglib.core.CodeGenerationException: java.lang.reflect.InaccessibleObjectException--&gt;Unable to make protected final java.lang.Class java.lang.ClassLoader.defineClass(java.lang.String,byte[],int,int,java.security.ProtectionDomain) throws java.lang.ClassFormatError accessible: module java.base does not &quot;opens java.lang&quot; to unnamed module @78dd667e\n    at org.springframework.cglib.core.ReflectUtils.defineClass(ReflectUtils.java:598) ~[spring-core-5.3.24.jar:5.3.24]\n    at org.springframework.cglib.core.AbstractClassGenerator.generate(AbstractClassGenerator.java:363) ~[spring-core-5.3.24.jar:5.3.24]\n// ...more error log here...\n</code></pre>\n<p>my java version:</p>\n<pre class=\"lang-bash prettyprint-override\"><code>dna@dna:/$ java -version\nopenjdk version &quot;17.0.5&quot; 2022-10-18\nOpenJDK Runtime Environment (build 17.0.5+8-Ubuntu-2ubuntu122.04)\nOpenJDK 64-Bit Server VM (build 17.0.5+8-Ubuntu-2ubuntu122.04, mixed mode, sharing)\n</code></pre>\n<p>[update]\nyou can check my project here:\n<a href=\"https://github.com/dhanyn10/java/tree/main/login-system\" rel=\"noreferrer\">https://github.com/dhanyn10/java/tree/main/login-system</a></p>\n"
    },
    {
      "tags": [
        "java"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 1420715,
            "display_name": "Lakatos Gyula"
          },
          "edited": false,
          "comment_id": 133893642,
          "body": "@Hulk URLs that contain non-encoded characters like a space in &quot;<a href=\"http://www.example.com/?test=Hello\" rel=\"nofollow noreferrer\">example.com/?test=Hello</a> world&quot;. This was parsed by the URL class without giving an error (and my data contains a lot of these). Also, links that failed the URL conversion like &quot;<a href=\"http://Ð¿Ñ€Ð¾Ð¼ÐºÐ°Ñ‚Ð°Ð»Ð¾Ð³.Ñ€Ñ„/PublicDocuments/05-0211-00.pdf\" rel=\"nofollow noreferrer\">Ð¿Ñ€Ð¾Ð¼ÐºÐ°Ñ‚Ð°Ð»Ð¾Ð³.Ñ€Ñ„/PublicDocuments/05-0211-00.pdf</a>&quot; are converted to URI successfully with URI.create."
        },
        {
          "owner": {
            "user_id": 1420715,
            "display_name": "Lakatos Gyula"
          },
          "edited": false,
          "comment_id": 133898859,
          "body": "You are right. I updated my question."
        },
        {
          "owner": {
            "user_id": 820127,
            "display_name": "rossum"
          },
          "edited": false,
          "comment_id": 133898931,
          "body": "How was the space encoded in the old method? I have sometimes seen %20 for a space in a URL. You could add that substitution yourself. Are there some parameters you need to set in the new method to cover more characters?"
        },
        {
          "owner": {
            "user_id": 1420715,
            "display_name": "Lakatos Gyula"
          },
          "edited": false,
          "comment_id": 133899294,
          "body": "@rossum As seen in the test class. Some of them are already properly URL encoded, while others are not. :/ The URL&#39;s construction did not validate against URL encoding. Then the URI was created like this for further validation: <code>new URI(url.getProtocol(), url.getUserInfo(), url.getHost(), url.getPort(), url.getPath(), url.getQuery(), url.getRef());</code>"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 664577,
            "display_name": "Anthony Accioly"
          },
          "up_vote_count": 7,
          "is_accepted": true,
          "creation_date": 1680549707,
          "answer_id": 75923069,
          "body": "<h2>The problem</h2>\n<p>The main problem seems to be that the <code>UrlEncoder</code> service is dealing with a mix of encoded, unencoded and partially encoded URLs. More than that, there isn't a good way to to know which one is which.</p>\n<p>This leads to ambiguity because certain characters can have different meanings when encoded vs unencoded. For instance, given a partially encoded URLs it isn't trivial to tell if a character such as <code>'&amp;'</code> is part of a query parameter (and thus should be encoded) or acting as a separator (and thus shouldn't be encoded):</p>\n<pre><code>https://www.example.com/test?firstQueryParam=hot%26cold&amp;secondQueryParam=test\n</code></pre>\n<p>To add salt to the injury, Java's <code>URI</code> implementation deviates from RFC 3986 and RFC 3987 due to historical / backwards compatibility reasons. Here's an interesting read about some of URI's quirks: <a href=\"https://cr.openjdk.org/%7Edfuchs/writeups/updating-uri/\" rel=\"nofollow noreferrer\">Updating URI support for RFC 3986 and RFC 3987 in the JDK</a>.</p>\n<p>&quot;Fixing&quot; incorrectly encoded URLs by re-encoding without proper knowledge about the original URL is not a trivial problem. Fixing incorrectly encoded URLs using encoders and decoders full of quirks is even harder. A good enough &quot;best effort&quot; heuristic would be my recommendation.</p>\n<h2>A simple best effort solution</h2>\n<p>So the good news is that I've managed to implement a solution that passes all of the above tests. The solution in question leverages Spring Web <a href=\"https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/util/UriUtils.html\" rel=\"nofollow noreferrer\"><code>UriUtils</code></a> and <a href=\"https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/util/UriUtils.html\" rel=\"nofollow noreferrer\"><code>UriComponentsBuilder</code></a>. The cherry on the cake is that you may not need <a href=\"https://github.com/smola/galimatias\" rel=\"nofollow noreferrer\">galimatias</a> anymore.</p>\n<p>Here's the code:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class UrlEncoder {\n\n    public Optional&lt;URL&gt; encode(final String link) {\n        try {\n            final URI validatedURI = reencode(link).parseServerAuthority();\n            return Optional.of(validatedURI.toURL());\n        } catch (MalformedURLException | URISyntaxException e) {\n            return Optional.empty();\n        }\n    }\n\n    private URI reencode(String url) { // best effort\n        final String decodedUrl = UriUtils.decode(url, StandardCharsets.UTF_8);\n        return UriComponentsBuilder.fromHttpUrl(decodedUrl)\n                .encode()\n                .build()\n                .toUri();;\n    }\n}\n</code></pre>\n<p>Here's the gist of it:</p>\n<ul>\n<li><code>reencode</code> â†’ best attempt to &quot;fix&quot; URL encoding by decoding and re-encoding</li>\n<li><code>parseServerAuthority()</code> â†’ As an alternative to the former <code>validateUrl(url)</code> method.</li>\n</ul>\n<h2>Double encoding ampersands and other special characters</h2>\n<p>As previously stated, while the code above passes all tests. Itis easy enough to come up with a &quot;broken&quot; test case. E.g., running the URL above through the encoder would result in:</p>\n<pre><code>https://www.example.com/test?firstQueryParam=hot&amp;cold&amp;secondQueryParam=test\n</code></pre>\n<p>This is a perfectly valid URL, but likely not what one would be looking for.</p>\n<p>We are now entering dangerous territory, but there are ways to implement a more &quot;opinionated&quot; re-encoding algorithm. E.g. the code bellow deals with ampersands by making sure that <code>%26</code> isn't decoded:</p>\n<pre><code>private final char PERCENT_SIGN = '%';\nprivate final String ENCODED_PERCENT_SIGN = &quot;25&quot;;\nprivate final String[] CODES_TO_DOUBLE_ENCODE = new String[]{\n        &quot;26&quot; // code for '&amp;'\n};\n\nprivate URI reencode(String url) throws URISyntaxException {\n    final String urlWithDoubleEncodedSpecialCharacters = doubleEncodeSpecialCharacters(url);\n    final String decodedUrl = UriUtils.decode(urlWithDoubleEncodedSpecialCharacters, StandardCharsets.UTF_8);\n    final String encodedUrl = UriComponentsBuilder.fromHttpUrl(decodedUrl).toUriString();\n    final String encodedUrlWithSpecialCharacters = decodeDoubleEncodedSpecialCharacters(encodedUrl);\n\n    return URI.create(encodedUrlWithSpecialCharacters);\n}\n\nprivate String doubleEncodeSpecialCharacters(String url) {\n    final StringBuilder sb = new StringBuilder(url);\n    for (String code : CODES_TO_DOUBLE_ENCODE) {\n        final String codeString = PERCENT_SIGN + code;\n        int index = sb.indexOf(codeString);\n        while (index != -1) {\n            sb.insert(index + 1, ENCODED_PERCENT_SIGN);\n            index = sb.indexOf(codeString, index + 3);\n        }\n    }\n    return sb.toString();\n}\n\nprivate String decodeDoubleEncodedSpecialCharacters(String url) {\n    final StringBuilder sb = new StringBuilder(url);\n    for (String code : CODES_TO_DOUBLE_ENCODE) {\n        final String codeString = PERCENT_SIGN + ENCODED_PERCENT_SIGN + code;\n        int index = sb.indexOf(codeString);\n        while (index != -1) {\n            sb.delete(index + 2, index + 4);\n            index = sb.indexOf(codeString, index + 5);\n        }\n    }\n    return sb.toString();\n}\n</code></pre>\n<p>The solution above can be modified to deal with other escaping sequences (e.g., to deal with all <a href=\"https://www.rfc-editor.org/rfc/rfc3986#section-2.2\" rel=\"nofollow noreferrer\">RFC 3986's Reserved Characters</a>), as well as to use more sophisticated heuristics (e.g., to do something different with query parameters, than, say, path parameters).</p>\n<p>Nevertheless, as someone that went down this rabbit hole before, I can tell you that once you know that you are dealing with incorrectly encoded URLs outside of your control there simply isn't a perfect solution.</p>\n"
        }
      ],
      "owner": {
        "user_id": 1420715,
        "display_name": "Lakatos Gyula"
      },
      "view_count": 381,
      "up_vote_count": 9,
      "accepted_answer_id": 75923069,
      "answer_count": 1,
      "score": 8,
      "creation_date": 1680377364,
      "question_id": 75908405,
      "body": "<p>I'm migrating my code to Java 20.</p>\n<p>In this release, the <a href=\"https://download.java.net/java/early_access/jdk20/docs/api/java.base/java/net/URL.html#constructor-deprecation\" rel=\"noreferrer\">java.net.URL#URL(java.lang.String)</a> got deprecated. Unfortunately, I have a class where I found no replacement for the old URL constructor.</p>\n<pre><code>package com.github.bottomlessarchive.loa.url.service.encoder;\n\nimport io.mola.galimatias.GalimatiasParseException;\nimport org.springframework.stereotype.Service;\n\nimport java.net.MalformedURLException;\nimport java.net.URI;\nimport java.net.URISyntaxException;\nimport java.net.URL;\nimport java.util.Optional;\n\n/**\n * This service is responsible for encoding existing {@link URL} instances to valid\n * &lt;a href=&quot;https://en.wikipedia.org/wiki/Internationalized_Resource_Identifier&quot;&gt;resource identifiers&lt;/a&gt;.\n */\n@Service\npublic class UrlEncoder {\n\n    /**\n     * Encodes the provided URL to a valid\n     * &lt;a href=&quot;https://en.wikipedia.org/wiki/Internationalized_Resource_Identifier&quot;&gt;resource identifier&lt;/a&gt; and return\n     * the new identifier as a URL.\n     *\n     * @param link the url to encode\n     * @return the encoded url\n     */\n    public Optional&lt;URL&gt; encode(final String link) {\n        try {\n            final URL url = new URL(link);\n\n            // We need to further validate the URL because the java.net.URL's validation is inadequate.\n            validateUrl(url);\n\n            return Optional.of(encodeUrl(url));\n        } catch (GalimatiasParseException | MalformedURLException | URISyntaxException e) {\n            return Optional.empty();\n        }\n    }\n\n    private void validateUrl(final URL url) throws URISyntaxException {\n        // This will trigger an URISyntaxException. It is needed because the constructor of java.net.URL doesn't always validate the\n        // passed url correctly.\n        new URI(url.getProtocol(), url.getUserInfo(), url.getHost(), url.getPort(), url.getPath(), url.getQuery(), url.getRef());\n    }\n\n    private URL encodeUrl(final URL url) throws GalimatiasParseException, MalformedURLException {\n        return io.mola.galimatias.URL.parse(url.toString()).toJavaURL();\n    }\n}\n</code></pre>\n<p>Luckily, I have tests for the class as well:</p>\n<pre><code>package com.github.bottomlessarchive.loa.url.service.encoder;\n\nimport org.junit.jupiter.params.ParameterizedTest;\nimport org.junit.jupiter.params.provider.CsvSource;\n\nimport java.net.MalformedURLException;\nimport java.net.URL;\nimport java.util.Optional;\n\nimport static org.assertj.core.api.Assertions.assertThat;\n\nclass UrlEncoderTest {\n\n    private final UrlEncoder underTest = new UrlEncoder();\n\n    @ParameterizedTest\n    @CsvSource(\n            value = {\n                    &quot;http://www.example.com/?test=Hello world,http://www.example.com/?test=Hello%20world&quot;,\n                    &quot;http://www.example.com/?test=ÅÃšÅ‘ÃºÅ°ÃœÅ±Ã¼,http://www.example.com/?test=%C5%90%C3%9A%C5%91%C3%BA%C5%B0%C3%9C%C5%B1%C3%BC&quot;,\n                    &quot;http://www.example.com/?test=random word Â£500 bank $,&quot;\n                            + &quot;http://www.example.com/?test=random%20word%20%C2%A3500%20bank%20$&quot;,\n                    &quot;http://www.aquincum.hu/wp-content/uploads/2015/06/Aquincumi-F%C3%BCzetek_14_2008.pdf,&quot;\n                            + &quot;http://www.aquincum.hu/wp-content/uploads/2015/06/Aquincumi-F%C3%BCzetek_14_2008.pdf&quot;,\n                    &quot;http://www.aquincum.hu/wp-content/uploads/2015/06/Aquincumi-F%C3%BCzetek_14 _2008.pdf,&quot;\n                            + &quot;http://www.aquincum.hu/wp-content/uploads/2015/06/Aquincumi-F%C3%BCzetek_14%20_2008.pdf&quot;\n            }\n    )\n    void testEncodeWhenUsingValidUrls(final String urlToEncode, final String expected) throws MalformedURLException {\n        final Optional&lt;URL&gt; result = underTest.encode(urlToEncode);\n\n        assertThat(result)\n                .contains(new URL(expected));\n    }\n\n    @ParameterizedTest\n    @CsvSource(\n            value = {\n                    &quot;http://Ð¿Ñ€Ð¾Ð¼ÐºÐ°Ñ‚Ð°Ð»Ð¾Ð³.Ñ€Ñ„/PublicDocuments/05-0211-00.pdf&quot;\n            }\n    )\n    void testEncodeWhenUsingInvalidUrls(final String urlToEncode) {\n        final Optional&lt;URL&gt; result = underTest.encode(urlToEncode);\n\n        assertThat(result)\n                .isEmpty();\n    }\n}\n</code></pre>\n<p>The only dependency it uses is the <a href=\"https://mvnrepository.com/artifact/io.mola.galimatias/galimatias/0.2.1\" rel=\"noreferrer\">galamatias</a> URL library.</p>\n<p>Does anyone have any ideas on how could I remove the <code>new URL(link)</code> code fragment while keeping the functionality the same?</p>\n<p>I tried various things, like using <code>java.net.URI#create</code> but it did not produce the exact result as the previous solution. For example, URLs that contain non-encoded characters like a space in <code>http://www.example.com/?test=Hello world</code> resulted in an IllegalArgumentException. This was parsed by the URL class without giving an error (and my data contains a lot of these). Also, links that failed the URL conversion like <code>http://Ð¿Ñ€Ð¾Ð¼ÐºÐ°Ñ‚Ð°Ð»Ð¾Ð³.Ñ€Ñ„/PublicDocuments/05-0211-00.pdf</code> are converted to URI successfully with URI.create.</p>\n"
    },
    {
      "tags": [
        "java",
        "android",
        "firebase-cloud-messaging",
        "google-cloud-messaging"
      ],
      "answers": [
        {
          "owner": {
            "user_id": 21563430,
            "display_name": "Raden Hor"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1680599584,
          "answer_id": 75927554,
          "body": "<p>For temporary work around solution\n<a href=\"https://issuetracker.google.com/issues/275036593#comment31\" rel=\"nofollow noreferrer\">https://issuetracker.google.com/issues/275036593#comment31</a></p>\n"
        }
      ],
      "owner": {
        "user_id": 20126669,
        "display_name": "Shekhar J. Lobo"
      },
      "view_count": 837,
      "up_vote_count": 9,
      "answer_count": 1,
      "score": 8,
      "creation_date": 1679572623,
      "question_id": 75822678,
      "body": "<p>I'm getting an Exception like <code>com.google.android.gms.common.api.ApiException: 17: Device doesn't support the messaging feature</code> in Android 13</p>\n<p>It works fine on another version as well as the Android 13 emulator in Android studio, but when I connect an Android 13 physical device it throws the above error.</p>\n<pre><code>   try {\n        SmsRetrieverClient mClient = SmsRetriever.getClient(this);\n        Task&lt;Void&gt; mTask = mClient.startSmsRetriever();\n        mTask.addOnSuccessListener(new OnSuccessListener&lt;Void&gt;() {\n            @Override\n            public void onSuccess(Void aVoid) {\n                Bundle bundle = new Bundle();\n                bundle.putString(&quot;mobile&quot;, stringFromView(binding.etPhoneNumber));\n                bundle.putString(&quot;setting&quot;, settingScreen);\n                startActivity(OtpActivity.class, bundle);\n//                Toast.makeText(mContext, &quot;SMS Retriever starts&quot;, Toast.LENGTH_LONG).show();\n            }\n        });\n        mTask.addOnFailureListener(new OnFailureListener() {\n            @Override\n            public void onFailure(@NonNull Exception e) {\n                e.printStackTrace();\n            }\n        });\n    } catch (Exception e) {\n        e.printStackTrace();\n    }\n</code></pre>\n"
    },
    {
      "tags": [
        "java",
        "javafx",
        "tableview"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 203657,
            "display_name": "kleopatra"
          },
          "edited": false,
          "comment_id": 133853793,
          "body": "thanks for the <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> - always a pleasure to have something reproducible :) As both @jewelsea and me see the change between versions, you might consider reporting this as a regression - only if they knew about it, they can fix it :)"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 1155209,
            "display_name": "jewelsea"
          },
          "up_vote_count": 6,
          "is_accepted": false,
          "creation_date": 1680125308,
          "answer_id": 75882318,
          "body": "<blockquote>\n<p>Has there been a performance regression?</p>\n</blockquote>\n<p>Yes.</p>\n<p>I ran the example as provided on OpenJDK 20 + JavaFX 20 OS X x64 13.2.1, 2020 MacBook Pro.  With large numbers of rows (e.g. 1,000,000+), performance was slow when scrolling with the mouse via the scroll bar.  With 1,000 rows, the scrolling performance was good.</p>\n<p>With OpenJDK 8b251 scrolling performance was quick for 10,000,000 rows.</p>\n<p>It looks like this is a known issue, as pointed out by <a href=\"https://stackoverflow.com/a/75899926/1155209\">Maatr</a>:</p>\n<ul>\n<li><a href=\"https://bugs.openjdk.org/browse/JDK-8293836\" rel=\"nofollow noreferrer\">JDK-8293836\nRendering performance degradation at bottom of TableView with many rows</a>.</li>\n</ul>\n<p>If you consider your issue to be a different problem, you may consider <a href=\"https://wiki.openjdk.org/display/OpenJFX/Submitting+a+Bug+Report\" rel=\"nofollow noreferrer\">submitting a bug report</a>.</p>\n<p><strong>Workarounds</strong></p>\n<p>Use a JavaFX version between 8 and 17 inclusive.  From my local testing, scrolling of TableViews with large data sets performs acceptably.</p>\n<p>For other JavaFX versions, you could search for workarounds that will improve the performance of the TableView when backed by large data sets, but I wouldn't advise doing that unless you are skilled and motivated to do so.  Instead, if a version of JavaFX is required that exhibits this performance issue, rework your UI and logic so that you don't load a lot of items into the <code>TableView</code> backing list.  Perhaps, restrict the maximum number of items to 10,000 or so and handle large volumes of data via <a href=\"https://stackoverflow.com/questions/15349185/javafx-tableview-paginator\">pagination</a>.</p>\n<blockquote>\n<p>any idea when this started?</p>\n</blockquote>\n<p>The major TableView scrolling performance issue with large datasets started in JavaFX version 18.</p>\n<p>For the JDK 8b251 version I mentioned, scrolling performance for 1,000 rows or 10,000,000 is the same (excellent).</p>\n<p>For the JavaFX 17.0.2 version (on OS X x64 13.2.1, OpenJDK 20), scrolling performance for 10,000,000 rows will slightly stutter but is generally fine.  Performance is a bit worse than the good performance for 1,000 rows, but not really an issue.</p>\n<p>For the JavaFX 18.0.2, 19.0.2.1, and 20 versions (on OS X x64 13.2.1, OpenJDK 20), scrolling performance for 10,000,000 rows will greatly stutter.  Performance is much worse than the good performance for 1,000 rows.</p>\n<p>These results are from subjective visual observation of local testing in my environment. Results and subjective observations by you from your testing in your environment may differ, but will likely be generally similar.</p>\n"
        },
        {
          "owner": {
            "user_id": 3522523,
            "display_name": "Maatr"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1680274399,
          "answer_id": 75899926,
          "body": "<p>There is a similar TableView performance issue filled: <a href=\"https://bugs.openjdk.org/browse/JDK-8293836\" rel=\"nofollow noreferrer\">https://bugs.openjdk.org/browse/JDK-8293836</a></p>\n"
        }
      ],
      "owner": {
        "user_id": 21520762,
        "display_name": "andrerobot"
      },
      "view_count": 158,
      "up_vote_count": 7,
      "answer_count": 2,
      "score": 7,
      "creation_date": 1680110611,
      "question_id": 75880323,
      "body": "<p>I'm stumped.\nI have a use-case which involves the rendering of arbitrarily large, paginated tabular result sets in TableView form.</p>\n<p>What I'm finding is that both fine scrolling (via touch gestures or mouse wheel on the TableView) and coarse scrolling (via dragging of scroll bar slider) degrade to unuseability as I scroll to larger row ordinals.</p>\n<p>The degradation happens at relatively small row counts (&lt; ~1M).\nNote that the data model only ever holds a small subset of data at any given row offset and loads pages dynamically in response to scroll events.</p>\n<p>I've distilled the use case to a few lines of code below.\nI'm been able to support a similar such use case in the past (about 4 years ago, 1billion rows) with no issue, so I know this is doable. Whatever the issue is now, however, I just can't see it.</p>\n<p>Desperate for help...</p>\n<p>Incidentally, I've tried this with various permutations of SDK and JavaFX with same effect.</p>\n<pre><code>package com.example.demo;\n\nimport javafx.application.Application;\nimport javafx.beans.property.SimpleStringProperty;\nimport javafx.collections.FXCollections;\nimport javafx.collections.ObservableList;\nimport javafx.collections.ObservableListBase;\nimport javafx.scene.CacheHint;\nimport javafx.scene.Scene;\nimport javafx.scene.control.TableColumn;\nimport javafx.scene.control.TableView;\nimport javafx.scene.layout.BorderPane;\nimport javafx.stage.Stage;\n\nimport java.util.ArrayList;\nimport java.util.List;\n\npublic class Main extends Application {\n\n    public static void main(String[] args) {\n        launch();\n    }\n\n    @Override\n    public void start(Stage stage) {\n        final TableView&lt;Row&gt; table = new TableView();\n        final BorderPane borderPane = new BorderPane();\n        final Scene scene = new Scene(borderPane, 800, 600);\n\n        TableColumn&lt;Row, String&gt; col = new TableColumn&lt;&gt;(&quot;row&quot;);\n        col.setCellValueFactory(p -&gt; new SimpleStringProperty(p.getValue().data[0].toString()));\n        col.setPrefWidth(100);\n        table.getColumns().add(col);\n\n        col = new TableColumn&lt;&gt;(&quot;A&quot;);\n        col.setCellValueFactory(p -&gt; new SimpleStringProperty(p.getValue().data[1].toString()));\n        col.setPrefWidth(100);\n        table.getColumns().add(col);\n\n        col = new TableColumn&lt;&gt;(&quot;B&quot;);\n        col.setCellValueFactory(p -&gt; new SimpleStringProperty(p.getValue().data[2].toString()));\n        col.setPrefWidth(100);\n        table.getColumns().add(col);\n\n        col = new TableColumn&lt;&gt;(&quot;C&quot;);\n        col.setCellValueFactory(p -&gt; new SimpleStringProperty(p.getValue().data[3].toString()));\n        col.setPrefWidth(100);\n        table.getColumns().add(col);\n\n        table.setCache(true);\n        table.setEditable(false);\n        table.setCacheHint(CacheHint.SPEED);\n\n        table.setItems(getModel(10_000_000));\n\n        borderPane.setCenter(table);\n        stage.setScene(scene);\n\n        stage.show();\n    }\n\n    private static ObservableList&lt;Row&gt; getModel(final int rowCount) {\n        final List&lt;Row&gt; data = new ArrayList&lt;&gt;(rowCount);\n        for (int x = 0; x &lt; rowCount; x++) {\n            data.add(new Row(x, new Object[] {x, &quot;a_&quot; + x, &quot;b_&quot; + x, &quot;c_&quot; + x }));\n        }\n        return FXCollections.unmodifiableObservableList(FXCollections.observableList(data));\n    }\n\n    private static final class Row {\n        public final int rowOrdinal;\n        public final Object[] data;\n\n        public Row(final int rowOrdinal, final Object[] data) {\n            this.rowOrdinal = rowOrdinal;\n            this.data = data;\n        }\n\n        @Override\n        public boolean equals(Object o) {\n            return o != null &amp;&amp; o.getClass() == Row.class &amp;&amp; ((Row)o).rowOrdinal == rowOrdinal;\n        }\n        \n        @Override\n        public int hashCode() {\n            return rowOrdinal;\n        }\n    }\n}\n</code></pre>\n"
    },
    {
      "tags": [
        "java",
        "android"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 6309,
            "display_name": "VonC"
          },
          "edited": false,
          "comment_id": 134355298,
          "body": "Try and add <code>android:fitsSystemWindows=&quot;true&quot;</code> to your <code>bottomappbar.BottomAppBar</code> attributes, to see if that improves the layout."
        },
        {
          "owner": {
            "user_id": 19674027,
            "display_name": "user2357113"
          },
          "edited": false,
          "comment_id": 134425779,
          "body": "<code>BottomAppBar(modifier = Modifier.height(56.dp).fillMaxWidth())</code>  <i>Set the height to a fixed value</i>"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 9851608,
            "display_name": "Zain"
          },
          "up_vote_count": 5,
          "is_accepted": true,
          "creation_date": 1683329182,
          "answer_id": 76186441,
          "body": "<p><strong>Edit:</strong></p>\n<p>Adding this padding to the <code>BottomAppBar</code> is a kind of weird whenever the <code>setDecorFitsSystemWindows</code> API is used to have an edge-to-edge app.</p>\n<p>The system could automatically add this padding as a way to avoid the overlap between the  <code>BottomAppBar</code> buttons and the system bottom navigation bar. Normally this overlapping should happen when using <code>setDecorFitsSystemWindows</code> API, because the developer intentionally needs that edge-to-edge; and <a href=\"https://developer.android.com/develop/ui/views/layout/edge-to-edge#handle-overlaps\" rel=\"noreferrer\">that overlap case already handled by the documentation using the insets API</a>.</p>\n<hr />\n<p><strong>Solution</strong></p>\n<p>When using <code>setDecorFitsSystemWindows</code> API, the system still continues to automatically add the padding to the <code>BottomAppBar</code> thinking that the <code>BottomAppBar</code>is still on top of the assigned room of the system navigation bar (before having edge-to-edge screen). This padding equals to the height of the system bottom navigation bar to ensure that <code>BottomAppBar</code> is drawn on top of the system bar without overlap.</p>\n<p>To get the exact height of the bottom navigation bar, we can use the window  insets API by registering <code>View.OnApplyWindowInsetsListener</code>, and get the bottom insets:</p>\n<p>The system navigation bar height which equals to the bottom insets needs to be subtracted from the bottom padding of the window <code>DecorView</code> view:</p>\n<pre><code>ViewCompat.setOnApplyWindowInsetsListener(getWindow().getDecorView(), (v, insets) -&gt; {\n\n    Insets systemInsets = insets.getInsets(WindowInsetsCompat.Type.systemBars());\n\n    v.setPadding(v.getPaddingLeft(),\n            v.getPaddingTop(),\n            v.getPaddingRight(),\n            v.getPaddingBottom() - systemInsets.bottom); // subtract the insets from the bottom padding\n    return insets;\n});\n</code></pre>\n<p>Now the <code>BottomAppBar</code> looks like:</p>\n<p><a href=\"https://i.stack.imgur.com/7rhAE.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/7rhAE.png\" alt=\"enter image description here\" /></a></p>\n<hr />\n<p><strong>Original Assumption</strong></p>\n<p>Disclaimer</p>\n<blockquote>\n<p>This is just left so it probably can help future visitors in another context; but the above solution should be considers instead for the question asked here.</p>\n</blockquote>\n<p>By the following documentation quotes about consuming the insets listener:</p>\n<p><a href=\"https://developer.android.com/reference/androidx/core/view/WindowInsetsCompat#CONSUMED()\" rel=\"noreferrer\">First for the <code>WindowInsetsCompat.CONSUMED</code></a>:</p>\n<blockquote>\n<p>This can be used during insets dispatch in the view hierarchy by\nreturning this value from View.onApplyWindowInsets(WindowInsets) or\nonApplyWindowInsets to stop dispatch the insets to its children to\navoid traversing the entire view hierarchy.</p>\n</blockquote>\n<p><a href=\"https://developer.android.com/develop/ui/views/layout/edge-to-edge#system-bars-insets\" rel=\"noreferrer\">Second in the code snippet comment</a>:</p>\n<blockquote>\n<pre><code>// Return CONSUMED if you don't want want the window insets to keep being \n// passed down to descendant views.\nreturn WindowInsetsCompat.CONSUMED;\n</code></pre>\n</blockquote>\n<p>So, probably when using <code>setDecorFitsSystemWindows</code> API, the window insets keep passing down to descendant views. Hence, trying to consume that on the Window <code>DecorView</code> has been actually solved the problem:</p>\n<pre><code>// This snippet is used in `onCreate()` method.\nViewCompat.setOnApplyWindowInsetsListener(getWindow().getDecorView(), (v, insets) -&gt; {\n    return ViewCompat.onApplyWindowInsets(v, WindowInsetsCompat.CONSUMED);\n    //  return WindowInsetsCompat.CONSUMED; // Also can be used\n});\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/lF0jF.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/lF0jF.png\" alt=\"enter image description here\" /></a></p>\n<p><strong>Side note:</strong> This could have some overlapping issues for the users that prefer to use the three-button navigation that probably need to be handled:</p>\n<p><a href=\"https://i.stack.imgur.com/mnHOl.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/mnHOl.png\" alt=\"enter image description here\" /></a></p>\n"
        }
      ],
      "owner": {
        "user_id": 72437,
        "display_name": "Cheok Yan Cheng"
      },
      "view_count": 208,
      "up_vote_count": 7,
      "accepted_answer_id": 76186441,
      "answer_count": 1,
      "score": 7,
      "creation_date": 1683123586,
      "question_id": 76164938,
      "body": "<p>I want to let user enjoy full screen experience.</p>\n<p>I am following guideline from <a href=\"https://developer.android.com/develop/ui/views/layout/edge-to-edge\" rel=\"noreferrer\">https://developer.android.com/develop/ui/views/layout/edge-to-edge</a></p>\n<p>However, when I apply <code>WindowCompat.setDecorFitsSystemWindows(getWindow(), false);</code>, the height of bottom app bar grows significantly.</p>\n<p>The picture on the left is before applying <code>WindowCompat.setDecorFitsSystemWindows(getWindow(), false);</code>, and the picture on the right is after applying <code>WindowCompat.setDecorFitsSystemWindows(getWindow(), false);</code>.</p>\n<p><a href=\"https://i.stack.imgur.com/LI0zR.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/LI0zR.png\" alt=\"enter image description here\" /></a></p>\n<p>I am using the following components to implement bottom app bar.</p>\n<ol>\n<li><code>BottomAppBar</code> (So that <code>FloatingActionButton</code> can position in center)</li>\n<li><code>FloatingActionButton</code></li>\n<li><code>BottomNavigationView</code> (So that I can integrate with <code>NavController</code> and <code>NavigationUI</code>).</li>\n</ol>\n<p>This is my layout XML</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\n&lt;androidx.coordinatorlayout.widget.CoordinatorLayout\n    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\n    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;\n    android:id=&quot;@+id/linear_layout&quot;\n    android:layout_width=&quot;match_parent&quot;\n    android:layout_height=&quot;match_parent&quot;&gt;\n\n    &lt;FrameLayout\n        android:id=&quot;@+id/toolbar_content_and_background_image_frame_layout&quot;\n        android:layout_width=&quot;match_parent&quot;\n        android:layout_height=&quot;match_parent&quot;&gt;\n\n        &lt;ImageView\n            android:id=&quot;@+id/background_image_view&quot;\n            android:layout_width=&quot;match_parent&quot;\n            android:layout_height=&quot;match_parent&quot;\n            android:src=&quot;@drawable/background2&quot;\n            android:scaleType=&quot;centerCrop&quot; /&gt;\n\n        &lt;LinearLayout\n            android:id=&quot;@+id/toolbar_content_linear_layout&quot;\n            android:orientation=&quot;vertical&quot;\n            android:layout_width=&quot;match_parent&quot;\n            android:layout_height=&quot;match_parent&quot;&gt;\n\n            &lt;com.google.android.material.appbar.AppBarLayout\n                app:elevation=&quot;0dp&quot;\n                android:background=&quot;@android:color/transparent&quot;\n\n                android:layout_width=&quot;match_parent&quot;\n                android:layout_height=&quot;wrap_content&quot;\n                android:fitsSystemWindows=&quot;true&quot;&gt;\n\n                &lt;com.google.android.material.appbar.MaterialToolbar\n                    android:background=&quot;@android:color/transparent&quot;\n\n                    android:id=&quot;@+id/toolbar&quot;\n                    android:layout_width=&quot;match_parent&quot;\n                    android:layout_height=&quot;?attr/actionBarSize&quot; /&gt;\n\n            &lt;/com.google.android.material.appbar.AppBarLayout&gt;\n\n            &lt;fragment\n\n                android:id=&quot;@+id/nav_host_fragment_activity_main&quot;\n                android:name=&quot;androidx.navigation.fragment.NavHostFragment&quot;\n                android:layout_width=&quot;match_parent&quot;\n                android:layout_height=&quot;0dp&quot;\n                android:layout_weight=&quot;1&quot;\n                app:defaultNavHost=&quot;true&quot;\n                app:navGraph=&quot;@navigation/mobile_navigation&quot; /&gt;\n        &lt;/LinearLayout&gt;\n    &lt;/FrameLayout&gt;\n\n    &lt;com.google.android.material.bottomappbar.BottomAppBar\n        android:backgroundTint=&quot;#ff0000&quot;\n        app:fabCradleRoundedCornerRadius=&quot;0dp&quot;\n\n        android:layout_gravity=&quot;bottom&quot;\n\n        android:id=&quot;@+id/bottom_app_bar&quot;\n        android:layout_width=&quot;match_parent&quot;\n        android:layout_height=&quot;wrap_content&quot;&gt;\n\n        &lt;com.google.android.material.bottomnavigation.BottomNavigationView\n            android:layout_marginEnd=&quot;16dp&quot;\n            app:elevation=&quot;0dp&quot;\n            app:backgroundTint=&quot;@android:color/transparent&quot;\n\n            android:id=&quot;@+id/nav_view&quot;\n            android:layout_width=&quot;match_parent&quot;\n            android:layout_height=&quot;wrap_content&quot;\n\n            app:labelVisibilityMode=&quot;unlabeled&quot;\n            app:itemBackground=&quot;?attr/actionBarItemBackground&quot;\n            app:menu=&quot;@menu/bottom_nav_menu&quot; /&gt;\n    &lt;/com.google.android.material.bottomappbar.BottomAppBar&gt;\n\n    &lt;com.google.android.material.floatingactionbutton.FloatingActionButton\n        android:id=&quot;@+id/fab&quot;\n        android:layout_width=&quot;wrap_content&quot;\n        android:layout_height=&quot;wrap_content&quot;\n        android:src=&quot;@drawable/ic_android_black_24dp&quot;\n        android:contentDescription=&quot;@string/app_name&quot;\n        app:layout_anchor=&quot;@id/bottom_app_bar&quot; /&gt;\n\n&lt;/androidx.coordinatorlayout.widget.CoordinatorLayout&gt;\n</code></pre>\n<p>I was wondering, why the height of bottom app bar grow significantly when displaying content edge-to-edge, and how we can avoid such?</p>\n<p>Here's the minimal workable example to try out such an issue - <a href=\"https://github.com/yccheok/bottom-navigation-example/tree/4494860eba7959ab59bb5ac2497302473ca0ad85\" rel=\"noreferrer\">https://github.com/yccheok/bottom-navigation-example/tree/4494860eba7959ab59bb5ac2497302473ca0ad85</a></p>\n"
    },
    {
      "tags": [
        "java",
        "database",
        "hibernate"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 7109162,
            "display_name": "XtremeBaumer"
          },
          "edited": false,
          "comment_id": 132591067,
          "body": "Couldn&#39;t verify it at all, but perhaps <code>sessionFactory.getCache().evictAllRegions();</code> would do the trick, as it should clear all possible caches, which could also include the sequence IDs. Otherwise, you could attempt to close the session/connection and reopen it (like restarting the application). However, are you locked into the sequence? If not, <code>IDENTITY</code> column would make this much easier"
        },
        {
          "owner": {
            "user_id": 886697,
            "display_name": "Stanislav Bashkyrtsev"
          },
          "edited": false,
          "comment_id": 132698364,
          "body": "When creating a sequence, you specify <code>increment by 50</code>. Then when nextval is requested, the external process will get +50, then +50 again. So when Hibernate will request for the next &quot;batch&quot; of IDs, it will also get a +50. So no overlap is possible."
        },
        {
          "owner": {
            "user_id": 3426309,
            "display_name": "Andrey B. Panfilov"
          },
          "edited": false,
          "comment_id": 132699440,
          "body": "@StanislavBashkyrtsev what is going on was properly described by walen: HBN expects it may safely use range <code>(nextval - increment, nextval]</code> when generating new IDs, any SQL procedures which do not honour that expectation are considered to be wrong (and yes, it is not possible to reset HBN sequence caches without using reflection)"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 1856573,
            "display_name": "lapadets"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1673866375,
          "answer_id": 75133195,
          "body": "<p>Have you tried to clear the current session and create a new one?\nThis forces Hibernate to re-query the database for the current sequence value.</p>\n<p>In other words you can use the method <code>Session.flush()</code> and <code>Session.clear()</code>:</p>\n<pre><code>Session session = sessionFactory.openSession();\nTransaction transaction = session.beginTransaction();\n\n// Perform some operations that use the id cache\n\nsession.flush();\nsession.clear();\n\n// Perform some more operations that use the id cache\n\ntransaction.commit();\nsession.close();\n</code></pre>\n<p>Or you could use <code>EntityManager.refresh()</code> which will refresh the state of the instance from the database, and in the process, update the internal cache with the current sequence value:</p>\n<pre><code>EntityManager em = entityManagerFactory.createEntityManager();\nem.getTransaction().begin();\n\n// Perform some operations that use the id cache\n\nem.refresh(entity);\n\n// Perform some more operations that use the id cache\n\nem.getTransaction().commit();\nem.close();\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 6404321,
            "display_name": "walen"
          },
          "up_vote_count": 5,
          "is_accepted": false,
          "creation_date": 1674125053,
          "answer_id": 75171054,
          "body": "<blockquote>\n<p>a low-level procedure [...] inserts let's say 100 entities [...] with ids from 1 to 100</p>\n</blockquote>\n<p>Why is that low-level procedure generating the IDs on its own? Why is it NOT using the sequence?</p>\n<p><strong>The whole point of Hibernate's <a href=\"https://vladmihalcea.com/hibernate-hidden-gem-the-pooled-lo-optimizer/\" rel=\"noreferrer\">pooled and pooled-lo</a> ID generating mechanisms</strong>, which you appear to be using (and definitely should, if you're not), <strong>is to be able to safely cache IDs <em>even on the face of any external processes making use of the sequence outside of Hibernate's control</em></strong>.</p>\n<p>If that external process used the sequence too, your problem would disappear, since none of Hibernate's cached values would get used; and the next batch of cached values would start from whatever sequence value was last generated by the external process, avoiding conflicts:</p>\n<ol>\n<li>Hibernate caches values 0-49. <code>sequence.NEXTVAL</code> would be 50.</li>\n<li>External process inserts 100 rows. <code>sequence.NEXTVAL</code> would be 5050.</li>\n<li>Hibernate ends up using all cached values, and asks for the next sequence value.</li>\n<li>Hibernate caches values 5050-5099. <code>sequence.NEXTVAL</code> would be 5100.</li>\n<li>Etc.</li>\n</ol>\n<p>The solution to your issue, assuming you're using Hibernate's pooled(-lo) ID strategy, is not to disable or reset Hibernate's cache and hinder your application performance; <strong>the solution is to make any external processes use NEXTVAL() too</strong> to generate the appropriate IDs for the entities when inserting data into that table, instead of providing their own values.</p>\n<hr />\n<p>Concerns:</p>\n<p><em>&quot;But then I would end up with gaps in my IDs!&quot;</em><br />\nSo what?<br />\nThere's no problem whatsoever in your ID column having gaps. Your goal here is avoiding ID conflicts and ensuring that your application does not make 2 trips to DB (one for the sequence, one for the actual insert) every time you create an entity. If not having a neat, perfectly sequential set of IDs is the price to pay for that, so be it! Quite a deal, if you ask me ;)</p>\n<p><em>&quot;But then entities that were created later using Hibernate's cached values would have a lower ID than those created by the external process before!&quot;</em><br />\nSo what?<br />\nThe primary goal of having an ID column is to be able to uniquely identify a row via a single value. Discerning order of creation should not be a factor in how you manage your ID values; a timestamp column is better suited for that.</p>\n<p><em>&quot;But the ID value would grow up too fast! I just inserted 50 rows and it's already by the thousands! I'll run out of numbers!&quot;</em><br />\nOk, legitimate concern here. But if you're using sequences, chances are you're using either Oracle or PostgreSQL, maybe SQL Server. Am I right?<br />\nWell, PostgreSQL's MAXVALUE for a <code>bigint</code> sequence is 9223372036854775807. Same goes for SQL Server. If your process inserted a new row <em>each millisecond</em> non-stop, it would still take it <strong>5 million years</strong> to reach the end of the sequence. Oracle's MAXVALUE for a sequence is 999999999999999999999999999, several orders of magnitude greater than that.<br />\nSo... As long as the datatype of your ID column and sequence is aptly chosen, you're safe on that regard.</p>\n"
        },
        {
          "owner": {
            "user_id": 1402425,
            "display_name": "vudangngoc"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1674377276,
          "answer_id": 75199157,
          "body": "<p>May this link will help\n<a href=\"https://www.baeldung.com/hibernate-identifiers#3-sequence-generation\" rel=\"nofollow noreferrer\">https://www.baeldung.com/hibernate-identifiers#3-sequence-generation</a></p>\n<pre><code>@Entity\npublic class User {\n    @Id\n    @GeneratedValue(generator = &quot;sequence-generator&quot;)\n    @GenericGenerator(\n      name = &quot;sequence-generator&quot;,\n      strategy = &quot;org.hibernate.id.enhanced.SequenceStyleGenerator&quot;,\n      parameters = {\n        @Parameter(name = &quot;sequence_name&quot;, value = &quot;user_sequence&quot;),\n        @Parameter(name = &quot;initial_value&quot;, value = &quot;4&quot;),\n        @Parameter(name = &quot;increment_size&quot;, value = &quot;1&quot;)\n        }\n    )\n    private long userId;\n    \n    // ...\n}\n</code></pre>\n"
        }
      ],
      "owner": {
        "user_id": 8754410,
        "display_name": "Oleksandr Riznyk"
      },
      "view_count": 375,
      "up_vote_count": 7,
      "answer_count": 3,
      "score": 7,
      "creation_date": 1673531861,
      "question_id": 75097435,
      "body": "<p>Example:</p>\n<ul>\n<li>suppose that entity E has id generated by sequence e_seq</li>\n<li>suppose that value of sequence is initially 0 on the database, and increment is configured to be 50</li>\n<li>when hibernate starts, it gets the next value of the sequence (i.e. 0+50=50) and keeps an internal cache of the available values (i.e. those in the interval 0-50)</li>\n<li>as long as the cache has available values, no further requests to the dbms are performed to get next value of sequence</li>\n<li>only after you create 50 instances of entity E the 50 ids are consumed and hibernate asks the next value to the dbms.</li>\n<li>suppose that the hibernate cache has still 50 ids available</li>\n<li>suppose that a low-level procedure (like data migrations) inserts let's say 100 entities of type E in the database using SQL statements (not using hibernate APIs), with ids from 1 to 100 and then resets the sequence value to 100</li>\n<li>if application tries to create a new entity from its APIs, it will use an id taken from the hibernate cache but which has already being used by the low-level procedure, hence causing a duplicate id exception</li>\n</ul>\n<p>I need therefore to find a way to tell Hibernate to &quot;reset its ids cache&quot;, or in other words &quot;force hibernate to contact again the dbms to get the current sequence value&quot;.</p>\n"
    },
    {
      "tags": [
        "java",
        "spring-boot",
        "micrometer",
        "spring-micrometer"
      ],
      "answers": [
        {
          "owner": {
            "user_id": 971735,
            "display_name": "Jonatan Ivanov"
          },
          "up_vote_count": 2,
          "is_accepted": false,
          "creation_date": 1677019790,
          "answer_id": 75526660,
          "body": "<p>You need actuator and a bridge, the rest you included is not needed:</p>\n<pre><code>implementation 'org.springframework.boot:spring-boot-starter-actuator'\nimplementation 'io.micrometer:micrometer-tracing-bridge-brave'\n</code></pre>\n<p>If you also want to report your spans, you should add the zipkin reporter too:</p>\n<pre><code>implementation 'org.springframework.boot:spring-boot-starter-actuator'\nimplementation 'io.micrometer:micrometer-tracing-bridge-brave'\nimplementation 'io.zipkin.reporter2:zipkin-reporter-brave'\n</code></pre>\n<p>Here's an example on <a href=\"https://start.spring.io/#!type=gradle-project&amp;language=java&amp;platformVersion=3.0.2&amp;packaging=jar&amp;jvmVersion=17&amp;groupId=com.example&amp;artifactId=demo&amp;name=demo&amp;description=Demo%20project%20for%20Spring%20Boot&amp;packageName=com.example.demo&amp;dependencies=distributed-tracing,zipkin\" rel=\"nofollow noreferrer\">start.spring.io</a> and there are a lot of samples in the <a href=\"https://github.com/micrometer-metrics/micrometer-samples\" rel=\"nofollow noreferrer\">micrometer-samples</a> repo.</p>\n"
        }
      ],
      "owner": {
        "user_id": 10459891,
        "display_name": "htmoia"
      },
      "view_count": 1201,
      "up_vote_count": 7,
      "answer_count": 1,
      "score": 7,
      "creation_date": 1674122326,
      "question_id": 75170489,
      "body": "<p>After migrating spring boot from version 2.x to 3 we miss traceId and spanId in our logs.</p>\n<p>We removed all <strong>sleuth</strong> dependencies and added</p>\n<pre><code>implementation 'io.micrometer:micrometer-core'\nimplementation 'io.micrometer:micrometer-tracing'\nimplementation 'io.micrometer:micrometer-tracing-bridge-brave'\nimplementation platform('io.micrometer:micrometer-tracing-bom:latest.release')\n</code></pre>\n<p>as well as</p>\n<pre class=\"lang-yaml prettyprint-override\"><code>logging.pattern.level: &quot;%5p [${spring.application.name:},%X{traceId:-},%X{spanId:-}]&quot;\n</code></pre>\n<p>but no traceIds and spanIds are being logged.</p>\n<p>Is there something we missed?</p>\n"
    },
    {
      "tags": [
        "java",
        "sql-server",
        "spring",
        "spring-boot",
        "download"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 2310289,
            "display_name": "Scary Wombat"
          },
          "edited": false,
          "comment_id": 133575054,
          "body": "<i>the file that I downloaded from the database is corrupted</i> - is it corrupted in the DB, or only when downloaded using your code?"
        },
        {
          "owner": {
            "user_id": 18146759,
            "display_name": "Lucas Lim"
          },
          "edited": false,
          "comment_id": 133575161,
          "body": "when downloaded using code"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 21354179,
            "display_name": "Aiden Jones"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1678689234,
          "answer_id": 75718635,
          "body": "<pre><code>@GetMapping(&quot;/download&quot;)\npublic void download(String path, HttpServletResponse response) throws IOException {\n    String filePath = fielUrl + &quot;\\\\&quot; + path;\n    File file = new File(filePath);\n\n    InputStream inputStream = new FileInputStream(filePath);\n    String filename = new File(filePath).getName();\n    response.setCharacterEncoding(&quot;utf-8&quot;);\n    response.setContentType(&quot;application/octet-stream&quot;);\n\n    response.addHeader(&quot;content-disposition&quot;, &quot;attachment; filename=&quot; + URLEncoder.encode(filename, &quot;UTF-8&quot;));\n\n    ServletOutputStream outputStream = response.getOutputStream();\n\n    byte[] b = new byte[1024];\n    int len;\n   \n    while ((len = inputStream.read(b)) &gt; 0) {\n        outputStream.write(b, 0, len);\n    }\n    inputStream.close();\n}\n</code></pre>\n<p>You can refer to my code.\nPay attention to setting the &quot;response&quot;.</p>\n"
        },
        {
          "owner": {
            "user_id": 13942448,
            "display_name": "jccampanero"
          },
          "up_vote_count": 0,
          "is_accepted": true,
          "creation_date": 1678920260,
          "answer_id": 75750733,
          "body": "<p>I think the problem could be related to the way you are performing the file download:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@RequestMapping(&quot;/downloadFile/{id}&quot;)\npublic String downloadFile(@PathVariable(&quot;id&quot;) String id,\n    HttpServletResponse res) throws IOException {\n    FileModel fm = tmDAO.getFile(id);\n    try {\n        File file = new File(fm.getName());\n        FileOutputStream fos = new FileOutputStream(file);\n        res.setContentLength(fm.getData().length);\n        res.setHeader(&quot;Content-Disposition&quot;, &quot;attachment; filename=&quot; + fm.getName());\n        fos.write(fm.getData(), 0, fm.getData().length);\n        fos.flush();\n        fos.close();\n    } catch (Exception e) {\n        System.out.println(e.getMessage());\n    }\n    return &quot;string&quot;;\n}\n</code></pre>\n<p>Note in your code that you are writing the obtained <code>FileModel</code> data to a <code>FileOutputStream</code>, but you should write that data to the <code>HttpServletResponse</code> underlying <code>OutputStream</code> instead. Please, consider the following modification in your code:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@RequestMapping(&quot;/downloadFile/{id}&quot;)\npublic void downloadFile(\n    @PathVariable(&quot;id&quot;) String id,\n    HttpServletResponse res\n) throws IOException {\n    // Define an auxiliary InputStream: more on this later\n    InputStream in = null;\n    // Define a reference to the response OutputStream. We will initialize\n    // it later\n    OutputStream out = null;\n    try {\n        FileModel fm = tmDAO.getFile(id);\n        byte[] data = fm.getData();\n        // initialize the response content-type (perhaps with type?)\n        // and additional headers\n        res.setContentType(&quot;application/octet-stream&quot;);\n        res.setContentLength(data.length);\n        res.setHeader(&quot;Content-Disposition&quot;, \n             &quot;attachment; filename=&quot; + fm.getName());\n        \n        // write data to output\n\n        // This variable ideally should be defined as a constant\n        int BUFFER_SIZE = 4096;\n\n        byte[] buffer = new byte[BUFFER_SIZE];\n\n        in = new ByteArrayInputStream(data);\n        out = res.getOutputStream();\n\n        while(data.read(buffer, 0, BUFFER_SIZE) != -1) {\n            out.write(buffer, 0, BUFFER_SIZE);\n        }\n\n        out.flush();\n    } catch (Exception e) {\n        System.out.println(e.getMessage());\n    } finally {\n        // cleanup\n        if (in != null) {\n            try {\n                in.close(); \n            } catch (Throwable t) {\n                t.printStackTrace();\n            }\n        }\n\n        if (out != null) {\n            try {\n                out.close(); \n            } catch (Throwable t) {\n                t.printStackTrace();\n            }\n        }\n    }\n\n    // there is no need to return anything\n}\n</code></pre>\n<p>If you wish, this process could be greatly simplified using the handly <a href=\"https://commons.apache.org/proper/commons-io/apidocs/org/apache/commons/io/IOUtils.html\" rel=\"nofollow noreferrer\">IOUtils</a> class from the <a href=\"https://mvnrepository.com/artifact/commons-io/commons-io/2.11.0\" rel=\"nofollow noreferrer\">Apache Commons IO project</a>:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@RequestMapping(&quot;/downloadFile/{id}&quot;)\npublic void downloadFile(\n    @PathVariable(&quot;id&quot;) String id,\n    HttpServletResponse res\n) throws IOException {\n    // Define a reference to the response OutputStream. We will initialize\n    // it later\n    OutputStream out = null;\n    try {\n        FileModel fm = tmDAO.getFile(id);\n        byte[] data = fm.getData();\n        // initialize the response content-type (perhaps with type?)\n        // and additional headers\n        res.setContentType(&quot;application/octet-stream&quot;);\n        res.setContentLength(data.length);\n        res.setHeader(&quot;Content-Disposition&quot;, \n             &quot;attachment; filename=&quot; + fm.getName());\n        \n        // write data to output\n        \n        out = res.getOutputStream();\n\n        // As suggested by @Olivier in this comments, we can\n        // get rid of the ByteArrayInputStream and use data directly\n        IOUtils.copy(data, out);\n\n        out.flush();\n    } catch (Exception e) {\n        System.out.println(e.getMessage());\n    } finally {\n        // cleanup\n        IOUtils.closeQuietly(out);\n    }\n\n    // there is no need to return anything\n}\n</code></pre>\n<p>Spring provides additional methods for dealing with writing <code>byte[]</code> to the wire but your solution is a simple and very good one.</p>\n"
        },
        {
          "owner": {
            "user_id": 3426309,
            "display_name": "Andrey B. Panfilov"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1679063045,
          "answer_id": 75768748,
          "body": "<p>Below is how your <code>downloadFile</code> method should look like (since you are loading blob contents into memory there is nothing to optimize out)</p>\n<pre class=\"lang-java prettyprint-override\"><code>@RequestMapping(&quot;/downloadFile/{id}&quot;)\npublic ResponseEntity&lt;ByteArrayResource&gt; downloadFile(@PathVariable(&quot;id&quot;) String id) throws IOException {\n    FileModel fm = tmDAO.getFile(id);\n    HttpHeaders headers = new HttpHeaders();\n    headers.setContentDisposition(ContentDisposition.builder(&quot;attachment&quot;)\n      .filename(fm.getName(), StandardCharsets.UTF_8)\n      .build());\n    headers.setContentLength(fm.getData().length);\n    return new ResponseEntity&lt;&gt;(new ByteArrayResource(fm.getData()), headers, HttpStatus.OK);\n}\n</code></pre>\n"
        }
      ],
      "owner": {
        "user_id": 18146759,
        "display_name": "Lucas Lim"
      },
      "view_count": 234,
      "up_vote_count": 7,
      "accepted_answer_id": 75750733,
      "answer_count": 3,
      "score": 7,
      "creation_date": 1678687611,
      "question_id": 75718498,
      "body": "<p>I am working on uploading and downloading files using Spring Boot, JSP and MSSQL. I am able to run the upload and download function, BUT the file that I downloaded from the database is <strong>corrupted</strong>. Can anyone help me with this?</p>\n<p>this is my spring version</p>\n<pre><code>    &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;3.0.3-SNAPSHOT&lt;/version&gt;\n        &lt;relativePath /&gt; &lt;!-- lookup parent from repository --&gt;\n    &lt;/parent&gt;\n</code></pre>\n<p>my controller</p>\n<pre><code>@RequestMapping(value = &quot;/uploadFile&quot;, method = RequestMethod.POST)\npublic ResponseEntity &lt; Object &gt; upload(@RequestPart(required = false) MultipartFile file) throws IOException {\n    try {\n        if (file != null) {\n            tmDAO.storeFile(file, tm);\n        }\n        return new ResponseEntity &lt; Object &gt; (&quot;success&quot;, HttpStatus.OK);\n    } catch (Exception e) {\n        System.out.println(e.getMessage());\n    }\n}\n\n@RequestMapping(&quot;/downloadFile/{id}&quot;)\npublic String downloadFile(@PathVariable(&quot;id&quot;) String id,\n    HttpServletResponse res) throws IOException {\n    FileModel fm = tmDAO.getFile(id);\n    try {\n        File file = new File(fm.getName());\n        FileOutputStream fos = new FileOutputStream(file);\n        res.setContentLength(fm.getData().length);\n        res.setHeader(&quot;Content-Disposition&quot;, &quot;attachment; filename=&quot; + fm.getName());\n        fos.write(fm.getData(), 0, fm.getData().length);\n        fos.flush();\n        fos.close();\n    } catch (Exception e) {\n        System.out.println(e.getMessage());\n    }\n    return &quot;string&quot;;\n}\n</code></pre>\n<p>Service</p>\n<pre><code>    \n@Override\npublic FileModel storeFile(MultipartFile file, TeachingMaterial tm) throws IOException {\n    String fileName = StringUtils.cleanPath(file.getOriginalFilename());\n    FileModel fileModel = new FileModel(UUID.randomUUID().toString(), tm.getContributor(), fileName,\n    file.getContentType(), file.getBytes(), tm.getClassName(), tm.getSubjectName(), tm.getSlots());\n    return fileRepo.save(fileModel);\n}\n\n@Override\npublic FileModel getFile(String id) throws IOException {\n    Optional &lt; FileModel &gt; fm = fileRepo.findById(id);\n    if (fm.isPresent()) {\n        return fm.get();\n    }\n    return null;\n}\n</code></pre>\n<p>FileModel.java</p>\n<pre><code>@Entity\n@Table(name = &quot;FILES&quot;)\npublic class FileModel {\n    @Id\n    private String id;\n    private String contributor;\n    private String name;\n    private String type;\n    @Lob\n    private byte[] data;\n    private String className;\n    private String subjectName;\n    private String slots;\n\n    public FileModel() {\n        super();\n    }\n\n    public FileModel(String id, String contributor, String name, String type, byte[] data, String className,\n            String subjectName, String slots) {\n        super();\n        this.id = id;\n        this.contributor = contributor;\n        this.name = name;\n        this.type = type;\n        this.data = data;\n        this.className = className;\n        this.subjectName = subjectName;\n        this.slots = slots;\n    }\n**I skips the getters and setters for simplication**\n}\n</code></pre>\n<p>Record in MSSQL</p>\n<p><a href=\"https://i.stack.imgur.com/9kSk8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9kSk8.png\" alt=\"enter image description here\" /></a></p>\n<p>what I get after downloading the txt file</p>\n<p><a href=\"https://i.stack.imgur.com/Ptvk0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ptvk0.png\" alt=\"enter image description here\" /></a></p>\n<p>the original data should be</p>\n<p>testing123</p>\n<p>abc</p>\n<p>Can anyone help me with this please?</p>\n"
    },
    {
      "tags": [
        "java",
        "android",
        "xml",
        "android-studio",
        "gradle"
      ],
      "answers": [
        {
          "owner": {
            "user_id": 12805923,
            "display_name": "Ahmet B."
          },
          "up_vote_count": 8,
          "is_accepted": true,
          "creation_date": 1673743563,
          "answer_id": 75122281,
          "body": "<p>Update your version to 33 as below</p>\n<pre><code> compileSdk 33\n\ndefaultConfig {\n    applicationId &quot;com.enetapplications.empty&quot;\n    minSdk 28\n    targetSdk 33\n    versionCode 1\n    versionName &quot;1.0&quot;\n\n    testInstrumentationRunner &quot;androidx.test.runner.AndroidJUnitRunner&quot;\n}\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 21063631,
            "display_name": "Md. Suhel Arman Khan"
          },
          "up_vote_count": 4,
          "is_accepted": false,
          "creation_date": 1674596445,
          "answer_id": 75227568,
          "body": "<p>Go to your <code>build.gradle(:app)</code>, increase your compileSdk and targetSdk.\nWrite there:</p>\n<pre><code>compileSdk 33\n\ntargetSdk 33\n</code></pre>\n<p>Then at the top you will see  'Sync Now' Option, click on it. Now your problem has been resolved.</p>\n<p><a href=\"https://i.stack.imgur.com/Dp5K8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Dp5K8.png\" alt=\"enter image description here\" /></a></p>\n"
        }
      ],
      "owner": {
        "user_id": 9877665,
        "display_name": "kiteandwindsurfer"
      },
      "view_count": 7415,
      "up_vote_count": 7,
      "accepted_answer_id": 75122281,
      "answer_count": 2,
      "score": 6,
      "creation_date": 1673742356,
      "question_id": 75122196,
      "body": "<p>This is a Gradle error which I get when running the empty &quot;hello world&quot; (building from Empty Activity template) without any added code,\nHere is the error:</p>\n<pre><code>FAILURE: Build failed with an exception.\n\n* What went wrong:\nExecution failed for task ':app:checkDebugAarMetadata'.\n&gt; A failure occurred while executing com.android.build.gradle.internal.tasks.CheckAarMetadataWorkAction\n   &gt; 6 issues were found when checking AAR metadata:\n \n\n  1.  Dependency 'androidx.appcompat:appcompat-resources:1.6.0' requires libraries and applications that\n      depend on it to compile against version 33 or later of the\n      Android APIs.\n\n      :app is currently compiled against android-32.\n\n      Also, the maximum recommended compile SDK version for Android Gradle\n      plugin 7.2.0 is 32.\n\n      Recommended action: Update this project's version of the Android Gradle\n      plugin to one that supports 33, then update this project to use\n      compileSdkVerion of at least 33.\n\n      Note that updating a library or application's compileSdkVersion (which\n      allows newer APIs to be used) can be done separately from updating\n      targetSdkVersion (which opts the app in to new runtime behavior) and\n      minSdkVersion (which determines which devices the app can be installed\n      on).\n\n  2.  Dependency 'androidx.appcompat:appcompat:1.6.0' requires libraries and applications that\n      depend on it to compile against version 33 or later of the\n      Android APIs.\n\n      :app is currently compiled against android-32.\n\n      Also, the maximum recommended compile SDK version for Android Gradle\n      plugin 7.2.0 is 32.\n\n      Recommended action: Update this project's version of the Android Gradle\n      plugin to one that supports 33, then update this project to use\n      compileSdkVerion of at least 33.\n\n      Note that updating a library or application's compileSdkVersion (which\n      allows newer APIs to be used) can be done separately from updating\n      targetSdkVersion (which opts the app in to new runtime behavior) and\n      minSdkVersion (which determines which devices the app can be installed\n      on).\n</code></pre>\n<p>I will stop the error messages after these two as I suspect fixing one will fix all six.</p>\n<p>Below is my <code>build.gradle (:app)</code></p>\n<pre><code>plugins {\n    id 'com.android.application'\n}\n\nandroid {\n    compileSdk 32\n\n    defaultConfig {\n        applicationId &quot;com.enetapplications.empty&quot;\n        minSdk 28\n        targetSdk 32\n        versionCode 1\n        versionName &quot;1.0&quot;\n\n        testInstrumentationRunner &quot;androidx.test.runner.AndroidJUnitRunner&quot;\n    }\n\n    buildTypes {\n        release {\n            minifyEnabled false\n            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'\n        }\n    }\n    compileOptions {\n        sourceCompatibility JavaVersion.VERSION_1_8\n        targetCompatibility JavaVersion.VERSION_1_8\n    }\n}\n\ndependencies {\n\n    implementation 'androidx.appcompat:appcompat:1.6.0'\n    implementation 'com.google.android.material:material:1.7.0'\n    implementation 'androidx.constraintlayout:constraintlayout:2.1.4'\n    testImplementation 'junit:junit:4.13.2'\n    androidTestImplementation 'androidx.test.ext:junit:1.1.5'\n    androidTestImplementation 'androidx.test.espresso:espresso-core:3.5.1'\n}\n</code></pre>\n<p>This error first occurred while building an app and I was only working with the xml and was ready to begin the java - then for testing I opened a blank &quot;empty&quot; project and received this exact same error thus seems something to do with how Android Studio is being configured.</p>\n"
    },
    {
      "tags": [
        "java",
        "multithreading",
        "algorithm",
        "performance",
        "loops"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 719263,
            "display_name": "Jean-Baptiste Yun&#232;s"
          },
          "edited": false,
          "comment_id": 132412426,
          "body": "Use <code>RecursiveTask</code>, which is appropriate for such a problem. It is based on the <code>ForkJoinPool</code> threading, which will create all necessary thread for you."
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 4137489,
            "display_name": "marstran"
          },
          "up_vote_count": 9,
          "is_accepted": true,
          "creation_date": 1673013820,
          "answer_id": 75031948,
          "body": "<p>This particular use-case fits very well for a parallel stream. See <a href=\"https://docs.oracle.com/javase/tutorial/collections/streams/parallelism.html\" rel=\"nofollow noreferrer\">tutorial by Oracle</a>. Use <a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/stream/LongStream.html\" rel=\"nofollow noreferrer\"><code>java.util.stream.LongStream</code></a> class for a stream of 64-bit <code>long</code> integers.</p>\n<p>You can implement it like this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>long sum = LongStream.rangeClosed(a, b)\n    .parallel()\n    .map(n -&gt; f(n))\n    .sum();\n\nSystem.out.println(sum);\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 768644,
            "display_name": "rzwitserloot"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1673015574,
          "answer_id": 75032276,
          "body": "<p>You probably want to look into the <a href=\"https://www.baeldung.com/java-fork-join\" rel=\"nofollow noreferrer\">fork/join framework</a>; it's a generalized approach to this principle of splitting up a task into a great many little independent tasks and then combining them back together, and gives you all control you'd want about how to spin off threads.</p>\n<p>Alternatively, you can use the <code>parallel()</code> method of the stream API, but note that this method doesn't explain or guarantee much about how it works. You have no control over which aspect is parallelized, and no control over the amount of threads that'll be involved. For trivial cases you might as well use it, but as a rule, if 'uhoh I better write this in parallel or it would be too slow' is relevant, then you need some guarantees and some control. Here's <a href=\"https://docs.oracle.com/javase/tutorial/collections/streams/parallelism.html\" rel=\"nofollow noreferrer\">oracle's tutorial/explanation on parallel streams</a>. For this specific case it does seem like it would more or less do what you want (it gets tricky if e.g. the stream you attempt to apply this to is e.g. what <code>Files.lines</code> gives you - where the parallelism gets potentially stymied by where it is applied vs. where the bottleneck is).</p>\n"
        },
        {
          "owner": {
            "user_id": 20807758,
            "display_name": "Omar Altinawi"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1673022072,
          "answer_id": 75033471,
          "body": "<ol>\n<li><p>create your sum class (edit 'f' function to your function):</p>\n<pre><code>class sumFun implements Callable&lt;Long&gt; {\n   public long f(long num){\n      return num;\n   }\n   private long a;\n   private long b;\n   public sumFun(long a, long b) {\n       this.a = a;\n       this.b = b;\n   }\n   @Override\n   public Long call() {\n       long sum = 0;\n       for (long i = a; i &lt;= b; i++) {\n           sum += f(i);\n       }\n       return sum;\n   }\n}\n</code></pre>\n</li>\n<li><p>in main :</p>\n<pre><code> public static void main(String[] args) throws InterruptedException, ExecutionException {\n    long start = 1;\n    long end = 10000000;\n    int numOfThreads = 5;\n    long step = (end - start + 1) / numOfThreads;\n    List&lt;sumFun&gt; tasks = new ArrayList&lt;&gt;();\n    for (long i = start; i &lt;= end; i += step) {\n        long tmp = end;\n        if(i+step-1 &lt; end){\n            tmp = i+step-1;\n        }\n        tasks.add(new sumFun(i, tmp));\n    }\n    ExecutorService executor = Executors.newFixedThreadPool(numOfThreads);\n    List&lt;Future&lt;Long&gt;&gt; results = executor.invokeAll(tasks);\n    long sum = 0;\n    for (Future&lt;Long&gt; result : results) {\n        sum += result.get();\n    }\n    System.out.println(&quot;sum = &quot; + sum);\n    executor.shutdown();\n }\n</code></pre>\n</li>\n</ol>\n"
        },
        {
          "owner": {
            "user_id": 719263,
            "display_name": "Jean-Baptiste Yun&#232;s"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1673027043,
          "answer_id": 75034361,
          "body": "<p><code>RecursiveTask</code> is suitable for such a problem. Threads will be managed by the <code>ForkJoinPool</code>.</p>\n<p>The general idea is to decompose the problem into shorter sub-problems, up to the point a single thread is able to manage the given sub-problem by itself.</p>\n<pre><code>class RecursiveSum extends RecursiveTask&lt;Long&gt; {\n    private final int THLD = 1_000;\n    private int low, high;\n    public RecursiveSum(int high) {\n        this(0,high);\n    }\n    public RecursiveSum(int low, int high) {\n        this.low = low; this.high = high;\n    }\n    \n    private long sum(int l,int h) {\n        long sum = 0;\n        for (int i=l; i&lt;h; i++) sum += i;\n        return sum;\n    }\n\n    @Override\n    protected Long compute() {\n        int len = high-low;\n        if (len&lt;=THLD) return sum(low,high);\n        RecursiveSum rhalf = new RecursiveSum(low+len/2,high);\n        rhalf.fork();\n        RecursiveSum lhalf = new RecursiveSum(low,low+len/2);\n        high = low+len/2;\n        return lhalf.compute()+rhalf.join();\n    }\n}\n</code></pre>\n<p>and use it like this:</p>\n<pre><code>long r = new RecursiveSum(1_000_000_000).invoke();\nSystem.out.println(&quot;Sum=&quot;+r);\n</code></pre>\n"
        }
      ],
      "owner": {
        "user_id": 4492659,
        "display_name": "Matan"
      },
      "view_count": 158,
      "up_vote_count": 6,
      "accepted_answer_id": 75031948,
      "answer_count": 4,
      "score": 6,
      "creation_date": 1673013359,
      "question_id": 75031864,
      "body": "<p>Suppose I am given integers <code>a</code> and <code>b</code> such that a range of interest is formed, of integers in <code>[a,b]</code>. The range can span well over <code>10^9</code> integers. I want to sum the values of a given function <code>f : N -&gt; N</code> over all integers <code>a &lt;= n &lt;= b</code>. The range is very large so I want to do this using multithreading.</p>\n<p>Less formaly, I want to parallelize the following code:</p>\n<pre><code>long sum = 0;\n    \nfor (long n = a ; n &lt;= b ; n++)\n    sum += f(n);\n    \nSystem.out.println(sum);\n</code></pre>\n<p>Ideally (at least in my mind), the range will divided equally across the available number of threads available by the processor (suppose <code>f(n)</code> has near-identical complexity and running time for each <code>n</code> in range). The values are completely independent, and <code>f</code> could really be any function. For example, it could output the sum of digits of the number, but it really could be anything, it's just an example.</p>\n<p>Is there a general way to do exactly that in Java using multithreading?</p>\n"
    },
    {
      "tags": [
        "java",
        "caching",
        "thread-local",
        "virtual-threads"
      ],
      "answers": [
        {
          "owner": {
            "user_id": 6275236,
            "display_name": "Roland J."
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1673181178,
          "answer_id": 75047772,
          "body": "<p>Honestly, I am not sure if I understand your question right.\n<a href=\"https://openjdk.org/jeps/429\" rel=\"nofollow noreferrer\">JEP 429</a> states the following:</p>\n<ul>\n<li>&quot;Every thread-local variable is mutable&quot; and &quot;The thread-local variable serves as a kind of hidden method argument&quot; but it is quite clear that &quot; this can lead to spaghetti-like data flow&quot; and much discipline and some engineering effort are recommended. Some best practices or more restrictions might be helpful ...</li>\n<li>&quot;... if each of a million virtual threads has mutable thread-local variables, the memory footprint may be significant.&quot; This raises the question of how an implementation of an algorithm should be designed, taking advantage of the parallelization with virtual threads.</li>\n<li>&quot;The Java Platform should provide a way to maintain immutable and inheritable per-thread data for thousands or millions of virtual threads.&quot; This is a comprehensible demand, but it seems that the authors are not sure and some more conceptual work is needed.</li>\n</ul>\n<p>Now getting back to your question concerning the &quot;allocation of thread locals on a carrier thread from the virtual thread&quot;. Why would you need that?\nAnd caching objects in a thread-local makes sense in some scenarios (like caching the principal for the DB access in the example).\nSince virtual threads are relatively new (Java 19), it might be a bit early to declare thread-locals dead.</p>\n"
        },
        {
          "owner": {
            "user_id": 2711488,
            "display_name": "Holger"
          },
          "up_vote_count": 8,
          "is_accepted": true,
          "creation_date": 1679057327,
          "answer_id": 75767787,
          "body": "<p>You wrote</p>\n<blockquote>\n<p>So I am assuming - please correct me if I am wrong - that</p>\n<ol>\n<li>the virtual thread will never be interleaved by another virtual thread on the same carrier thread or rescheduled on another carrier thread <em>unless the code would have blocked otherwise</em> and therefore, if</li>\n<li>the operation we invoke on the cached object never blocks, then the task/virtual thread will simply run from start to finish on the same carrier and so yes, it would be safe to cache the object on a platform thread-local.</li>\n</ol>\n</blockquote>\n<p>But the <a href=\"https://cr.openjdk.org/%7Erpressler/loom/loom/sol1_part1.html#scheduling:%7E:text=You%20must%20not,task%2Dswitching%20point.\" rel=\"noreferrer\">State of Loom</a> document states:</p>\n<blockquote>\n<p>You must not make any assumptions about where the scheduling points are any more than you would for todayâ€™s threads. Even without forced preemption, any JDK or library method you call could introduce blocking, and so a task-switching point.</p>\n</blockquote>\n<p><a href=\"https://cr.openjdk.org/%7Erpressler/loom/loom/sol1_part2.html#forced-preemption\" rel=\"noreferrer\">and further</a>:</p>\n<blockquote>\n<p>To that end, we plan for the VM to support an operation that tries to forcefully preempt execution at any safepoint. How that capability will be exposed to the schedulers is TBD, and will likely not make it to the first Preview.</p>\n</blockquote>\n<p>So</p>\n<ol>\n<li><p>The assumption that a virtual thread only releases the carrier thread when it is about to be blocked, only applies to the current preview. Preemptive switching between virtual threads is allowed and even planned for the future.</p>\n</li>\n<li><p>Even if we assume that a virtual thread can only release the carrier thread when performing blocking operations, we canâ€™t predict when a blocking operation may occur.</p>\n<ul>\n<li><p>One example of operations outside our control, is <em>class loading</em>. Loading class data is a blocking operation and class loading is implemented lazily for common JVMs. Itâ€™s even possible that a method that has been invoked multiple times suddenly executes an uncommon path that uses a class that has not been used before.</p>\n</li>\n<li><p>Another example is <em>resource loading</em>. Even an example as simple as your <code>DateFormat</code> already involves resources organized in an unspecified way, time zone data or localized month and weekday names, for example.</p>\n</li>\n</ul>\n</li>\n</ol>\n<p>So, thereâ€™s no way of having a safely working carrier-local cache and your assumption that using thread locals (or alike) for caching is dead, is indeed right. You may use an object pool instead, but since this implies some sort of synchronization, you might as well consider just using a single <code>DateFormat</code>Â¹ and synchronize on it. This would implement your initial idea of not releasing the carrier thread during the use of the object.</p>\n<p>Of course, in this specific example, the better option is to use a <code>DateTimeFormatter</code> from the <code>java.time</code> API which is thread safe and hence, allows a single instance to be shared by all threads.</p>\n<p>Â¹ or one of multiple, selected in a way that does not involve synchronization</p>\n"
        }
      ],
      "owner": {
        "user_id": 1268003,
        "display_name": "Martin Andersson"
      },
      "view_count": 325,
      "up_vote_count": 7,
      "accepted_answer_id": 75767787,
      "answer_count": 2,
      "score": 6,
      "creation_date": 1673178976,
      "question_id": 75047540,
      "body": "<p><a href=\"https://openjdk.org/jeps/425\" rel=\"noreferrer\">JEP-425: Virtual Threads</a> states that a new virtual thread &quot;should be created for every application task&quot; and makes twice a reference to the possibility of having &quot;millions&quot; of virtual threads running in the JVM.</p>\n<p>The same JEP implies that each virtual thread will have access to its own thread-local value:</p>\n<blockquote>\n<p>Virtual threads support thread-local variables [...] just like platform threads, so they can run existing code that uses thread locals.</p>\n</blockquote>\n<p>Thread locals are many times used for the purpose of caching an object that is not thread-safe and expensive to create. The JEP warns:</p>\n<blockquote>\n<p>However, because virtual threads can be very numerous, use thread locals after careful consideration.</p>\n</blockquote>\n<p>Numerous indeed! Especially given how virtual threads are not pooled (or at least <a href=\"https://openjdk.org/jeps/425#Do-not-pool-virtual-threads\" rel=\"noreferrer\">shouldn't be</a>). As representative of a short-lived task, using thread locals in a virtual thread for the purpose of caching an expensive object seems to be borderline void of meaning. Unless! We can from a virtual thread create and access thread locals bound to its carrier thread ðŸ¤”</p>\n<p>For clarification, I would like to go from something like this (which would have been perfectly acceptable when using only native threads capped to the size of a pool, but this is clearly no longer a very effective caching mechanism when running millions of virtual threads continuously re-created:</p>\n<pre><code>static final ThreadLocal&lt;DateFormat&gt; CACHED = ThreadLocal.withInitial(DateFormat::getInstance);\n</code></pre>\n<p>To this (alas this class is not part of the public API):</p>\n<pre><code>static final ThreadLocal&lt;DateFormat&gt; CACHED = new jdk.internal.misc.CarrierThreadLocal();\n// CACHED.set(...)\n</code></pre>\n<p>Before we even get there. One must ask, is this a safe practice?</p>\n<p>Well, as far as I have understood virtual threads correctly, they are merely logical stages executed on a platform thread (aka. the &quot;carrier thread&quot;) with the ability to unmount instead of being blocked waiting. So I am assuming - please correct me if I am wrong - that 1) the virtual thread will never be interleaved by another virtual thread on the same carrier thread or rescheduled on another carrier thread <em>unless the code would have blocked otherwise</em> and therefore, if 2) the operation we invoke on the cached object never blocks, then the task/virtual thread will simply run from start to finish on the same carrier and so yes, it would be safe to cache the object on a platform thread-local.</p>\n<p>With the risk of answering my own question, JEP-425 indicates this is not possible:</p>\n<blockquote>\n<p>Thread-local variables of the carrier are unavailable to the virtual thread, and vice-versa.</p>\n</blockquote>\n<p>I could not find a public API to get the carrier thread or allocate thread locals explicitly on a platform thread [from a virtual thread], but that's not to say my humble research is definitive. Maybe there is a way?</p>\n<p>Then I read <a href=\"https://openjdk.org/jeps/429\" rel=\"noreferrer\">JEP-429: Scoped Values</a> which at first glance seems to be a stab by the Java Gods to get rid of the <code>ThreadLocal</code> altogether, or at least provide an alternative for virtual threads. In fact, the JEP uses verbiage such as &quot;migration to scoped values&quot; and says they are &quot;preferred to thread-local variables, especially when using large numbers of virtual threads&quot;.</p>\n<p>For all the use cases discussed in the JEP, I can only agree. But towards the bottom of this document, we also find this:</p>\n<blockquote>\n<p>There are a few scenarios that favor thread-local variables. An example is caching objects that are expensive to create and use, such as instances of java.text.DateFormat. Notoriously, a DateFormat object is mutable, so it cannot be shared between threads without synchronization. Giving each thread its own DateFormat object, via a thread-local variable that persists for the lifetime of the thread, is often a practical approach.</p>\n</blockquote>\n<p>In light of what was discussed earlier, using a thread-local may be &quot;practical&quot; but not very ideal. In fact, JEP-429 itself actually started off with a very telling remark: &quot;if each of a million virtual threads has mutable thread-local variables, the memory footprint may be significant&quot;.</p>\n<p>To summarize:</p>\n<p>Have you found a way to allocate thread locals on a carrier thread from the virtual thread?</p>\n<p>If not, is it safe to say that for applications using virtual threads, the practice of caching objects in a thread-local is dead and one will have to implement/use a different approach such as a concurrent cache/map/pool/whatever?</p>\n"
    },
    {
      "tags": [
        "java",
        "lambda",
        "functional-programming",
        "java-stream"
      ],
      "answers": [
        {
          "owner": {
            "user_id": 5646962,
            "display_name": "Thomas Kl&#228;ger"
          },
          "up_vote_count": 1,
          "is_accepted": true,
          "creation_date": 1678348587,
          "answer_id": 75681803,
          "body": "<p>How about</p>\n<pre><code>return petRepository.findAll().stream()\n            .filter(x -&gt; types.getIds().isEmpty() ||\n                         types.getIds().contains(x.getType().getId()))\n            .collect(Collectors.groupingBy(x -&gt; x.getType().getName(), Collectors.counting()));\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 1553851,
            "display_name": "shmosel"
          },
          "up_vote_count": 5,
          "is_accepted": false,
          "creation_date": 1678349198,
          "answer_id": 75681878,
          "body": "<p>If you don't want to check for empty on every <code>x</code>, you can put the whole lambda in a ternary expression:</p>\n<pre><code>return petRepository.findAll().stream()\n            .filter(types.getIds().isEmpty() ? x -&gt; true \n                    : x -&gt; types.getIds().contains(x.getType().getId()))\n            .collect(Collectors.groupingBy(x -&gt; x.getType().getName(), Collectors.counting()));\n</code></pre>\n<p>Or pop the stream in a temporary variable and apply the entire <code>filter()</code> conditionally:</p>\n<pre><code>Stream&lt;X&gt; stream = petRepository.findAll().stream();\nif (!types.getIds().isEmpty()) {\n    stream = stream.filter(x -&gt; types.getIds().contains(x.getType().getId()));\n}\nreturn stream.collect(Collectors.groupingBy(x -&gt; x.getType().getName(), Collectors.counting()));\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 5752737,
            "display_name": "geco17"
          },
          "up_vote_count": 2,
          "is_accepted": false,
          "creation_date": 1678349220,
          "answer_id": 75681881,
          "body": "<p>You just need to remember that the predicate in the <code>filter</code> has to return true whenever you want a result to be included. So in your case the filter condition must be such that, if the ids are NOT empty, filter will only return true for the condition you want. If the ids are empty, then filter must always return true.</p>\n<p>You can play with this by writing a minimal test example (or better yet, mocking your petRepository with junit or another testing framework).</p>\n<p>Consider:</p>\n<pre><code>Set&lt;Integer&gt; ids = Set.of(2);\nList&lt;Integer&gt; elements = List.of(1, 2, 3);\nList&lt;Integer&gt; list = elements.stream()\n        .filter(u -&gt; ids.size() &gt; 0 ? ids.contains(u) : true)\n        .toList();\nSystem.out.println(list);\n\n// output here will be [2]\n// but if ids is empty it will be [1, 2, 3]\n</code></pre>\n<p>Look at what's inside <code>filter</code>: <code>ids.size() &gt; 0 ? ids.contains(u) : true</code></p>\n<p>If there are ids to check, see if the streamed element of <code>elements</code> is contained in them. If there are no ids to check, return true regardless (keep everything in the elements stream for the next step in the pipeline).</p>\n<p>The ternary expression in this case could be further simplified to <code>u -&gt; ids.size() &lt;= 0 || ids.contains(u)</code>.</p>\n"
        }
      ],
      "owner": {
        "display_name": "user21348253"
      },
      "view_count": 133,
      "up_vote_count": 6,
      "accepted_answer_id": 75681803,
      "answer_count": 3,
      "score": 6,
      "creation_date": 1678348380,
      "question_id": 75681774,
      "body": "<p>I have the following stream statement with Java Stream and I filter records based on the typeId values as  <code>types.getIds().contains(x.getType().getId())</code>:</p>\n<pre><code>return petRepository.findAll().stream()\n                .filter(x -&gt; types.getIds().contains(x.getType().getId()))\n                .collect(Collectors.groupingBy(x -&gt; x.getType().getName(), Collectors.counting()));\n</code></pre>\n<p>However, I want to fetch all values when <code>types.getIds().size() == 0</code> and tried something as shpon below:</p>\n<pre><code>.filter(types.getIds().size() &gt; 0 ? x -&gt; types.getIds().contains(x.getType().getId()) : &lt;NO FILTERING&gt;)\n</code></pre>\n<p>So, how can I skip filtering when <code>types.getIds().size() == 0</code> ?</p>\n"
    },
    {
      "tags": [
        "java",
        "azure",
        "maven",
        "azure-blob-storage"
      ],
      "answers": [
        {
          "owner": {
            "user_id": 13942448,
            "display_name": "jccampanero"
          },
          "up_vote_count": 5,
          "is_accepted": true,
          "creation_date": 1679954726,
          "answer_id": 75860761,
          "body": "<p>With your first code snippet you are actually generating a valid SAS:</p>\n<pre class=\"lang-json prettyprint-override\"><code>{\n    &quot;uploadCredentialUrl&quot;: &quot;sv=2021-10-04&amp;spr=https%2Chttp&amp;se=2023-03-24T13%3A36%3A38Z&amp;sr=b&amp;sp=w&amp;sig=JUXXe1Qi13VWipgFWzx70mTOsVqadQCjmIF%2BxRl14cs%3D&quot;,\n    &quot;httpsHeaders&quot;: {\n        &quot;Content-Type&quot;: &quot;image/jpeg&quot;\n    },\n    &quot;mediaId&quot;: &quot;0ae4a0c5-167d-4a32-9752-0ad0d2b67e66.JPEG&quot;\n}\n</code></pre>\n<p>You mentioned that <code>uploadCredentialUrl</code> doesn't seem to be a valid URL and you are right because in fact you are receiving a SAS token.</p>\n<p>A SAS token is composed by a series of <a href=\"https://learn.microsoft.com/en-us/rest/api/storageservices/create-user-delegation-sas#construct-a-user-delegation-sas\" rel=\"noreferrer\">query parameters</a> that should be appended to the URL of the resource for which it should be applied.</p>\n<p>You are creating a SAS for uploading a specific blob (you can create the SAS for different <a href=\"https://learn.microsoft.com/en-us/rest/api/storageservices/delegate-access-with-shared-access-signature\" rel=\"noreferrer\">resources</a>); it means that you need to provide the URL for the blob resource you want to create and append to that obtained SAS token.</p>\n<p>Your <code>curl</code> command looks fine indeed, just be sure of using the right SAS token:</p>\n<pre><code>curl -X PUT -T ~/Downloads/gfx100s_sample_04_thum-1.jpg -H &quot;x-ms-date: $(date -u)&quot; &quot;https://&lt;storage account name&gt;.blob.core.windows.net/&lt;container name&gt;/myimage.jpg?&lt;received SAS token&gt;&quot;\n</code></pre>\n<p>Please, consider review the <a href=\"https://learn.microsoft.com/en-us/rest/api/storageservices/put-blob?tabs=shared-access-signatures\" rel=\"noreferrer\">Put Blob REST API documentation</a> for detailed information about the headers you can specify.</p>\n<p><a href=\"https://techcommunity.microsoft.com/t5/azure-paas-blog/performing-simple-blob-storage-rest-api-operations-using-curl/ba-p/3302552\" rel=\"noreferrer\">This related page</a> offers guidance as well.</p>\n<p>Finally, you are trying generating the signature yourself, and the process is well <a href=\"https://learn.microsoft.com/en-us/rest/api/storageservices/create-user-delegation-sas#specify-the-signature\" rel=\"noreferrer\">documented</a> but it is common to receive errors related to signature mismatch: if possible, prefer the Azure SDK for the specific programming language instead.</p>\n"
        },
        {
          "owner": {
            "user_id": 19231322,
            "display_name": "Arnob"
          },
          "up_vote_count": 2,
          "is_accepted": false,
          "creation_date": 1680117454,
          "answer_id": 75881322,
          "body": "<p>@jccampanero helped quite a lot. So thanks!</p>\n<p>Here is the actual piece of code that worked:</p>\n<pre><code>    public String generatePresignedUrl {\n        BlobServiceClient blobServiceClient = new BlobServiceClientBuilder().connectionString(STORAGE_ACCOUNT_CONNECTION_STRING).buildClient();\n        BlobContainerClient containerClient = blobServiceClient.getBlobContainerClient(CONTAINER_NAME);\n\n        OffsetDateTime expiryTime = OffsetDateTime.now().plusMinutes(30);\n        BlobClient blobClient = blobServiceClient.getBlobContainerClient(CONTAINER_NAME)\n                .getBlobClient(request.getFileName());\n        BlobSasPermission permission = new BlobSasPermission().setReadPermission(true).setWritePermission(true);\n        BlobServiceSasSignatureValues sasValues = new BlobServiceSasSignatureValues(expiryTime, permission);\n        String sasToken = blobClient.generateSas(sasValues);\n\n        String blobName = containerClient.getBlobClient(request.getFileName()).getBlobName();\n        log.info(sasToken);\n        String url = String.format(&quot;https://%s.blob.core.windows.net/%s/%s?%s&quot;, STORAGE_ACCOUNT_NAME, CONTAINER_NAME, request.getFileName(), sasToken);\n        return url;\n    }\n</code></pre>\n<p>and the curl command:</p>\n<pre><code>curl -X PUT -T &lt;file-location&gt; -H &quot;x-ms-blob-type: BlockBlob&quot; &quot;&lt;resource-url with SAS token&gt;&quot;\n</code></pre>\n<p>Notice the <code>x-ms-blob-type</code>.</p>\n<p>Resources that helped:</p>\n<ol>\n<li><a href=\"https://learn.microsoft.com/en-us/rest/api/storageservices/create-user-delegation-sas#version-2020-12-06-and-later\" rel=\"nofollow noreferrer\">String to sign</a> [if you want to do create the token manually]</li>\n<li><a href=\"https://learn.microsoft.com/en-us/rest/api/storageservices/put-blob?tabs=shared-access-signatures#request-headers-all-blob-types\" rel=\"nofollow noreferrer\">Header</a></li>\n</ol>\n"
        }
      ],
      "owner": {
        "user_id": 19231322,
        "display_name": "Arnob"
      },
      "view_count": 268,
      "up_vote_count": 6,
      "accepted_answer_id": 75860761,
      "answer_count": 2,
      "score": 6,
      "creation_date": 1679662341,
      "question_id": 75833896,
      "body": "<p>For uploading media my client will send a request to the server:</p>\n<pre><code>message GetMediaUploadCredRequest {\n  media.MediaType.Enum media_type = 1;\n  media.Extension.Enum extension = 2;\n  string file_name = 3;\n  bool is_private = 4;\n  string uploaded_by = 5;\n}\n</code></pre>\n<p>And the server will generate a SAS token (like <code>presigned_url</code> from AWS) and <code>http_header</code> will send back to the client.</p>\n<pre><code>message GetMediaUploadCredResponse {\n  string upload_credential_url = 1;\n  map&lt;string, string&gt; https_headers = 2;\n  string media_id = 3;\n}\n</code></pre>\n<p>client will then make a PUT request to the URL with the <code>https_headers</code> and the upload process will be complete.</p>\n<p>Here is the implementation:</p>\n<pre><code>public class StorexServiceImpl extends StorexServiceGrpc.StorexServiceImplBase {\n    private static final Logger log = LoggerFactory.getLogger(StorexServiceImpl.class);\n\n    private static final String STORAGE_ACCOUNT_CONNECTION_STRING = &quot;&lt;connection-string&gt;&quot;;\n    \n    private static final String CONTAINER_NAME = &quot;&lt;container-name&gt;&quot;;\n\n\n\n    @Override\n    public void getMediaUploadCred(GetMediaUploadCredRequest request, StreamObserver&lt;GetMediaUploadCredResponse&gt; response) {\n        try{\n            MediaType.Enum mediaType = request.getMediaType();\n            Extension.Enum extension = request.getExtension();\n            \n            String fileName = String.format(&quot;%s.%s&quot;, UUID.randomUUID(), extension.toString());\n\n            BlobServiceClient blobServiceClient = new BlobServiceClientBuilder().connectionString(STORAGE_ACCOUNT_CONNECTION_STRING).buildClient();\n            BlobContainerClient containerClient = blobServiceClient.getBlobContainerClient(CONTAINER_NAME);\n            BlobClient blobClient = containerClient.getBlobClient(fileName);\n            BlobHttpHeaders headers = new BlobHttpHeaders().setContentEncoding(&quot;gzip&quot;);\n\n            BlobSasPermission permission = new BlobSasPermission().setWritePermission(true); // Set the permission to allow uploading\n            OffsetDateTime expiryTime = OffsetDateTime.now().plusHours(1); // Set the expiration time to 1 hour from now\n\n            BlobServiceSasSignatureValues sasValues = new BlobServiceSasSignatureValues(expiryTime, permission)\n                    .setProtocol(SasProtocol.HTTPS_HTTP);\n\n            String sasUrl = blobClient.generateSas(sasValues);\n\n            Map&lt;String, String&gt; httpHeaders = new TreeMap&lt;&gt;();\n            httpHeaders.put(&quot;Content-Type&quot;, getContentType(mediaType, extension));\n            if(!request.getIsPrivate()) {\n                httpHeaders.put(&quot;x-amz-acl&quot;, &quot;public-read&quot;);\n            }\n\n            String blobId = blobClient.getBlobName(); // get the ID of the blob\n\n            GetMediaUploadCredResponse res = GetMediaUploadCredResponse.newBuilder()\n                    .setMediaId(blobId) // set the blob ID in the response\n                    .setUploadCredentialUrl(sasUrl)\n                    .putAllHttpsHeaders(httpHeaders)\n                    .build();\n            response.onNext(res);\n            response.onCompleted();\n        } catch (Exception e){}\n        super.getMediaUploadCred(request, response);\n\n    }\n\n    private String getContentType(MediaType.Enum mediaType, Extension.Enum extension) {\n        if(mediaType == MediaType.Enum.IMAGE) {\n            return &quot;image/&quot; + extension.toString().toLowerCase();\n        } else if(mediaType == MediaType.Enum.AUDIO) {\n            return &quot;audio/mp3&quot;;\n        } else if(mediaType == MediaType.Enum.VIDEO) {\n            return &quot;audio/mp4&quot;;\n        } else if(mediaType == MediaType.Enum.FILE) {\n            return &quot;application/&quot; + extension.toString().toLowerCase();\n        }\n        return &quot;binary/octet-stream&quot;;\n    }\n}\n</code></pre>\n<p>But for result I got this:</p>\n<pre><code>{\n    &quot;uploadCredentialUrl&quot;: &quot;sv=2021-10-04&amp;spr=https%2Chttp&amp;se=2023-03-24T13%3A36%3A38Z&amp;sr=b&amp;sp=w&amp;sig=JUXXe1Qi13VWipgFWzx70mTOsVqadQCjmIF%2BxRl14cs%3D&quot;,\n    &quot;httpsHeaders&quot;: {\n        &quot;Content-Type&quot;: &quot;image/jpeg&quot;\n    },\n    &quot;mediaId&quot;: &quot;0ae4a0c5-167d-4a32-9752-0ad0d2b67e66.JPEG&quot;\n}\n</code></pre>\n<p>The uploadCredentialUrl seems weird and not like an actual URL at all.</p>\n<p><strong>Update 1:</strong></p>\n<p>Found this <a href=\"https://stackoverflow.com/questions/61135060/azure-blob-storage-java-generate-sas-token-always-throw-sr-is-mandatory-cannot\">post</a>. So I changed my code a bit:</p>\n<pre><code>    public void getMediaUploadCred(GetMediaUploadCredRequest request, StreamObserver&lt;GetMediaUploadCredResponse&gt; response) {\n        try{\n            MediaType.Enum mediaType = request.getMediaType();\n            Extension.Enum extension = request.getExtension();\n\n            String fileName = String.format(&quot;%s.%s&quot;, UUID.randomUUID(), extension.toString());\n\n            \n            log.info(&quot;New Implementations Started&quot;);\n            SimpleDateFormat fmt = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);\n            fmt.setTimeZone(TimeZone.getTimeZone(&quot;UTC&quot;));\n            Calendar cal = Calendar.getInstance();\n            cal.setTime(new Date());\n            cal.add(Calendar.DATE, -2);\n            String start = fmt.format(cal.getTime());\n            cal.add(Calendar.DATE, 4);\n            String expiry =  fmt.format(cal.getTime());\n            SecretKeySpec secretKey = new SecretKeySpec(Base64.getDecoder().decode(STORAGE_ACCOUNT_KEY), &quot;HmacSHA256&quot;);\n            Mac sha256HMAC = Mac.getInstance(&quot;HmacSHA256&quot;);\n            sha256HMAC.init(secretKey);\n            String  resource =&quot;sc&quot;;\n            String permissions =&quot;rwdlac&quot;;\n            String service = &quot;b&quot;;\n            String apiVersion=&quot;2019-07-07&quot;;\n            String stringToSign = STORAGE_ACCOUNT_NAME + &quot;\\n&quot; +\n                    permissions +&quot;\\n&quot; +  // signed permissions\n                    service+&quot;\\n&quot; + // signed service\n                    resource+&quot;\\n&quot; + // signed resource type\n                    start + &quot;\\n&quot; + // signed start\n                    expiry + &quot;\\n&quot; + // signed expiry\n                    &quot;\\n&quot; +  // signed IP\n                    &quot;https\\n&quot;;\n            log.info(&quot;string to sign: {}&quot;, stringToSign);\n\n            String signature=Base64.getEncoder().encodeToString(sha256HMAC.doFinal(stringToSign.getBytes(&quot;UTF-8&quot;)));\n            String sasToken = &quot;sv=&quot; + apiVersion +\n                    &quot;&amp;ss=&quot; + service+\n                    &quot;&amp;srt=&quot; + resource+\n                    &quot;&amp;sp=&quot; +permissions+\n                    &quot;&amp;se=&quot; + URLEncoder.encode(expiry, &quot;UTF-8&quot;) +\n                    &quot;&amp;st=&quot; + URLEncoder.encode(start, &quot;UTF-8&quot;) +\n                    &quot;&amp;spr=https&quot; +\n                    &quot;&amp;sig=&quot; + URLEncoder.encode(signature,&quot;UTF-8&quot;);\n            log.info(&quot;sas token: {}&quot;, sasToken);\n            String resourceUrl = &quot;https://&quot; + STORAGE_ACCOUNT_NAME + &quot;.blob.core.windows.net/&quot; + CONTAINER_NAME + &quot;?comp=block&amp;&quot; + sasToken;\n            \n            \n\n            Map&lt;String, String&gt; httpHeaders = new TreeMap&lt;&gt;();\n            httpHeaders.put(&quot;Content-Type&quot;, getContentType(mediaType, extension));\n            if(!request.getIsPrivate()) {\n                httpHeaders.put(&quot;x-amz-acl&quot;, &quot;public-read&quot;);\n            }\n\n            GetMediaUploadCredResponse res = GetMediaUploadCredResponse.newBuilder()\n                    .setMediaId(&quot;blob id&quot;) // set the blob ID in the response\n                    .setUploadCredentialUrl(resourceUrl)\n                    .putAllHttpsHeaders(httpHeaders)\n                    .build();\n            response.onNext(res);\n            response.onCompleted();\n        } catch (Exception e){}\n    }\n</code></pre>\n<p>And I got a response:</p>\n<pre><code>{\n    &quot;uploadCredentialUrl&quot;: &quot;https://&lt;STORAGE_ACCOUNT&gt;.blob.core.windows.net/&lt;CONTAINER_NAME&gt;?comp=block&amp;sv=2019-07-07&amp;ss=b&amp;srt=sc&amp;sp=rwdlac&amp;se=2023-03-28&amp;st=2023-03-24&amp;spr=https&amp;sig=RpdV8prUgjzFApNo6bkuuiRAPHnw1mqww5l42cwVwyY%3D&quot;,\n    &quot;httpsHeaders&quot;: {\n        &quot;Content-Type&quot;: &quot;image/jpeg&quot;\n    },\n    &quot;mediaId&quot;: &quot;blob id&quot;\n}\n</code></pre>\n<p>But when I tried this:</p>\n<pre><code>curl -X PUT -T ~/Downloads/gfx100s_sample_04_thum-1.jpg -H &quot;x-ms-date: $(date -u)&quot; &quot;https://&lt;STORAGE_ACCOUNT&gt;.blob.core.windows.net/&lt;CONTAINER_NAME&gt;/myimage.jpg?comp=block&amp;sv=2019-07-07&amp;ss=b&amp;srt=sc&amp;sp=rwdlac&amp;se=2023-03-28&amp;st=2023-03-24&amp;spr=https&amp;sig=RpdV8prUgjzFApNo6bkuuiRAPHnw1mqww5l42cwVwyY%3D&quot;\n</code></pre>\n<p>I got this:</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;Error&gt;&lt;Code&gt;AuthenticationFailed&lt;/Code&gt;&lt;Message&gt;Server failed to authenticate the request. Make sure the value of Authorization header is formed correctly including the signature.\nRequestId:337c6e4d-301e-0019-7ebd-5f3baf000000\nTime:2023-03-26T08:30:28.5705948Z&lt;/Message&gt;&lt;AuthenticationErrorDetail&gt;Signature did not match. String to sign used was storageapollodevappstro\nrwdlac\nb\nsc\n2023-03-24\n2023-03-28\n\nhttps\n2019-07-07\n&lt;/AuthenticationErrorDetail&gt;&lt;/Error&gt;%\n</code></pre>\n<p><strong>Update 2:</strong></p>\n<p>I have updated my code following jccampanero guideline:</p>\n<pre><code>    @Override\n    public void getMediaUploadCred(GetMediaUploadCredRequest request, StreamObserver&lt;GetMediaUploadCredResponse&gt; response) {\n        BlobServiceClient blobServiceClient = new BlobServiceClientBuilder().connectionString(STORAGE_ACCOUNT_CONNECTION_STRING).buildClient();\n        BlobContainerClient containerClient = blobServiceClient.getBlobContainerClient(CONTAINER_NAME);\n        BlobSasPermission permission = new BlobSasPermission().setReadPermission(true).setWritePermission(true);\n        OffsetDateTime expiryTime = OffsetDateTime.now().plusMinutes(30);\n\n        String blobName = containerClient.getBlobClient(request.getFileName()).getBlobName();\n        String sasToken = generateSasToken(STORAGE_ACCOUNT_NAME, STORAGE_ACCOUNT_KEY, CONTAINER_NAME, blobName, permission, expiryTime);\n        String url = String.format(&quot;https://%s.blob.core.windows.net/%s/%s?%s&quot;, STORAGE_ACCOUNT_NAME, CONTAINER_NAME, request.getFileName(), sasToken);\n        GetMediaUploadCredResponse res = GetMediaUploadCredResponse.newBuilder()\n                .setMediaId(blobName)\n                .setUploadCredentialUrl(url)\n                .build();\n        response.onNext(res);\n        response.onCompleted();\n    }\n\n    private static String generateSasToken(String accountName, String accountKey, String containerName, String blobName, BlobSasPermission permission, OffsetDateTime expiryTime) {\n        String sasToken = null;\n        try {\n            String signedPermissions = permission.toString();\n            String signedStart = OffsetDateTime.now().format(DateTimeFormatter.ISO_OFFSET_DATE_TIME);\n            String signedExpiry = expiryTime.format(DateTimeFormatter.ISO_OFFSET_DATE_TIME);\n            String canonicalizedResource = String.format(&quot;/blob/%s/%s/%s&quot;, accountName, containerName, blobName);\n            String signedVersion = &quot;2020-12-06&quot;;\n\n            String stringToSign = signedPermissions + &quot;\\n&quot; +\n                    signedStart + &quot;\\n&quot; +\n                    signedExpiry + &quot;\\n&quot; +\n                    canonicalizedResource + &quot;\\n&quot; +\n                    &quot;\\n&quot; + // signedKeyObjectId\n                    &quot;\\n&quot; + // signedKeyTenantId\n                    &quot;\\n&quot; + // signedKeyStart\n                    &quot;\\n&quot; + // signedKeyExpiry\n                    &quot;\\n&quot; + // signedKeyService\n                    &quot;\\n&quot; + // signedKeyVersion\n                    &quot;\\n&quot; + // signedAuthorizedUserObjectId\n                    &quot;\\n&quot; + // signedUnauthorizedUserObjectId\n                    &quot;\\n&quot; + // signedCorrelationId\n                    &quot;\\n&quot; + // signedIP\n                    &quot;https\\n&quot; + // signedProtocol\n                    signedVersion + &quot;\\n&quot; +\n                    &quot;\\n&quot; + // signedResource\n                    &quot;\\n&quot; + // signedSnapshotTime\n                    &quot;\\n&quot; + // signedEncryptionScope\n                    &quot;\\n&quot; + // rscc\n                    &quot;\\n&quot; + // rscd\n                    &quot;\\n&quot; + // rsce\n                    &quot;\\n&quot; + // rscl\n                    &quot;\\n&quot;; // rsct\n\n            Mac mac = Mac.getInstance(&quot;HmacSHA256&quot;);\n            mac.init(new SecretKeySpec(Base64.getDecoder().decode(accountKey), &quot;HmacSHA256&quot;));\n            String signature = Base64.getEncoder().encodeToString(mac.doFinal(stringToSign.getBytes(&quot;UTF-8&quot;)));\n            sasToken = String.format(&quot;sv=%s&amp;st=%s&amp;se=%s&amp;sr=b&amp;sp=%s&amp;sig=%s&quot;,\n                    signedVersion, signedStart, signedExpiry, permission.toString(), URLEncoder.encode(signature, &quot;UTF-8&quot;));\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n        return sasToken;\n    }\n</code></pre>\n<p>And running the CURL command:</p>\n<pre><code>curl -X PUT \\\n  -T ~/Downloads/gfx100s_sample_04_thum-1.jpg \\\n  -H &quot;x-ms-blob-type: BlockBlob&quot; \\\n  -H &quot;x-ms-meta-name: example&quot; \\\n  &quot;&lt;URL-with sas token&gt;&quot;\n</code></pre>\n<p>gives me:</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;Error&gt;&lt;Code&gt;AuthenticationFailed&lt;/Code&gt;&lt;Message&gt;Server failed to authenticate the request. Make sure the value of Authorization header is formed correctly including the signature.\nRequestId:124d92c4-101e-001e-189f-6157cc000000\nTime:2023-03-28T18:02:50.6977457Z&lt;/Message&gt;&lt;AuthenticationErrorDetail&gt;Signature fields not well formed.&lt;/AuthenticationErrorDetail&gt;&lt;/Error&gt;%\n</code></pre>\n<p>But I followed the Signature fields from <a href=\"https://learn.microsoft.com/en-us/rest/api/storageservices/create-user-delegation-sas#version-2020-12-06-and-later\" rel=\"noreferrer\">docs</a>. So why am I still getting the error?</p>\n<p><strong>Update 3:</strong></p>\n<pre><code>        BlobServiceClient blobServiceClient = new BlobServiceClientBuilder().connectionString(STORAGE_ACCOUNT_CONNECTION_STRING).buildClient();\n        BlobContainerClient containerClient = blobServiceClient.getBlobContainerClient(CONTAINER_NAME);\n\n        OffsetDateTime expiryTime = OffsetDateTime.now().plusMinutes(30);\n        BlobClient blobClient = blobServiceClient.getBlobContainerClient(CONTAINER_NAME)\n                .getBlobClient(request.getFileName());\n        BlobSasPermission permission = new BlobSasPermission().setReadPermission(true).setWritePermission(true);\n        BlobServiceSasSignatureValues sasValues = new BlobServiceSasSignatureValues(expiryTime, permission);\n        String sasToken = blobClient.generateSas(sasValues);\n\n        String blobName = containerClient.getBlobClient(request.getFileName()).getBlobName();\n        log.info(sasToken);\n        String url = String.format(&quot;https://%s.blob.core.windows.net/%s/%s?%s&quot;, STORAGE_ACCOUNT_NAME, CONTAINER_NAME, request.getFileName(), sasToken);\n        GetMediaUploadCredResponse res = GetMediaUploadCredResponse.newBuilder()\n                .setMediaId(blobName)\n                .setUploadCredentialUrl(url)\n                .build();\n</code></pre>\n<p>Error:</p>\n<pre><code>Server failed to authenticate the request. Make sure the value of Authorization header is formed correctly including the signature.\n</code></pre>\n"
    },
    {
      "tags": [
        "java",
        "refactoring",
        "automated-refactoring"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 40342,
            "display_name": "Joachim Sauer"
          },
          "edited": false,
          "comment_id": 133242224,
          "body": "A long time ago I <a href=\"https://stackoverflow.com/questions/7566565/is-there-a-way-to-apply-a-refactoring-script-just-for-its-side-effects\">looked for something very similar for Eclipse</a> and didn&#39;t find a good answer. It&#39;s quite possible that this thing now exists."
        },
        {
          "owner": {
            "user_id": 2513200,
            "display_name": "Hulk"
          },
          "edited": false,
          "comment_id": 133243055,
          "body": "Well, the company I&#39;m working for develops a rule-based refactoring engine (Eclipse plugin and Maven plugin), but it doesn&#39;t allow custom rules. It does have some for frequently used migration paths, such as between jUnit versions and various styles of Asserts: <a href=\"https://jsparrow.github.io/\" rel=\"nofollow noreferrer\">jsparrow.github.io</a>"
        },
        {
          "owner": {
            "user_id": 9193100,
            "display_name": "Garruk The Wildspeaker"
          },
          "edited": false,
          "comment_id": 133261442,
          "body": "I need exactly the same but with the custom rules :("
        },
        {
          "owner": {
            "user_id": 37213,
            "display_name": "duffymo"
          },
          "edited": false,
          "comment_id": 133304669,
          "body": "Get IntelliJ.  It&#39;s terrific at refactoring.  Not something I&#39;d script."
        },
        {
          "owner": {
            "user_id": 40342,
            "display_name": "Joachim Sauer"
          },
          "edited": false,
          "comment_id": 133304943,
          "body": "@duffymo: indeed it is, but as a developer of libraries that others use, I want to hand them a simple way to do all the &quot;mechanical&quot; transformations that might be necessary to migrate to another major version of my library."
        },
        {
          "owner": {
            "user_id": 2513200,
            "display_name": "Hulk"
          },
          "edited": false,
          "comment_id": 133305092,
          "body": "@GarrukTheWildspeaker if you have a specific migration path in mind that may also be useful to other people, feel free to use the <a href=\"https://jsparrow.io/contact-us/\" rel=\"nofollow noreferrer\">jsparrow contact form</a> to send us a feature request - it will be considered. User-customizable rules are unfortunately out of scope for now."
        },
        {
          "owner": {
            "user_id": 37213,
            "display_name": "duffymo"
          },
          "edited": false,
          "comment_id": 133310488,
          "body": "@JoachimSauer, if I&#39;m a user of your library I expect to add your code as a package.  I&#39;m certainly not going to apply any refactorings.  I expect you to do that, publish the modified package to a public repo with release notes.  I would get rid of your library if you gave me a script to apply a refactoring to your code.  I have never gotten a script to modify MY code from Spring Boot.  I don&#39;t see how it can be practical."
        },
        {
          "owner": {
            "user_id": 40342,
            "display_name": "Joachim Sauer"
          },
          "edited": false,
          "comment_id": 133314383,
          "body": "@duffymo: I&#39;m not talking about applying refactoring to the library. I&#39;m talking about the client code that <i>uses</i> the library."
        },
        {
          "owner": {
            "user_id": 37213,
            "display_name": "duffymo"
          },
          "edited": false,
          "comment_id": 133317847,
          "body": "Yes.  I&#39;ve never seen such a thing from Spring Boot or any library that I use.  I would not expect to ever get more than release notes.  Conversion refactoring is up to me."
        },
        {
          "owner": {
            "user_id": 2513200,
            "display_name": "Hulk"
          },
          "edited": false,
          "comment_id": 133337738,
          "body": "@duffymo backwards compatibility is hard, and there are occasionly valid reasons for a library to break it. If it does, helping users with the migration will ease the pain. But this comment thread is not the right place for this discussion."
        },
        {
          "owner": {
            "user_id": 37213,
            "display_name": "duffymo"
          },
          "edited": false,
          "comment_id": 133344199,
          "body": "I don&#39;t disagree that it&#39;s painful.  I&#39;m pointing out that Spring Boot offers no such script.  I don&#39;t need instruction from you on how SO works."
        },
        {
          "owner": {
            "user_id": 13195754,
            "display_name": "branboyer"
          },
          "edited": false,
          "comment_id": 133396839,
          "body": "Intellij already has refactoring shortcuts to do that, but it also has a systematic programmatic way (and with Groovy): <a href=\"https://www.jetbrains.com/help/idea/structural-search-and-replace.html#share_template\" rel=\"nofollow noreferrer\">jetbrains.com/help/idea/&hellip;</a>"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 1752215,
            "display_name": "cw&#39;"
          },
          "up_vote_count": 3,
          "is_accepted": false,
          "creation_date": 1677761026,
          "answer_id": 75615576,
          "body": "<p>Sounds like a job for <a href=\"https://docs.openrewrite.org/running-recipes/getting-started\" rel=\"nofollow noreferrer\">OpenRewrite</a>. Standard recipes, e.g., for renaming a package are available. You can also write your own recipes, which make use of a visitor pattern over a tree-based representation of your source code (which will preserve, e.g., indentation).</p>\n<p>You can use Maven or Gradle to execute the rewrite.</p>\n<p>For instance the change package configuration from the getting started page looks like this:</p>\n<pre><code>type: specs.openrewrite.org/v1beta/recipe\nname: com.yourorg.VetToVeterinary\nrecipeList:\n  - org.openrewrite.java.ChangePackage:\n    oldPackageName: org.springframework.samples.petclinic.vet\n    newPackageName: org.springframework.samples.petclinic.veterinary\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 120163,
            "display_name": "Ira Baxter"
          },
          "up_vote_count": 2,
          "is_accepted": false,
          "creation_date": 1677784372,
          "answer_id": 75619901,
          "body": "<p>Not Groovy based (but then other answers suggesting &quot;OpenRewrite&quot; or &quot;IntelliJ&quot; aren't Groovy based either).</p>\n<p>What OP is asking for is a <a href=\"https://en.wikipedia.org/wiki/Program_transformation\" rel=\"nofollow noreferrer\">program transformation system (PTS)</a> that will let him write custom transformation rules.  Most PTS system provide you with access to the target language AST... and you write custom rules by coding procedural visitors that clamber around the tree, matching and splicing individual tree nodes. Eclipse works like this; apparantly also OpenRewrite.</p>\n<p>That's a clumsy way to do it, mostly because the details of the AST are voluminous and sort of arbitrary, and your tree-crawling code has to know all of this.  See <a href=\"http://www.semdesigns.com/Products/DMS/ProgramTransformation.html\" rel=\"nofollow noreferrer\">program_transforms on AST vs surface syntax</a>  for more details.  Ideally you'd write transformations using the surface syntax of the programming language and let the PTS take care of doing the matching and replacement against the actual AST.</p>\n<p>Our <a href=\"http://www.semdesigns.com/Products/DMS/DMSToolkit.html\" rel=\"nofollow noreferrer\">DMS Software Reengineering Toolkit</a> will let you do this.  The transformations op wants do are coded like this:</p>\n<pre><code>Domain Java~v11; -- specifies which specific Java dialect grammar is relevant\n\nrule rename_foo(p:access_path_prefix): access_path -&gt; access_path\n  = &quot;\\p foo.method2&quot; -&gt; &quot;\\p foo.method3&quot;;\n\nrule rename_myMethod(p:access_path_prefix): access_path -&gt; access_path\n  = &quot;\\p myMethod&quot; -&gt; &quot;\\p your_method&quot;;\n\nrule change_import_AnotherClassFromExternalPackage: import_statement -&gt; import_statement\n  = &quot;import org.you.core.util.AnotherClassFromExternalPackage&quot;\n    -&gt; &quot;import com.me.core.util.AnotherClassFromExternalPackage&quot;;\n\nruleset my_patches = \n   { rename_foo, \n     rename_myMethod, \n     change_import_AnotherClassFromExternalPackage\n   }\n</code></pre>\n<p>The <code>Domain</code> keyword tells DMS which precise grammar to use to parse the source text, including the specific dialect. (Java 6 is not the same as Java 11).</p>\n<p>Individual rules are named (e.g., <code>rename_foo</code>). The parmeter list (e.g. <code>p:access_path_prefix</code>) allows one to specify a named piece of syntax (e.g., <code>p</code>) that can match an arbitrary tree of the syntax category (e.g., <code>access_path_prefix</code>).  Each rule specifies that it is a mapping <code>-&gt;</code> from one piece of syntax to another; for these rules, source and target syntax categories are the same (e.g. <code>access_path</code>).</p>\n<p>Each rule also specifies the details of the mapping ( <code>= &quot;*match*&quot; -&gt; &quot;*replacement*&quot;</code> ) where match and replacement are valid surface syntax patterns that match the source and target syntax categories respectively.  The reason for the quote marks is to separate the rule syntax from the source/target language syntax (e..g Java) inside the quotes. The match pattern <code>&quot;\\p foo.method2&quot;</code> matches an arbitrary path prefix (a sequence of identifiers trailed by dots or a special case of empty, as defined by the Java grammar) followed by the end of the access_path <code>foo.method2</code> as op desired. The replacement pattern is that same access_path_prefix <code>p</code> followed by the changed end of access path <code>foo.method3</code>.</p>\n<p>The <code>ruleset mypatches</code> collects the individual rules into a group that DMS can apply everywhere.</p>\n<p>One can run a DMS RuleRewrite engine configured for Java~v11, point it at a legal Java file, and apply the <code>mypatches</code> ruleset to achieve what OP desires. DMS parses the file to build the AST, parses the rules to construct the ASTs necessary for matching, matches the rule ASTs and replaces ASTs where matches occur (so you don't have to do all this stuff with procedural tree hacking).  When complete, DMS regenerates the transformed source text, preserving indentation, comments, etc.</p>\n<p>So you get a mechanical process for applying the rules of interest, with the rules being fairly easy to write because they use (Java) surface syntax rather than tree-climbing primitives.</p>\n<p>These are rather simple examples.  We've used DMS to carry out massive rewrites across Java and C++, and even to translate COBOL to Java.</p>\n"
        },
        {
          "owner": {
            "user_id": 1732516,
            "display_name": "ashK"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1677839654,
          "answer_id": 75625958,
          "body": "<p>I would have an excel with columns like,</p>\n<p><a href=\"https://i.stack.imgur.com/u9q1P.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/u9q1P.png\" alt=\"enter image description here\" /></a></p>\n<ol>\n<li>Use a library like Apache POI to read the Excel file and extract the required information (project name, package name, class name, method name, and field name).</li>\n<li>Use a library like Eclipse JDT to parse the source code and build the AST.</li>\n<li>Traverse the AST and identify the nodes that correspond to the specified classes, methods, and fields.</li>\n<li>Apply the required modifications to the identified AST nodes.</li>\n<li>Generate the modified source code from the updated AST.</li>\n</ol>\n"
        }
      ],
      "owner": {
        "user_id": 9193100,
        "display_name": "Garruk The Wildspeaker"
      },
      "view_count": 326,
      "up_vote_count": 6,
      "answer_count": 3,
      "score": 6,
      "creation_date": 1676979822,
      "question_id": 75520058,
      "body": "<p>How to refactor this class programmatically via Java code/Groovy plugin?\nLet's say, I need to:</p>\n<ul>\n<li>Rename <code>foo.method2</code> to <code>foo.method3</code></li>\n<li>Rename <code>myMethod</code> to <code>yourMethod</code></li>\n<li>Change the imported package <code>org.you.core.util.AnotherClassFromExternalPackage</code></li>\n</ul>\n<pre><code>import com.me.core.util.AnotherClassFromExternalPackage;\nimport com.me.core.util.Foo;\n\npublic class MyClass implements AnotherClassFromExternalPackage {\n\n    private final Foo foo;\n\n    public MyClass() {\n        this.foo = new Foo();\n    }\n\n    @Override\n    public long myMethod() {\n        return foo.method2();\n    }\n}\n</code></pre>\n<p>How to create a script that will parse the code, apply syntactical transformations and save it using given instructions?</p>\n<p>The code above is just an example. The bigger problem is that I have a lot of projects that are using the same external library. And sometimes they release a new version with breaking changes that is breaking the current code after the dependency bump.\nAnd I must update the dependency to the latest version every 2 weeks for 10+ projects. I need to write a script that will fix these breaking changes automatically.\nIdeally, apply code transformations one by one.</p>\n"
    },
    {
      "tags": [
        "java",
        "http",
        "batch-processing",
        "job-scheduling"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 466862,
            "display_name": "Mark Rotteveel"
          },
          "edited": false,
          "comment_id": 132557723,
          "body": "HTTP itself will do that just fine (it is something layered on top of TCP), but in my experience, HTTP servers, clients, and middleware like loadbalancers, firewalls and proxies might be configured to terminate HTTP connections after a few minutes. It might be better to have the HTTP request submit the job, return a job-id, and let the client poll for completion of that job."
        },
        {
          "owner": {
            "user_id": 1175279,
            "display_name": "Dilip Raj Baral"
          },
          "edited": false,
          "comment_id": 132568604,
          "body": "Client polling is definitely something we have thought of but we feel it isn&#39;t very elegant. What would the polling interval be? Job completion time may vary from a couple seconds to hours. If you keep small interval, it might be an overkill for long running jobs; if you keep it large, it would result delay in getting results for short running jobs. Also, since the there will be multiple instances (pods) of Batch service, each request will hit different pod. So, batch service will need to store the job completion result into some persistent storage adding another layer of complexity."
        },
        {
          "owner": {
            "user_id": 6395627,
            "display_name": "Slaw"
          },
          "edited": false,
          "comment_id": 132570017,
          "body": "I have absolutely no practical experience with them, but what about web sockets? I believe they use the same ports as HTTP(S). And <a href=\"https://stackoverflow.com/a/7620721/6395627\">as I understand it</a>, they are designed for long-lived connections with two-way communication. Again, I don&#39;t know if they&#39;re appropriate to your use case, but thought I&#39;d just throw the idea out there."
        },
        {
          "owner": {
            "user_id": 1175279,
            "display_name": "Dilip Raj Baral"
          },
          "edited": false,
          "comment_id": 132570259,
          "body": "@Slaw This is an interesting idea and could potentially work. It will require us to do some R&amp;D to make with work with existing load balancers in place (a potential problem like Mark mentioned in the first comment."
        },
        {
          "owner": {
            "user_id": 2067492,
            "display_name": "matt"
          },
          "edited": false,
          "comment_id": 132715242,
          "body": "It sounds a bit weird. What if a computer goes to sleep? It seems like there are lots of ways this task can fail especially if you&#39;re running a task for hours. When it does fail, do you expect it to just start over?"
        },
        {
          "owner": {
            "user_id": 14570999,
            "display_name": "Piotr"
          },
          "edited": false,
          "comment_id": 132719799,
          "body": "You need some state. In the past the state was in the connection that was open, it worked, you were not using that state directly and it was prone to all sort of issues. Once you moved your workload to openshift you have multiple abstractions added. Probably ingress controller in cluster and very likely load balancer infront of the cluster. Maybe also cloudflare (which by default will terminate connections after some time as well) Like someone mentioned all of them would have to support what you need. Options: pooling (easy &amp; dummy) or more async architecture with callbacks when job is done"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 5802417,
            "display_name": "Michael Gantman"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1673866499,
          "answer_id": 75133218,
          "body": "<p>When your worked with socket and TCPprotocol you were in control on how long to keep connections open. With HTTP you are only in control of logical connections and not physical ones. Actual connections are controlled by OS and usually IT people can configure all those timeouts. But by default how it works is that when you even close logical connection the real connection is no closed in anticipation of next communication. It is closed by OS and not controlled by your code. However even if it closes and your next request comes after that it is opened transparently to you. SO it doesn't really matter if it closed or not. It should be transparent to your code. So in short I assume that you can move to HTTP/HTTPS with no problems. But you will have to test and see. <br><br>Also about other options on server to client communications you can look at my answer to this question: <a href=\"https://stackoverflow.com/questions/71395004/how-to-continues-send-data-from-backend-to-frontend-when-something-changes/71395235#71395235\">How to continues send data from backend to frontend when something changes</a></p>\n"
        },
        {
          "owner": {
            "user_id": 1402425,
            "display_name": "vudangngoc"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1674393096,
          "answer_id": 75200697,
          "body": "<p>IMHO, you should  improve your scheduler to a REST API server, Websocket isn't effective in this scenario, the connection will inactive most of time</p>\n"
        },
        {
          "owner": {
            "user_id": 13791634,
            "display_name": "Bangarraju Vadapalli"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1674443798,
          "answer_id": 75205426,
          "body": "<p>The jobs can be short-lived or long running. So, When a long running job fails in the middle, how does the restart of the job happen? Does it start from beginning again?</p>\n<p>In a similar scenario, we had a database to keep track of the progress of the job (no of records successfully processed). So, the jobs can resume after a failure. With such a design, another webservice can monitor the status of the job by looking at the database. So, the main process is not impacted by constant polling by the client.</p>\n"
        },
        {
          "owner": {
            "user_id": 21063779,
            "display_name": "Lae"
          },
          "up_vote_count": 2,
          "is_accepted": false,
          "creation_date": 1674464172,
          "answer_id": 75207289,
          "body": "<p>There isn't a reliable way to keep a connection alive for a long period over the internet, because of nodes (routers, load balancers, proxies, nat gateways, etc) that may be sitting between your client and server, they might drop mid connection under load, some of them will happily ignore your HTTP keep alive request, or have an internal max connection duration time that will kill long running TCP connections, you may find it works for you today but there is no guarantee it will work for you tomorrow.</p>\n<p>So you'll probably need to submit the job as a short lived request and check the status via other means:</p>\n<ul>\n<li>Push based strategy by sending a webhook URL as part of the job submission and have the server call it (possibly with retries) on job completion to notify interested parties.</li>\n<li>Pull based strategy by having the server return a job ID on submission, then have the client check periodically. Due to the nature of your job durations, you may want to implement this with some form of exponential backoff up to a certain limit, for example, first check after waiting for 2 seconds, then wait for 4 seconds before next check, then 8 seconds, and so on, up to a maximum of time you are happy to wait between each check. So that you can find out about short job completions sooner and not check too frequently for long jobs.</li>\n</ul>\n"
        },
        {
          "owner": {
            "user_id": 606513,
            "display_name": "schneida"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1674476192,
          "answer_id": 75209378,
          "body": "<p>We have had bad experiences with long standing HTTP/HTTPS connections. We used to schedule short jobs (only a couple of minutes) via HTTP and wait for it to finish and send a response. This worked fine, until the jobs got longer (hours) and some network infrastructure closed the inactive connections. We ended up only submitting the request via HTTP, get an immediate response and then implemented a polling to wait for the response. At the time, the migration was pretty quick for us, but since then we have migrated it even further to use &quot;webhooks&quot;, e.g. allow the processor of the job to signal it's state back to the server using a known webhook address.</p>\n"
        }
      ],
      "owner": {
        "user_id": 1175279,
        "display_name": "Dilip Raj Baral"
      },
      "view_count": 248,
      "up_vote_count": 6,
      "answer_count": 5,
      "score": 6,
      "creation_date": 1673688006,
      "question_id": 75116927,
      "body": "<p>My team maintains an application (written on Java) which processes long running batch jobs. These jobs needs to be run on a defined sequence. Hence, the application starts a socket server on a pre-defined port to accept job execution requests. It keeps the socket open until the job completes (with success or failure). This way the job scheduler knows when one job ends and upon successful completion of the job, it triggers the next job in the pre-defined sequence. If the job fails, scheduler sends out an alert.</p>\n<p>This is a setup we have had for over a decade. We have some jobs which runs for a few minutes and other which takes a couple hours (depending on the volume) to complete. The setup has worked without any issues.</p>\n<p>Now, we need to move this application to a container (RedHat OpenShift Container Platform) and the infra policy in place allows only default HTTPS port be exposed. The scheduler sits outside OCP and cannot access any port other than the default HTTPS port.</p>\n<p>In theory, we could use the HTTPS, set Client timeout to a very large duration and try to mimic the the current setup with TCP socket. But would this setup be reliable enough as HTTP protocol is designed to serve short-lived requests?</p>\n"
    },
    {
      "tags": [
        "java",
        "android",
        "react-native",
        "gradle",
        "google-cloud-storage"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 6877799,
            "display_name": "AmerllicA"
          },
          "edited": false,
          "comment_id": 133281678,
          "body": "I found it out, it happens because I&#39;m located in Iran, the country that got banned by US sanctions, so even by using a VPN, I&#39;m not able to take an Android build of my current project. if anybody knows how to fix this please give me shout here."
        },
        {
          "owner": {
            "user_id": 17018079,
            "display_name": "Ramin Khodaie"
          },
          "edited": false,
          "comment_id": 133328189,
          "body": "this is a common problem among us my brother.I fix my case once using &#39;Shekan DNS&#39;."
        },
        {
          "owner": {
            "user_id": 6877799,
            "display_name": "AmerllicA"
          },
          "edited": false,
          "comment_id": 133335215,
          "body": "@RaminKhodaie, Bro, I already test Shekan DNSz, but have no success so far."
        },
        {
          "owner": {
            "user_id": 1055015,
            "display_name": "Exlord"
          },
          "edited": false,
          "comment_id": 133338139,
          "body": "@AmerllicA Broo also clear DNS cache before running this command"
        },
        {
          "owner": {
            "user_id": 17018079,
            "display_name": "Ramin Khodaie"
          },
          "edited": false,
          "comment_id": 133340944,
          "body": "@AmerllicA once I was struggling with somehow same problem for a week, then I left it and when came back at Saturday without any changes it works and download all packages.it is strange a little :)"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 3464834,
            "display_name": "mohammadreza berneti"
          },
          "up_vote_count": 2,
          "is_accepted": false,
          "creation_date": 1677395419,
          "answer_id": 75570492,
          "body": "<p>This solution works for me:</p>\n<p><strong>Step 1:</strong> creating a socks proxy with ssh tunnel:</p>\n<p><code>ssh -f -N -M -S /tmp/sshtunnel -D 1086 root@x.x.x.x</code></p>\n<p><strong>Step 2:</strong> passing my system traffic through the socks proxy by Shadowrocket (needs m1 macbook)</p>\n<p><a href=\"https://i.stack.imgur.com/T9uec.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/T9uec.png\" alt=\"enter image description here\" /></a></p>\n"
        }
      ],
      "owner": {
        "user_id": 6877799,
        "display_name": "AmerllicA"
      },
      "view_count": 187,
      "up_vote_count": 6,
      "answer_count": 1,
      "score": 6,
      "creation_date": 1677061879,
      "question_id": 75531408,
      "body": "<p>I'm trying to development build (<code>yarn android</code>), but the Android build of React Native got stuck behind this issue, I don't know which package needs this, I made a fresh React Native project and everything was correct there, but on my project, it got stuck. For sure a package needs this, but I haven't got any clue.</p>\n<pre><code>Execution failed for task ':app:checkDebugDuplicateClasses'.\n&gt; Could not resolve all files for configuration ':app:debugRuntimeClasspath'.\n   &gt; Failed to transform lifecycle-common-java8-2.4.0.jar (androidx.lifecycle:lifecycle-common-java8:2.4.0) to match attributes {artifactType=enumerated-runtime-classes, org.gradle.category=library, org.gradle.dependency.bundling=external, org.gradle.jvm.version=8, org.gradle.libraryelements=jar, org.gradle.status=release, org.gradle.usage=java-runtime}.\n      &gt; Could not find lifecycle-common-java8-2.4.0.jar (androidx.lifecycle:lifecycle-common-java8:2.4.0).\n        Searched in the following locations:\n            https://dl.google.com/dl/android/maven2/androidx/lifecycle/lifecycle-common-java8/2.4.0/lifecycle-common-java8-2.4.0.jar\n</code></pre>\n<p>I'm able to download this file by using a browser, but the build procedure cannot download it. even I thought if I know the download place I will put the file there and maybe it helps, but I don't know where does the build procedure use to store the file and then use it.</p>\n"
    },
    {
      "tags": [
        "java",
        "rest",
        "http",
        "elasticsearch",
        "opensearch"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 14000148,
            "display_name": "warkolm"
          },
          "edited": false,
          "comment_id": 132599334,
          "body": "can you share <code>_cat&#47;aliases?v</code> showing this?"
        },
        {
          "owner": {
            "user_id": 10685211,
            "display_name": "Musab Dogan"
          },
          "edited": false,
          "comment_id": 132604909,
          "body": "Why you&#39;re not using a <code>rollover_alias</code> to automatize the rollover move alias process? <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-rollover-index.html\" rel=\"nofollow noreferrer\">elastic.co/guide/en/elasticsearch/reference/current/&hellip;</a>   You can even use datastream indices for your case, and it would be better. <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/data-streams.html\" rel=\"nofollow noreferrer\">elastic.co/guide/en/elasticsearch/reference/current/&hellip;</a>"
        },
        {
          "owner": {
            "user_id": 5104202,
            "display_name": "Loc Ann"
          },
          "edited": false,
          "comment_id": 132619089,
          "body": "@musabDogan, thanks for your time. Datastream indices does not look to be well suited for my use case, it&#39;s not time series index. Regarding rollover_alias, why not, still I&#39;d like first to understand what exactly is happening in my case, I see nothing wrong in the solution we built."
        },
        {
          "owner": {
            "user_id": 10685211,
            "display_name": "Musab Dogan"
          },
          "edited": false,
          "comment_id": 132624726,
          "body": "@LocAnn I test it your scenario and it&#39;s working perfectly.  &quot;It happens not 100% of the time&quot; from this sentence, the only possible reason looks like <code>POST _aliases</code> API not returning <code>{&quot;acknowledged&quot;:true}</code> every time you run. Do you have any check and retry mechanism until get <code>{&quot;acknowledged&quot;:true}</code>?  Are you sure the API successfully runs every time you push?"
        },
        {
          "owner": {
            "user_id": 5104202,
            "display_name": "Loc Ann"
          },
          "edited": false,
          "comment_id": 132631940,
          "body": "@MusabDogan, we log the response and I can guarantee to you that we get {&quot;acknowledged&quot;:true} and 200 while no switch is done. But unfortunately it does not always happen, from 3 attemps done to reproduce since yesterday, it never happened. And to answer, yes we introduced a retry mechanism following checking aliases to see if switch really happened as we cannot rely on {&quot;acknowleded&quot;:true} which looks to me like a bug or something I don&#39;t get in ES internal related to potential sync, knowing we have a cluster of 3 nodes all master eligible."
        },
        {
          "owner": {
            "user_id": 10685211,
            "display_name": "Musab Dogan"
          },
          "edited": false,
          "comment_id": 132631974,
          "body": "Maybe you can check the elasticsearch logs to see some clues about it."
        },
        {
          "owner": {
            "user_id": 13763713,
            "display_name": "oliver_t"
          },
          "edited": false,
          "comment_id": 132634593,
          "body": "I tested your scenario in our local cluster and it works perfectly. I was a bit afraid, that the actions might not always be processed in the given order. But this was not the case. I tested it like 20 times and it was always executed as expected. Maybe this is some rare case, but definitely not 2 out of 10."
        },
        {
          "owner": {
            "user_id": 5104202,
            "display_name": "Loc Ann"
          },
          "edited": false,
          "comment_id": 132639928,
          "body": "Thanks @oliver_t for your time. Do you have any idea what would explain this occurence ? Is is worth opening a bug with ticket information ?"
        },
        {
          "owner": {
            "user_id": 10685211,
            "display_name": "Musab Dogan"
          },
          "edited": false,
          "comment_id": 132647337,
          "body": "You need proof to open a bug or solve the case. All you have is experience :). Please check the Elasticsearch logs, find a log about it, and share it with me. If you can share the logs I can review them for you."
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 3218983,
            "display_name": "Prescol"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1674499275,
          "answer_id": 75213687,
          "body": "<p>It appears that there might be an issue with the way you are updating the alias. When you perform a POST request to the _aliases endpoint with the &quot;remove&quot; and &quot;add&quot; actions, Elasticsearch will update the alias based on the current state of the indices at the time the request is executed.</p>\n<p>However, it is possible that there are other processes or actions that are also modifying the indices or aliases at the same time, and this can cause conflicts or inconsistencies. Additionally, when you use the wildcard character (*) in the &quot;index&quot; field of the &quot;remove&quot; action, it will remove the alias from all indices that match the pattern, which may not be the intended behavior.</p>\n<p>To avoid this issue, you could try using the Indices Aliases API instead of the _aliases endpoint. This API allows you to perform atomic updates on aliases, which means that the alias will only be updated if all actions succeed, and will roll back if any of the actions fail. Additionally, instead of using the wildcard character, you can explicitly specify the index that you want to remove the alias from.</p>\n<p>Here is an example of how you could use the Indices Aliases API to update the alias:</p>\n<pre><code>POST /_aliases\n{\n    &quot;actions&quot;: [\n        { &quot;remove&quot;: { &quot;index&quot;: &quot;products-2023-01-12-0900&quot;, &quot;alias&quot;: &quot;current-products&quot; } },\n        { &quot;add&quot;: { &quot;index&quot;: &quot;products-2023-01-12-1520&quot;, &quot;alias&quot;: &quot;current-products&quot; } }\n    ]\n}\n</code></pre>\n<p>This way, the alias will only be removed from the specific index &quot;products-2023-01-12-0900&quot; and added to the specific index &quot;products-2023-01-12-1520&quot;. This can help avoid any conflicts or inconsistencies that may be caused by other processes or actions that are modifying the indices or aliases at the same time.</p>\n<p>Additionally, it is recommended to use a version of elasticsearch that is equal or greater than 8.4.3, as it has many bug fixes that might be the cause of the issue you are facing.</p>\n<p>In conclusion, the issue you are encountering may not be a known bug but it's a regular behavior if multiple processes are modifying the indices or aliases at the same time, and using the Indices Aliases API and specifying the exact index to remove or add the alias can help avoid this issue.</p>\n"
        }
      ],
      "owner": {
        "user_id": 5104202,
        "display_name": "Loc Ann"
      },
      "view_count": 251,
      "up_vote_count": 6,
      "answer_count": 1,
      "score": 6,
      "creation_date": 1673720965,
      "question_id": 75120349,
      "body": "<p>Using elasticsearch 8.4.3 with Java 17 and a cluster of 3 nodes where 3 are master eligible, we start with following situation:</p>\n<ul>\n<li>index <strong>products-2023-01-12-0900</strong> which has an alias <strong>current-products</strong></li>\n</ul>\n<p>We then start a job that creates a new index <strong>products-2023-01-12-1520</strong> and at the end using <a href=\"https://github.com/elastic/elasticsearch/tree/main/client/rest\" rel=\"nofollow noreferrer\">elastic-rest-client</a> on client side and <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-aliases.html\" rel=\"nofollow noreferrer\">alias API</a>, we make this call:</p>\n<p>At 2023-01-12 16:27:26,893:</p>\n<pre><code>POST /_aliases\n{&quot;actions&quot;:[\n   {\n    &quot;remove&quot;: { \n       &quot;alias&quot;:&quot;current-products&quot;,\n       &quot;index&quot;:&quot;products-*&quot;\n    }\n   },\n   { \n    &quot;add&quot;:{\n       &quot;alias&quot;:&quot;current-products&quot;,\n       &quot;index&quot;:&quot;products-2023-01-12-1520&quot;}\n    }\n]}\n</code></pre>\n<p>And we get the following response 26 millis after with HTTP response code 200:</p>\n<pre><code>{&quot;acknowledged&quot;:true}\n</code></pre>\n<p>But looking at what we end up with, we still have old index with <strong>current-products</strong> alias.</p>\n<p>I don't understand why it happens, and it does not happen 100% of the time (it happened 2 times out of around 10 indexations).\nIs it a known bug ? or a regular behaviour ?</p>\n<p>Edit for @warkolm:</p>\n<p>GET /_cat/aliases?v before indexation as of now:</p>\n<pre><code>alias               index                       filter routing.index routing.search is_write_index\ncurrent-products    products-2023-01-13-1510    -      -             -              -\n</code></pre>\n"
    },
    {
      "tags": [
        "java",
        "android",
        "kotlin",
        "rotation",
        "android-custom-view"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 6120487,
            "display_name": "Lev Leontev"
          },
          "edited": false,
          "comment_id": 134125383,
          "body": "When you rotate the view around different pivots, you get different results (obviously). So, when you change the pivot, you have to translate the view to compensate for this. To calculate the exact translation needed, you need to use some math like sines and cosines. Google (or ask ChatGPT) about rotation matrices if you don&#39;t know what that&#39;s about."
        },
        {
          "owner": {
            "user_id": 11949116,
            "display_name": "Abdo21"
          },
          "edited": false,
          "comment_id": 134125521,
          "body": "Thank you, @LevLeontev I know about matrix rotation, but I&#39;m unsure how it can be applied to address my current problem."
        },
        {
          "owner": {
            "user_id": 9871101,
            "display_name": "dinhlam"
          },
          "edited": false,
          "comment_id": 134221896,
          "body": "Your expectation looks like move one point and update its coordinate. I don&#39;t sure why need to use rotation?"
        },
        {
          "owner": {
            "user_id": 6287910,
            "display_name": "Cheticamp"
          },
          "edited": false,
          "comment_id": 134251303,
          "body": "I believe it would be best to work the movements through <a href=\"https://developer.android.com/reference/android/graphics/Matrix\" rel=\"nofollow noreferrer\">Matrix</a> operations. <a href=\"https://stackoverflow.com/q/31234875/6287910\">This</a> question/answer may help."
        },
        {
          "owner": {
            "user_id": 11949116,
            "display_name": "Abdo21"
          },
          "edited": false,
          "comment_id": 134257395,
          "body": "Thanks @Cheticamp! After performing the required calculations using the <code>Matrix</code> class. I cannot find a <code>View::setMatrix()</code> method to apply the new matrix to the view! How can I tell the view to use the new matrix? Additionally, I have also made some updates to the question, which you may want to check out."
        },
        {
          "owner": {
            "user_id": 6287910,
            "display_name": "Cheticamp"
          },
          "edited": false,
          "comment_id": 134259214,
          "body": "There is no <i>setMatrix</i> method. When you rotate/translate/scale you are operating on internal values that are used by the view to draw. <a href=\"https://developer.android.com/reference/android/view/View#getMatrix()\" rel=\"nofollow noreferrer\"><i>View#getMatrix()</i></a> will give you access to this matrix, but you should not need to directly modify it or replace it with one of your own."
        },
        {
          "owner": {
            "user_id": 6287910,
            "display_name": "Cheticamp"
          },
          "edited": false,
          "comment_id": 134259299,
          "body": "<i>ImageViews</i> do, however, have an optional matrix. See <a href=\"https://developer.android.com/reference/android/widget/ImageView#setImageMatrix(android.graphics.Matrix)\" rel=\"nofollow noreferrer\">ImageView#setImageMatrix</a>. If you want your own matrix, you can take a look at how <i>ImageView</i> does it or use an <i>ImageView</i>."
        },
        {
          "owner": {
            "user_id": 6287910,
            "display_name": "Cheticamp"
          },
          "edited": false,
          "comment_id": 134264507,
          "body": "You can also use a matrix with the canvas: See <a href=\"https://developer.android.com/reference/android/graphics/Canvas#setMatrix(android.graphics.Matrix)\" rel=\"nofollow noreferrer\">Canvas#setMatrix</a> although <i>getMatrix()</i> has a caveat for hardware acceleration."
        },
        {
          "owner": {
            "user_id": 11949116,
            "display_name": "Abdo21"
          },
          "edited": false,
          "comment_id": 134286457,
          "body": "Thank you, @Cheticamp! I attempted to add <code>Matrix</code> property into <code>MyView</code> class and then using it inside <code>onDraw</code> by starting with <code>canvas.concat(matrix)</code>. However, I faced some issues. When I attempt to rotate the view, only the view appears to rotate while the viewport remains unaffected, causing the view to become invisible (out of its viewport)."
        },
        {
          "owner": {
            "user_id": 6287910,
            "display_name": "Cheticamp"
          },
          "edited": false,
          "comment_id": 134287185,
          "body": "The matrix will effect all drawing while the matrix operation is applied. It sounds like the code is misapplying or miscalculating the rotation although it is difficult to know from what you say. You may want to consider taking a look at online tutorials about canvas and matrix operations and, maybe, set up a small project to test things out."
        },
        {
          "owner": {
            "user_id": 6287910,
            "display_name": "Cheticamp"
          },
          "edited": false,
          "comment_id": 134291028,
          "body": "I think I see what you mean about &quot;out of its viewport.&quot; This is probably the clipping that occurs when you define the dimensions of your view but then move outside of those dimensions. You can make the boundary of the view larger to hold all possible variations or you can set <code>android:clipChildren=&quot;false&quot;</code> to the view&#39;s parent view group."
        },
        {
          "owner": {
            "user_id": 6287910,
            "display_name": "Cheticamp"
          },
          "edited": false,
          "comment_id": 134292492,
          "body": "You may want to scratch <code>android:clipChildren=&quot;false&quot;</code>. It will look OK, but you will have trouble with touches that appear to be within the view but actually fall outside it and can&#39;t be detected by the view without some machinations. You would have to detect touches in the parent view group which you may not want to do. Just be aware of this potential pitfall."
        }
      ],
      "owner": {
        "user_id": 11949116,
        "display_name": "Abdo21"
      },
      "view_count": 176,
      "up_vote_count": 6,
      "answer_count": 0,
      "score": 6,
      "creation_date": 1681855043,
      "question_id": 76049338,
      "body": "<p>I have a custom view named <code>MyView</code> that has two anchors. I would like to be able to rotate this view from its anchors, with one anchor acting as the center of rotation while the user drags the other anchor.</p>\n<p><strong>For simplicity, I have drawn a line, but in reality, I will be drawing something else</strong>. Here are the steps:</p>\n<ul>\n<li>If the user clicks on the view itself, translate the view.</li>\n<li>If the user clicks on one of its anchors, calculate the rotation angle and make the other anchor the center of rotation by using <code>setPivotX()</code> and <code>setPivotY()</code>.</li>\n</ul>\n<p>Here is the relevant code:</p>\n<pre><code>@Override\n    public boolean onTouchEvent(MotionEvent event) {\n        switch (event.getAction()) {\n            case MotionEvent.ACTION_DOWN: {\n                tapX = event.getX();\n                tapY = event.getY();\n\n                if (anchorRect1.contains(tapX, tapY)) {\n                    viewState = ViewState.ANCHOR1;\n                    setPivotX(anchorRect2.centerX());\n                    setPivotY(anchorRect2.centerY());\n                } else if (anchorRect2.contains(tapX, tapY)) {\n                    viewState = ViewState.ANCHOR2;\n                    setPivotX(anchorRect1.centerX());\n                    setPivotY(anchorRect1.centerY());\n                } else {\n                    viewState = ViewState.VIEW;\n                }\n                break;\n            }\n            case MotionEvent.ACTION_MOVE: {\n                switch (viewState) {\n                    //Anchor 1 clicked\n                    case ANCHOR1: {\n                        float angle = (float) Math.toDegrees(Math.atan2(event.getY() - anchorRect2.centerY(), getWidth()));\n                        setRotation(getRotation() - angle);\n                        break;\n                    }\n                    //Anchor 2 clicked\n                    case ANCHOR2: {\n                        float angle = (float) Math.toDegrees(Math.atan2(event.getY() - anchorRect1.centerY(), getWidth()));\n                        setRotation(getRotation() + angle);\n                        break;\n                    }\n                    //View Clicked\n                    case VIEW: {\n                        float deltaX = event.getX() - tapX;\n                        float deltaY = event.getY() - tapY;\n\n                        // Transform point\n                        PointF transformedPoint = transformPoint(deltaX, deltaY, getRotation());\n\n                        //Perform the rotation\n                        setX(getX() + transformedPoint.x);\n                        setY(getY() + transformedPoint.y);\n                        break;\n                    }\n                }\n                break;\n            }\n            case MotionEvent.ACTION_UP:\n            case MotionEvent.ACTION_CANCEL: {\n                break;\n            }\n        }\n        return true;\n    }\n</code></pre>\n<p>Here is the screenshot of the current output:</p>\n<p><a href=\"https://i.stack.imgur.com/ngzwp.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ngzwp.gif\" alt=\"enter image description here\" /></a></p>\n<p>The issue is that when I rotate the view for the first time, it works correctly, but when I rotate it from the other anchor, it jumps to another position. I believe this is because the rotation doesn't affect the position of the view. To fix this, I need to recalculate the new position of the view so that it moves accordingly, but I'm not sure how to do that.</p>\n<p>This is what I am trying to achieve (created with the GeoGebra tool):</p>\n<p><a href=\"https://i.stack.imgur.com/wUnHs.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wUnHs.gif\" alt=\"enter image description here\" /></a></p>\n<p>Additionally, I believe that this issue is not limited to the Android platform as I have faced a similar problem while implementing <a href=\"https://stackoverflow.com/questions/75944102/how-to-correctly-rotate-a-qgraphicsitem-around-different-anchors-in-qt-c\">this</a> feature using the Qt framework.</p>\n<p>I've invested a significant amount of time in addressing this issue, and any assistance you could provide would be greatly appreciated.</p>\n<p><strong>--------------------Start Edit-----------------------------------</strong></p>\n<p>According to the answer on <a href=\"https://stackoverflow.com/questions/75944102/how-to-correctly-rotate-a-qgraphicsitem-around-different-anchors-in-qt-c\">here</a>, it seems like the issue with the current implementation is that the view isn't saving the previous transformation. Every time the pivot point is updated, all the previous transformations are reset, which causes the view to behave incorrectly.</p>\n<p>To resolve this issue, we need to chain those transformations (one applied after another). In Qt, this can be achieved by saving the transformations in a list, as in this code:</p>\n<pre><code>QList&lt;QGraphicsTransform*&gt; trans;\n\n\nauto angle = qRadiansToDegrees(qAtan2( _anchor2.y() -p.y(), width));\nQGraphicsRotation* rot = new QGraphicsRotation;\nrot-&gt;setOrigin(QVector3D(cp2.x(), cp2.y(), 0));\nrot-&gt;setAxis(Qt::ZAxis);\nrot-&gt;setAngle(angle);\ntrans.push_back(rot);\nsetTransformations(_trans);\n</code></pre>\n<p>Another way to achieve this behavior is to use the <a href=\"https://developer.android.com/reference/android/opengl/Matrix\" rel=\"nofollow noreferrer\">QTransform</a> class directly. In this case, it's important to set the <code>isRelative</code> parameter to true in <code>setTransform()</code> so that the transformations are chained together.</p>\n<pre><code>QTransform t;\nauto angle = qRadiansToDegrees(qAtan2(_anchor2.y() -p.y(), width));\nt.translate(cp2.x(), cp2.y());\nt.rotate(angle);\nt.translate(-cp2.x(), -cp2.y());\nsetTransform(t, true);\n</code></pre>\n<p>In Android, the equivalent of the <a href=\"https://developer.android.com/reference/android/opengl/Matrix\" rel=\"nofollow noreferrer\">QTransform</a> is the <a href=\"https://developer.android.com/reference/android/opengl/Matrix\" rel=\"nofollow noreferrer\">Matrix</a> class. However, unlike QT, the <code>View</code> class in Android does not have a <code>setMatrix()</code> method. This means that when performing transformations, you cannot simply apply the current matrix to the view, which makes it more difficult to work with.</p>\n<p><strong>-------------------End Edit---------------------------------------</strong></p>\n<p>Here is a <a href=\"https://github.com/elhaouzi/RotateViewQuestion\" rel=\"nofollow noreferrer\">repo</a> to reproduce the issue, and below is the complete code:</p>\n<p>MyView.java</p>\n<pre><code>public class MyView extends View {\n\n    enum ViewState {\n        ANCHOR1, ANCHOR2, VIEW\n    }\n\n    public static final int RADIUS = 24; // Anchor radius\n    public static final int OFFSET = 1;\n\n    private final Paint paint;\n\n    public RectF anchorRect1;\n    public RectF anchorRect2;\n\n    private ViewState viewState;\n\n    private float tapX;\n    private float tapY;\n\n\n    public MyView(Context context) {\n        super(context);\n\n        paint = new Paint();\n        paint.setStyle(Paint.Style.STROKE);\n\n        anchorRect1 = new RectF();\n        anchorRect2 = new RectF();\n    }\n\n    @Override\n    protected void onDraw(Canvas canvas) {\n        var width = getWidth();\n        var height = getHeight();\n\n        //Draw line between anchor points\n        canvas.drawLine(\n                anchorRect1.centerX(), anchorRect1.centerY(),\n                anchorRect2.centerX(), anchorRect2.centerY(), paint);\n\n        //Draw anchor circle\n        canvas.drawCircle(anchorRect1.centerX(), anchorRect1.centerY(), RADIUS, paint);\n        canvas.drawCircle(anchorRect2.centerX(), anchorRect2.centerY(), RADIUS, paint);\n\n        //Draw bounding rect\n        canvas.drawRect(OFFSET, OFFSET, width - OFFSET, height - OFFSET, paint);\n    }\n\n    @Override\n    protected void onSizeChanged(int w, int h, int oldw, int oldh) {\n        //Recompute anchors rect\n        anchorRect1.set(\n                OFFSET, h /2f - RADIUS + OFFSET,\n                2*RADIUS, h /2f + RADIUS - OFFSET\n        );\n\n        anchorRect2.set(\n                w - 2*RADIUS, h /2f - RADIUS + OFFSET,\n                w - OFFSET, h /2f + RADIUS - OFFSET\n        );\n    }\n\n    @Override\n    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {\n\n        // Measure exactly\n        int width = MeasureSpec.getSize(widthMeasureSpec);\n        int height = MeasureSpec.getSize(heightMeasureSpec);\n\n        setMeasuredDimension(width, height);\n    }\n\n    @Override\n    public boolean onTouchEvent(MotionEvent event) {\n        switch (event.getAction()) {\n            case MotionEvent.ACTION_DOWN: {\n                tapX = event.getX();\n                tapY = event.getY();\n\n                // Anchor 1 clicked\n                if (anchorRect1.contains(tapX, tapY)) {\n                    viewState = ViewState.ANCHOR1;\n                    setPivotX(anchorRect2.centerX());\n                    setPivotY(anchorRect2.centerY());\n                }\n                // Anchor 2 clicked\n                else if (anchorRect2.contains(tapX, tapY)) {\n                    viewState = ViewState.ANCHOR2;\n                    setPivotX(anchorRect1.centerX());\n                    setPivotY(anchorRect1.centerY());\n                }\n                // View body clicked\n                else {\n                    viewState = ViewState.VIEW;\n                }\n                break;\n            }\n            case MotionEvent.ACTION_MOVE: {\n                switch (viewState) {\n                    //Anchor 1 clicked\n                    case ANCHOR1: {\n                        float angle = (float) Math.toDegrees(Math.atan2(event.getY() - anchorRect2.centerY(), getWidth()));\n                        setRotation(getRotation() - angle);\n                        break;\n                    }\n                    //Anchor 2 clicked\n                    case ANCHOR2: {\n                        float angle = (float) Math.toDegrees(Math.atan2(event.getY() - anchorRect1.centerY(), getWidth()));\n                        setRotation(getRotation() + angle);\n                        break;\n                    }\n                    //View Clicked\n                    case VIEW: {\n                        float deltaX = event.getX() - tapX;\n                        float deltaY = event.getY() - tapY;\n\n                        // Transform point\n                        PointF transformedPoint = transformPoint(deltaX, deltaY, getRotation());\n\n                        //Perform the rotation\n                        setX(getX() + transformedPoint.x);\n                        setY(getY() + transformedPoint.y);\n                        break;\n                    }\n                }\n                break;\n            }\n            case MotionEvent.ACTION_UP:\n            case MotionEvent.ACTION_CANCEL: {\n                break;\n            }\n        }\n        return true;\n    }\n\n    private PointF transformPoint(float x, float y, float degree) {\n        //https://en.wikipedia.org/wiki/Rotation_matrix\n        double radian = Math.toRadians(degree);\n        float xp = (float) (x*Math.cos(radian) - y*Math.sin(radian));\n        float yp = (float) (x*Math.sin(radian) + y*Math.cos(radian));\n        return new PointF(xp, yp);\n    }\n}\n</code></pre>\n<p>FixedPosLayout.java</p>\n<pre><code>public class FixedPosLayout extends ViewGroup {\n\n    public FixedPosLayout(Context context) {\n        super(context);\n    }\n\n    public FixedPosLayout(Context context, AttributeSet attrs) {\n        super(context, attrs);\n    }\n\n    public FixedPosLayout(Context context, AttributeSet attrs, int defStyleAttr) {\n        super(context, attrs, defStyleAttr);\n    }\n\n    @Override\n    protected void onLayout(boolean changed, int l, int t, int r, int b) {\n        int count = getChildCount();\n\n        for (int i = 0; i&lt;count; ++i) {\n            View child = getChildAt(i);\n\n            FixedPosLayout.LayoutParams params =\n                    (FixedPosLayout.LayoutParams) child.getLayoutParams();\n\n            int left = params.x;\n            int top = params.y;\n\n            child.layout(left, top,\n                    left + child.getMeasuredWidth(),\n                    top + child.getMeasuredHeight());\n        }\n    }\n\n    @Override\n    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {\n        // Measure this view\n        super.onMeasure(widthMeasureSpec, heightMeasureSpec);\n\n        // Measure children\n        int count = getChildCount();\n        for (int i = 0; i&lt;count; ++i) {\n            View child = getChildAt(i);\n\n            FixedPosLayout.LayoutParams lp =\n                    (FixedPosLayout.LayoutParams) child.getLayoutParams();\n\n            int childWidthMeasureSpec =\n                    MeasureSpec.makeMeasureSpec(lp.width, MeasureSpec.EXACTLY);\n\n            int childHeightMeasureSpec =\n                    MeasureSpec.makeMeasureSpec(lp.height, MeasureSpec.EXACTLY);\n\n            child.measure(childWidthMeasureSpec, childHeightMeasureSpec);\n        }\n    }\n\n    public static class LayoutParams extends ViewGroup.LayoutParams {\n        public int x;\n        public int y;\n\n        public LayoutParams(int width, int height, int x, int y) {\n            super(width, height);\n            this.x = x;\n            this.y = y;\n        }\n    }\n}\n</code></pre>\n<p>MainActivity.java</p>\n<pre><code>public class MainActivity extends AppCompatActivity {\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_main);\n\n        FixedPosLayout fixedPosLayout = findViewById(R.id.fixedPosLayout);\n\n        MyView myView = new MyView(this);\n\n        FixedPosLayout.LayoutParams params = new FixedPosLayout.LayoutParams(300, 80, 200, 400);\n        fixedPosLayout.addView(myView, params);\n    }\n}\n</code></pre>\n<p>main_activity.xml</p>\n<pre><code>&lt;com.abdo.rotateviewquestion.FixedPosLayout \n    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\n    xmlns:tools=&quot;http://schemas.android.com/tools&quot;\n    android:layout_width=&quot;match_parent&quot;\n    android:layout_height=&quot;match_parent&quot;\n    android:id=&quot;@+id/fixedPosLayout&quot;\n    tools:context=&quot;.MainActivity&quot;/&gt;\n</code></pre>\n"
    },
    {
      "tags": [
        "java",
        "android",
        "java-native-interface",
        "android-runonuithread"
      ],
      "answers": [
        {
          "owner": {
            "user_id": 16057905,
            "display_name": "Byte Code"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1678694943,
          "answer_id": 75719339,
          "body": "<p>Try putting some delay beetween requestFocus and showKeyboard functions. I had the same problem before and it worked for me.</p>\n"
        }
      ],
      "owner": {
        "user_id": 21238708,
        "display_name": "Jatin guglani"
      },
      "view_count": 68,
      "up_vote_count": 6,
      "answer_count": 1,
      "score": 6,
      "creation_date": 1678436471,
      "question_id": 75693705,
      "body": "<p>In my android application, the core logic is written in C++. Hence, for multiple scenarios, there will be JNI calls happening.</p>\n<p>In one use-case, as the text is being entered by the user in the 'EditText', I call a JNI method which will capitalize each word (the logic and hence the outcome can vary from case to case).</p>\n<p>The TextChange handler calls a JNI function which will capitalize each word in the text in a worker thread and then invoke a method on the main thread using 'runOnUIThread' to update the text field's value. My expectation is this should happen seamlessly and should not hamper the way the user is interacting.</p>\n<p>Code Samples:</p>\n<p>Calling of the JNI function-</p>\n<pre><code>edittext.addTextChangedListener(new TextWatcher() {\n\n            @Override\n            public void onTextChanged(CharSequence s, int start, int before, int count) {\n                \n                OnTextChanged (edittext.getId(), String.valueOf(s));\n            }\n            ...\n     });\n</code></pre>\n<p>Updating the EditText with the capitalized text-</p>\n<pre><code>// Below function is invoked on the Main Thread once the Worker Thread is done with its job of capitalizing\n// An entry function is called which gets the textfield object from the layout and then called the below\npublic static void UpdateTextField(EditText pEditTextObj, int pID, int pPosX, int pPosY, int pHeight, int pWidth, int pColor, String pText)\n{\n        Log.d(&quot;SampleJNIApp01&quot;, &quot;TextField valued to be updated = &quot; + pText);\n        \n        pEditTextObj.setText(pText);\n\n        //requesting focus\n        pEditTextObj.requestFocus();\n        pEditTextObj.setSelection(pEditTextObj.getText().length());\n\n        //showing keyboard\n        InputMethodManager imm = (InputMethodManager) MainActivity.GetCurrentActivity().getSystemService(Context.INPUT_METHOD_SERVICE);\n        imm.showSoftInput(pEditTextObj, InputMethodManager.SHOW_IMPLICIT);\n         \n}\n</code></pre>\n<p>Observation:</p>\n<p>Once the first letter is typed in, it does get capitalized by the JNI function and the text in the EditText is also updated.</p>\n<p>However, after the pEditTextObj.setText(pText), the focus goes away, cursor is not visible and the keyboard gets hidden.</p>\n<p>Same is observed when I am typing in the text field and some worker thread has invoked some java method to 'runOnUIthread' - the focus is lost and soft keyboard gets hidden.</p>\n<p>The returned value of pEditTextObj.requestFocus() is true, still it is not getting focussed.</p>\n<p>I have also checked that pEditTextObj.isFocusable() returns true and MainActivity.this.getCurrentFocus() is returning the same edittext. but on the emulator screen the edittext is not getting focused neither the keyboard is poping up.</p>\n<p>Is there something wrong that I am doing ?</p>\n"
    },
    {
      "tags": [
        "java",
        "prometheus",
        "monitoring",
        "jmx"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 13510562,
            "display_name": "rmunge"
          },
          "edited": false,
          "comment_id": 132959313,
          "body": "@Guli13 what do you refer with &quot;Java HeapSpace exceptions&quot;? java.lang.OutOfMemoryError?"
        },
        {
          "owner": {
            "user_id": 5763327,
            "display_name": "Setop"
          },
          "edited": false,
          "comment_id": 132966889,
          "body": "Which JVM, which version ? Which OS ? Which Payara version ?"
        },
        {
          "owner": {
            "user_id": 389405,
            "display_name": "Gui13"
          },
          "edited": false,
          "comment_id": 132979789,
          "body": "We are using Java 8 (the last one, through Temurin) and Payara 4.174. What I want is to have metrics about the number of java.lang.OutOfMemoryError indeed! I can&#39;t install a &quot;global try catch&quot; on this, since it is managed by Payara. I&#39;m wondering how to do that."
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 10751633,
            "display_name": "bosowski"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1675820371,
          "answer_id": 75380619,
          "body": "<p>Since you are already using Prometheus to monitor your application, you could use the <a href=\"https://github.com/google/mtail\" rel=\"nofollow noreferrer\">mtail exporter</a> to count your exceptions from the logs and expose the metrics for Prometheus to scrape.</p>\n<blockquote>\n<p>mtail is a tool for extracting metrics from application logs to be exported into a timeseries database or timeseries calculator for alerting and dashboarding.\nIt fills a monitoring niche by being the glue between applications that do not export their own internal state (other than via logs) and existing monitoring systems, such that system operators do not need to patch those applications to instrument them or writing custom extraction code for every such application.</p>\n</blockquote>\n"
        }
      ],
      "owner": {
        "user_id": 389405,
        "display_name": "Gui13"
      },
      "view_count": 257,
      "up_vote_count": 6,
      "answer_count": 1,
      "score": 6,
      "creation_date": 1672831025,
      "question_id": 75004642,
      "body": "<p>We are using an old version of Payara, and exporting JVM metrics with the Prometheus JVM GC Exporter and Memory exporters.</p>\n<p>In these exporters, we don't have access to the number of Java HeapSpace exceptions, which is an indicator of a inadequate value of the XMX.</p>\n<p>I have a dashboard where I survey the memory status of our Java apps, and here is a typical example of a &quot;memory starved&quot; app:\n<a href=\"https://i.stack.imgur.com/828fg.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/828fg.png\" alt=\"enter image description here\" /></a></p>\n<p>I could use the GC average duration, but I'd rather have a &quot;hard fact&quot; counter of the number of Java Heapspace exceptions, which is the real indicator of a lack of memory. Since we are operating in a Java App server, we don't have a main() to intercept all Java HeapSpace exceptions (and we won't be able to be sure that it wasn't intercepted below so the counter might be faulty anyway).</p>\n<p>Do you guys have had the same issues, and found a way to measure this problem? I explored the JMX tree but didn't find conclusive metrics.</p>\n"
    },
    {
      "tags": [
        "java",
        "android",
        "typescript",
        "react-native",
        "react-native-turbomodule"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 13942448,
            "display_name": "jccampanero"
          },
          "edited": false,
          "comment_id": 132618586,
          "body": "I am sorry because I am not fluent with react native and my skills in Android programming are now rusty, so take my words with caution: the error could be related with some kind of misconfiguration. It has been reported in different related contexts in several places like in <a href=\"https://medium.com/react-native-zone/english-bundling-failed-error-while-resolving-module-react-native-vector-icons-fontawesome-3958d7fa15ad\" rel=\"nofollow noreferrer\">this article</a>.  Please, consider review the <a href=\"https://github.com/oblador/react-native-vector-icons/issues/626#issuecomment-357405396\" rel=\"nofollow noreferrer\">linked Github issue</a> as well. I hope it helps."
        },
        {
          "owner": {
            "user_id": 9552485,
            "display_name": "BraveEvidence"
          },
          "edited": false,
          "comment_id": 132622315,
          "body": "@jccampanero I did check few of these kind of issues but they are for the old architecture of react native"
        },
        {
          "owner": {
            "user_id": 13942448,
            "display_name": "jccampanero"
          },
          "edited": false,
          "comment_id": 132660952,
          "body": "I am sorry to hear that @Pritish. Please, forgive me, as I told, I am not used to using react native and the current Android libraries nowadays. I hope somebody shed some light into the issue."
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 9552485,
            "display_name": "BraveEvidence"
          },
          "up_vote_count": 0,
          "is_accepted": true,
          "creation_date": 1674539629,
          "answer_id": 75217868,
          "body": "<p>This is a react native issue introduced in 0.70 and was resolved in 0.71. Check <a href=\"https://github.com/facebook/react-native/issues/35832\" rel=\"nofollow noreferrer\">here</a> for more details</p>\n"
        }
      ],
      "owner": {
        "user_id": 9552485,
        "display_name": "BraveEvidence"
      },
      "view_count": 448,
      "up_vote_count": 6,
      "accepted_answer_id": 75217868,
      "answer_count": 1,
      "score": 6,
      "creation_date": 1673699936,
      "question_id": 75117982,
      "body": "<p>I am trying the new arch of react native. I have enabled it in my <code>gradle.properties</code> file. This error is for android only and I have not tried iOS yet.</p>\n<p>I am following the exact sample of Calculator mentioned over <a href=\"https://reactnative.dev/docs/next/the-new-architecture/pillars-turbomodules\" rel=\"noreferrer\">here</a>.</p>\n<p>I get an error saying</p>\n<pre><code>error: Error: While resolving module `rtn-calculator/js/NativeCalculator.js`, the Haste package `rtn-calculator` was found. However the module `js/NativeCalculator.js` could not be found within the package. Indeed, none of these files exist:\n\n  * `/Users/transformhub/Desktop/rnapp/RTNCalculator/js/NativeCalculator.js(.native|.android.js|.native.js|.js|.android.jsx|.native.jsx|.jsx|.android.json|.native.json|.json|.android.ts|.native.ts|.ts|.android.tsx|.native.tsx|.tsx)`\n  * `/Users/transformhub/Desktop/rnapp/RTNCalculator/js/NativeCalculator.js/index(.native|.android.js|.native.js|.js|.android.jsx|.native.jsx|.jsx|.android.json|.native.json|.json|.android.ts|.native.ts|.ts|.android.tsx|.native.tsx|.tsx)`\n    at resolveHasteName (/Users/transformhub/Desktop/rnapp/node_modules/metro-resolver/src/resolve.js:173:9)\n    at Object.resolve (/Users/transformhub/Desktop/rnapp/node_modules/metro-resolver/src/resolve.js:63:20)\n    at ModuleResolver.resolveDependency (/Users/transformhub/Desktop/rnapp/node_modules/metro/src/node-haste/DependencyGraph/ModuleResolution.js:111:31)\n    at DependencyGraph.resolveDependency (/Users/transformhub/Desktop/rnapp/node_modules/metro/src/node-haste/DependencyGraph.js:260:43)\n    at Object.resolve (/Users/transformhub/Desktop/rnapp/node_modules/metro/src/lib/transformHelpers.js:177:21)\n    at Graph._resolveDependencies (/Users/transformhub/Desktop/rnapp/node_modules/metro/src/DeltaBundler/Graph.js:432:35)\n    at Graph._processModule (/Users/transformhub/Desktop/rnapp/node_modules/metro/src/DeltaBundler/Graph.js:218:38)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async Graph._addDependency (/Users/transformhub/Desktop/rnapp/node_modules/metro/src/DeltaBundler/Graph.js:314:20)\n    at async Promise.all (index 2)\n</code></pre>\n<p>The complete repo is <a href=\"https://github.com/PritishSawant/RnMyAppNewArch\" rel=\"noreferrer\">here</a></p>\n<p>Below is sample code</p>\n<pre><code>NativeCalculator.ts\n\nimport type {TurboModule} from 'react-native/Libraries/TurboModule/RCTExport';\nimport {TurboModuleRegistry} from 'react-native';\n\nexport interface Spec extends TurboModule {\n  add(a: number, b: number): Promise&lt;number&gt;;\n}\n\nexport default TurboModuleRegistry.get&lt;Spec&gt;('RTNCalculator') as Spec | null;\n\n\npackage com.rtncalculator;\n\nimport androidx.annotation.Nullable;\nimport com.facebook.react.bridge.NativeModule;\nimport com.facebook.react.bridge.ReactApplicationContext;\nimport com.facebook.react.module.model.ReactModuleInfo;\nimport com.facebook.react.module.model.ReactModuleInfoProvider;\nimport com.facebook.react.TurboReactPackage;\n\nimport java.util.Collections;\nimport java.util.List;\nimport java.util.HashMap;\nimport java.util.Map;\n\npublic class CalculatorPackage extends TurboReactPackage {\n\n  @Nullable\n  @Override\n  public NativeModule getModule(String name, ReactApplicationContext reactContext) {\n      if (name.equals(CalculatorModule.NAME)) {\n          return new CalculatorModule(reactContext);\n      } else {\n          return null;\n      }\n  }\n\n\n  @Override\n  public ReactModuleInfoProvider getReactModuleInfoProvider() {\n      return () -&gt; {\n          final Map&lt;String, ReactModuleInfo&gt; moduleInfos = new HashMap&lt;&gt;();\n          moduleInfos.put(\n                  CalculatorModule.NAME,\n                  new ReactModuleInfo(\n                          CalculatorModule.NAME,\n                          CalculatorModule.NAME,\n                          false, // canOverrideExistingModule\n                          false, // needsEagerInit\n                          true, // hasConstants\n                          false, // isCxxModule\n                          true // isTurboModule\n          ));\n          return moduleInfos;\n      };\n  }\n}\n\npackage com.rtncalculator;\n\nimport androidx.annotation.NonNull;\nimport com.facebook.react.bridge.NativeModule;\nimport com.facebook.react.bridge.Promise;\nimport com.facebook.react.bridge.ReactApplicationContext;\nimport com.facebook.react.bridge.ReactContext;\nimport com.facebook.react.bridge.ReactContextBaseJavaModule;\nimport com.facebook.react.bridge.ReactMethod;\nimport java.util.Map;\nimport java.util.HashMap;\nimport com.rtncalculator.NativeCalculatorSpec;\n\npublic class CalculatorModule extends NativeCalculatorSpec {\n\n    public static String NAME = &quot;RTNCalculator&quot;;\n\n    CalculatorModule(ReactApplicationContext context) {\n        super(context);\n    }\n\n    @Override\n    @NonNull\n    public String getName() {\n        return NAME;\n    }\n\n    @Override\n    public void add(double a, double b, Promise promise) {\n        promise.resolve(a + b);\n    }\n}\n</code></pre>\n"
    },
    {
      "tags": [
        "java",
        "tdd",
        "class-visibility"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 869736,
            "display_name": "Louis Wasserman"
          },
          "edited": false,
          "comment_id": 134126710,
          "body": "&quot;I dont want to modify the visibility of this constant just for the tests to avoid this posible modification in the future.&quot; Sorry, but you&#39;re going to have to."
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 17795888,
            "display_name": "Chaosfire"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1681840627,
          "answer_id": 76047727,
          "body": "<p>Changing visibility to package-private for tests should be fine. Still, it can be used in the same package, if some other developer is not aware he shouldn't do it. This can break stuff, if you change the value later on.</p>\n<p>Better approach would be to use some abstraction to get this value, instead of using it directly. For example:</p>\n<pre><code>public class MyClass {\n\n  private static final String SOME_VALUE = &quot;value&quot;;\n\n  private final Supplier&lt;String&gt; valueSupplier;\n\n  public MyClass(Supplier&lt;String&gt; valueSupplier) {\n    //new constructor\n    this.valueSupplier = valueSupplier;\n  }\n\n  public MyClass() {\n    //previous constructor\n    //provides the default supplier with the constant\n    this(() -&gt; SOME_VALUE);\n  }\n\n  public String doStuff(String stringValue) {\n    //method to test\n    return this.valueSupplier.get() + &quot;_&quot; + stringValue;\n  }\n}\n</code></pre>\n<p>Now you can mock <code>valueSupplier</code> in your unit tests. This allows you to change <code>SOME_VALUE</code> however you like, without breaking existing tests, while still keeping it private.</p>\n"
        },
        {
          "owner": {
            "user_id": 126014,
            "display_name": "Mark Seemann"
          },
          "up_vote_count": 18,
          "is_accepted": false,
          "creation_date": 1681887547,
          "answer_id": 76051557,
          "body": "<p>Since this question is tagged <a href=\"https://stackoverflow.com/questions/tagged/tdd\">tdd</a>, I'm going to pretend that the OP didn't include</p>\n<blockquote>\n<p>when I want to make the test for this class</p>\n</blockquote>\n<p>After all, TDD means <em>test-driven development</em>; i.e. write the test <em>before</em> the implementation.</p>\n<p>Additionally, since this issue is a problem in several programming languages, and not just Java, I'm going to respond with some C# code. I'm sure you'll be able to follow it.</p>\n<p>The short answer, however, is that it depends on whether or not that constant is part of the specification of the System Under Test (SUT).</p>\n<p>Imagine, as an illustrative example, that you have to TDD a little <em>Hello World</em> API.</p>\n<p>You might write a few test cases like this:</p>\n<pre><code>[Theory]\n[InlineData(&quot;Mary&quot;)]\n[InlineData(&quot;Sue&quot;)]\npublic void ExactEnglishSpec(string name)\n{\n    var sut = new Greeter();\n\n    var actual = sut.Greet(name);\n\n    Assert.StartsWith(&quot;Hello, &quot;, actual);\n    Assert.EndsWith(name + &quot;.&quot;, actual);\n}\n</code></pre>\n<p>This might drive an implementation like this:</p>\n<pre><code>public sealed class Greeter\n{\n    private const string englishTemplate = &quot;Hello, {0}.&quot;;\n\n    public string Greet(string name)\n    {\n        return string.Format(englishTemplate, name);\n    }\n}\n</code></pre>\n<p>As in the OP, this implementation contains a <code>private const string</code>. What happens if that <code>englishTemplate</code> changes?</p>\n<p>Obviously, the tests fail.</p>\n<p>As they should, since you wrote them that way.</p>\n<p>Tests specify the behaviour of the software, and if they assert that a string should be exactly a particular value, then that is part of the specification, and it's a breaking change if it changes.</p>\n<p>This may or may not be what you want.</p>\n<p>It depends on what you're doing. If you're implementing a formal specification that demands that exact template string, then that <em>should</em> be part of the contract, and it <em>should</em> be a breaking change if someone changes the template. This would also be true if it's part of an API where you've agreed with callers that the string will always be based on that template.</p>\n<p>On the other hand, this may not be what you want. If you're implementing an (object-oriented) API that encapsulates behaviour, and you expect that the template might change in the future, write a more robust test:</p>\n<pre><code>[Theory]\n[InlineData(&quot;Rose&quot;)]\n[InlineData(&quot;Mary&quot;)]\npublic void RobustEnglishBehaviour(string name)\n{\n    var sut = new Greeter();\n\n    var actual = sut.Greet(name);\n\n    Assert.Contains(name, actual);\n    Assert.NotEqual(name, actual);\n}\n</code></pre>\n<p>The first assertion here verifies that the <code>name</code> is to be found somewhere in <code>actual</code>. The second assertion prevents the implementation from simply echoing back the name.</p>\n<p>Now, if you change the template, this robust test still passes, while the first example would break.</p>\n<p>By now, I'm sure you're asking: <em>But how can I verify that the return value isn't just some nonsense?</em></p>\n<p>In a sense, you can't, because you've made the decision that the actual value is no longer part of the contract. Imagine that, instead of an English greeting, you're asked to internationalise the API. Will you, as the developer, be able to verify that greetings in Romanian, Chinese, Thai, Korean, etc. are correct?</p>\n<p>Probably not. Those strings are going to be opaque to you, hopefully instead supplied by professional translators.</p>\n<p>How do you test against something like that?</p>\n<p>Naively, one might attempt something like this:</p>\n<pre><code>[Theory]\n[InlineData(&quot;Hans&quot;)]\n[InlineData(&quot;Christian&quot;)]\npublic void ExactDanishSpec(string name)\n{\n    var sut = new Greeter();\n    sut.Culture = &quot;da-DK&quot;;\n\n    var actual = sut.Greet(name);\n\n    Assert.StartsWith(&quot;Hej &quot;, actual);\n    Assert.EndsWith(name + &quot;.&quot;, actual);\n}\n</code></pre>\n<p>This might drive an implementation like this:</p>\n<pre><code>public sealed class Greeter\n{\n    private const string englishTemplate = &quot;Hello, {0}.&quot;;\n    private const string danishTemplate = &quot;Hej {0}.&quot;;\n\n    public string? Culture { get; set; }\n\n    public string Greet(string name)\n    {\n        if (Culture == &quot;da-DK&quot;)\n            return string.Format(danishTemplate, name);\n        else\n            return string.Format(englishTemplate, name);\n    }\n}\n</code></pre>\n<p>Again, this is <em>an exact specification.</em> I'll remind you that this example is just a placeholder for a 'real' problem. If the exact string is part of the specification, then writing the test as shown above seems appropriate, but that also means that if you change the strings, the tests will break. And that's by design.</p>\n<p>If you instead want to write a more robust test, you might do something like this:</p>\n<pre><code>[Theory]\n[InlineData(&quot;Charlotte&quot;)]\n[InlineData(&quot;Martin&quot;)]\npublic void EnglishIsDifferentFromDanish(string name)\n{\n    var sut = new Greeter();\n    var unexpected = sut.Greet(name);\n    sut.Culture = &quot;da-DK&quot;;\n\n    var actual = sut.Greet(name);\n\n    Assert.Contains(name, actual);\n    Assert.NotEqual(name, actual);\n    Assert.NotEqual(unexpected, actual);\n}\n</code></pre>\n<p>These assertions again verify that the name is included in the response, and not just echoed back. Furthermore, the test asserts that the Danish greeting isn't the same as the English greeting.</p>\n<p>This test is <em>more</em> robust than the exact specification, but isn't absolutely guaranteed never to fail. If, in the future, translators decide that the English greeting and the Danish greeting should use effectively equal templates, the test would fail.</p>\n<p>Coming back to the OP. How about exposing the templates as public constants?</p>\n<p>Sure, you could do that if the exact value is <em>not</em> part of the specification:</p>\n<pre><code>public const string EnglishTemplate = &quot;Hello, {0}.&quot;;\npublic const string DanishTemplate = &quot;Hej {0}.&quot;;\n</code></pre>\n<p>This would enable you to write a test like this:</p>\n<pre><code>[Theory]\n[InlineData(&quot;Thelma&quot;)]\n[InlineData(&quot;Louise&quot;)]\npublic void UseEnglishTemplate(string name)\n{\n    var sut = new Greeter();\n    var actual = sut.Greet(name);\n    Assert.Equal(string.Format(Greeter.EnglishTemplate, name), actual);\n}\n</code></pre>\n<p>Does that, however, provide any value? It essentially just repeats the implementation code.</p>\n<p>Don't repeat yourself.</p>\n<p>Still, just to drive home the point: Such a test would be robust to changes of the template strings. The test would pass even if you edit the string. Is that appropriate?</p>\n<p>That depends on whether or not the exact string value is part of the public contract for the SUT.</p>\n<p>This line of reasoning applies not only to strings, but also to constant numbers.</p>\n<p>If the constant is part of the contract, write your tests in such a way that they fail if the constant changes. If the constant is an implementation detail, write robust tests that pass when the value changes.</p>\n"
        }
      ],
      "owner": {
        "user_id": 3254515,
        "display_name": "fernando1979"
      },
      "view_count": 471,
      "up_vote_count": 6,
      "answer_count": 2,
      "score": 5,
      "creation_date": 1681837354,
      "question_id": 76047269,
      "body": "<p>Having a private String constant in a java class that is used in some methods, when I want to make the test for this class, I will have to hardcode the string constant in the test because its private in the class. But if in the future the string constant is modified in the class,  I will have to modify in the test class too. I dont want to modify the visibility of this constant just for the tests to avoid this possible modification in the future. Is this thinking correct according to the TDD methodology?.</p>\n<p>Thanks.</p>\n"
    },
    {
      "tags": [
        "java",
        "maven"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 296328,
            "display_name": "khmarbaise"
          },
          "edited": false,
          "comment_id": 133157821,
          "body": "Create an newline between the <code>--settings</code> and the parameter.."
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 891624,
            "display_name": "mxcd"
          },
          "up_vote_count": 10,
          "is_accepted": true,
          "creation_date": 1676538261,
          "answer_id": 75469911,
          "body": "<p>With the introduction of <code>maven 3.9</code>, there was a BREAKING CHANGE that affects the parsing of the <code>maven.config</code> file:<br />\n<a href=\"https://maven.apache.org/docs/3.9.0/release-notes.html#potentially-breaking-core-changes\" rel=\"noreferrer\">https://maven.apache.org/docs/3.9.0/release-notes.html#potentially-breaking-core-changes</a></p>\n<blockquote>\n<p>Each line in <code>.mvn/maven.config</code> is now interpreted as a single argument. That is, if the file contains multiple arguments, these must now be placed on separate lines, see <a href=\"https://issues.apache.org/jira/browse/MNG-7684\" rel=\"noreferrer\">MNG-7684</a>.</p>\n</blockquote>\n<p>As pointed out by @khmarbaise in the comments, adding a newline in the <code>maven.config</code> works just fine and is even downwards compatible.</p>\n<pre><code>--settings\n./.mvn/local-settings.xml\n</code></pre>\n<p><strong>IMPORTANT NOTE:</strong> There must not be a whitespace after <code>--settings</code></p>\n"
        },
        {
          "owner": {
            "user_id": 6080893,
            "display_name": "Rahul"
          },
          "up_vote_count": 3,
          "is_accepted": false,
          "creation_date": 1679280376,
          "answer_id": 75786207,
          "body": "<p>Also noticed that <code>-s./.mvn/settings.xml</code> works too without any space</p>\n"
        }
      ],
      "owner": {
        "user_id": 891624,
        "display_name": "mxcd"
      },
      "view_count": 1225,
      "up_vote_count": 5,
      "accepted_answer_id": 75469911,
      "answer_count": 2,
      "score": 5,
      "creation_date": 1676536320,
      "question_id": 75469591,
      "body": "<p>In my Java projects building with maven, I have a a <code>.mvn</code> directory that contains a <code>maven.config</code> file. Content of that file is as follows:</p>\n<pre><code>--settings ./.mvn/local-settings.xml\n</code></pre>\n<p>The <code>local-settings.xml</code> holds authentication credentials for pulling from a private registry.<br />\nThis setup worked fine up until yesterday. Now, the CI build (using <code>maven:3-amazoncorretto-17</code>) is failing with the following error message:</p>\n<pre><code>Unable to parse maven.config file options: Unrecognized option: --settings ./.mvn/local-settings.xml\n</code></pre>\n<p>Has there been a breaking change in the <code>maven</code> image I am using for building?</p>\n"
    },
    {
      "tags": [
        "java",
        "java-17"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 5133585,
            "display_name": "Sweeper"
          },
          "edited": false,
          "comment_id": 132825433,
          "body": "&quot;how would a sealed class know beforehand which classes it should permit for extension?&quot; The whole point of this is that sealed classes <i>do not</i> permit external extension, so that client code knows that variables of a sealed class can only contain instances of a fixed set of classes."
        },
        {
          "owner": {
            "user_id": 2711488,
            "display_name": "Holger"
          },
          "edited": false,
          "comment_id": 132843347,
          "body": "The permitted classes must be in the same package or module, so there are no permitted classes outside the hypothetical library."
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 2288659,
            "display_name": "Silvio Mayolo"
          },
          "up_vote_count": 13,
          "is_accepted": true,
          "creation_date": 1674972088,
          "answer_id": 75272899,
          "body": "<p><code>sealed</code> classes provide the opposite guarantee to open classes (the default in Java). An open class says to implementors &quot;Hey, you can subclass me and override my non-<code>final</code> methods&quot;, but it says to <em>users</em> &quot;I have no idea what subclasses look like, so you can only use my own methods directly&quot;. On the flipside, <code>sealed</code> classes are very restrictive to implementors &quot;You cannot subclass me, and you can only use me in these prescribed ways&quot;, but very powerful to users: &quot;I know in advance all of my subclasses, so you know that if you have an instance of me, then it must be one of X, Y, or Z&quot;. Consequently, adding a subclass to a <code>sealed</code> class is a breaking change.</p>\n<p>It may be helpful to think of <code>sealed</code> classes less as &quot;restricted classes&quot; and more as &quot;enums with superpowers&quot;. An <code>enum</code> in Java is a finite set of data values, all constructed in advance. A <code>sealed class</code> is a finite set of <em>classes</em> that you set forth, but those classes may have an infinite number of possible instances.</p>\n<p>Here's a real-world example that I wrote myself recently. This was in Kotlin, which also has <code>sealed</code> classes, but it's the same idea. I was writing a wrapper for some Minecraft code and I needed a class that could uniformly represent all of the ways you can die in Minecraft. Long story short, I ended up partitioning the death reasons into &quot;killed by another living thing&quot; and &quot;all other death reasons&quot;. So I wrote a sealed interface <code>CauseOfDeath</code>. Its two implementors were <code>VanillaDeath</code> (which took a &quot;cause of damage&quot; as its constructor argument, basically an enum listing all of the possible causes) and <code>VanillaMobDeath</code> (which took the specific entity that killed you as its constructor argument).</p>\n<p>Since this was clearly exhaustive, I made it <code>sealed</code>. If Minecraft later adds more death reasons, they will fit into one of the two categories (&quot;death by entity&quot; or &quot;death by other causes&quot;), so it makes no sense for me or anyone else to ever subclass this interface again.</p>\n<p>Further, since I'm providing very strong guarantees about the type of death reason, it's reasonable for users to discriminate based on type. Downcasting in Java has always been a bit of a code smell, on the basis that it can't possibly know every possible subclass of a class. The logic is &quot;okay, you've handled cases X and Y, but what if someone comes along and writes class Z that you've never heard of&quot;. But that can't happen here. The class is sealed, so it's perfectly reasonable for someone to write a sort of pseudo-visitor that does one thing for &quot;death by entity&quot; and another for &quot;death by other&quot;, since Java (or Kotlin, in my case) can be fully confident that there are not, and never will be, any other possibilities.</p>\n<p>This makes more sense as well if you've used algebraic data types in Haskell or OCaml. The <code>sealed</code> keyword originated in Scala as a way to encode ADTs, and they're exactly what I just described: a type defined as the (tagged) union of a finite number of possible collections of data. And in Haskell and OCaml, it's entirely normal to discriminate on ADTs as well using <code>match</code> (or <code>case</code>) expressions.</p>\n"
        }
      ],
      "owner": {
        "user_id": 11729079,
        "display_name": "bakarJc"
      },
      "view_count": 247,
      "up_vote_count": 5,
      "accepted_answer_id": 75272899,
      "answer_count": 1,
      "score": 5,
      "creation_date": 1674966093,
      "question_id": 75272580,
      "body": "<p>Java 17 has introduced sealed classes which can permit only specific classes to extend them and would otherwise be final</p>\n<p>I understand the technical use-case, but can't think of any real life use cases where this would be useful?</p>\n<p>When would we want only specific classes to be able to extend a particular class?</p>\n<p>In our own projects, if we want a new class to extend the sealed class can't we just add it to the permitted classes? Wouldn't it be better to just not make the class final or sealed in that case to avoid the slight overhead?</p>\n<p>On the other hand, while exposing a library for external use how would a sealed class know beforehand which classes it should permit for extension?</p>\n"
    },
    {
      "tags": [
        "java",
        "linux",
        "undefined-symbol"
      ],
      "answers": [
        {
          "owner": {
            "user_id": 21569172,
            "display_name": "Baole Fang"
          },
          "up_vote_count": 3,
          "is_accepted": false,
          "creation_date": 1680712672,
          "answer_id": 75941996,
          "body": "<p>I've also encountered this bug after a recent ubuntu update. I think this is related to the snap and vscode.</p>\n<p>One simple solution is to uninstall vscode in snap with</p>\n<pre class=\"lang-bash prettyprint-override\"><code>sudo snap remove code\n</code></pre>\n<p>Then, install vscode with apt shown in <a href=\"https://code.visualstudio.com/docs/setup/linux\" rel=\"nofollow noreferrer\">https://code.visualstudio.com/docs/setup/linux</a></p>\n<pre class=\"lang-bash prettyprint-override\"><code>sudo apt install ./&lt;file&gt;.deb\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 4690576,
            "display_name": "AmeyaVS"
          },
          "up_vote_count": 9,
          "is_accepted": false,
          "creation_date": 1680850735,
          "answer_id": 75956168,
          "body": "<p>Though I have already answered it <a href=\"https://askubuntu.com/questions/1462295/ubuntu-22-04-both-eye-of-gnome-and-gimp-failing-with-undefined-symbol-error/1462494#1462494\">here</a></p>\n<p>The issue with how the VSCode Snap package libraries are configured to be used.\nThey are setting the following environment variable <code>GTK_PATH</code>, which gets inherited by the VSCode Terminal.</p>\n<p>Unsetting the environment variable in the VSCode terminal does seem to work for me.</p>\n<pre class=\"lang-bash prettyprint-override\"><code>unset GTK_PATH\n</code></pre>\n<p>As a slightly more permanent workaround, you can also unset <code>GTK_PATH</code> in your VS Code user settings, run &quot;Preferences: Open User Settings (JSON)&quot; and add this to your <code>settings.json</code>:</p>\n<pre class=\"lang-json prettyprint-override\"><code>    &quot;terminal.integrated.env.linux&quot;: {\n        &quot;GTK_PATH&quot;: &quot;&quot;\n    }\n</code></pre>\n"
        }
      ],
      "owner": {
        "user_id": 21557738,
        "display_name": "Leonardo Monteiro"
      },
      "view_count": 1784,
      "up_vote_count": 5,
      "answer_count": 2,
      "score": 5,
      "creation_date": 1680537323,
      "question_id": 75921414,
      "body": "<p>I've been working on a Java project that uses a gui.jar file to import some classes. Everything was working fine until yesterday. Now, I can compile the .class files by the command</p>\n<p><code>javac -d ./bin -sourcepath ./src -classpath ./bin/gui.jar src/simulation/TestSimulateur.javac</code></p>\n<p>but when I try to execute the program with</p>\n<p><code>java -classpath bin:bin/gui.jar simulation.TestSimulateur</code></p>\n<p>I get the error</p>\n<p><code>java: symbol lookup error: /snap/core20/current/lib/x86_64-linux-gnu/libpthread.so.0: undefined symbol: __libc_pthread_init, version GLIBC_PRIVATE make: *** [Makefile:47: carte1] Error 127</code></p>\n<p>I don't know much about how snap and the libraries work so I'm not sure about the root of the problem. It's strange that the problem only appears when I run it on VSCode, while it works fine if I run it on the normal Linux terminal.</p>\n<p>I've searched a lot but couldn't find how to solve the problem. As I've said, I'm newbie on Linux system. Between my attempts, I tried to reinstall VSCode, updating the system and updating snap packages, but none of those worked.</p>\n"
    },
    {
      "tags": [
        "java",
        "flutter",
        "macos",
        "android-studio"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 9251541,
            "display_name": "bakboem"
          },
          "edited": false,
          "comment_id": 132555209,
          "body": "try update Android cmdline-tools  <a href=\"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f0988aa1740d46b19ffc52a67c02cfa1~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp?\" rel=\"nofollow noreferrer\">this</a>"
        },
        {
          "owner": {
            "user_id": 6128304,
            "display_name": "Gaurav Singh"
          },
          "edited": false,
          "comment_id": 132555878,
          "body": "@bakboem I&#39;ve latest  Android cmdline-tools"
        },
        {
          "owner": {
            "user_id": 9251541,
            "display_name": "bakboem"
          },
          "edited": false,
          "comment_id": 132555988,
          "body": "try <a href=\"https://stackoverflow.com/questions/51281702/unable-to-find-bundled-java-version-on-flutter?rq=1\">this</a>"
        },
        {
          "owner": {
            "user_id": 1233565,
            "display_name": "Isaias"
          },
          "edited": false,
          "comment_id": 132580237,
          "body": "Looks like with the release of Electrci Eel the directory where JRE lives changed to JRB. Check this <a href=\"https://stackoverflow.com/a/75119315/1233565\">answer</a>."
        },
        {
          "owner": {
            "user_id": 305135,
            "display_name": "AVEbrahimi"
          },
          "edited": false,
          "comment_id": 132709135,
          "body": "Just delete JRE folder: <a href=\"https://stackoverflow.com/questions/75108707/android-studio-electric-eel-javahome-seems-to-be-invalid/75116649#75116649\" title=\"android studio electric eel javahome seems to be invalid\">stackoverflow.com/questions/75108707/&hellip;</a>"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 14634256,
            "display_name": "ALI USAMA"
          },
          "up_vote_count": 10,
          "is_accepted": false,
          "creation_date": 1673956069,
          "answer_id": 75145961,
          "body": "<ol>\n<li>Go to your AndroidStudio folder</li>\n</ol>\n<blockquote>\n<p>(e.g.  C:\\Program Files\\Android\\Android Studio) in Windows</p>\n</blockquote>\n<ol start=\"2\">\n<li>There you'll find the <code>jbr</code> and <code>jre</code> folder So all you need to do is to copy the content of jbr and paste the content into the <strong>jre</strong> folder.</li>\n</ol>\n"
        },
        {
          "owner": {
            "user_id": 15066584,
            "display_name": "Xlife"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1674268874,
          "answer_id": 75190830,
          "body": "<p>Open your AndroidStudio folder</p>\n<p>copy All Content of &quot;jbr&quot; Folder into the &quot;jre&quot; folder.</p>\n<p>Worked For Me.</p>\n"
        },
        {
          "owner": {
            "user_id": 305135,
            "display_name": "AVEbrahimi"
          },
          "up_vote_count": 2,
          "is_accepted": false,
          "creation_date": 1674892961,
          "answer_id": 75266223,
          "body": "<p>For <strong>Windows</strong>:</p>\n<p>The problem is because of trace of old Android Studio java folder, just delete this folder and it starts working:</p>\n<p>C:\\Program Files\\Android\\Android Studio\\jre</p>\n<p>The new Android Studio Electric Eel is using jbr, not jre.</p>\n<hr />\n<p>For <strong>macOS</strong> as @Jayanth replied above:\nIf you are using macOS replace the path in .bash_profile or .zshrc</p>\n<pre><code>export JAVA_HOME=&quot;/Applications/Android Studio.app/Contents/jre/Contents/Home&quot;\n</code></pre>\n<p>with</p>\n<pre><code>export JAVA_HOME=&quot;/Applications/Android Studio.app/Contents/jbr/Contents/Home&quot;\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 12903156,
            "display_name": "Bhargav Raviya"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1679825736,
          "answer_id": 75847100,
          "body": "<p>First Go On &quot;C:\\Program Files\\Android\\Android Studio&quot;\nCopy All Data in jbr folder to jre</p>\n<p>And</p>\n<p>Set System Varaible (windows)\nName: JAVA_HOME\nValue: C:\\Program Files\\Android\\Android Studio\\jre</p>\n<p>Then Restart your terminal</p>\n"
        }
      ],
      "owner": {
        "user_id": 6128304,
        "display_name": "Gaurav Singh"
      },
      "view_count": 4636,
      "up_vote_count": 5,
      "answer_count": 4,
      "score": 5,
      "creation_date": 1673641243,
      "question_id": 75114124,
      "body": "<p>When running command <code>flutter doctor</code> getting 1 issue:</p>\n<pre><code>[âœ“] Flutter (Channel stable, 2.8.1, on macOS 13.1 22C65 darwin-x64, locale en-IN)\n[âœ“] Android toolchain - develop for Android devices (Android SDK version 33.0.0)\n[âœ“] Xcode - develop for iOS and macOS (Xcode 14.2)\n[âœ“] Chrome - develop for the web\n[!] Android Studio (version 2022.1)\n    âœ— Unable to find bundled Java version.\n[âœ“] VS Code (version 1.69.2)\n[âœ“] Connected device (2 available)\n</code></pre>\n<p>System config:</p>\n<p>macOS Ventura v13.1 | Intel chip</p>\n<p>Android Studio Electric Eel(Stable version v2022.1.1)</p>\n<p>JAVA_HOME=/Applications/Android\\ Studio.app/Contents/jbr/Contents/Home</p>\n<p><code>java -version</code> command is working perfectly in terminal.</p>\n"
    },
    {
      "tags": [
        "java",
        "multithreading"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 21473475,
            "display_name": "Arfur Narf"
          },
          "edited": false,
          "comment_id": 134316433,
          "body": "I wouldn&#39;t be iterating through 1 to n in unit steps since &#39;most&#39; of the values will not be selected.  I&#39;d just generate the values that will match - e.g. <code>for (i=divisor; i&lt;=n; i+=divisor) storeResult(i)</code>. I&#39;d have one thread per unique divisor 3,5,7. Eliminate duplicates as before."
        },
        {
          "owner": {
            "user_id": 3426309,
            "display_name": "Andrey B. Panfilov"
          },
          "edited": false,
          "comment_id": 134317548,
          "body": "my understanding of &quot;multithreaded program that finds all integers in the range [1, n] that are divisible by 3, 5, or 7&quot; is: you need write program using something like: int stream &gt; range &gt; parallel &gt; filter &gt; sum. That would be the only solution which actually makes sense."
        },
        {
          "owner": {
            "user_id": 3426309,
            "display_name": "Andrey B. Panfilov"
          },
          "edited": false,
          "comment_id": 134317617,
          "body": "<code>IntStream.range(1, n).parallel().filter(i -&gt; i % 3 == 0 || i % 5 == 0 || i % 7 == 0).sum()</code>"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 773113,
            "display_name": "Mike Nakis"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1683114963,
          "answer_id": 76163523,
          "body": "<p>The main solution to your problem is to lose <code>static</code> everywhere. Never use <code>static</code> unless you have a very good reason to. In this case, you do not. Generally speaking, it will be a few years of programming in Java before you will encounter your first situation where you may legitimately use <code>static</code>. Until then, just don't.</p>\n<p>As a bonus thought, you could perhaps greatly reduce the amount of work you have to do by not creating a thread for each divisor and instead creating threads for different ranges of integers that you want to process. So, for example, for <code>n = 1000</code> you might create two threads, one that will process numbers from 1 to 500 and another that will process numbers from 501 to 1000. This way, each thread is guaranteed to yield numbers that will not be yielded by the other thread.</p>\n"
        },
        {
          "owner": {
            "user_id": 21473475,
            "display_name": "Arfur Narf"
          },
          "up_vote_count": 2,
          "is_accepted": false,
          "creation_date": 1683116825,
          "answer_id": 76163819,
          "body": "<p>Your problem is the shared variable <code>temp</code> which is expected to hold the same value across several statements.</p>\n<pre><code>public static int temp = 0;\npublic static synchronized void increment() {\n    dividends.add(temp);\n}\n</code></pre>\n<p>In each thread:</p>\n<pre><code>temp=i;\nincrement();\n</code></pre>\n<p>So if thread1 sets 'temp', it can be changed by another thread before thread1 gets to use it in increment.</p>\n<p>But it's not necessary anyway.</p>\n<pre><code>public static synchronized void increment(int x) {\n    dividends.add(X);\n}\n</code></pre>\n<p>then</p>\n<pre><code>increment(i);\n</code></pre>\n<p>Other answers talk about eliminating unnecessary static, which is valid design criticism, but that in itself does not fix your 'temp' problem.  Even a non-static 'temp' is still shared across threads - there's one instance of FindMultiples shared by all of the thread instances.</p>\n<p>This answer addresses the question of why you're getting variable results.  In comments I've noted that efficiency can be improved.</p>\n"
        },
        {
          "owner": {
            "user_id": 13157139,
            "display_name": "Mukhtar Amirkhanov"
          },
          "up_vote_count": 2,
          "is_accepted": true,
          "creation_date": 1683117589,
          "answer_id": 76163931,
          "body": "<p>Most likely your main problem is that you are synchronizing the increment() method, and not synchronizing the temp variable.\nWhile one thread is trying to execute the increment() method, the second thread is changing the value of the temp variable. Run your code in debug and check it out.</p>\n<p>It's better to send the value directly to increment() than store it in temp.\nSee my edited code:</p>\n<pre><code>import java.util.*;\npublic class FindMultiples\n{\n\n  public static ArrayList&lt;Integer&gt; dividends = new ArrayList&lt;&gt;();\n  public static synchronized void increment(int temp){\n     dividends.add(temp);\n  }\n  \n  public static class MyThread implements Runnable{\n\n    public int divisor;\n    public int n;\n\n    public MyThread(int n , int divisor){\n        this.n=n;\n        this.divisor=divisor;\n    }\n\n    @Override\n    public void run() {\n\n        for (int i=1 ; i&lt;=n ; i++){\n            if (i%divisor==0){\n                increment(i);\n            }\n        }\n    }\n  }\n\n  public int getSum(int n) {\n    int sum = 0;\n    Thread thread1 = new Thread(new MyThread(n,3));\n    Thread thread2 = new Thread(new MyThread(n,7));\n    Thread thread3 = new Thread(new MyThread(n,5));\n\n    thread3.start();\n    thread2.start();\n    thread1.start();\n    try {\n        thread3.join();\n        thread2.join();\n        thread1.join();\n    }catch (InterruptedException e){\n        System.out.println(e.getMessage());\n    }\n    Set&lt;Integer&gt; set = new HashSet&lt;&gt;(dividends);\n    dividends.clear();\n    dividends.addAll(set);\n\n    for (int i : dividends){\n        sum+=i;\n    }\n\n    return sum;\n  }\n\n  public static void main(String[] args) {\n    FindMultiples findMultiples = new FindMultiples();\n    System.out.println(findMultiples.getSum(1000));\n  }\n}\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 592355,
            "display_name": "xerx593"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1683118249,
          "answer_id": 76164034,
          "body": "<h3>See mine</h3>\n<h4>For <code>n ~= 100,000</code>, better use <code>long getSum(int n)</code></h4>\n<p>...and we need to adjust.</p>\n<p>Comments inline:</p>\n<pre class=\"lang-java prettyprint-override\"><code>package com.example;\n\nimport java.util.BitSet;\nimport java.util.concurrent.ExecutionException;\nimport java.util.concurrent.ExecutorCompletionService;\nimport java.util.concurrent.ExecutorService;\nimport java.util.concurrent.Executors;\n\npublic class Test {\n    // Our thread pool (e.g...):\n    static final ExecutorService THREAD_POOL = Executors.newFixedThreadPool(3);\n    // to complete our &quot;tasks&quot; (see javadoc):\n    static final ExecutorCompletionService&lt;BitSet&gt; ECS = new ExecutorCompletionService&lt;&gt;(THREAD_POOL);\n\n    static long getSum(int n) throws InterruptedException, ExecutionException { // for brevity: throw\n        // start &quot;3 job&quot;:\n        ECS.submit(() -&gt; findDivisors(3, n));\n        // start &quot;5 job&quot;:\n        ECS.submit(() -&gt; findDivisors(5, n));\n        // start &quot;7 job&quot;:\n        ECS.submit(() -&gt; findDivisors(7, n));\n\n        // collect result:\n        BitSet collect = new BitSet(n + 1);\n        for (int i = 3; i &gt; 0; i--) { // complete all jobs ...\n            BitSet tmpResult = ECS.take().get(); // see javadoc\n            if (tmpResult != null) // &quot;or'ing&quot; their results into &quot;collect&quot;:\n                collect.or(tmpResult);\n        }\n\n        // stream over &quot;all set indices&quot; in &quot;collect&quot; and return ...\n        return collect.stream()\n                // ... (as a long;) their sum \n                .mapToLong(i -&gt; (long) i).sum();\n    }\n\n    static BitSet findDivisors(int d, int n) { // MAIN JOB:\n        BitSet mem = new BitSet(n + 1); // ignore 0th bit\n        for (int i = d; i &lt;= n; i += d) { // set i(th) index to true:\n            mem.set(i);\n        }\n        return mem; // done!\n    }\n\n    public static void main(String[] args) throws InterruptedException, ExecutionException {\n        // do I/O, more tests...:\n        System.out.println(getSum(10));\n        System.out.println(getSum(100));\n        System.out.println(getSum(1_000));\n        System.out.println(getSum(10_000));\n        System.out.println(getSum(100_000));\n        System.out.println(getSum(1_000_000));\n        System.out.println(getSum(10_000_000));\n        System.out.println(getSum(100_000_000));\n        System.out.println(getSum(1_000_000_000));\n        // System.out.println(getSum(2_000_000_000)); // oh-oh\n        // finally: release resources:\n        THREAD_POOL.shutdown();\n    }\n}\n</code></pre>\n<h4>Prints:</h4>\n<pre class=\"lang-text prettyprint-override\"><code>40\n2838\n272066\n27152139\n2714364277\n271428928569\n27142867857145\n2714285835714288\n271428572071428566\n1085714285285714288 # ?? &lt;- this looks like (long!) overflow ;(\n</code></pre>\n<h3>References</h3>\n<ul>\n<li><a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/ExecutorCompletionService.html\" rel=\"nofollow noreferrer\"><code>ExecutorCompletionService</code></a> + linked (since java 1.5)</li>\n<li><a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/BitSet.html\" rel=\"nofollow noreferrer\"><code>BitSet</code></a> (since java 1.0;)</li>\n<li><a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/Executor.html\" rel=\"nofollow noreferrer\"><code>Executor</code></a></li>\n<li><a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/ExecutorService.html\" rel=\"nofollow noreferrer\"><code>ExecutorService</code></a></li>\n</ul>\n<h3>Key Points</h3>\n<ul>\n<li>BitSet as &quot;data structure&quot;:\n<ul>\n<li>similar to <code>boolean[]([])</code>, but:\n<ul>\n<li>better memory efficience (a <code>boolean</code> costs 1 byte of memory (in current hw architecture), whereas BitSet can do better (backed by a <code>long[]|byte[]</code>))</li>\n<li>advanced API (<code>or, and, xor, cardinality, stream, ...</code>)</li>\n</ul>\n</li>\n<li>to overcome its lack of multi-thread support we can:\n<ul>\n<li>&quot;synchronize&quot;</li>\n<li>use multiple BitSets to join/or/and/... them together</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><code>i</code>th index in bitSet_x (3/5/7) set, means: <code>i</code> is divisible by x (3/5/7)</li>\n<li>challenges start from <code>n~=100000</code></li>\n</ul>\n<hr />\n<p>And the &quot;ultra-light&quot; version (regarding the lines of code, performance is another chapter), inspired by Andrey B.P.:</p>\n<pre class=\"lang-java prettyprint-override\"><code>[static] long getSum(int n) {\n  return IntStream.rangeClosed(1, n) // rangeClosed not range (or +/-1;)\n    .parallel() // ok\n    .filter(i -&gt;\n         (i % 3 == 0 &amp;&amp; i % 15 &gt; 0 &amp;&amp; i % 21 &gt; 0) // 1.\n      || (i % 5 == 0 &amp;&amp; i % 35 &gt; 0) // 2.\n      || (i % 7 == 0) // 3.\n    )\n    .mapToLong(i -&gt; (long) i) // for bigger input\n    .sum(); // #\n}\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 3426309,
            "display_name": "Andrey B. Panfilov"
          },
          "up_vote_count": 3,
          "is_accepted": false,
          "creation_date": 1683146997,
          "answer_id": 76167884,
          "body": "<p>Well, I believe solution below is the most optimal, cause it is just an arithmetic formula:</p>\n<pre class=\"lang-java prettyprint-override\"><code>BiFunction&lt;Integer, Integer, Long&gt; sumDivInRange = (to, div) -&gt; {\n    int first = (1 / div) * div;\n    int last = (to / div) * div;\n\n    return ((long) first + last) * ((last - first) / div + 1) / 2;\n};\n\nint n = 100000000;\n\n// not sure we need parallel that\nreturn sumDivInRange.apply(n, 3)\n        + sumDivInRange.apply(n, 5)\n        + sumDivInRange.apply(n, 7)\n        - sumDivInRange.apply(n, 15)\n        - sumDivInRange.apply(n, 21)\n        - sumDivInRange.apply(n, 35)\n        + sumDivInRange.apply(n, 105);\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 821497,
            "display_name": "ciamej"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1683219555,
          "answer_id": 76175658,
          "body": "<p>When your goal is to parallelize computations you should make sure that your solution is actually faster than a serial (single threaded) one. Unfortunately your code (fixed by Mukhtar Amirkhanov) is probably much slower than a naive loop going through 1 to n. This is because a naive solution does not have to store the actual dividends anywhere. Also your multithreaded program synchronizes on each step, which means it won't actually make much progress in parallel. Finally, after the threads join your program removes duplicates in the main thread - that step alone take probably way more time than the naive loop.</p>\n<p>Unfortunately, the task is poorly defined, because the fastest solution is just a formula (as shown by @Andrey B. Panfilov) which can be computed in constant time <code>O(1)</code> and which cannot be sped up by multithreading. Probably your teacher meant to speed the computations by using multithreading compared to the naive solution, so you should settle for &quot;second-best&quot; approach.</p>\n<p>A meaningful approach to parallelizing such tasks is described by @Mike Nakis in his answer. You should split the work between threads not by the divisor, but by ranges of dividends. You can define separate threads do the work, and after joining them just add their results, or you can simply use a parallel stream (as shown by @Andrey B. Panfilov in a comment, just use a LongStream instead of an IntStream) to the same effect (if streams are allowed in your assignment).</p>\n<pre><code>import java.util.*;\npublic class FindMultiples\n{\n  public static final int numberOfThreads = 3;\n  public static long[] partialResults = new long[numberOfThreads];\n\n  public static class MyThread implements Runnable{\n    public int threadNumber;\n    public int n;\n\n    public MyThread(int threadNumber, int n) {\n        this.threadNumber = threadNumber;\n        this.n = n;\n    }\n\n    @Override\n    public void run() {\n        int start = ((threadNumber - 1) * n / numberOfThreads) + 1;\n        int end = threadNumber * n / numberOfThreads;\n        long result = 0;\n        for (int i = start; i &lt;= end; i++)\n            if (i % 3 == 0 || i % 5 == 0 || i % 7 == 0)\n                result += i;\n        partialResults[threadNumber - 1] = result;\n    }\n  }\n\n  public long getSum(int n) {\n    Thread[] threads = new Thread[numberOfThreads];\n    for (int i = 1; i &lt;= numberOfThreads; i++)\n        threads[i - 1] = new Thread(new MyThread(i, n));\n\n    for (int i = 1; i &lt;= numberOfThreads; i++)\n        threads[i - 1].start();\n\n    try {\n        for (int i = 1; i &lt;= numberOfThreads; i++)\n            threads[i - 1].join();\n    } catch (InterruptedException e) {\n        System.out.println(e.getMessage());\n    }\n    \n    long sum = 0;\n    for (int i = 1; i &lt;= numberOfThreads; i++)\n        sum += partialResults[i - 1];\n\n    return sum;\n  }\n\n  public static void main(String[] args) {\n    FindMultiples findMultiples = new FindMultiples();\n    System.out.println(findMultiples.getSum(1000));\n  }\n}\n</code></pre>\n"
        }
      ],
      "owner": {
        "user_id": 21232984,
        "display_name": "Phantom"
      },
      "view_count": 205,
      "up_vote_count": 5,
      "accepted_answer_id": 76163931,
      "answer_count": 6,
      "score": 5,
      "creation_date": 1683114406,
      "question_id": 76163443,
      "body": "<p>explanation of the question:\nyou must write a multithreaded program that finds all\nintegers in the range [1, n] that are divisible by 3, 5, or 7. Return the\nsum of all unique integers as your answer.\nNote that an integer such as 15 (which is a multiple of 3 and 5) is only\ncounted once.\nThe Positive integer n &gt; 0 is given to you as input. Create as many threads as\nyou need to solve the problem. You can use a Thread Pool for bonus points.</p>\n<pre><code>Example:\nInput: n = 10\nOutput: sum = 40\nExplanation: Numbers in the range [1, 10] that are divisible by 3, 5, or 7 are:\n3, 5, 6, 7, 9, 10. The sum of these numbers is 40.\n</code></pre>\n<p>My solution and problem that I faced:\nin this program I created three threads each for finding the integers that are divided by 3,5 and 7 separately then it will store them all in the dividends array list and by the following code it will remove the repeated ones in the array list:</p>\n<pre><code>Set&lt;Integer&gt; set = new HashSet&lt;&gt;(dividends);\n    dividends.clear();\n    dividends.addAll(set);\n</code></pre>\n<p>I used some test cases that were provided by our teacher and the problem is that in the testcases that n=1000 and n=76293 sum won't show the amount that was expected:</p>\n<pre><code>n=1000\nexpected sum:272066\nactual sum:247377\n</code></pre>\n<p>and the other problem is that the actual sum keeps changing every time I run the testcase.\ncan someone tell me what the problem of my code is and how I can fix it</p>\n<p>my code:</p>\n<pre><code>import java.util.*;\npublic class FindMultiples\n{\n\npublic static ArrayList&lt;Integer&gt; dividends = new ArrayList&lt;&gt;();\npublic static int temp = 0;\npublic static synchronized void increment(){\n    dividends.add(temp);\n}\npublic static class thread implements Runnable{\n\n    public int divisor;\n    public int n;\n\n    public thread(int n , int divisor){\n        this.n=n;\n        this.divisor=divisor;\n    }\n\n    @Override\n    public void run() {\n\n        for (int i=1 ; i&lt;=n ; i++){\n            if (i%divisor==0){\n                temp=i;\n                increment();\n            }\n        }\n    }\n}\n\npublic int getSum(int n) {\n    int sum = 0;\n    Thread thread1 = new Thread(new thread(n,3));\n    Thread thread2 = new Thread(new thread(n,7));\n    Thread thread3 = new Thread(new thread(n,5));\n    \n    thread3.start();\n    thread2.start();\n    thread1.start();\n    try {\n        thread3.join();\n        thread2.join();\n        thread1.join();\n    }catch (InterruptedException e){\n\n    }\n    Set&lt;Integer&gt; set = new HashSet&lt;&gt;(dividends);\n    dividends.clear();\n    dividends.addAll(set);\n\n    for (int i : dividends){\n        sum+=i;\n    }\n\n    return sum;\n}\n\npublic static void main(String[] args) {\n}\n}\n</code></pre>\n"
    },
    {
      "tags": [
        "java"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 2164365,
            "display_name": "Abra"
          },
          "edited": false,
          "comment_id": 133435000,
          "body": "Enter the following into the &quot;Search...&quot; box at the top of this Web page: <i>[java] generics instanceof</i> Or just go to: <a href=\"https://stackoverflow.com/questions/1570073/java-instanceof-and-generics\" title=\"java instanceof and generics\">stackoverflow.com/questions/1570073/&hellip;</a>"
        },
        {
          "owner": {
            "user_id": 6483824,
            "display_name": "mike"
          },
          "edited": false,
          "comment_id": 133435027,
          "body": "If I cast ps to Object, then instanceof does generate error. But above code does compile."
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 6169894,
            "display_name": "AminM"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1677914823,
          "answer_id": 75634260,
          "body": "<p>instanceof will be unable to distinguish between <code>WeakReference&lt;String&gt;</code> and <code>WeakReference&lt;Integer&gt;</code>. Because these types (String and Integer) are erased during compilation (hence the name &quot;type erasure&quot;) and at runtime it will only know that it is a WeakReference containing something of type Object.</p>\n<p>In Java generics are a way of avoiding the need for casting when you retrieve an object from a generic type (in earlier versions you had to cast a lot). But they don't really exist at runtime.</p>\n<p>Here is the Java spec on the topic: <a href=\"https://docs.oracle.com/javase/specs/jls/se8/html/jls-4.html#jls-4.6\" rel=\"nofollow noreferrer\">https://docs.oracle.com/javase/specs/jls/se8/html/jls-4.html#jls-4.6</a></p>\n"
        },
        {
          "owner": {
            "user_id": 5133585,
            "display_name": "Sweeper"
          },
          "up_vote_count": 6,
          "is_accepted": true,
          "creation_date": 1677915375,
          "answer_id": 75634297,
          "body": "<p>Checking if a <code>WeakReference&lt;String&gt;</code> is a <code>WeakReference&lt;String&gt;</code> does not require the runtime to check anything regarding generic types. It is trivially true, after all.</p>\n<p>More meaningful/useful examples would be:</p>\n<pre><code>List&lt;String&gt; x = new LinkedList&lt;&gt;();\nif (x instanceof ArrayList&lt;String&gt;) {\n    System.out.println(&quot;Ok&quot;);\n}\n</code></pre>\n<pre><code>List&lt;Integer&gt; x = new LinkedList&lt;&gt;();\nif (x instanceof ArrayList&lt;? extends Number&gt;) {\n    System.out.println(&quot;Ok&quot;);\n}\n</code></pre>\n<p>In both of these cases, the &quot;generics parts&quot; can be checked all at compile time. It is only when you need to determine generics at runtime that is problematic, because the runtime does not know about generics. An example of this would be:</p>\n<pre><code>List&lt;?&gt; x = new LinkedList&lt;Integer&gt;();\n// this does not compile because the runtime will need to check if the &quot;?&quot; is String, which it can't.\nif (x instanceof ArrayList&lt;String&gt;) {\n    System.out.println(&quot;Ok&quot;);\n}\n</code></pre>\n<p>According to the <a href=\"https://docs.oracle.com/javase/specs/jls/se17/html/jls-15.html#jls-15.20.2\" rel=\"nofollow noreferrer\">spec</a>, the type needs to be &quot;downcast-compatible&quot; with the expression:</p>\n<blockquote>\n<p>The RelationalExpression must be downcast compatible with the ReferenceType (<a href=\"https://docs.oracle.com/javase/specs/jls/se17/html/jls-5.html#jls-5.5\" rel=\"nofollow noreferrer\">Â§5.5</a>), or a compile-time error occurs.</p>\n</blockquote>\n<p>And that means:</p>\n<blockquote>\n<p>If an expression can be converted to a reference type by a casting conversion other than a narrowing reference conversion which is unchecked, we say the expression (or its value) is downcast compatible with the reference type.</p>\n</blockquote>\n<p>So a rule of thumb is that if <code>(T)foo</code> gives you an unchecked warning, that means <code>foo instanceof T</code> does not compile.</p>\n<p>Note that the spec didn't always say this. The <a href=\"https://docs.oracle.com/javase/specs/jls/se8/html/jls-15.html#jls-15.20.2\" rel=\"nofollow noreferrer\">Java 8 spec</a> said:</p>\n<blockquote>\n<p>It is a compile-time error if the ReferenceType mentioned after the instanceof operator does not denote a reference type that is reifiable (<a href=\"https://docs.oracle.com/javase/specs/jls/se8/html/jls-4.html#jls-4.7\" rel=\"nofollow noreferrer\">Â§4.7</a>).</p>\n</blockquote>\n<p>Which would have made <code>instanceof WeakReference&lt;String&gt;</code> invalid in all situations.</p>\n"
        },
        {
          "owner": {
            "user_id": 2164365,
            "display_name": "Abra"
          },
          "up_vote_count": 3,
          "is_accepted": false,
          "creation_date": 1677916509,
          "answer_id": 75634371,
          "body": "<p>In Java, Generics<sup><a href=\"https://docs.oracle.com/javase/tutorial/java/generics/index.html\" rel=\"nofollow noreferrer\">1,</a></sup><sup><a href=\"https://docs.oracle.com/javase/tutorial/extra/generics/index.html\" rel=\"nofollow noreferrer\">2,</a></sup><sup><a href=\"https://docs.oracle.com/javase/8/docs/technotes/guides/language/generics.html\" rel=\"nofollow noreferrer\">3</a></sup> uses type parameters. The code in your question uses type arguments and not type parameters. Similar to method parameters vs method arguments as explained in <a href=\"https://stackoverflow.com/questions/12709026/difference-between-arguments-and-parameters-in-java\">Difference between arguments and parameters in Java</a>.</p>\n<p>Even if you replace the <code>String</code> with the <code>?</code> wildcard, the code still compiles, i.e.</p>\n<pre class=\"lang-java prettyprint-override\"><code>WeakReference&lt;?&gt; ps = new WeakReference&lt;&gt;(new String());\nif (ps instanceof WeakReference&lt;?&gt;) {\n    System.out.println(&quot;Ok&quot;);\n}\n</code></pre>\n<p>This is because the same generic argument is being used, i.e. <code>?</code></p>\n<p>If you replace the arguments with parameters, then the code will not compile, for example:</p>\n<pre class=\"lang-java prettyprint-override\"><code>import java.lang.ref.WeakReference;\n\npublic class TestClaz&lt;T&gt; {\n\n    public static &lt;T&gt; void main(String[] args) {\n        WeakReference&lt;T&gt; ps = new WeakReference&lt;&gt;(new String());\n        if (ps instanceof WeakReference&lt;T&gt;) {\n            System.out.println(&quot;Ok&quot;);\n        }\n    }\n}\n</code></pre>\n<p>Here <code>T</code> is a type parameter (and <strong>not</strong> a type argument) and my IDE<sup><a href=\"https://www.eclipse.org/\" rel=\"nofollow noreferrer\">4</a></sup> gives the following compiler error:</p>\n<blockquote>\n<p>Cannot infer type arguments for WeakReference&lt;&gt;</p>\n</blockquote>\n<p>This part of the code does not compile:</p>\n<pre class=\"lang-java prettyprint-override\"><code>WeakReference&lt;T&gt; ps = new WeakReference&lt;&gt;(new String());\n</code></pre>\n<p>If I change that line to:</p>\n<pre class=\"lang-java prettyprint-override\"><code>WeakReference&lt;T&gt; ps = new WeakReference&lt;T&gt;(new String());\n</code></pre>\n<p>Then the compiler error becomes:</p>\n<blockquote>\n<p>The constructor WeakReference&lt;T&gt;(String) is undefined</p>\n</blockquote>\n<p>Now I can add a cast to <code>T</code>, as in:</p>\n<pre class=\"lang-java prettyprint-override\"><code>WeakReference&lt;T&gt; ps = new WeakReference&lt;T&gt;((T) new String());\n</code></pre>\n<p>and then the code compiles but with the following [compiler] warning:</p>\n<blockquote>\n<p>Unchecked cast from String to T</p>\n</blockquote>\n<p>In other words, the compiler cannot know whether <code>String</code> can be cast to <code>T</code> because, at runtime, <code>T</code> could be any class and not necessarily one that can be cast to <code>String</code>, hence the compiler cannot verify that <code>String</code> can be cast to <code>T</code>.</p>\n<p><sup>1</sup> Generics lesson in Oracle's Java tutorials.<br />\n<sup>2</sup> Generics bonus lesson in Oracle's Java tutorials.<br />\n<sup>3</sup> Generics guide from Oracle's Java documentation.<br />\n<sup>4</sup> My IDE is Eclipse.</p>\n"
        }
      ],
      "owner": {
        "user_id": 6483824,
        "display_name": "mike"
      },
      "view_count": 128,
      "up_vote_count": 5,
      "accepted_answer_id": 75634297,
      "answer_count": 3,
      "score": 5,
      "creation_date": 1677914271,
      "question_id": 75634223,
      "body": "<p>I am reading about generics, and I learned that they don't allow the use of <code>instanceof</code>. However, the following code compiles:</p>\n<pre><code>WeakReference&lt;String&gt; ps = new WeakReference&lt;&gt;(new String());\nif (ps instanceof WeakReference&lt;String&gt;) {\n    System.out.println(&quot;Ok&quot;);\n}\n</code></pre>\n<p>Can anyone clarify what I don't understand?</p>\n"
    },
    {
      "tags": [
        "java",
        "constructor-reference"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 2837741,
            "display_name": "daniu"
          },
          "edited": false,
          "comment_id": 133158584,
          "body": "I&#39;m surprised it outputs anything since it doesn&#39;t compile. <code>Dog::new</code> is a reference to the <code>Dog</code> constructor, not a <code>Dog</code>, so you can&#39;t assign it to a <code>Dog</code> variable. Do you maybe still have an older version that you compiled before and still run?"
        },
        {
          "owner": {
            "user_id": 5133585,
            "display_name": "Sweeper"
          },
          "edited": false,
          "comment_id": 133158660,
          "body": "@daniu OP is not assigning <code>Dog::new</code> to a <code>Dog</code> variable though, but an <code>Animal</code>, which does compile."
        },
        {
          "owner": {
            "user_id": 112968,
            "display_name": "knittl"
          },
          "edited": false,
          "comment_id": 133158684,
          "body": "<code>Dog::new</code> is a method reference. It does not call the constructor. <code>new Dog()</code> calls the constructor. The line is equivalent to <code>Animal animal = () -&gt; new Dog();</code>"
        },
        {
          "owner": {
            "user_id": 2837741,
            "display_name": "daniu"
          },
          "edited": false,
          "comment_id": 133158791,
          "body": "@Sweeper you&#39;re right, it does compile and run, but I&#39;m somewhat surprised even though I do understand why. I was going to write an answer but knittl ninja&#39;d me."
        },
        {
          "owner": {
            "user_id": 637853,
            "display_name": "Thomas"
          },
          "edited": false,
          "comment_id": 133158821,
          "body": "You basically created a new anonymous class instance of <code>Animal</code> and implemented <code>eat()</code> to call <code>new Dog()</code>. That&#39;s what the method reference is doing. Add another method to <code>Animal</code> and you&#39;ll see the compiler complaining about functional interfaces not allowed to have more than one method. Replace <code>Dog::new</code> with <code>new Dog()</code> to fix your issue."
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 112968,
            "display_name": "knittl"
          },
          "up_vote_count": 6,
          "is_accepted": true,
          "creation_date": 1676540736,
          "answer_id": 75470429,
          "body": "<p><code>Animal</code> is a functional interface with a single method <code>void eat()</code> (void return, no parameters) â€“ also known as <em>SAM type</em> (single abstract method).</p>\n<p>It is structurally identical to the <code>java.util.Runnable</code> interface (<code>interface Runnable { void run(); }</code>). Your code could as well be written as:</p>\n<pre><code>final Runnable runnable = Dog::new;\nrunnable.run(); // calls the constructor\n</code></pre>\n<p>You can assign it any lambda or method reference with zero arguments and no return value, e.g. <code>() -&gt; {}</code>.</p>\n<p><code>Dog::new</code> is a method reference and equivalent to the lambda <code>() -&gt; { new Dog(); }</code>. If you look closely, you will notice that this lambda does not return anything. It constructs a new Dog instance and then forgets about it again.</p>\n<p>Assigning a method reference or a lambda to a variable does not execute it (yet). You have to explicitly invoke the lambda by calling the named method from your interface.</p>\n<p>Now, your <code>animal</code> is an instance of your <code>Animal</code> interface and got assigned a method reference which can then be invoked later. <code>animal.eat()</code> invokes the assigned method reference, calling the constructor.</p>\n<p>If you want your variable <code>animal</code> to hold a <code>Dog</code> instance and then invoke the <code>eat</code> method on it, call the constructor directly: <code>Animal animal = new Dog();</code></p>\n<p>The &quot;problem&quot; is the signature of your <code>eat</code> method, because it is equivalent to <code>Runnable#run</code> and allows assigning any &quot;empty&quot; action.</p>\n<p>Lambdas and method references were introduced with Java 8. In Java versions before, you had to create an anonymous class to achieve the same behavior:</p>\n<pre><code>final Animal animal = new Animal() {\n  @Override public void eat() {\n    new Dog();\n  }\n};\nanimal.eat(); // calls &quot;eat&quot; of the anonymous instance, which in turn calls the constructor; does NOT call `Dog#eat`\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 5133585,
            "display_name": "Sweeper"
          },
          "up_vote_count": 2,
          "is_accepted": false,
          "creation_date": 1676541150,
          "answer_id": 75470499,
          "body": "<p><code>Animal</code> is an interface with a single abstract method, <code>eat</code>. This method does not take any parameters and does not return anything. Because of this, it can represent any function that takes no parameters. For example:</p>\n<pre><code>Animal foo = () -&gt; System.out.println(&quot;foo&quot;);\n</code></pre>\n<p>Now if I call <code>foo.eat()</code>, it will run the code in the lambda, which prints &quot;foo&quot;.</p>\n<p>I can also use a method reference instead of a lambda:</p>\n<pre><code>Animal foo = SomeClass::someStaticMethod;\n</code></pre>\n<p>Now <code>foo.eat()</code> will run the parameterless method called <code>someStaticMethod</code> located in <code>SomeClass</code>.</p>\n<p>Notice that this works in exactly the same way as using the built-in <a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Runnable.html\" rel=\"nofollow noreferrer\"><code>Runnable</code></a> interface and called its <code>run</code> method. Yours is just called <code>Animal</code> and <code>eat</code>, rather than <code>Runnable</code> and <code>run</code>.</p>\n<p>So by the same logic, using a constructor reference of <code>Dog</code> will invoke the constructor of <code>Dog</code>.</p>\n<pre><code>Animal foo = Dog::new;\nRunnable bar = Dog::new;\n\n// these two lines do the same thing:\nfoo.eat();\nbar.run();\n</code></pre>\n<p>Would you still have the confusion if you have written the code with <code>Runnable</code> instead?</p>\n<p>Note that the fact that <code>Dog</code> implements <code>Animal</code> does not matter here. <code>Dog</code> implements <code>Animal</code> just means that you can do:</p>\n<pre><code>Animal animal = new Dog();\n</code></pre>\n<p>which has a completely different meaning. If at this point I do <code>animal.eat()</code>, then it will output what you expect - &quot;dog eat&quot;.</p>\n<p>Alternatively, you could also make a method reference to a newly-created <code>Dog</code>'s <code>eat</code> method for it to output &quot;dog eat&quot;:</p>\n<pre><code>Animal animal = new Dog()::eat;\n</code></pre>\n"
        }
      ],
      "owner": {
        "user_id": 21225554,
        "display_name": "vozrr"
      },
      "view_count": 93,
      "up_vote_count": 7,
      "accepted_answer_id": 75470429,
      "answer_count": 2,
      "score": 5,
      "creation_date": 1676539826,
      "question_id": 75470235,
      "body": "<p>code like this</p>\n<pre><code>public class LambdaTest {\n    public static void main(String[] args) {\n        final Animal animal = Dog::new;\n        animal.eat();\n    }\n}\n\n@FunctionalInterface\ninterface Animal {\n    void eat();\n}\n\nclass Dog implements Animal {\n\n    public Dog() {\n        System.out.println(&quot;dog init.&quot;);\n    }\n\n    @Override\n    public void eat() {\n        System.out.println(&quot;dog eat&quot;);\n    }\n</code></pre>\n<p>When I ran this code, &quot;dog init.&quot; was printed to the console, but &quot;dog eat&quot; was not. Why is that? Can someone tell me the reason?</p>\n<p>I expected &quot;dog init&quot; and &quot;dog eat&quot; to be printed, but only &quot;dog init&quot; was printed. Additionally, I'm puzzled as to why there was no error when <code>Animal animal = Dog::new;</code>.</p>\n"
    },
    {
      "tags": [
        "java",
        "generics",
        "var"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 3890632,
            "display_name": "khelwood"
          },
          "edited": false,
          "comment_id": 134112414,
          "body": "Is <code>get()</code> supposed to be the same as <code>create()</code> in this example?"
        },
        {
          "owner": {
            "user_id": 1258130,
            "display_name": "eja"
          },
          "edited": false,
          "comment_id": 134112466,
          "body": "yeah, should be create, I mistyped that.. thanks @khelwood"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 5646962,
            "display_name": "Thomas Kl&#228;ger"
          },
          "up_vote_count": 3,
          "is_accepted": false,
          "creation_date": 1681811549,
          "answer_id": 76043149,
          "body": "<p>The <a href=\"https://openjdk.org/projects/amber/guides/lvti-faq#Q8\" rel=\"nofollow noreferrer\">FAQ about Local Variable Type Inference</a> describes whats happening:</p>\n<blockquote>\n<p><strong>Q8. Can you use var with a diamond on the right-hand side?</strong></p>\n<p>Yes, it works, but itâ€™s probably not what you want. Consider:</p>\n<pre><code>var list = new ArrayList&lt;&gt;();\n</code></pre>\n<p>This will infer the type of list to be <code>ArrayList&lt;Object&gt;</code>. In general, itâ€™s preferable use an explicit type on the left with diamond on the right, or use var on the left with an explicit type on the right. See the <a href=\"https://openjdk.org/projects/amber/guides/lvti-style-guide\" rel=\"nofollow noreferrer\">LVTI Style Guidelines</a>, <a href=\"https://openjdk.org/projects/amber/guides/lvti-style-guide#G6\" rel=\"nofollow noreferrer\">guideline G6</a>, for further information.</p>\n</blockquote>\n<p>That guideline G6 additionally states:</p>\n<blockquote>\n<p>For its inference, diamond can use the target type (typically, the left-hand side of a declaration) or the types of constructor arguments. If neither is present, it falls back to the broadest applicable type, which is often <code>Object</code>. This is usually not what was intended.</p>\n</blockquote>\n"
        },
        {
          "owner": {
            "user_id": 5133585,
            "display_name": "Sweeper"
          },
          "up_vote_count": 4,
          "is_accepted": false,
          "creation_date": 1681811634,
          "answer_id": 76043167,
          "body": "<p>For how <code>var</code> works, refer to section <a href=\"https://docs.oracle.com/javase/specs/jls/se17/html/jls-14.html#jls-14.4.1\" rel=\"nofollow noreferrer\">14.4.1</a> of the JLS.</p>\n<blockquote>\n<p>If the LocalVariableType is <code>var</code>, then let T be the type of the initializer expression when treated as if it did not appear in an assignment context, and were thus a standalone expression (Â§15.2). The type of the local variable is the upward projection of T with respect to all synthetic type variables mentioned by T (Â§4.10.5).</p>\n</blockquote>\n<p>To know how the type parameter gets inferred, refer to section <a href=\"https://docs.oracle.com/javase/specs/jls/se17/html/jls-15.html#jls-15.12.2.6\" rel=\"nofollow noreferrer\">15.12.2.6</a>, where it specifies how the <em>invocation type</em> is determined</p>\n<blockquote>\n<p>If the chosen method is generic and the method invocation does not provide explicit type arguments, the invocation type is inferred as specified in Â§18.5.2.</p>\n</blockquote>\n<p>Digging deeper into <a href=\"https://docs.oracle.com/javase/specs/jls/se17/html/jls-18.html#jls-18.5.2\" rel=\"nofollow noreferrer\">18.5.2</a>, we find a lot of rules that are not relevant to your situation - about the case of poly expressions (which the method call in the initialiser of <code>var</code> can never be). In the case of not using <code>var</code>, more bounds would be added in this step. It also mentioned what additional bounds to add when there are argument expressions (which your method has none). The relevant part is that <code>T</code> is eventually <a href=\"https://docs.oracle.com/javase/specs/jls/se17/html/jls-18.html#jls-18.4\" rel=\"nofollow noreferrer\">resolved</a> (section 18.4).</p>\n<p>What constraints are on <code>T</code>? Well, you did not write <code>T extends Something</code>, so the only bound is <code>T &lt;: Object</code>. (See the end of section <a href=\"https://docs.oracle.com/javase/specs/jls/se17/html/jls-18.html#jls-18.1.3\" rel=\"nofollow noreferrer\">18.1.3</a>) This just means <code>T</code> must be a subtype of <code>Object</code>. In other words, <code>Object</code>  is the only <em>lower bound</em> of <code>T</code>. If you declare the method with <code>&lt;T extend SomeOtherType&gt;</code>, then it would have <code>SomeOtherType</code> as a lower bound.</p>\n<p>The section about resolution is quite long, but the relevant thing here is that lower bounds are resolved to their <a href=\"https://docs.oracle.com/javase/specs/jls/se17/html/jls-4.html#jls-4.10.4\" rel=\"nofollow noreferrer\">least upper bound</a>, a super type that is more specific than any other common super type the types have.</p>\n<p>Since we only have one lower bound, <code>Object</code>, its least upper bound is trivially itself. Therefore, <code>T</code> is inferred to be <code>Object</code>. You can see this by adding the <code>--debug=verboseResolution=all</code> option when compiling:</p>\n<pre class=\"lang-none prettyprint-override\"><code>JavaClass.java:8: Note: resolving method create in type JavaClass to candidate 0\n        var s = create();\n                ^\n  phase: BASIC\n  with actuals: no arguments\n  with type-args: no arguments\n  candidates:\n      #0 applicable method found: &lt;T&gt;create()\n        (partially instantiated to: ()Set&lt;Object&gt;)\n  where T is a type-variable:\n    T extends Object declared in method &lt;T&gt;create()\nJavaClass.java:8: Note: Deferred instantiation of method &lt;T&gt;create()\n        var s = create();\n                      ^\n  instantiated signature: ()Set&lt;Object&gt;\n  target-type: &lt;none&gt;\n  where T is a type-variable:\n    T extends Object declared in method &lt;T&gt;create()\n</code></pre>\n"
        }
      ],
      "owner": {
        "user_id": 1258130,
        "display_name": "eja"
      },
      "view_count": 84,
      "up_vote_count": 6,
      "answer_count": 2,
      "score": 5,
      "creation_date": 1681808410,
      "question_id": 76042683,
      "body": "<p>Considering a following example of a generic method without any parameters:</p>\n<pre class=\"lang-java prettyprint-override\"><code>private &lt;T&gt; Set&lt;T&gt; create() {\n    return new HashSet&lt;T&gt;();\n}\n</code></pre>\n<p>According to the docs, the type will be inferred depending on how the return value is used, i.e., during assignments, from the LHS type defined, for example:</p>\n<pre class=\"lang-java prettyprint-override\"><code>Set&lt;Integer&gt; numbers = create();\n</code></pre>\n<p>How does this play out when using the <code>var</code> keyword?</p>\n<p>The following will compile:</p>\n<pre class=\"lang-java prettyprint-override\"><code>var numbers = create();\n</code></pre>\n"
    },
    {
      "tags": [
        "java",
        "kotlin"
      ],
      "answers": [
        {
          "owner": {
            "user_id": 1701776,
            "display_name": "BambooleanLogic"
          },
          "up_vote_count": 7,
          "is_accepted": true,
          "creation_date": 1676061930,
          "answer_id": 75415954,
          "body": "<p>Kotlin makes an explicit difference between methods and properties. They are not considered the same thing; it just so happens that both are compiled down to methods in the end since the JVM doesn't natively support properties. As such, a method cannot implement a property since they're fundamentally different.</p>\n<p>The reason why you can't implement a Java getter with a property is the same reason as why you can't implement a Kotlin-defined <code>fun getX(): String</code> with an <code>override val x: String</code>; they're just not compatible.</p>\n<p>The confusion here seems to stem from how Kotlin allows you to access Java getters with a property-like syntax, i.e. <code>val foo = obj.x</code> is equivalent to <code>val foo = obj.getX()</code> if the class is defined in Java.</p>\n<p>This is strictly a one-way relationship to make Kotlin code that interoperates with Java code slightly more compact and &quot;Kotlin-like&quot;; this syntactical shortcut doesn't extend to <em>implementing</em> the method as if it were a property.</p>\n<p>Additionally, if you <em>were</em> to implement a method as a property, that would probably lead to strange effects. Arguably, it would be <em>both</em> a method and a property <em>at the same time</em>, which would not only be <em>weird</em>, but would likely lead to a lot of other unexpected behaviors and edge cases in the language. (For instance, how would it be treated when using reflection?)</p>\n"
        }
      ],
      "owner": {
        "user_id": 1033686,
        "display_name": "Matthew Layton"
      },
      "view_count": 51,
      "up_vote_count": 5,
      "accepted_answer_id": 75415954,
      "answer_count": 1,
      "score": 5,
      "creation_date": 1676061314,
      "question_id": 75415887,
      "body": "<p>Consider the following Java interface</p>\n<pre class=\"lang-java prettyprint-override\"><code>interface Foo {\n    String getValue();\n}\n</code></pre>\n<p>In Kotlin, get/set functions are converted to properties, so I would expect the implementation to look like this</p>\n<pre class=\"lang-kotlin prettyprint-override\"><code>class FooImpl : Foo {\n    val value: String get() = &quot;Hello, World!&quot;\n}\n</code></pre>\n<p>But I actually have to implement the method as it is in the interface</p>\n<pre class=\"lang-kotlin prettyprint-override\"><code>class FooImpl {\n    override fun getValue(): String {\n        return &quot;Hello, World!&quot;;\n    }\n}\n</code></pre>\n<p>Why?</p>\n"
    },
    {
      "tags": [
        "java",
        "performance",
        "regression",
        "java-11",
        "java-13"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 40342,
            "display_name": "Joachim Sauer"
          },
          "edited": false,
          "comment_id": 132912909,
          "body": "You&#39;re still using <a href=\"https://stackoverflow.com/questions/2770321/what-is-a-raw-type-and-why-shouldnt-we-use-it\">raw types</a>? Interesting, but unrelated to your performance. I don&#39;t know anything about this regression. Since you plan to move to 17 anyway, did you check if maybe it&#39;s fixed again in 17?"
        },
        {
          "owner": {
            "user_id": 7928721,
            "display_name": "samabcde"
          },
          "edited": false,
          "comment_id": 132912958,
          "body": "Is there any bench marking(e.g. jmh) to let us verify?"
        },
        {
          "owner": {
            "user_id": 1103863,
            "display_name": "sveri"
          },
          "edited": false,
          "comment_id": 132913023,
          "body": "@JoachimSauer We bought the library and it&#39;s code, we don&#39;t want to change it unless it&#39;s really necessary, so yea, it&#39;s still the old code from almost 2 decades ago. Java 17 has the same performance problems, unfortunately."
        },
        {
          "owner": {
            "user_id": 1103863,
            "display_name": "sveri"
          },
          "edited": false,
          "comment_id": 132913082,
          "body": "@samabcde We only have raw numbers from our internal testing tools, not sure if that&#39;s of any help.  I can setup a test project and bench with jmh if that helps in any way?"
        },
        {
          "owner": {
            "user_id": 40342,
            "display_name": "Joachim Sauer"
          },
          "edited": false,
          "comment_id": 132913136,
          "body": "@sveri: I mean if you could boil it down to a reasonably small <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> then that would of course help (both for this question and your own hunt for a solution), but if it&#39;s really as you said that it&#39;s just many small regressions, then this might be tricky. Personally I&#39;d still try it for a while to see if you find an &quot;easy&quot; culprit."
        },
        {
          "owner": {
            "user_id": 3426309,
            "display_name": "Andrey B. Panfilov"
          },
          "edited": false,
          "comment_id": 132913193,
          "body": "@sveri have you tried to <a href=\"https://openjdk.org/jeps/374\" rel=\"nofollow noreferrer\">re-enable biased locking</a>? I believe <code>&lt;=1.5</code> code is full of StringBuffers, Vectors, HashTables, etc"
        },
        {
          "owner": {
            "user_id": 40342,
            "display_name": "Joachim Sauer"
          },
          "edited": false,
          "comment_id": 132913238,
          "body": "@AndreyB.Panfilov: oh, that&#39;s a good hint. <code>Collections.synchronizedMap</code> probably produces lots of uncontested locking attempts. If re-enabling biased locking helps, then replacing those with <code>ConcurrentHashMap</code>s would probably help as well. (edit: oh, but &quot;Prior to JDK 15, biased locking is always enabled&quot;)."
        },
        {
          "owner": {
            "user_id": 1103863,
            "display_name": "sveri"
          },
          "edited": false,
          "comment_id": 132913341,
          "body": "@AndreyB.Panfilov You are my man, I just ran the test code with reenabled biased locking and Java 17 and the numbers are even a bit better than with Java 11. Awesome, if you provide this as answer, I will accept it."
        },
        {
          "owner": {
            "user_id": 2711488,
            "display_name": "Holger"
          },
          "edited": false,
          "comment_id": 132994268,
          "body": "Just because you paid for it, doesnâ€™t make it code worth keeping. Itâ€™s poor code, even by the old standards 1.) pointless lazy initialization, far more expensive than its supposed savings 2) overuse of synchronization, 3) no-idiomatic test for the presence of a key; instead of <code>Value v = (Value) ht.get(key); if (v != null) return ht;</code>, you can just use <code>if(ht.containsKey(key)) return ht;</code> 4) non-idiomatic loop. What you have here, is a classical for loop: <code>for(Context c = this; c != null; c = c.m_parent) { Map ht = c.getVariables(); if(ht.containsKey(key)) return ht; } return null;</code>"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 3426309,
            "display_name": "Andrey B. Panfilov"
          },
          "up_vote_count": 7,
          "is_accepted": true,
          "creation_date": 1675349458,
          "answer_id": 75324918,
          "body": "<p>Based on the fact the library you are using was written for <code>Java 1.5</code>, that time we were primarily using <code>synchronized</code> keyword to write thread-safe code, I would say the root cause of performance degradation you are observing now is <a href=\"https://openjdk.org/jeps/374\" rel=\"noreferrer\">JEP 374: Deprecate and Disable Biased Locking\n</a></p>\n"
        }
      ],
      "owner": {
        "user_id": 1103863,
        "display_name": "sveri"
      },
      "view_count": 90,
      "up_vote_count": 5,
      "accepted_answer_id": 75324918,
      "answer_count": 1,
      "score": 5,
      "creation_date": 1675347485,
      "question_id": 75324470,
      "body": "<p>we are using Jess, which is a rules engine, written in Java. It has become pretty old and most of it is written using Java 1.5 and lower language features.\nNow, we are using this for many years and never noticed any problems during the Java upgrades, until now, when we plan to switch from Java 11 to Java 17.</p>\n<p>Our runtime has become 30-40% slower, just by switching the java version. We did a lot of testing already, but cannot really find the one culprit.<br />\nFor instance, we checked different Java versions and different vendors (eclipse, azul and orcacle), everything from 13+ was slower than Java 11.</p>\n<p>Using VisualVM I was able to point down to a few methods, but there is nothing specific in there where I would say that this could be the problem.<br />\nLooking at it, it seems like there are multiple performance regressions that sum together to a big one, but that seems pretty unrealistic.</p>\n<p>Some of the functions look like this:</p>\n<pre><code>    private synchronized Map findVariable(String key) {\n        Context c = this;\n        while (c != null) {\n            Map ht = c.getVariables();\n            Value v = (Value) ht.get(key);\n            if (v != null)\n                return ht;\n            else\n                c = c.m_parent;\n        }\n        return null;\n    }\n\n    private synchronized Map getVariables() {\n        if (m_variables == null)\n            m_variables = Collections.synchronizedMap(new HashMap());\n\n        return m_variables;\n    }\n</code></pre>\n<p>Do you know if there are any know regressions going on from J13+, maybe regarding synchronized functions and variables for instances?</p>\n<p>Any other pointers what might be the problem?</p>\n"
    },
    {
      "tags": [
        "java",
        "comparison"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 5103317,
            "display_name": "Old Dog Programmer"
          },
          "edited": false,
          "comment_id": 132858363,
          "body": "Which line of code throws the NPE?"
        },
        {
          "owner": {
            "user_id": 1081110,
            "display_name": "Dawood ibn Kareem"
          },
          "edited": false,
          "comment_id": 132858382,
          "body": "@OldDogProgrammer The second line is the only one that can throw an NPE.  (Unless someone does something silly like <code>System.setOut(null);</code>)."
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 9513184,
            "display_name": "Unmitigated"
          },
          "up_vote_count": 6,
          "is_accepted": true,
          "creation_date": 1675130119,
          "answer_id": 75291958,
          "body": "<p>The type of the conditional expression is inferred as <code>double</code>, so you get a <code>NullPointerException</code> when the program attempts to unbox <code>value</code> (which is <code>null</code>) as a primitive <code>double</code>.</p>\n<p>To make the expression have a <code>Double</code> result (which can store <code>null</code>), cast <code>0.0</code> to <code>Double</code>.</p>\n<pre class=\"lang-java prettyprint-override\"><code>Double v = value != null &amp;&amp; value.isNaN() ? (Double) 0.0 : value\n</code></pre>\n<p>See <a href=\"https://docs.oracle.com/javase/specs/jls/se8/html/jls-15.html#jls-15.25.2\" rel=\"noreferrer\">Â§15.25.2. Numeric Conditional Expressions</a> for more details.</p>\n"
        },
        {
          "owner": {
            "user_id": 7237884,
            "display_name": "Panagiotis Bougioukos"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1675243947,
          "answer_id": 75308098,
          "body": "<p>Just to extend the above accepted answer which is to the point but you may as well avoid casting here.</p>\n<pre><code>   Double value = null;\n   Double v = value != null &amp;&amp; value.isNaN() ? Double.valueOf(0.0) : value;\n   System.out.println(v);\n</code></pre>\n<p>The <code>Double.valueOf(0.0)</code> will provide a <code>Double</code> in first type of condition which will make the conditional operator to evaluate into the type of <code>Double</code> since <code>value</code> is as well of type <code>Double</code>. So if no participant of condition is of primitive type <code>double</code>, it will not try any unboxing and a NPE will not be thrown.</p>\n"
        }
      ],
      "owner": {
        "user_id": 16177734,
        "display_name": "Vic Investa"
      },
      "view_count": 121,
      "up_vote_count": 5,
      "accepted_answer_id": 75291958,
      "answer_count": 2,
      "score": 5,
      "creation_date": 1675129640,
      "question_id": 75291929,
      "body": "<p>Why does this work:</p>\n<pre><code>String a = null;\nString b = a != null &amp;&amp; a.equals(&quot;Nan&quot;) ? &quot;Nan&quot; : a;\nSystem.out.println(b);\n</code></pre>\n<p>but this produces NPE:</p>\n<pre><code>Double value = null;\nDouble v = value != null &amp;&amp; value.isNaN() ? 0.0 : value;\nSystem.out.println(v);\n</code></pre>\n<p>Rewriting it as:</p>\n<pre><code>Double value = null;\nDouble v;\nif (value != null &amp;&amp; value.isNaN()) {\n    v = 0.0;\n} else {\n    v = value;\n}\n</code></pre>\n<p>of course works as expected. But why do I get NPE using the ternary/conditional operator when using <code>Double</code> and no NPE when using <code>String</code>? What am I missing?</p>\n"
    },
    {
      "tags": [
        "java",
        "algorithm",
        "search",
        "set"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 18157,
            "display_name": "Jim Garrison"
          },
          "edited": false,
          "comment_id": 132692524,
          "body": "It&#39;s not clear what you&#39;re trying to accomplish, but this is almost surely wrong <code>Map&lt;HashSet&lt;String&gt;, String&gt; map = new HashMap&lt;&gt;();</code>  You should never use a mutable object as the <i>key</i> in a map, you&#39;ll regret it at 4 AM troubleshooting an &quot;impossible&quot; bug.  Please provide some examples (not in code) of what you are trying to do."
        },
        {
          "owner": {
            "user_id": 13061224,
            "display_name": "siggemannen"
          },
          "edited": false,
          "comment_id": 132693261,
          "body": "Can Set.retainAll be of service? it will keep only items matching the passed collection. If you pass all your other Sets in a loop, it will only keep the items matching all the sets. Watch out that it will change the original set, so might wanna make a copy of it first."
        },
        {
          "owner": {
            "user_id": 10662977,
            "display_name": "Samuel Squire"
          },
          "edited": false,
          "comment_id": 132694250,
          "body": "The data one in the set should not change, but I want to search a set of named sets for a union with a set of any items in the map."
        },
        {
          "owner": {
            "user_id": 10662977,
            "display_name": "Samuel Squire"
          },
          "edited": false,
          "comment_id": 132705116,
          "body": "As an example, If I have the &quot;fruits&quot; set with [&quot;orange&quot;, &quot;kiwi&quot;, &quot;apple&quot;] and &quot;vegetables&quot; set with [&quot;cabbage&quot;, &quot;carrot&quot;, &quot;broccoli&quot;]. I want a search for [&quot;orange&quot;, &quot;kiwi&quot;] to match &quot;fruits&quot;"
        },
        {
          "owner": {
            "user_id": 12763954,
            "display_name": "Olivier"
          },
          "edited": false,
          "comment_id": 132971724,
          "body": "How many sets do you have? How many elements in them?"
        },
        {
          "owner": {
            "user_id": 2711488,
            "display_name": "Holger"
          },
          "edited": false,
          "comment_id": 132975243,
          "body": "Your set <code>partialSearch</code> is not used anywhere. Instead, you add even more elements to the already existing <code>search</code> and use that. Besides that, you should clarify whether your sets really have to be <code>HashSet</code> instances or could be replaced by better suited objects."
        },
        {
          "owner": {
            "user_id": 10662977,
            "display_name": "Samuel Squire"
          },
          "edited": false,
          "comment_id": 132983286,
          "body": "I&#39;ve since fixed the code. Sorry about that. I am happy to use any data structure as long as I can do a search against many sets of many items for a set with a partial list. Assume the data fits in RAM and is typical objects used for business object processing. I don&#39;t understand what the canonical &quot;union find&quot; algorithm does and if it is relevant to what I&#39;m trying to do. I just want to replace a for loop with a hash or something to do a check if a list of items (a set) is partially inside another list of lists / sets and which one."
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 5231798,
            "display_name": "Moemen"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1675710660,
          "answer_id": 75365604,
          "body": "<ol>\n<li><p>You need to use <code>Map&lt;String, HashSet&lt;String&gt;&gt; map = new HashMap&lt;&gt;();</code> instead.</p>\n</li>\n<li><p>The following solution finds all set names which contain all elements in &quot;search&quot; set.</p>\n<pre><code>HashSet&lt;String&gt; vegetables = new HashSet&lt;&gt;();\nvegetables.add(&quot;tomato&quot;);\nvegetables.add(&quot;carrot&quot;);\nvegetables.add(&quot;broccoli&quot;);\nHashSet&lt;String&gt; fruit = new HashSet&lt;&gt;();\nfruit.add(&quot;apple&quot;);\nfruit.add(&quot;kiwi&quot;);\nfruit.add(&quot;orange&quot;);\n\nMap&lt;String, HashSet&lt;String&gt;&gt; map = new HashMap&lt;&gt;();\nmap.put(&quot;vegetables&quot;, vegetables);\nmap.put(&quot;fruit&quot;, fruit);\n\nHashSet&lt;String&gt; search = new HashSet&lt;&gt;();\nsearch.add(&quot;tomato&quot;);\nsearch.add(&quot;carrot&quot;);\n//search.add(&quot;broccoli&quot;);\n\nSet&lt;String&gt; nameOfSets = map.entrySet().stream()\n        .filter(entry -&gt; entry.getValue().containsAll(search))\n        .map(Map.Entry::getKey).collect(Collectors.toSet());\n</code></pre>\n</li>\n</ol>\n"
        },
        {
          "owner": {
            "user_id": 12779324,
            "display_name": "Darsh Gondalia"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1675796088,
          "answer_id": 75377774,
          "body": "<p>As far as I understand your problem, you are trying to classify different vegetables and fruits and store the names of the vegetables and fruits just once.\nAnd you want to retrieve the type of food item by the name of the food item.</p>\n<p>The way you are describing your search query,</p>\n<p>&quot;If I have the &quot;fruits&quot; set with [&quot;orange&quot;, &quot;kiwi&quot;, &quot;apple&quot;] and &quot;vegetables&quot; set with [&quot;cabbage&quot;, &quot;carrot&quot;, &quot;broccoli&quot;]. I want a search for [&quot;orange&quot;, &quot;kiwi&quot;] to match &quot;fruits&quot;</p>\n<p>You would have to iterate through the parameter array ([&quot;orange&quot;, &quot;kiwi&quot;]) and look for matches. You can keep a count for how many in the search parameter are vegetables and how many are fruits.</p>\n<p>Storing your data works in the same way as described by Moemen. It would be</p>\n<p><code>Map&lt;String, HashSet&lt;String&gt;&gt; map = new HashMap&lt;&gt;();</code></p>\n<p>The type of variable (&quot;vegetables&quot;, &quot;fruits&quot;) will be key stored as a string, and your items would be in a Hashset.</p>\n<p>In its entirety, the map would look something like:</p>\n<p>Map-&gt; &quot;Vegetables&quot;: [&quot;tomato&quot;, &quot;broccoli&quot;, &quot;carrot&quot;],</p>\n<pre><code>  &quot;fruits&quot;: [&quot;apple&quot;, &quot;kiwi&quot;, &quot;orange&quot;]\n</code></pre>\n<p>A second approach to this would be to have a map of string pointing to string.</p>\n<p>map=&gt;{string:string}</p>\n<p>This map you can input data and make it so:</p>\n<p>map-&gt; &quot;orange&quot;: &quot;fruit&quot;,</p>\n<pre><code>  &quot;apple&quot;: &quot;fruit&quot;,\n\n  &quot;carrot&quot;: &quot;vegetable&quot; and so on.\n</code></pre>\n<p>This way you would be able to run a loop through the search food items and retrieve whether they are fruits or vegetables.</p>\n<p>I am almost certain that food items combined cannot be used to query a map. Meaning, you will have to go element by element. So [&quot;orange&quot;, &quot;apple&quot;], you would have to have a loop for looking for the type of orange and then apple.</p>\n<p>Hope this answers your questions and gives you an insight on planning structures for data storage.</p>\n"
        },
        {
          "owner": {
            "user_id": 14183092,
            "display_name": "kerbermeister"
          },
          "up_vote_count": 3,
          "is_accepted": false,
          "creation_date": 1675796364,
          "answer_id": 75377829,
          "body": "<p>Actually your question is quite broad, this is topic is really huge, there are many details ommitted, however, I'll offer and explain different approaches. Also we'll try to review bloom filters and union operations you mentioned.</p>\n<h1>Let's consider some assumptions first</h1>\n<ul>\n<li>We're dealing with <strong>unique</strong> items within a single collection</li>\n<li>Starting from here we will call our goal as finding the <strong>intersections</strong> of our collection</li>\n<li>Namely our goal is to find all the <strong>full intersections</strong> with our collection. That means we want to find all the collections that contain <strong>all values</strong> of our collection</li>\n<li>We're dealing with <strong>Strings</strong> as values</li>\n<li>When comparing values, we are looking for <strong>exact</strong> match</li>\n<li>We omit the details <strong>HOW</strong> we actually initialize our collections, this is out of the question scope. We consider only the way how do we search those intersections.</li>\n<li>We're not implementing any low-level logic by our own. We're just using any existing library for these tasks, just focusing on principles.</li>\n<li>The examples below are not &quot;best-written&quot; solutions. Those are just to demonstrate the ideas</li>\n</ul>\n<p>To simplify code writing we'll use <a href=\"https://github.com/google/guava\" rel=\"nofollow noreferrer\">Java Google Guava library</a></p>\n<p>Maven <code>pom.xml</code> dependency to add to our project:</p>\n<pre><code>&lt;!-- https://mvnrepository.com/artifact/com.google.guava/guava --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;com.google.guava&lt;/groupId&gt;\n    &lt;artifactId&gt;guava&lt;/artifactId&gt;\n    &lt;version&gt;31.1-jre&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>Having that said, let's take a look to different approaches:</p>\n<h1>Pretty straightforward way</h1>\n<p>As we're dealing with strings, in case if we have primarily quite long strings they could take too many space in RAM memory. But as long as we don't care about the actual values of these strings in our collections, we may use only hash codes of them. If our strings are primarily short, then there's no need to hash them, we can just use them as they are.</p>\n<p>Let's assume that our strings may be quite long (in real world, for example, URLs).\nWhat algorithm for hashing should we use? Well, it really depends, but the main goal is to achieve uniqueness to prevent collissions as much as possible. So in this example we'll use <a href=\"https://en.wikipedia.org/wiki/SHA-2\" rel=\"nofollow noreferrer\">SHA-256</a> hashing algorithm which gives 256-bit output.</p>\n<p>So, the way we would search for intersections in this approach is the following:</p>\n<pre><code>public static void main(String[] args) {\n    // initialize the first set in which we'll perform searching\n    Set&lt;HashCode&gt; vegetables = Set.of(\n            hash256(&quot;tomato&quot;),\n            hash256(&quot;carrot&quot;),\n            hash256(&quot;broccoli&quot;)\n    );\n    // initialize the second set in which we'll perform searching\n    Set&lt;HashCode&gt; fruit = Set.of(\n            hash256(&quot;apple&quot;),\n            hash256(&quot;kiwi&quot;),\n            hash256(&quot;orange&quot;)\n    );\n    // collecting those collections to Map, where key = collection name, value = collection itself\n    Map&lt;String, Set&lt;HashCode&gt;&gt; targetMap = Map.of(&quot;vegetables&quot;, vegetables, &quot;fruit&quot;, fruit);\n\n    // initialize set for searching full intersections\n    Set&lt;HashCode&gt; search = Set.of(hash256(&quot;tomato&quot;), hash256(&quot;carrot&quot;));\n\n    // let's search\n    Set&lt;String&gt; intersections = targetMap.entrySet().stream()\n            // skip sets which size is lower than search set size\n            .filter(target -&gt; target.getValue().size() &gt;= search.size())\n            // check the rest sets with containsAll()\n            .filter(entry -&gt; entry.getValue().containsAll(search))\n            .map(Map.Entry::getKey).collect(Collectors.toSet());\n    // print names of sets which intersect with our search set\n    System.out.println(results);\n}\n\n// using Guava library to get 256-bit hash of string\npublic static HashCode hash256(String input) {\n    HashFunction hashFunction = Hashing.sha256();\n    return hashFunction.hashString(input, StandardCharsets.UTF_8);\n}\n</code></pre>\n<p>Note: while iterating through the sets we first skip all the sets which size is less than our search set, just for optimization sake. Obviously there's no sense to check those sets since it is guaranteed that they don't have enough elements for full intersection with our search set. Also, you can add <code>equals()</code> checking if you want to check whether the search set is the actual instance of the target set.</p>\n<h1>Using Bloom Filter</h1>\n<p>A <a href=\"https://en.wikipedia.org/wiki/Bloom_filter\" rel=\"nofollow noreferrer\">Bloom filter</a> is a probabilistic data structure that is good for checking whether or not an element is definitely not in a set, but cannot tell you for sure whether something is in the set. A query returns either &quot;possibly in set&quot; or &quot;definitely not in set&quot;. A bloom filter doesn't store the elements themselves, this is the crucial point. You don't use a bloom filter to test if an element is present, you use it to test whether it's certainly not present, since it guarantees no false negatives. And it takes <strong>significantly</strong> less space comparing to a hash table/hash set and etc. and <strong>speeds up</strong> the checking.</p>\n<p>The bloom filter works by taking the elements, running them through N different hash functions each with an accompanying bit vector, and then setting to True the position in the accompanying vector based on the hash observed. Once the position is flipped True (1), it is never set back to False (0).</p>\n<p>The number of different hash functions N, as well as the length of the bit vectors, is usually reverse engineered in the implementation based on a configured capacity and maximum allowed error rate. Capacity is the number of distinct elements we expect to ever be seen by the bloom filter.</p>\n<p><a href=\"https://i.stack.imgur.com/jmtUr.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jmtUr.jpg\" alt=\"enter image description here\" /></a></p>\n<p>Of course, it has disadvantages:</p>\n<ul>\n<li>Probabilistic in nature. It has false positive probability</li>\n<li>Bloom filters add complexity. Complexity is more opportunity for things to go wrong</li>\n<li>You should take care of cap of <em>expected insertions</em> since the overflowing a bloom filter with significantly more elements than specified, will result in its saturation, and a sharp deterioration of its false positive probability.</li>\n<li>Cannot delete the inserted elements</li>\n</ul>\n<p>So, using Guava library which has implementation of Bloom Filter we could write our code the following way:</p>\n<pre><code>public static void main(String[] args) throws IOException {\n    // initialize the first set in which we'll perform searching\n    Set&lt;String&gt; vegetables = Set.of(&quot;tomato&quot;, &quot;carrot&quot;, &quot;broccoli&quot;);\n    // initialize the second set in which we'll perform searching\n    Set&lt;String&gt; fruit = Set.of(&quot;apple&quot;, &quot;kiwi&quot;, &quot;orange&quot;);\n\n    // preparing our blooms.\n    // assign expectedAssertions for test = 100.\n    // assign fpp (the desired false positive probability) to 0.01 = 1%\n    int expectedAssertions = 100;\n    BloomFilter&lt;String&gt; vegetablesBloom = BloomFilter.create(\n            Funnels.stringFunnel(StandardCharsets.UTF_8), expectedAssertions, 0.01);\n    BloomFilter&lt;String&gt; fruitBloom = BloomFilter.create(\n            Funnels.stringFunnel(StandardCharsets.UTF_8), expectedAssertions, 0.01);\n\n    // put all the vegetables and fruits to blooms\n    vegetables.forEach(vegetablesBloom::put);\n    fruit.forEach(fruitBloom::put);\n    // collecting those blooms to Map, where key = bloom name, value = bloom itself\n    Map&lt;String, BloomFilter&lt;String&gt;&gt; targetMap =\n            Map.of(&quot;vegetables&quot;, vegetablesBloom, &quot;fruit&quot;, fruitBloom);\n\n    // initialize set for searching full intersections\n    Set&lt;String&gt; search = Set.of(&quot;tomato&quot;, &quot;carrot&quot;);\n\n    Set&lt;String&gt; results = targetMap.entrySet().stream()\n            // skip blooms which size is lower than search set size\n            .filter(entry -&gt; entry.getValue().approximateElementCount() &gt;= search.size())\n            .filter(entry -&gt; intersect(search, entry.getValue()))\n            .map(Map.Entry::getKey).collect(Collectors.toSet());\n\n    System.out.println(results);\n}\n\n// check intersection of our search set with bloom\npublic static boolean intersect(Set&lt;String&gt; search, BloomFilter&lt;String&gt; bloomFilter) {\n    for (String value : search) {\n        // return false immediately if this is definitely not the case.\n        if (!bloomFilter.mightContain(value)) {\n            return false;\n        }\n    }\n    return true;\n} \n</code></pre>\n<p>Pay attention to <code>expectedAssertions</code> parameter. This is <code>fpp</code> - the desired false positive probability (must be positive and less than 1.0). Our bloom is more accurate the less value we provide, however, the more it accurate, the more memory our bloom takes.</p>\n<p>Here we're iterating through our <strong>blooms</strong> checking each element from our search collection in it with <code>mightContain(value)</code> if it says <code>false</code>, then we're sure this is not the case, this bloom is not intersected with our set.</p>\n<h1>Intersection with Union operation on Bloom Filter</h1>\n<p>In the previous approach we were checking each element of our search collection with bloom filter. One operation you can do with two bloom filters is union them, which means that if you have a bloom filter A and bloom filter B, you end up with a third bloom filter C that contains all the unique items from both A and B. How you union two bloom filters is you just do a bitwise OR on every bit in A and B to get the bits for C. Simple and fast to calculate.</p>\n<p>But by itself this operation cannot be useful in our case. However, we can use it to perform the intersection checking. How can we achieve this?</p>\n<p>Well, there's some math included:</p>\n<blockquote>\n<p>Count(Intersection(A,B)) = (Count(A) + Count(B)) â€“ Count(Union(A,B))</p>\n</blockquote>\n<p>Having that said, let's try to perform this.</p>\n<p>Change the piece of code of previous approch to the following:</p>\n<pre><code>// prepare our search bloom\nBloomFilter&lt;String&gt; searchBloom = BloomFilter.create(\n        Funnels.stringFunnel(StandardCharsets.UTF_8), expectedAssertions, 0.01);\nsearch.forEach(searchBloom::put);\n\nSet&lt;String&gt; results = targetMap.entrySet().stream()\n        // skip blooms which size is lower than search set size\n        .filter(entry -&gt; entry.getValue().approximateElementCount() &gt;= search.size())\n        .filter(entry -&gt; intersectWithUnion(searchBloom, entry.getValue()))\n        .map(Map.Entry::getKey).collect(Collectors.toSet());\n\nSystem.out.println(results);\n</code></pre>\n<p>And <code>intersectWithUnion()</code> method:</p>\n<pre><code>// check intersection of our search bloom with bloom\npublic static boolean intersectWithUnion(BloomFilter&lt;String&gt; searchBloom, BloomFilter&lt;String&gt; bloomFilter) {\n    long searchCount = searchBloom.approximateElementCount();\n    long targetCount = bloomFilter.approximateElementCount();\n    // making a copy of search bloom\n    BloomFilter&lt;String&gt; union = searchBloom.copy();\n    // perform union operation\n    union.putAll(bloomFilter);\n\n    // apply our formula\n    long intersectionFactor = (searchCount + targetCount) - union.approximateElementCount();\n    // if intersection factor is equal to initial search count, then we have full intersection\n    return intersectionFactor == searchCount;\n}\n</code></pre>\n<p>Here we creating a bloom from our search set first. Then check the intersection of each bloom with our new method. The union operation is implemented in Guava library with <a href=\"https://guava.dev/releases/18.0/api/docs/com/google/common/hash/BloomFilter.html#putAll(com.google.common.hash.BloomFilter)\" rel=\"nofollow noreferrer\">putAll()</a> method. Why do we call <code>copy()</code> on our search bloom? Well, as docs of <code>putAll()</code> states:</p>\n<blockquote>\n<p>Combines this Bloom filter with another Bloom filter by performing a\nbitwise OR of the underlying data. The mutations happen to <strong>this</strong>\ninstance. Callers must ensure the Bloom filters are appropriately\nsized to avoid saturating them.</p>\n</blockquote>\n<p>So, <code>putAll()</code> mutates our bloom. This <code>copy()</code> is our overhead in this case.</p>\n<p><strong>Important note:</strong>\nTo perform union operation the blooms must be <strong>compatible</strong>. Basically they must have the same <em>expectedAssertions</em> and <em>fpp</em>. To be compatible there are requirements:</p>\n<ol>\n<li>BloomFilters must have the same number of hash functions</li>\n<li>BloomFilters must have the same size underlying bit arrays</li>\n<li>BloomFilters must have equal strategies</li>\n<li>BloomFilters must have equal funnels</li>\n</ol>\n<p>Otherwise <code>IllegalArgumentException</code> will be thrown.</p>\n<h1>What approach should we use?</h1>\n<p>Well, there's no direct answer to this question, as it really depends to a lot of factors in your real case. There's no &quot;always better&quot; or &quot;always performant&quot; cases. Bloom filters are very useful and very memory-cheap when dealing with <strong>huge</strong> amount of data, for example, millions and millions of strings. But it has it's own disadvantages. In simple cases where you have not so much data it is definitely better to use some straight approach. Hope it hepls :)</p>\n<p>Also, an <a href=\"https://blog.demofox.org/2015/02/08/estimating-set-membership-with-a-bloom-filter/\" rel=\"nofollow noreferrer\">interesting article about bloom filters</a></p>\n"
        },
        {
          "owner": {
            "user_id": 1617548,
            "display_name": "vin"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1675856884,
          "answer_id": 75385375,
          "body": "<p>Another way of looking at this is preparing an index over the component sets which here are <code>fruits</code> and <code>vegetables</code></p>\n<p>A pythonic way to do this would be as follows. I am sure similar can be easily done in java</p>\n<pre><code>&gt;&gt;&gt; lookup = defaultdict(lambda: set())\n&gt;&gt;&gt; populate_lookup = lambda x, y: [lookup[elem].add(y) for elem in x]\n&gt;&gt;&gt; populate_lookup([&quot;orange&quot;, &quot;kiwi&quot;, &quot;apple&quot;], &quot;fruits&quot;)\n[None, None, None]\n&gt;&gt;&gt; populate_lookup([&quot;cabbage&quot;, &quot;carrot&quot;, &quot;broccoli&quot;], &quot;vegetables&quot;)\n[None, None, None]\n&gt;&gt;&gt; search_matching = lambda x: set.intersection(*[lookup[elem] for elem in x])\n&gt;&gt;&gt; search_matching([&quot;orange&quot;, &quot;kiwi&quot;])\n{'fruits'}\n&gt;&gt;&gt;\n\n</code></pre>\n<p>Where lookup is simply a reverse dict of the elems</p>\n<pre><code>&gt;&gt;&gt; dict(lookup)\n{'orange': {'fruits'}, 'kiwi': {'fruits'}, 'apple': {'fruits'}, 'cabbage': {'vegetables'}, 'carrot': {'vegetables'}, 'broccoli': {'vegetables'}}\n&gt;&gt;&gt;\n</code></pre>\n<p>If you want to solve this for a service using SQL and tables, I would suggest looking at GIN indexes in Postgres.</p>\n<p>EDITED (Added)</p>\n<p>An alternative to <code>intersection</code> would be a counter as follows, not necessarily an optimization (set intersection will only look at the smallest set)</p>\n<pre><code>search_matching_counter = lambda x: [xi[0] for xi in Counter([set_name for elem in x for set_name in lookup[elem]]).items() if xi[1] == len(x)]\n\nsearch_matching_counter([&quot;orange&quot;, &quot;kiwi&quot;])\n['fruits']\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 16702058,
            "display_name": "Hi computer"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1676023215,
          "answer_id": 75409502,
          "body": "<p>You can use inverted index, <a href=\"https://sease.io/2015/07/exploring-solr-internals-lucene.html#:%7E:text=The%20Inverted%20Index%20is%20the,the%20end%20of%20a%20book.\" rel=\"nofollow noreferrer\">lucene</a> uses it.</p>\n<pre><code>                vegetables(Document)    fruit(Document)\ntomato               +\ncarrot               +\nbroccoli             +\napple                                         +\nkiwi                                          +\norange                                        +\n</code></pre>\n<p>Other answers are probably saying the same, invert the map and search item one by one.</p>\n<p>If you have a lot of those set, better insert into database like elastic search that uses inverted index too, or use full-text search engine on mysql(still uses inverted index).</p>\n"
        },
        {
          "owner": {
            "user_id": 21063779,
            "display_name": "Lae"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1676086395,
          "answer_id": 75417945,
          "body": "<p>You can build an index mapping each item (e.g. apple) to all the sets that contain it, then look them up at search time and count how many matches each contains:</p>\n<pre class=\"lang-java prettyprint-override\"><code>package com.example;\n\nimport java.util.Collection;\nimport java.util.HashMap;\nimport java.util.HashSet;\nimport java.util.List;\nimport java.util.Map;\nimport java.util.Objects;\nimport java.util.Set;\n\nimport static java.util.function.Function.identity;\nimport static java.util.stream.Collectors.toMap;\n\npublic class Sets {\n\n  public static void main(String[] args) {\n\n    var vegetables = Set.of(&quot;tomato&quot;, &quot;carrot&quot;, &quot;broccoli&quot;);\n    var fruits = Set.of(&quot;apple&quot;, &quot;kiwi&quot;, &quot;orange&quot;);\n    var random = Set.of(&quot;tomato&quot;, &quot;rock&quot;);\n\n    /*\n     * A map where the key is an item (e.g. apple) and its value is a collection of all the sets\n     * that contain this item.\n     */\n    var index = new HashMap&lt;String, Set&lt;Set&lt;String&gt;&gt;&gt;();\n    for (Set&lt;String&gt; items : List.of(vegetables, fruits, random)) {\n      for (String item : items) {\n        index.computeIfAbsent(item, key -&gt; new HashSet&lt;&gt;()).add(items);\n      }\n    }\n\n    var search = Set.of(&quot;tomato&quot;, &quot;broccoli&quot;);\n\n    /*\n     * For each of the terms in the search, find all the sets that contain each, and produce a map\n     * where the key is the set, and the value is the number of search terms the set matches.\n     */\n    var atLeastOneMatches =\n        search.stream()\n            .collect(toMap(identity(), item -&gt; index.getOrDefault(item, Set.of())))\n            .values()\n            .stream()\n            .flatMap(Collection::stream)\n            .collect(toMap(identity(), it -&gt; 1, Integer::sum));\n\n    var extractMatches =\n        atLeastOneMatches.entrySet().stream()\n            .filter(entry -&gt; entry.getValue() == search.size())\n            .map(Map.Entry::getKey)\n            .toList();\n\n    System.out.println(&quot;Search term(s): &quot; + search);\n    System.out.println(\n        &quot;Set(s) that contain at least one of the search terms: &quot; + atLeastOneMatches.keySet());\n    System.out.println(&quot;Set(s) that contain all of the search terms: &quot; + extractMatches);\n  }\n}\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 21194044,
            "display_name": "gavgav"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1676188664,
          "answer_id": 75425601,
          "body": "<p>You could gather all items' sets (tags), like\norange -&gt; fruits\nkiwi -&gt; fruits\n...</p>\n<p>and then loop input items to narrow down resulting intersection.</p>\n<p>Something like this below. Note I used Set for map value type because one item could exist in multiple sets (even though the fruits/vegetables sample data does not)</p>\n<pre><code>import java.util.Collection;\nimport java.util.Iterator;\nimport java.util.Map;\nimport java.util.Set;\nimport java.util.TreeSet;\n\npublic class a {\n    private static final Map&lt;String, Set&lt;String&gt;&gt; ITEM_TAGS = Map.of(\n        &quot;orange&quot;, Set.of(&quot;fruits&quot;),\n        &quot;kiwi&quot;, Set.of(&quot;fruits&quot;),\n        &quot;apple&quot;, Set.of(&quot;fruits&quot;),\n        &quot;cabbage&quot;, Set.of(&quot;vegetables&quot;),\n        &quot;carrot&quot;, Set.of(&quot;vegetables&quot;),\n        &quot;broccoli&quot;, Set.of(&quot;vegetables&quot;)\n    );\n    \n    private static Collection&lt;String&gt; getTags(Set&lt;String&gt; items){\n        if (items == null || items.isEmpty()) {\n            return Set.of();\n        }\n        else if (items.size() == 1) {\n            return ITEM_TAGS.get(items.iterator().next());\n        }\n        \n        Iterator&lt;String&gt; iterItems = items.iterator();\n        Set&lt;String&gt; tagScope = ITEM_TAGS.get(iterItems.next());\n        if (tagScope == null || tagScope.isEmpty()) {\n            return Set.of();\n        }\n        \n        Set&lt;String&gt; result = new TreeSet&lt;&gt;(tagScope);\n        while (iterItems.hasNext() &amp;&amp; !result.isEmpty()) {\n            Set&lt;String&gt; scope = ITEM_TAGS.get(iterItems.next());\n            if (scope == null || scope.isEmpty()) {\n                result.clear();\n            }\n            else {\n                result.retainAll(scope);\n            }\n        }\n        \n        return result;\n    }\n    \n    public static void main(String[] args) {\n        Collection&lt;String&gt; fruits = getTags(Set.of(&quot;orange&quot;, &quot;kiwi&quot;));\n        System.out.println(fruits);\n    }\n}\n</code></pre>\n"
        }
      ],
      "owner": {
        "user_id": 10662977,
        "display_name": "Samuel Squire"
      },
      "view_count": 1025,
      "up_vote_count": 5,
      "answer_count": 7,
      "score": 5,
      "creation_date": 1674308555,
      "question_id": 75193776,
      "body": "<p>If I have lots of sets of strings and they each have different items in them and some of them have items that overlap.</p>\n<p>I want to search for the set that is the union of all the items in the search set.</p>\n<p>Is there something I can do with hashing?</p>\n<p>Is the union find the right algorithm?</p>\n<p>Is it a bloom filter I want?</p>\n<p>In the following example, I can first check if there is an exact match by relying on <code>equals</code> of HashSet.</p>\n<p>I search each set and do a <code>containsAll</code> to see if it is union with the search set.</p>\n<p>As an example, If I have the &quot;fruits&quot; set with [&quot;orange&quot;, &quot;kiwi&quot;, &quot;apple&quot;] and &quot;vegetables&quot; set with [&quot;cabbage&quot;, &quot;carrot&quot;, &quot;broccoli&quot;]. I want a search for [&quot;orange&quot;, &quot;kiwi&quot;] to match &quot;fruits&quot;</p>\n<p>There must be a more better approach than this, but I'm not sure.</p>\n<pre><code>package main;\n\nimport java.util.HashMap;\nimport java.util.HashSet;\nimport java.util.Map;\n\npublic class SetKeyHash {\n\n    public static void main(String args[]) {\n        HashSet&lt;String&gt; vegetables = new HashSet&lt;&gt;();\n        vegetables.add(&quot;tomato&quot;);\n        vegetables.add(&quot;carrot&quot;);\n        vegetables.add(&quot;broccoli&quot;);\n        HashSet&lt;String&gt; fruit = new HashSet&lt;&gt;();\n        fruit.add(&quot;apple&quot;);\n        fruit.add(&quot;kiwi&quot;);\n        fruit.add(&quot;orange&quot;);\n\n        Map&lt;HashSet&lt;String&gt;, String&gt; map = new HashMap&lt;&gt;();\n        map.put(vegetables, &quot;vegetables&quot;);\n        map.put(fruit, &quot;fruit&quot;);\n\n        HashSet&lt;String&gt; search = new HashSet&lt;&gt;();\n        search.add(&quot;tomato&quot;);\n        search.add(&quot;carrot&quot;);\n        search.add(&quot;broccoli&quot;);\n        System.out.println(&quot;Exact set search&quot;);\n        System.out.println(map.get(search));\n        System.out.println(&quot;Partial set search&quot;);\n        HashSet&lt;String&gt; partialSearch = new HashSet&lt;&gt;();\n        partialSearch.add(&quot;tomato&quot;);\n        partialSearch.add(&quot;broccoli&quot;);\n        for (HashSet&lt;String&gt; set : map.keySet()) {\n            if (set.containsAll(partialSearch)) {\n                System.out.println(String.format(&quot;Found partial match %s&quot;, map.get(set)));\n            }\n        }\n\n    }\n}\n</code></pre>\n"
    },
    {
      "tags": [
        "java",
        "javafx"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 642706,
            "display_name": "Basil Bourque"
          },
          "edited": false,
          "comment_id": 133372370,
          "body": "Interesting question. I cannot find any documentation specifically explaining what â€œwidthâ€ and â€œheightâ€ float numbers mean precisely. For example, no details on <a href=\"https://openjfx.io/javadoc/19/javafx.graphics/javafx/scene/Scene.html#%3Cinit%3E(javafx.scene.Parent,double,double)\" rel=\"nofollow noreferrer\">constructor of <code>Scene</code></a>."
        },
        {
          "owner": {
            "user_id": 2316663,
            "display_name": "Osama El-Ghonimy"
          },
          "edited": false,
          "comment_id": 133372420,
          "body": "I also did some research in multiple sites and classes and found nothing"
        },
        {
          "owner": {
            "user_id": 5558072,
            "display_name": "Youcef LAIDANI"
          },
          "edited": false,
          "comment_id": 133372538,
          "body": "From the documentation of Node here, they talk about using pixels <a href=\"https://docs.oracle.com/javase/8/javafx/api/javafx/scene/Node.html\" rel=\"nofollow noreferrer\">docs.oracle.com/javase/8/javafx/api/javafx/scene/Node.html</a> I think it can be the same thing with the other components, I delete my answer to find a good reference"
        },
        {
          "owner": {
            "user_id": 642706,
            "display_name": "Basil Bourque"
          },
          "edited": false,
          "comment_id": 133372632,
          "body": "With the advent of high-density screens, Cascading Style Sheets (CSS) years ago changed the meaning of their <code>px</code> (pixel) unit of size, changing from physical screen picture elements to a <a href=\"https://en.wikipedia.org/wiki/Pixel#Logical_pixel\" rel=\"nofollow noreferrer\">logical unit</a> of minimally apparent physical drawing. Unfortunately Iâ€™ve not seen a precise definition in CSS. Apparently JavaFX/OpenJFX is doing something similar, but with even less specification/documentation."
        },
        {
          "owner": {
            "user_id": 1155209,
            "display_name": "jewelsea"
          },
          "edited": false,
          "comment_id": 133372652,
          "body": "The closest definition I know of in Javadoc is the <a href=\"https://openjfx.io/javadoc/19/javafx.graphics/javafx/scene/Node.html\" rel=\"nofollow noreferrer\">Coordinate System</a> documentation for <code>Node</code>, though it is not really well-defined, perhaps deliberately.  If a dimension is specified in CSS as a size or length, there <a href=\"https://openjfx.io/javadoc/19/javafx.graphics/javafx/scene/doc-files/cssref.html#typesize\" rel=\"nofollow noreferrer\">are more unit options</a>.  The equivalent term in the JavaFX CSS spec is <i>&quot;<b>px</b>: pixels, relative to the viewing device&quot;</i>, which is the default unit used."
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 1165724,
            "display_name": "swpalmer"
          },
          "up_vote_count": 6,
          "is_accepted": true,
          "creation_date": 1677622941,
          "answer_id": 75597886,
          "body": "<p>They are in pixels, subject to a scaling factor for high DPI displays.</p>\n<p>From the docs for Node:</p>\n<blockquote>\n<p>At the device pixel level, integer coordinates map onto the corners and cracks between the pixels and the centers of the pixels appear at the midpoints between integer pixel locations. Because all coordinate values are specified with floating point numbers, coordinates can precisely point to these corners (when the floating point values have exact integer values) or to any location on the pixel. For example, a coordinate of (0.5, 0.5) would point to the center of the upper left pixel on the Stage. Similarly, a rectangle at (0, 0) with dimensions of 10 by 10 would span from the upper left corner of the upper left pixel on the Stage to the lower right corner of the 10th pixel on the 10th scanline. The pixel center of the last pixel inside that rectangle would be at the coordinates (9.5, 9.5).</p>\n</blockquote>\n<p>For scaling factor, see:</p>\n<ul>\n<li><a href=\"https://openjfx.io/javadoc/19/javafx.graphics/javafx/stage/Window.html#getOutputScaleX()\" rel=\"noreferrer\">https://openjfx.io/javadoc/19/javafx.graphics/javafx/stage/Window.html#getOutputScaleX()</a></li>\n</ul>\n<p>Which states:</p>\n<blockquote>\n<p>The scale that the Window will apply to horizontal scene coordinates in all stages of rendering and compositing the output to the screen or other destination device.</p>\n</blockquote>\n<p>Similarly OutputScaleY exists for the vertical coordinates.</p>\n<p>Also:</p>\n<ul>\n<li><a href=\"https://openjfx.io/javadoc/19/javafx.graphics/javafx/stage/Screen.html#getOutputScaleX()\" rel=\"noreferrer\">https://openjfx.io/javadoc/19/javafx.graphics/javafx/stage/Screen.html#getOutputScaleX()</a></li>\n</ul>\n"
        }
      ],
      "owner": {
        "user_id": 2316663,
        "display_name": "Osama El-Ghonimy"
      },
      "view_count": 108,
      "up_vote_count": 5,
      "accepted_answer_id": 75597886,
      "answer_count": 1,
      "score": 5,
      "creation_date": 1677615099,
      "question_id": 75596840,
      "body": "<p>When learning JavaFX you find that you can set the height and width of scene, you can set the spacing between nodes in HBox, and other similar aspects.\nMy question is about the unit of such values.\nFor example, in this simple code:</p>\n<pre><code>import javafx.application.Application;\nimport javafx.geometry.Pos;\nimport javafx.scene.Scene;\nimport javafx.scene.control.Button;\nimport javafx.scene.layout.HBox;\nimport javafx.stage.Stage;\n\npublic class TestGUI extends Application{\n    @Override\n    public void start(Stage primaryStage) {\n        Button btn1 = new Button(&quot;OK&quot;);\n        Button btn2 = new Button(&quot;Cancel&quot;);\n        HBox root = new HBox(15,btn1,btn2);\n        root.setAlignment(Pos.CENTER);\n        Scene scene = new Scene(root,250,50);\n        primaryStage.setScene(scene);\n        primaryStage.setTitle(&quot;GUI Example&quot;);\n        primaryStage.show();\n    }\n    public static void main(String[] args) {\n        launch(args);\n    }\n}\n</code></pre>\n<p>What is the units of 250, 50 and 15?</p>\n"
    },
    {
      "tags": [
        "java",
        "delay"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 1898563,
            "display_name": "Michael"
          },
          "edited": false,
          "comment_id": 132382290,
          "body": "The schedule method doesn&#39;t know that the 2nd action should happen 60000 after the first action, and the 3rd should happen 60000 after that. It just knows that you want each action deferred 60000 from when it&#39;s called, and all <code>printFirst</code>s are called at the same time. You could add an integer parameter to <code>printFirst</code> and call printFirst(1), then 2, then 3. Change the delay to <code>60000 * myIntParam</code>."
        },
        {
          "owner": {
            "user_id": 10642567,
            "display_name": "Sangmin Kim"
          },
          "edited": false,
          "comment_id": 132382939,
          "body": "I was trying to do this to create a delay between each email that is being sent @Michael"
        },
        {
          "owner": {
            "user_id": 5730279,
            "display_name": "hc_dev"
          },
          "edited": false,
          "comment_id": 132389051,
          "body": "@SangminKim sorry, I somehow was confused by the separate code-blocks. Thanks for guiding me, edited to have them in one."
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 20440272,
            "display_name": "Sohaib Ahmed"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1672917814,
          "answer_id": 75017682,
          "body": "<p>While calling function, you can set the number of seconds as a parameter</p>\n<pre><code>System.out.println(ts() + &quot; Zero&quot;);\nprintFirst(60000);\nprintFirst(12000);\nprintFirst(18000);\nSystem.out.println(ts() + &quot; Second&quot;);\nSystem.out.println(ts() + &quot; Third&quot;);\nSystem.out.println(ts() + &quot; Fourth&quot;);\n</code></pre>\n<p>In your function,</p>\n<pre><code>static void printFirst(long time) {\n  new java.util.Timer().schedule(\n    new java.util.TimerTask() {\n      public void run() {\n        System.out.println(ts() + &quot; First&quot;);\n      }\n    },time\n  );\n}\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 5309419,
            "display_name": "DmitryArc"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1672924383,
          "answer_id": 75018963,
          "body": "<p>As an option you can set up your timer for periodic execution and limit the number of runs</p>\n<pre class=\"lang-java prettyprint-override\"><code>static void printFirst(long delay, int numberOfIterations) {\n    new java.util.Timer().schedule(\n        new java.util.TimerTask() {\n            private int counter = 0;\n            public void run() {\n                System.out.println(ts() + &quot; First&quot;);\n\n                if(++counter == numberOfIterations) {\n                    this.cancel();\n                }\n            }\n        }, delay, delay\n    );\n}\n</code></pre>\n<p>And then just run it with one command <code>printFirst(60000, 3);</code></p>\n"
        },
        {
          "owner": {
            "user_id": 20938349,
            "display_name": "Raigormator"
          },
          "up_vote_count": 4,
          "is_accepted": true,
          "creation_date": 1672935795,
          "answer_id": 75021492,
          "body": "<p>We can achieve the expected results using ExecutorService class with the newSingleThreadExecutor() method. See the code below.</p>\n<pre><code>static ExecutorService es = Executors.newSingleThreadExecutor();\n\nstatic void printFirst() {\n    es.submit(() -&gt; {\n        try {\n            TimeUnit.MILLISECONDS.sleep(60000);\n            System.out.println(ts() + &quot; First&quot;);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n    });\n}\n</code></pre>\n<p>The main method is still the same.</p>\n<pre><code>System.out.println(ts() + &quot; Zero&quot;);\nprintFirst();\nprintFirst();\nprintFirst();\nSystem.out.println(ts() + &quot; Second&quot;);\nSystem.out.println(ts() + &quot; Third&quot;);\nSystem.out.println(ts() + &quot; Fourth&quot;);\n</code></pre>\n<p>When run, the results are:</p>\n<pre><code>2023-01-06 00:05:45.72 Zero\n2023-01-06 00:05:45.763 Second\n2023-01-06 00:05:45.763 Third\n2023-01-06 00:05:45.763 Fourth\n2023-01-06 00:06:45.776 First\n2023-01-06 00:07:45.782 First\n2023-01-06 00:08:45.784 First\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 5730279,
            "display_name": "hc_dev"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1672936501,
          "answer_id": 75021618,
          "body": "<h3>Issue</h3>\n<p>The delay in your <a href=\"https://docs.oracle.com/javase/7/docs/api/java/util/Timer.html#schedule(java.util.TimerTask,%20long)\" rel=\"nofollow noreferrer\"><code>Timer.schedule(TimerTask task, long initialDelay)</code></a> is just for the <strong>initial</strong> delay, time between scheduled and start of task. See parameter in docs:</p>\n<blockquote>\n<p><code>delay</code> - delay in milliseconds before task is to be executed.</p>\n</blockquote>\n<h3>Solution</h3>\n<p>For your intent - as <strong>interval</strong> - you need the overloaded sister-method <a href=\"https://docs.oracle.com/javase/7/docs/api/java/util/Timer.html#schedule(java.util.TimerTask,%20long,%20long)\" rel=\"nofollow noreferrer\"><code>schedule(TimerTask task, long delay, long period)</code></a> passing the 1 minute interval as third argument to parameter named <code>period</code>:</p>\n<blockquote>\n<p>Schedules the specified task for repeated fixed-delay execution, beginning after the specified delay. Subsequent executions take place at <strong>approximately regular intervals separated by the specified <code>period</code></strong>.</p>\n</blockquote>\n<pre><code>import java.util.Timer;\nimport java.util.TimerTask;\n\n// define the task, here in a method on demand\npublic static TimerTask createPrintTask(String text) {\n   return new TimerTask() {\n      public void run() {\n        System.out.println(ts() + text);  // not sure how ts() is defined\n      }\n    };\n}\n\n// define print-method using Timer with interval and zero delay\nstatic void printScheduledWithInterval(String text, int intervalMillis) {\n  var initialDelayMillis = 0; // start immediately (first after 0 seconds)\n  new Timer().schedule(createPrintTask(text), initialDelayMillis, intervalMillis);\n}\n\n// MAIN\nSystem.out.println(ts() + &quot; Zero&quot;);\n\n// use to start the task asynchronously (it will continue to print every interval until canceled)\nprintScheduledWithInterval(&quot; First&quot;, 60_000);  // 1 minute interval\n\nSystem.out.println(ts() + &quot; Second&quot;);\nSystem.out.println(ts() + &quot; Third&quot;);\nSystem.out.println(ts() + &quot; Fourth&quot;);\n</code></pre>\n<p>Note: In you code there was <code>printFirst</code> called 3 times. Presumably to have 3 different tasks started or to have 3 lines printed.</p>\n<h3>When does the scheduling of task end?</h3>\n<p>The <code>printScheduledWithInterval</code> here, rather means schedule a print-job to be executed repeatedly on a fixed-interval.</p>\n<p>Since there are no requirements about number of printed lines or max-execution count, the timer will continuously start new tasks.</p>\n"
        }
      ],
      "owner": {
        "user_id": 10642567,
        "display_name": "Sangmin Kim"
      },
      "view_count": 165,
      "up_vote_count": 5,
      "accepted_answer_id": 75021492,
      "answer_count": 4,
      "score": 5,
      "creation_date": 1672913398,
      "question_id": 75016807,
      "body": "<p>I want to have a delay of 1 minute before the <code>printFirst()</code> method is called without affecting the main thread.</p>\n<h3>Code</h3>\n<p>I tried</p>\n<pre class=\"lang-java prettyprint-override\"><code>// define delaying print-method using Timer\nstatic void printFirst() {\n  new java.util.Timer().schedule(\n    new java.util.TimerTask() {\n      public void run() {\n        System.out.println(ts() + &quot; First&quot;);\n      }\n    },60000\n  );\n}\n\n// main to run\nSystem.out.println(ts() + &quot; Zero&quot;);\nprintFirst();\nprintFirst();\nprintFirst();\nSystem.out.println(ts() + &quot; Second&quot;);\nSystem.out.println(ts() + &quot; Third&quot;);\nSystem.out.println(ts() + &quot; Fourth&quot;);\n</code></pre>\n<h3>Actual Output</h3>\n<p>but the output was</p>\n<pre><code>Timestamp: 2023-01-05 17:40:43.664 Zero\nTimestamp: 2023-01-05 17:40:43.666 Second\nTimestamp: 2023-01-05 17:40:43.667 Third\nTimestamp: 2023-01-05 17:40:43.667 Fourth\nTimestamp: 2023-01-05 17:41:13.681 First\nTimestamp: 2023-01-05 17:41:13.681 First\nTimestamp: 2023-01-05 17:41:13.681 First\n</code></pre>\n<h3>Expected</h3>\n<p>I was expecting an interval of 1 min between the 3 lines ending with &quot;First&quot;.</p>\n<pre><code>Timestamp: 2023-01-05 17:40:43.664 Zero\nTimestamp: 2023-01-05 17:40:43.666 Second\nTimestamp: 2023-01-05 17:40:43.667 Third\nTimestamp: 2023-01-05 17:40:43.667 Fourth\nTimestamp: 2023-01-05 17:41:43.667 First\nTimestamp: 2023-01-05 17:42:43.667 First\nTimestamp: 2023-01-05 17:43:43.667 First\n</code></pre>\n"
    },
    {
      "tags": [
        "java"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 133203,
            "display_name": "Federico klez Culloca"
          },
          "edited": false,
          "comment_id": 132667004,
          "body": "<i>&quot;When I replace line 2 with line 1 in code, it runs successfully.&quot;</i> because they do completely different things. One creates an <code>HashSet</code> with default capacity, the other creates an <code>HashSet</code> with initial capacity <code>x</code>, which may very well be 305589003, which is rather big."
        },
        {
          "owner": {
            "user_id": 16320675,
            "display_name": "user16320675"
          },
          "edited": false,
          "comment_id": 132667124,
          "body": "<code>computeIfAbsent</code> calls the 2nd parameter (a <code>Function</code>) with the key as argument, in this case <code>305589003</code>; the passed function <code>HashSet::new</code> is the <code>HashSet(int initialCapacity)</code> - as commented above, <code>305589003</code> as capacity is too big to be stored in the available memory (line 1 should be <code>k -&gt; new HashSet&lt;&gt;(k)</code> to be the same as line 2, both wrong)"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 6537157,
            "display_name": "akop"
          },
          "up_vote_count": 5,
          "is_accepted": true,
          "creation_date": 1674200717,
          "answer_id": 75181094,
          "body": "<p><code>HashSet::new</code> is a method reference pointing to <code>new HashSet(initialCapacity)</code>. See the  java-doc of <a href=\"https://docs.oracle.com/javase/7/docs/api/java/util/HashSet.html#HashSet(int)\" rel=\"nofollow noreferrer\">HashSet</a>.</p>\n<p>So, it creates a bigger <code>HashSet</code>s than you expect, because it takes your <code>x</code> variable as parameter.</p>\n"
        }
      ],
      "owner": {
        "user_id": 8008906,
        "display_name": "djy"
      },
      "view_count": 152,
      "up_vote_count": 5,
      "accepted_answer_id": 75181094,
      "answer_count": 1,
      "score": 5,
      "creation_date": 1674199546,
      "question_id": 75180919,
      "body": "<pre class=\"lang-java prettyprint-override\"><code>import java.util.HashMap;\nimport java.util.HashSet;\n\npublic class ComputeIfAbsentWithHashSetNew {\n    public static void main(String[] args) {\n        var map = new HashMap&lt;Integer, HashSet&lt;Integer&gt;&gt;();\n        var data = new int[][]{{305589003, 4136}, {305589004, 4139}};\n        for (var entry : data) {\n            int x = entry[0];\n            int y = entry[1];\n//            map.computeIfAbsent(x, _x -&gt; new HashSet&lt;&gt;()).add(y); // ----- line 1\n            var k = map.computeIfAbsent(x, HashSet::new);           // ----- line 2\n            k.add(y);\n        }\n    }\n}\n</code></pre>\n<p>Above code throws at jdk 17ã€ 18ã€ 19:</p>\n<pre><code>Exception in thread &quot;main&quot; java.lang.OutOfMemoryError: Java heap space\n    at java.base/java.util.HashMap.resize(HashMap.java:702)\n    at java.base/java.util.HashMap.putVal(HashMap.java:627)\n    at java.base/java.util.HashMap.put(HashMap.java:610)\n    at java.base/java.util.HashSet.add(HashSet.java:221)\n    at _explore.ComputeIfAbsentWithHashSetNew.main(ComputeIfAbsentWithHashSetNew.java:15)\n</code></pre>\n<p>When debug, I see the <code>newCap</code> in <code>Hashmap::resize()</code> is very large, I don't know why. I thought both the lines do same thing previously.</p>\n<p>When I replace <strong>line 2</strong> with <strong>line 1</strong> in code, it runs successfully.</p>\n"
    },
    {
      "tags": [
        "java",
        "overloading",
        "boxing"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 139985,
            "display_name": "Stephen C"
          },
          "edited": false,
          "comment_id": 134458685,
          "body": "<code>Short</code> and <code>short</code> are different types.  Try declaring <code>go</code> as <code>go(short n)</code>."
        },
        {
          "owner": {
            "user_id": 139985,
            "display_name": "Stephen C"
          },
          "edited": false,
          "comment_id": 134458761,
          "body": "The rules for resolving overload calls are complicated.  But basically, when you have a <code>go</code> call with a <code>short</code> argument, the <code>go(int)</code> method is closer than the <code>go(Short)</code> method.   Technically, <code>short</code> is a subtype of <code>int</code> but not <code>Short</code>.  And that means that <code>go(int)</code> is <i>more specific</i> than <code>go(Short)</code> ... and that is why it is chosen."
        },
        {
          "owner": {
            "user_id": 671543,
            "display_name": "njzk2"
          },
          "edited": false,
          "comment_id": 134458798,
          "body": "because widening of type is higher on the priority list than auto-boxing."
        },
        {
          "owner": {
            "user_id": 286934,
            "display_name": "Progman"
          },
          "edited": false,
          "comment_id": 134458812,
          "body": "Are you intentionally use <code>Short</code> as in the <a href=\"https://docs.oracle.com/javase/8/docs/api/java/lang/Short.html\" rel=\"nofollow noreferrer\"><code>java.lang.Short</code></a> wrapper class or was it just a typo and you wanted to write the primitive type <code>short</code>?"
        },
        {
          "owner": {
            "user_id": 207421,
            "display_name": "user207421"
          },
          "edited": false,
          "comment_id": 134459095,
          "body": "Why do you <i>have</i> an overload <code>method(Short)</code>? Don&#39;t do this."
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 139985,
            "display_name": "Stephen C"
          },
          "up_vote_count": 4,
          "is_accepted": true,
          "creation_date": 1684065572,
          "answer_id": 76247370,
          "body": "<p>When you make a call to an overloaded method, the compiler needs to decide <em>statically</em> which of the overloads will be called.  Intuitively, this is done by looking at each of the overloads' signatures, and working out which one is the best match ... based on the <em>static</em> types of the argument expressions.  If there is a tie (i.e. no single &quot;best&quot; match), the compiler gives an error saying that the method call is ambiguous.</p>\n<p>This is the code of your example.</p>\n<pre><code>public class test {\n    public static void go(Short n) {System.out.println(&quot;Short&quot;);}\n    public static void go(int n) {System.out.println(&quot;int&quot;);}\n    \n    public static void main(String[] args) {\n        short x=11;\n        go(x);\n    }\n}\n</code></pre>\n<p>The reason that this prints &quot;int&quot; rather than &quot;Short&quot; is because <code>go(int)</code> is deemed to be a better match than <code>go(Short)</code> to a call where the argument expression's static type is <code>short</code>.</p>\n<p>(Technically, <code>short</code> is a subtype of <code>int</code>, but not of <code>Short</code>.)</p>\n<p>If we change your code to this:</p>\n<pre><code>public class test {\n    public static void go(short n) {System.out.println(&quot;short&quot;);}\n    public static void go(int n) {System.out.println(&quot;int&quot;);}\n    \n    public static void main(String[] args) {\n        short x=11;\n        go(x);\n    }\n}\n</code></pre>\n<p>we will now see that <code>short</code> is printed.   The type <code>short</code> is a subtype<sup>1</sup> of both <code>short</code> and <code>int</code>, but <code>go(short)</code> is a closer match than <code>go(int)</code>.</p>\n<p>The relevant section of the Java Language Specification is <a href=\"https://docs.oracle.com/javase/specs/jls/se17/html/jls-15.html#jls-15.12\" rel=\"nofollow noreferrer\">JLS 15.2</a>.   But beware that is long and complicated ... and NOT recommended for beginners to try to read.  (Indeed, I would posit that <em>most</em> Java programmers don't fully understand all of what it says.  Myself included!)</p>\n<hr />\n<p><sup>1 - This is according to the definition of subtype used in the JLS.</sup></p>\n"
        }
      ],
      "owner": {
        "user_id": 8024530,
        "display_name": "kolinunlt"
      },
      "view_count": 87,
      "up_vote_count": 5,
      "accepted_answer_id": 76247370,
      "answer_count": 1,
      "score": 5,
      "creation_date": 1684059641,
      "question_id": 76246945,
      "body": "<p>I am learning Java.  When I call <code>go(x)</code>, I get â€˜intâ€™.  Why not â€˜Shortâ€™?</p>\n<pre><code>public class test {\n    public static void go(Short n) {System.out.println(&quot;Short&quot;);}\n    public static void go(int n) {System.out.println(&quot;int&quot;);}\n    \n    public static void main(String[] args) {\n        short x=11;\n        go(x);\n    }\n}\n</code></pre>\n"
    },
    {
      "tags": [
        "java",
        "multithreading",
        "jvm",
        "classloader"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 12749998,
            "display_name": "Kozmotronik"
          },
          "edited": false,
          "comment_id": 134269643,
          "body": "What do you see in the output? Can you add its output as well?"
        },
        {
          "owner": {
            "user_id": 573032,
            "display_name": "Roman C"
          },
          "edited": false,
          "comment_id": 134269647,
          "body": "Because you locked the main thread."
        },
        {
          "owner": {
            "user_id": 7628578,
            "display_name": "Q10Viking"
          },
          "edited": false,
          "comment_id": 134269811,
          "body": "@Roman C.yes. I locked the main thread.But I let the new thread to wake up it.But the main thread is  not wake up .I find no dead lock in the code."
        },
        {
          "owner": {
            "user_id": 573032,
            "display_name": "Roman C"
          },
          "edited": false,
          "comment_id": 134269874,
          "body": "@Q10Viking It&#39;s not true, the new thread is not able to unlock it."
        },
        {
          "owner": {
            "user_id": 898478,
            "display_name": "m0skit0"
          },
          "edited": false,
          "comment_id": 134269927,
          "body": "@RomanC Yes but why? That&#39;s what is being asked."
        },
        {
          "owner": {
            "user_id": 768644,
            "display_name": "rzwitserloot"
          },
          "edited": false,
          "comment_id": 134269942,
          "body": "For those who are voting-to-close or attempting to answer: You&#39;re missing it. The CRUCIAL question here is: <b>Why in the blazes is that thread not starting??</b> - try it, paste this code, compile it, run it. Add a print to the run() block of that thread right up top. It NEVER STARTS. A proper answer to this question requires intricate knowledge of the JVM class init rules and the vagaries of what thread constructor locks on, to answer why in this peculiar case the thread doesn&#39;t actually start. 2 answers so far that missed it."
        },
        {
          "owner": {
            "user_id": 768644,
            "display_name": "rzwitserloot"
          },
          "edited": false,
          "comment_id": 134269947,
          "body": "For the vote-to-closers closing for &#39;insufficient detail&#39;: Replace the log.info with sysout and this is a self-contained example, surely that is sufficient detail!"
        },
        {
          "owner": {
            "user_id": 573032,
            "display_name": "Roman C"
          },
          "edited": false,
          "comment_id": 134269959,
          "body": "@m0skit0 Because it&#39;s very poor written. The same question should be asked million times and it cannot be answered in a few words."
        },
        {
          "owner": {
            "user_id": 768644,
            "display_name": "rzwitserloot"
          },
          "edited": false,
          "comment_id": 134269980,
          "body": "The key point here is that starting threads in the middle of class initialization (because you&#39;re in the context of that <code>static {}</code> block) does not work - it delays the starting of it until initialization is done, which it&#39;ll never be, because during initialization you invoke <code>wait()</code> on a lock. I&#39;ve tried to find out why and I can&#39;t find it (hence, this is a comment, not an answer)."
        },
        {
          "owner": {
            "user_id": 4712734,
            "display_name": "DuncG"
          },
          "edited": false,
          "comment_id": 134270229,
          "body": "Its not starting because the lambda is equivalent to a static method, and that can&#39;t be called unless the class has completed initialisation. The thread code is awaiting init to end. Its similar to / duplicates the issues seen <a href=\"https://stackoverflow.com/questions/75712988/why-does-joining-a-no-op-virtual-thread-in-a-static-initialiser-block-indefinite\">here</a> and <a href=\"https://stackoverflow.com/questions/34820066/why-does-parallel-stream-with-lambda-in-static-initializer-cause-a-deadlock\">here</a>."
        },
        {
          "owner": {
            "user_id": 4712734,
            "display_name": "DuncG"
          },
          "edited": false,
          "comment_id": 134270421,
          "body": "The lock is not to do with <code>synchronized</code>, you can reproduce with starting a Thread with any <code>Runnable</code> that references a field of the class. For example replace init() by <code>new Thread(() -&gt; System.out.println(&quot;Hello World &quot;&#47;* +lock *&#47;),&quot;demo-thread&quot;).start()</code>. The code will never run if you uncomment use of <code>lock</code>."
        },
        {
          "owner": {
            "user_id": 7628578,
            "display_name": "Q10Viking"
          },
          "edited": false,
          "comment_id": 134270441,
          "body": "@xerx593 if code <code>static{ init();}</code> change to <code>static{ new Thread(()-&gt;init()) }</code> will workã€‚So that&#39;s not a dead lock problem."
        },
        {
          "owner": {
            "user_id": 592355,
            "display_name": "xerx593"
          },
          "edited": false,
          "comment_id": 134271119,
          "body": "the one (main thread approach) was a classical &quot;dead lock&quot;: the main thread &quot;owns&quot; the lock and waits it (blockingly) forever., by introducing another thread (<i>asynchronizing</i> the <code>lock.wait()</code> indeed) you give jvm a chance for &quot;Reentrant Synchronization&quot; (<a href=\"https://docs.oracle.com/javase/tutorial/essential/concurrency/locksync.html\" rel=\"nofollow noreferrer\">docs.oracle.com/javase/tutorial/essential/concurrency/&hellip;</a>)"
        },
        {
          "owner": {
            "user_id": 7628578,
            "display_name": "Q10Viking"
          },
          "edited": false,
          "comment_id": 134271140,
          "body": "@xerx593 Cool!!! Can you please reopen it to write this answer?Thank you very muchðŸ˜ƒ"
        },
        {
          "owner": {
            "user_id": 592355,
            "display_name": "xerx593"
          },
          "edited": false,
          "comment_id": 134271320,
          "body": "Thank you for the flowers :) here some <a href=\"https://docs.oracle.com/javase/specs/jls/se20/html/jls-14.html#jls-14.19\" rel=\"nofollow noreferrer\">jls-link</a> , but i fear this, the tiny chapter ( + <i>rest</i> ) of <a href=\"https://docs.oracle.com/javase/tutorial/essential/concurrency/locksync.html\" rel=\"nofollow noreferrer\">tutorial</a> and maybe <a href=\"https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/util/concurrent/locks/ReentrantLock.html\" rel=\"nofollow noreferrer\">ReentrantLock javadoc</a> are the best documentation about..."
        },
        {
          "owner": {
            "user_id": 7628578,
            "display_name": "Q10Viking"
          },
          "edited": false,
          "comment_id": 134272190,
          "body": "@rzwitserloot Thank you for the adviceã€‚I have change <code>log.info</code> to <code>sysout</code> in the code.My original intention was to use <code>log.info</code> to see the thread name"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 898478,
            "display_name": "m0skit0"
          },
          "up_vote_count": 5,
          "is_accepted": true,
          "creation_date": 1682773981,
          "answer_id": 76136427,
          "body": "<p>I'm not an expert in JVM internals but I think the problem lies in here:</p>\n<pre><code>static {\n    init();\n}\n</code></pre>\n<p>I suspect this will be executed when the JVM classloader is loading the class. However this class loading will never finish since you're blocking the classloader itself, and thus execution of the rest of the program will never resume, and thus the other thread is never started.</p>\n<p>If you remove the static block and call it directly:</p>\n<pre><code>public static void main(String[] args) {\n    // ...\n    MyFactory.init();\n    MyFactory.getSomething();\n    // ...\n}\n</code></pre>\n<p>You will see that it works properly.</p>\n<p>More details under <a href=\"https://docs.oracle.com/javase/specs/jls/se7/html/jls-12.html#jls-12.4.2\" rel=\"nofollow noreferrer\">JLS 12.4.2</a></p>\n<p>On a side note, sleeping is not a good idea to synchronize threads.</p>\n"
        }
      ],
      "owner": {
        "user_id": 7628578,
        "display_name": "Q10Viking"
      },
      "view_count": 178,
      "up_vote_count": 6,
      "accepted_answer_id": 76136427,
      "answer_count": 1,
      "score": 5,
      "creation_date": 1682769866,
      "question_id": 76136132,
      "body": "<p>The code is below, in the <code>Main</code> method I call a static method:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class Main {\n    public static void main(String[] args) {\n        MyFactory.getSomething();\n        System.out.println(&quot;over&quot;); \n    }\n}\n</code></pre>\n<p>In the static method, let the main thread wait, then by demo-thread wake up. <strong>But the main thread does not wake up</strong> and I don't know why.</p>\n<pre class=\"lang-java prettyprint-override\"><code>import java.util.concurrent.TimeUnit;\n\npublic class MyFactory {\n    private static Object lock = new Object();\n\n    static{\n        init();\n    }\n\n    private static void init(){\n        new Thread(()-&gt;{\n            try {\n                // make this thread run after main thread\n                TimeUnit.SECONDS.sleep(3);\n                System.out.println(&quot;task run...&quot;);\n                synchronized (lock){\n                    lock.notifyAll();  // notify main thread\n                }\n            } catch (InterruptedException e) {\n                throw new RuntimeException(e);\n            }\n        },&quot;demo-thread&quot;).start();\n\n        synchronized (lock){\n            try {\n                System.out.println(&quot;waiting...&quot;);\n                lock.wait();  // wait\n                System.out.println(&quot;wake up&quot;);\n            } catch (InterruptedException e) {\n                throw new RuntimeException(e);\n            }\n        }\n    }\n    public static Object getSomething(){\n        return null;\n    }\n}\n</code></pre>\n<p>The output is below:</p>\n<pre class=\"lang-none prettyprint-override\"><code>waiting...\n</code></pre>\n<p>My expected should be like this:</p>\n<pre class=\"lang-none prettyprint-override\"><code>waiting...\ntask run...\nwake up\nover\n</code></pre>\n<p><a href=\"https://github.com/Q10Viking/static-thread\" rel=\"nofollow noreferrer\">Here is the demo code on Github</a> You can download it to run.</p>\n<hr />\n<p><strong>My try</strong>:</p>\n<p>I see losts of people say may be a dead lock cause the problem.I don't think so.Because we don't see <code>task run...</code> info in the output. So the <code>demo thread</code> not aquire the lock at all.</p>\n<p>When I change the code In <code>MyFactory.java</code>.(Add a new thread to run <strong>init</strong> method)</p>\n<p>from this</p>\n<pre class=\"lang-java prettyprint-override\"><code>static{\n  init();\n}\n\n</code></pre>\n<p>to this.</p>\n<pre><code>static{\n  new Thread(()-&gt;init()).start();\n}\n</code></pre>\n<p>Every thing work fine.The program not block.</p>\n<p>Here is the out put after I change the code .</p>\n<pre class=\"lang-bash prettyprint-override\"><code>over\nwaiting...\ntask run...\nwake up\n</code></pre>\n<blockquote>\n<p>Back to the original question &quot;Why main thread not wake up&quot;ï¼Ÿ\nI think the JVM didn't load the <code>MyFactory.class</code> completely due to main thread blockingã€‚I don't know if my guess is right???</p>\n</blockquote>\n"
    },
    {
      "tags": [
        "java"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 6395627,
            "display_name": "Slaw"
          },
          "edited": false,
          "comment_id": 133257934,
          "body": "Just wondering, but is the relative convolution of the code necessary to reproduce the problem? Or can it be reproduced with e.g., only one class and a functional interface implemented via a method reference?"
        },
        {
          "owner": {
            "user_id": 40342,
            "display_name": "Joachim Sauer"
          },
          "edited": false,
          "comment_id": 133260253,
          "body": "@Slaw: I could reproduce the result by simply doing <code>Runnable r = () -&gt; {}; System.out.println(r.getClass().getCanonicalName());</code>. That prints some internal class name in Java 11 and null in Java 17."
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 5133585,
            "display_name": "Sweeper"
          },
          "up_vote_count": 4,
          "is_accepted": false,
          "creation_date": 1677051579,
          "answer_id": 75529510,
          "body": "<p>After a bit of investigation, it is apparently because since Java 15, method references and lambdas (or rather, <code>invokedynamic</code>) are now implemented using <a href=\"https://openjdk.org/jeps/371\" rel=\"nofollow noreferrer\">hidden classes</a>, at least in the OpenJDK. In short, hidden classes are classes that are defined dynamically at runtime, using <a href=\"https://docs.oracle.com/en/java/javase/18/docs/api/java.base/java/lang/invoke/MethodHandles.Lookup.html#defineHiddenClass(byte%5B%5D,boolean,java.lang.invoke.MethodHandles.Lookup.ClassOption...)\" rel=\"nofollow noreferrer\"><code>Lookup.defineHiddenClass</code></a>, has no binary name, and does not need a class loader to be loaded.</p>\n<p>Try also printing <code>getClass().isHidden()</code> in <code>printClassName</code>. It should print <code>true</code>.</p>\n<p>You can also compare the <a href=\"https://github.com/openjdk/jdk15/blob/master/src/java.base/share/classes/java/lang/invoke/InnerClassLambdaMetafactory.java#L382\" rel=\"nofollow noreferrer\">Java 15 implementation</a> of <code>InnerClassLambdaMetafactory</code> vs the <a href=\"https://hg.openjdk.org/jdk8/jdk8/jdk/file/687fd7c7986d/src/share/classes/java/lang/invoke/InnerClassLambdaMetafactory.java#l324\" rel=\"nofollow noreferrer\">Java 8 implementation</a>. The latter uses the deprecated <code>sun.misc.Unsafe.defineAnonymousClass</code>.</p>\n<p>According to the JEP that introduced hidden classes, which was also implemented in Java 15, <code>getCanonicalName</code> returning null is the expected behaviour:</p>\n<blockquote>\n<p>Via the <code>Class</code> object, the hidden class can be instantiated and its members accessed as if it was a normal class, except for four restrictions:</p>\n<ol>\n<li><p><code>Class::getName</code> returns a string that is not a binary name, as described earlier.</p>\n</li>\n<li><p><code>Class::getCanonicalName</code> returns null, indicating the hidden class has no canonical name. (Note that the <code>Class </code>object for an anonymous class in the Java language has the same behavior.)</p>\n</li>\n<li><p>[...]</p>\n</li>\n</ol>\n</blockquote>\n<p>At the end of the day, the objects produced by a method reference expression only has the guarantees stated in <a href=\"https://docs.oracle.com/javase/specs/jls/se17/html/jls-15.html#jls-15.13.3\" rel=\"nofollow noreferrer\">this section of the JLS</a>. The implementation could change at any moment, and this case is exactly an example of that.</p>\n"
        }
      ],
      "owner": {
        "user_id": 934373,
        "display_name": "Hawk"
      },
      "view_count": 106,
      "up_vote_count": 5,
      "answer_count": 1,
      "score": 5,
      "creation_date": 1677044673,
      "question_id": 75528685,
      "body": "<pre><code>public class MyClass{\n    public void action() {\n    }\n    public void test(){\n        MyClassNameTest.takeAction(this::action);\n    }\n}\n\npublic interface MyInterface {\n    public void action();\n    default void printClassName(){\n        System.out.println(&quot;java version: &quot; + System.getProperty(&quot;java.version&quot;));\n        System.out.println(&quot;getCanonicalName: &quot; + getClass().getCanonicalName());\n        System.out.println(&quot;getName: &quot; + getClass().getName());\n        System.out.println(&quot;isAnonymousClass: &quot; + getClass().isAnonymousClass());\n    }\n}\n</code></pre>\n<p>Run this class:</p>\n<pre><code>public class MyClassNameTest {\n    public static void main(String[] args) {\n        new MyClass().test();\n    }\n    static void takeAction(MyInterface myInterface) {\n        myInterface.printClassName();\n        myInterface.action();\n    }\n}\n</code></pre>\n<h1>Steps to Reproduce</h1>\n<ol>\n<li>compile above classes in java 1.8 or 11</li>\n<li>run MyClassNameTest in java 15 or above</li>\n</ol>\n<h1>Current result</h1>\n<p><code>getClass().getCanonicalName()</code> returns null</p>\n<p>If you run them in the same Java version as you compiled, <code>getCanonicalName()</code> returns a non-null string.</p>\n<p>I found the interesting result, but I don't know the reason. Does anyone know?</p>\n"
    },
    {
      "tags": [
        "javascript",
        "java",
        "security",
        "struts2",
        "content-security-policy"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 438992,
            "display_name": "Dave Newton"
          },
          "edited": false,
          "comment_id": 132741374,
          "body": "<a href=\"https://meta.stackoverflow.com/questions/285551/why-should-i-not-upload-images-of-code-data-errors-when-asking-a-question/285557#285557\">Please post text, not images.</a>"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 9239311,
            "display_name": "Halvor Sakshaug"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1674539156,
          "answer_id": 75217815,
          "body": "<p>The content of your policies and the one in the error message don't match, and while you are adding &quot;Content-Security-Policy&quot;, the error message is for &quot;Content-Security-Policy-Report-Only&quot;. This means that there is another header present, and you are adding another. Adding another can only make the policy stricter. The report only version of Content-Security-Policy doesn't actually block anything, and must be set as a response header. You should identify where this header is set and modify it as needed.</p>\n<p>Additionally you should replace jquery-1.8.3 with a recent version that doesn't have known vulnerabilities.</p>\n"
        },
        {
          "owner": {
            "user_id": 13942448,
            "display_name": "jccampanero"
          },
          "up_vote_count": 1,
          "is_accepted": true,
          "creation_date": 1674775088,
          "answer_id": 75252633,
          "body": "<p>Struts provides support for <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP\" rel=\"nofollow noreferrer\"><code>Content-Security-Policy</code></a> since <a href=\"https://github.com/apache/struts/commit/4d8bec5d0a56dd8fefaf3783ed57ae65139525cc\" rel=\"nofollow noreferrer\">version 6.x</a>.</p>\n<p>The functionality is implemented primarily in <a href=\"https://github.com/apache/struts/blob/4d58dd1960a6fefef562ed578c42e3671c357279/core/src/main/java/org/apache/struts2/interceptor/csp/CspInterceptor.java\" rel=\"nofollow noreferrer\"><code>CspInterceptor</code></a>.</p>\n<p>This interceptor is configured by providing a convenient <a href=\"https://github.com/apache/struts/blob/8c4a90f6e3b20697d3e57134a983b2c694e5fe75/core/src/main/java/org/apache/struts2/interceptor/csp/DefaultCspSettings.java\" rel=\"nofollow noreferrer\">default implementation</a> of <a href=\"https://github.com/apache/struts/blob/253d8558e55737084f56a0fab3c32ee3deee9cee/core/src/main/java/org/apache/struts2/interceptor/csp/CspSettings.java\" rel=\"nofollow noreferrer\">CspSettings</a>.</p>\n<p>This interceptor is included by default in the <a href=\"https://github.com/apache/struts/blob/master/core/src/main/resources/struts-default.xml\" rel=\"nofollow noreferrer\">Struts configuration</a>. As you can see in the <a href=\"https://github.com/apache/struts/blob/2a85d0fbc4dcc8e59b4e48d1c8289252ade042af/core/src/main/resources/struts-default.xml#L199\" rel=\"nofollow noreferrer\">linked resource</a> and in <a href=\"https://struts.apache.org/core-developers/csp-interceptor\" rel=\"nofollow noreferrer\">the documentation</a> by default is configured in report only, non enforcing mode:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;interceptor-ref name=&quot;csp&quot;&gt;\n  &lt;param name=&quot;disabled&quot;&gt;false&lt;/param&gt;\n  &lt;param name=&quot;enforcingMode&quot;&gt;false&lt;/param&gt;\n&lt;/interceptor-ref&gt;\n</code></pre>\n<p>I reviewed the current source code of the library and the companion documentation and it seems that providing a custom CSP configuration to <code>CspInterceptor</code> is not possible right now.</p>\n<p>That means that in order to mitigate your error one possibility will be to disable the <code>CspInterceptor</code> and provide your own. The <a href=\"https://struts.apache.org/core-developers/interceptors#disabling-interceptor\" rel=\"nofollow noreferrer\">Struts documentation</a> provides guidance about how it could be accomplished. In your case, I think it should look like similar to the following:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;action name=&quot;myAction&quot; class=&quot;myActionClass&quot;&gt;\n    &lt;interceptor-ref name=&quot;defaultStack&quot;&gt;\n        &lt;param name=&quot;csp.disabled&quot;&gt;true&lt;/param&gt;\n    &lt;/interceptor-ref&gt;\n&lt;/action&gt;\n</code></pre>\n<p>In addition, in the <a href=\"https://github.com/apache/struts/commit/4d8bec5d0a56dd8fefaf3783ed57ae65139525cc\" rel=\"nofollow noreferrer\">commit</a> I cited at the beginning of the answer they mention the components and corresponding tags <a href=\"https://github.com/apache/struts/blob/master/core/src/main/java/org/apache/struts2/components/Link.java\" rel=\"nofollow noreferrer\"><code>s:link</code></a> and <a href=\"https://github.com/apache/struts/blob/master/core/src/main/java/org/apache/struts2/components/Script.java\" rel=\"nofollow noreferrer\"><code>s:script</code></a> as a possible way for fetching the required CSS and Javascript resources taking into account the default CSP settings: basically they provide the necessary mechanisms for taking into account the appropriate nonces for the linked resources, required according to the policy applied. Please, consider review for instance <a href=\"https://github.com/apache/struts/blob/master/apps/showcase/src/main/webapp/WEB-INF/decorators/main.jsp\" rel=\"nofollow noreferrer\">this page</a> in the showcase provided by Struts as example, reproduced here for convenience:</p>\n<pre><code>&lt;%@taglib prefix=&quot;s&quot; uri=&quot;/struts-tags&quot; %&gt;\n\n\n&lt;html lang=&quot;en&quot;&gt;\n&lt;head&gt;\n    &lt;!-- content removed for brevity --&gt;\n\n    &lt;s:url var=&quot;jqueryJs&quot; value='/js/jquery-2.1.4.min.js' encode='false' includeParams='none'/&gt;\n    &lt;s:script src=&quot;%{jqueryJs}&quot;/&gt;\n    &lt;!-- other resources... now handling inline sources --&gt; \n    &lt;s:script type=&quot;text/javascript&quot;&gt;\n        $(function () {\n            var alerts = $('ul.alert').wrap('&lt;div /&gt;');\n            alerts.prepend('&lt;a class=&quot;close&quot; data-dismiss=&quot;alert&quot; href=&quot;#&quot;&gt;&amp;times;&lt;/a&gt;');\n            alerts.alert();\n        });\n    &lt;/s:script&gt;\n\n\n    &lt;!-- ... --&gt;\n&lt;/head&gt;\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 4905182,
            "display_name": "Ryan"
          },
          "up_vote_count": 2,
          "is_accepted": false,
          "creation_date": 1675206696,
          "answer_id": 75304080,
          "body": "<p>I was also struggling with the new Content Security Policy interceptor.  We had to temporarily disable it since Struts doesn't really provide any way to configure it yet and all of those browser console error / CSP reports are really unacceptable.</p>\n<p>At least for me, in order to disable it across all of my actions in struts.xml I needed to reference &quot;cspInterceptor&quot; instead of &quot;csp&quot; as follows:</p>\n<pre><code>&lt;interceptor-ref name=&quot;defaultStack&quot; &gt;\n    &lt;param name=&quot;cspInterceptor.disabled&quot;&gt;true&lt;/param&gt;              \n&lt;/interceptor-ref&gt;\n</code></pre>\n"
        }
      ],
      "owner": {
        "user_id": 15262402,
        "display_name": "Sebastian Ruiz"
      },
      "view_count": 849,
      "up_vote_count": 5,
      "accepted_answer_id": 75252633,
      "answer_count": 3,
      "score": 5,
      "creation_date": 1674521858,
      "question_id": 75216534,
      "body": "<p>I have a problem updating my version of struts struts2-core-2.5.30 project to struts2-core-6.1.1 so I began to receive an error indicating that the security policies have been violated, doing some research, I found that a header should be added</p>\n<blockquote>\n<p>[Report Only] Refused to load the script '' because it violates the following Content Security Policy directive: &quot;script-src 'nonce-MOz6w31eaDHGUDfV__K8LEZ1' 'strict-dynamic' http: https:&quot;. Note that 'strict-dynamic' is present, so host-based allowlisting is disabled. Note that 'script-src-elem' was not explicitly set, so 'script-src' is used as a fallback.</p>\n</blockquote>\n<p>and inside this error I have this description</p>\n<blockquote>\n<p>[Report Only] Refused to load the script <code>http://localhost:8080/Portal/html/js/jquery/jquery-1.8.3.min.js</code> because it violates the following Content Security Policy directive: &quot;script-src 'nonce-MOz6w31eaDHGUDfV__K8LEZ1' 'strict-dynamic' http: https:&quot;. Note that 'strict-dynamic' is present, so host-based allowlisting is disabled. Note that 'script-src-elem' was not explicitly set, so 'script-src' is used as a fallback.</p>\n</blockquote>\n<blockquote>\n<p>[Report Only] Refused to load the script <code>http://localhost:8080/Portal/html/js/jquery/jquery-ui.1.10.4.min.js</code> because it violates the following Content Security Policy directive: &quot;script-src 'nonce-MOz6w31eaDHGUDfV__K8LEZ1' 'strict-dynamic' http: https:&quot;. Note that 'strict-dynamic' is present, so host-based allowlisting is disabled. Note that 'script-src-elem' was not explicitly set, so 'script-src' is used as a fallback.</p>\n</blockquote>\n<p>however I have tried these headers</p>\n<pre><code>&lt;meta http-equiv=&quot;Content-Security-Policy&quot; content=&quot;default-src 'self'&quot;&gt;\n\n\n&lt;meta http-equiv=&quot;Content-Security-Policy&quot; content=&quot;default-src *;\n    style-src * 'unsafe-inline'; script-src * 'unsafe-inline'\n    'unsafe-eval'; img-src * data: 'unsafe-inline'; connect-src *\n    'unsafe-inline'; frame-src *;&quot;&gt;\n\n&lt;meta http-equiv=&quot;Content-Security-Policy&quot; content=&quot;default-src  'nonce-rAnd0m'&quot;&gt;\n&lt;script src=&quot;${pageContext.request.contextPath}/html/js/jquery/jquery-1.8.3.min.js&quot; type=&quot;text/javascript&quot; nonce=&quot;rAnd0m123&quot;&gt;&lt;/script&gt; \n</code></pre>\n<p>with each of them I get the same error, In my previous version of Struts it did not ask me for any of this.</p>\n<p>I have also tried to make an interceptor to add the corresponding directives, however it did not work for me either.</p>\n<pre><code>import com.opensymphony.xwork2.ActionContext;\nimport com.opensymphony.xwork2.ActionInvocation;\nimport com.opensymphony.xwork2.interceptor.AbstractInterceptor;\nimport javax.servlet.http.HttpServletResponse;\nimport org.apache.struts2.StrutsStatics;\n\n\npublic class SessionInterceptor extends AbstractInterceptor{\n\n   private static final long serialVersionUID = 1L;\n\n\n   public String intercept(ActionInvocation invocation) throws Exception {\n     \n    ActionContext ac = invocation.getInvocationContext();\n    HttpServletResponse response = (HttpServletResponse) ac.get(StrutsStatics.HTTP_RESPONSE);\n    //HttpServletResponse response = ServletActionContext.getResponse();\n\n    response.addHeader(&quot;X-Frame-Options&quot;, &quot;SAMEORIGIN&quot;);\n    response.addHeader(&quot;Content-Security-Policy-Report-Only&quot;, &quot;default-src 'self'; script-src 'self' 'unsafe-inline'; object-src 'none'; style-src 'self' 'unsafe-inline'; img-src 'self'; media-src 'none'; frame-src 'none'; font-src 'self'; connect-src 'self'; report-uri REDACTED&quot;);\n    response.addHeader(&quot;X-Content-Security-Policy-Report-Only&quot;, &quot;default-src 'self'; script-src 'self' 'unsafe-inline'; object-src 'none'; style-src 'self' 'unsafe-inline'; img-src 'self'; media-src 'none'; frame-src 'none'; font-src 'self'; connect-src 'self'; report-uri REDACTED&quot;);\n    return invocation.invoke();\n}\n\n}\n</code></pre>\n<p>In the same way I have updated the jquery-1.8.3 version as suggested in the comments but it dod not worked for me either</p>\n"
    },
    {
      "tags": [
        "java",
        "lambda",
        "enums",
        "circular-reference",
        "anonymous-class"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 1098361,
            "display_name": "Zack Macomber"
          },
          "edited": false,
          "comment_id": 132480784,
          "body": "Interesting experiment. <a href=\"https://jenkov.com/tutorials/java/lambda-expressions.html\" rel=\"nofollow noreferrer\">jenkov.com/tutorials/java/lambda-expressions.html</a> states &quot;Java lambda expressions can only be used where the type they are matched against is a single method interface&quot;.  So it looks like where you tried to apply a lambda is not an ok place to apply it."
        },
        {
          "owner": {
            "user_id": 10118965,
            "display_name": "davidalayachew"
          },
          "edited": false,
          "comment_id": 132480824,
          "body": "@ZackMacomber Thank you for your response. I am not sure you are correct though. Isn&#39;t the interface I am matching against supposed to be my <code>Supplier&lt;RPS1&gt;</code>?"
        },
        {
          "owner": {
            "user_id": 1898563,
            "display_name": "Michael"
          },
          "edited": false,
          "comment_id": 132480848,
          "body": "Very good question but I&#39;ve edited it for brevity. I don&#39;t think your (unfortunately fruitless) searches really add much, and I think it&#39;s a better question without them. If you strongly disagree then feel free to add it back, but perhaps edit to the salient points."
        },
        {
          "owner": {
            "user_id": 10118965,
            "display_name": "davidalayachew"
          },
          "edited": false,
          "comment_id": 132481047,
          "body": "@Michael I see your edits. Thank you for the changes. I made a simple bullet list of the searches I tried to make. That should satisfy brevity while allowing people&#39;s support to be more informed/directed. Please edit my edit if you feel it should be different."
        },
        {
          "owner": {
            "user_id": 525036,
            "display_name": "Didier L"
          },
          "edited": false,
          "comment_id": 132481431,
          "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/55162147/acessing-same-class-enum-inside-an-enum-constructor-within-a-lambda-doesnt-com\">Accessing Same Class&#39; enum value inside an enum declaration within a lambda doesn&#39;t compile</a>"
        },
        {
          "owner": {
            "user_id": 10118965,
            "display_name": "davidalayachew"
          },
          "edited": false,
          "comment_id": 132481463,
          "body": "@DidierL Ohhhh, I think you found it Didier. I am reading further, but this might be it"
        },
        {
          "owner": {
            "user_id": 10118965,
            "display_name": "davidalayachew"
          },
          "edited": false,
          "comment_id": 132481848,
          "body": "@DidierL I think that you are correct. Both of our questions fail for the reason mentioned in the answer. I have edited my answer to include a reference to that question and a simple explanation. Thank you for the help. <a href=\"https://stackoverflow.com/a/55166692/10118965\">stackoverflow.com/a/55166692/10118965</a>"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 4373567,
            "display_name": "CSDragon"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1673368937,
          "answer_id": 75073194,
          "body": "<p>I'm not an expert so I could be wrong but this is my understanding.</p>\n<p>An Illegal Forward Reference means that you're trying to use a variable before it has been defined.\nIt's like saying <code>&quot;i = 10; int i;&quot;</code>.</p>\n<p>The first two actually use the variable that was passed. RPS0 and RPS1 assign an unknown variable SCISSORS to a field expecting an RPS0/RPS1 variable. This should be the expected result.</p>\n<p>For the Anonymous Class then, it must be doing something different.\nJava must be re-ordering the definitions to first define the RPS2 instances first, then instancing them after.</p>\n"
        },
        {
          "owner": {
            "user_id": 1898563,
            "display_name": "Michael"
          },
          "up_vote_count": 2,
          "is_accepted": true,
          "creation_date": 1673369306,
          "answer_id": 75073267,
          "body": "<p>I believe this is rooted in what the JLS calls <a href=\"https://docs.oracle.com/javase/specs/jls/se19/html/jls-16.html\" rel=\"nofollow noreferrer\">&quot;definite assignment&quot;</a>.</p>\n<p>First, it may be helpful to outline the order in which the enum is initialized for your first example.</p>\n<ol>\n<li>Some other class refers to the enum class for the first time, e.g. <code>RPS0.ROCK.winsAgainst()</code></li>\n<li>The &quot;clinit&quot; (static initializer is invoked)</li>\n<li>The enum constants are initialized in order of declaration\n<ol>\n<li>An equivalent of <code>public static final RPS0 ROCK = new RPS0(SCISSORS);</code></li>\n<li>An equivalent of <code>public static final RPS0 PAPER = new RPS0(ROCK);</code></li>\n<li>An equivalent of <code>public static final RPS0 SCISSORS = new RPS0(PAPER);</code></li>\n</ol>\n</li>\n<li>The enum class is now loaded</li>\n<li>The expression <code>RPS0.ROCK</code> is evaluated for that referencing class in #1</li>\n<li><code>winsAgainst</code> is invoked on that instance.</li>\n</ol>\n<p>The reason this fails on the <code>ROCK</code> line is because <code>SCISSORS</code> is not &quot;definitely assigned&quot;. Knowing the order of initialization, we can see it's even worse than that. Not only is it <em>not definitely</em> assigned, it's <em>definitely not</em> assigned. The assignment of <code>SCISSORS</code> (3.3) happens after <code>ROCK</code> (3.1).</p>\n<p><code>SCISSORS</code> would be null when <code>ROCK</code> tried to access it, if the compiler were to allow this. It's assigned later.</p>\n<p>We can see this for ourselves if we introduce some indirection. The definite assignment problem is now gone because our constructors aren't referencing the fields directly. The compiler isn't checking for any definite assignment in the constructor expression. The constructor is using result of a method invocation, not a field.</p>\n<p>All we've done is trick the compiler into allowing something that's going to fail.</p>\n<pre><code>enum RPS0\n{\n    ROCK(scissors()),\n    PAPER(rock()),\n    SCISSORS(paper());\n\n    public final RPS0 winsAgainst;\n\n    RPS0(final RPS0 winsAgainst)\n    {\n        this.winsAgainst = Objects.requireNonNull(winsAgainst); // boom\n    }\n    \n    \n    \n    private static RPS0 scissors() {\n        return RPS0.SCISSORS;\n    }\n\n    private static RPS0 rock() {\n        return RPS0.ROCK;\n    }\n\n    private static RPS0 paper() {\n        return RPS0.PAPER;\n    }\n}\n</code></pre>\n<p>The lambda case is pretty much identical. The value is still not definitely assigned. Consider a case where the enum constructor calls <code>get</code> on the <code>Supplier</code>. Refer back to the order of initialization above. In the example below, <code>ROCK</code> would be trying to access <code>SCISSORS</code> before it was initialized, and that's a potential bug that the compiler is trying to protect you from.</p>\n<pre><code>enum RPS1\n{\n    ROCK(() -&gt; SCISSORS), // compiler error\n    PAPER(() -&gt; ROCK),\n    SCISSORS(() -&gt; PAPER);\n     \n    private final Supplier&lt;RPS1&gt; winsAgainst;\n     \n    RPS1(final Supplier&lt;RPS1&gt; winsAgainst)\n    {\n        RPS1.get(); // doesn't compile, but would be null if it did\n    }\n}\n</code></pre>\n<p>Annoying, really, because you know you're <em>not</em> using the Supplier in that way, and that's the only time it may not be assigned yet.</p>\n<p>The reason the abstract class works is because the expression-target in the constructor is now gone completely. Again, refer back to the order of initialization. You should be able to see that for anything which calls <code>winsAgainst</code>, e.g. the example in #1, that invocation (#6) necessarily occurs after <em>all</em> enum constants have already been initialized (#3). The compiler can guarantee this access is safe.</p>\n<p>Putting together two of the things we know - that we can use indirection to stop the compiler complaining about lack of definite assignment, and that <code>Supplier</code> can supply a value lazily - we can create an alternative solution:</p>\n<pre><code>enum RPS0\n{\n    ROCK(RPS0::scissors), // i.e. () -&gt; scissors()\n    PAPER(RPS0::rock),\n    SCISSORS(RPS0::paper);\n\n    public final Supplier&lt;RPS0&gt; winsAgainst;\n\n    RPS0(Supplier&lt;RPS0&gt; winsAgainst) {\n        this.winsAgainst = winsAgainst;\n    }\n    \n    public RPS0 winsAgainst() {\n        return winsAgainst.get();\n    }\n\n\n    // Private indirection methods\n    private static RPS0 scissors() {\n        return RPS0.SCISSORS;\n    }\n\n    private static RPS0 rock() {\n        return RPS0.ROCK;\n    }\n\n    private static RPS0 paper() {\n        return RPS0.PAPER;\n    }\n}\n</code></pre>\n<p>This is provably safe, provided that the constructor never calls <code>Supplier.get</code> (including any methods the constructor itself calls).</p>\n"
        },
        {
          "owner": {
            "user_id": 3764965,
            "display_name": "Nikolas Charalambidis"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1673369533,
          "answer_id": 75073316,
          "body": "<p>Not really an answer, but as soon as you replace the first lambda expression with an anonymous class, it gets to work.</p>\n<pre class=\"lang-java prettyprint-override\"><code>enum RPS1 {\n    ROCK(new Supplier&lt;&gt;() {\n        @Override\n        public RPS1 get() {\n            return SCISSORS;\n        }\n    }),\n        \n    PAPER(() -&gt; ROCK),\n    SCISSORS(() -&gt; PAPER);\n\n    private final Supplier&lt;RPS1&gt; winsAgainst;\n\n    RPS1(final Supplier&lt;RPS1&gt; winsAgainst) {\n        this.winsAgainst = winsAgainst;\n    }\n\n    public RPS1 winsAgainst() {\n        return this.winsAgainst.get();\n    }\n}\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 1098361,
            "display_name": "Zack Macomber"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1673370104,
          "answer_id": 75073412,
          "body": "<p><a href=\"https://docs.oracle.com/javase/specs/jls/se8/html/jls-8.html#jls-8.3.3\" rel=\"nofollow noreferrer\">https://docs.oracle.com/javase/specs/jls/se8/html/jls-8.html#jls-8.3.3</a></p>\n<p>Based on the rules in there, it looks like the anonymous class is considered acceptable because it's a &quot;different class&quot;.</p>\n<p>There are several comments in the example that say &quot;ok - occurs in a different class&quot;</p>\n"
        }
      ],
      "owner": {
        "user_id": 10118965,
        "display_name": "davidalayachew"
      },
      "view_count": 111,
      "up_vote_count": 6,
      "accepted_answer_id": 75073267,
      "answer_count": 4,
      "score": 5,
      "creation_date": 1673367734,
      "question_id": 75072937,
      "body": "<p>I am trying to represent a <a href=\"https://en.wikipedia.org/wiki/State_diagram\" rel=\"nofollow noreferrer\">State Transition Diagram</a>, and I want to do this with a Java enum. I am well aware that there are many other ways to accomplish this with <code>Map&lt;K, V&gt;</code> or maybe with a static initialization block in my enum. However, I am trying to understand why the following occurs.</p>\n<p>Here is a(n extremely) simplified example of what I am trying to do.</p>\n<pre class=\"lang-java prettyprint-override\"><code>\nenum RPS0\n{\n  \n    ROCK(SCISSORS),\n    PAPER(ROCK),\n    SCISSORS(PAPER);\n     \n    public final RPS0 winsAgainst;\n     \n    RPS0(final RPS0 winsAgainst)\n    {\n        this.winsAgainst = winsAgainst;\n    }\n}\n</code></pre>\n<p>Obviously, this fails due to an illegal forward reference.</p>\n<pre><code>ScratchPad.java:150: error: illegal forward reference\n         ROCK(SCISSORS),\n              ^\n</code></pre>\n<p>That's fine, I accept that. Trying to manually insert <code>SCISSORS</code> there would require Java to try and setup <code>SCISSORS</code>, which would then trigger setting up <code>PAPER</code>, which would then trigger setting up <code>ROCK</code>, leading to an infinite loop. I can easily understand then why this direct reference is not acceptable, and is prohibited with a compiler error.</p>\n<p>So, I experimented and tried to do the same with lambdas.</p>\n<pre class=\"lang-java prettyprint-override\"><code>enum RPS1\n{\n    ROCK(() -&gt; SCISSORS),\n    PAPER(() -&gt; ROCK),\n    SCISSORS(() -&gt; PAPER);\n     \n    private final Supplier&lt;RPS1&gt; winsAgainst;\n     \n    RPS1(final Supplier&lt;RPS1&gt; winsAgainst)\n    {\n        this.winsAgainst = winsAgainst;\n    }\n     \n    public RPS1 winsAgainst()\n    {\n        return this.winsAgainst.get();\n    }\n}\n</code></pre>\n<p>It failed with basically the same error.</p>\n<pre><code>ScratchPad.java:169: error: illegal forward reference\n         ROCK(() -&gt; SCISSORS),\n                    ^\n</code></pre>\n<p>I was a little more bothered by this, since I really felt like the lambda should have allowed it to not fail. But admittedly, I didn't understand nearly enough about the rules, scoping, and boundaries of lambdas to have a firmer opinion.</p>\n<p>By the way, I experimented with adding curly braces and a return to the lambda, but that didn't help either.</p>\n<p>So, I tried with an anonymous class.</p>\n<pre class=\"lang-java prettyprint-override\"><code>enum RPS2\n{\n    ROCK\n    {\n        public RPS2 winsAgainst()\n        {\n            return SCISSORS;\n        } \n    },\n         \n    PAPER\n    {\n        public RPS2 winsAgainst()\n        {\n            return ROCK;\n        }     \n    },\n         \n    SCISSORS\n    {\n        public RPS2 winsAgainst()\n        {\n            return PAPER;\n        }\n    };\n         \n    public abstract RPS2 winsAgainst();   \n}\n</code></pre>\n<p>Shockingly enough, it worked.</p>\n<pre><code>System.out.println(RPS2.ROCK.winsAgainst()); //returns &quot;SCISSORS&quot;\n</code></pre>\n<p>So then, I thought to search the <a href=\"https://docs.oracle.com/javase/specs/jls/se19/html/index.html\" rel=\"nofollow noreferrer\">Java Language Specification for Java 19</a> for answers, but my searches ended up returning nothing. I tried doing Ctrl+F searches (case-insensitive) for relevant phrases like &quot;<em><strong>Illegal</strong></em>&quot;, &quot;<em><strong>Forward</strong></em>&quot;, &quot;<em><strong>Reference</strong></em>&quot;, &quot;<em><strong>Enum</strong></em>&quot;, &quot;<em><strong>Lambda</strong></em>&quot;, &quot;<em><strong>Anonymous</strong></em>&quot; and more. Here are some of the links I searched. Maybe I missed something in them that answers my question?</p>\n<ul>\n<li><a href=\"https://docs.oracle.com/javase/specs/jls/se19/html/jls-15.html#jls-15.9.5\" rel=\"nofollow noreferrer\">Anonymous Class</a></li>\n<li><a href=\"https://docs.oracle.com/javase/specs/jls/se19/html/jls-15.html#jls-15.27\" rel=\"nofollow noreferrer\">Lambda</a></li>\n<li><a href=\"https://docs.oracle.com/javase/specs/jls/se19/html/jls-8.html#d5e14309\" rel=\"nofollow noreferrer\">Restrictions on Field References</a></li>\n<li><a href=\"https://docs.oracle.com/javase/specs/jls/se19/html/jls-8.html#d5e16611\" rel=\"nofollow noreferrer\">Restriction on Enum Constant Self-Reference</a></li>\n</ul>\n<p>None of them answered my question. Could someone help me understand the rules in play that prevented me from using lambdas but allowed anonymous classes?</p>\n<p><em><strong>EDIT</strong></em> - @DidierL pointed out a link to <a href=\"https://stackoverflow.com/a/55166692/10118965\">another StackOverflow post</a> that deals with something similar. I think the answer given to that question is the same answer to mine. In short, an anonymous class has its own &quot;context&quot;, while a lambda does not. Therefore, when the lambda attempts to fetch declarations of variables/methods/etc., it would be the same as if you did it inline, like my RPS0 example above.</p>\n<p>It's frustrating, but I think that, as well as @Michael's answer have both answered my question to completion.</p>\n<p><em><strong>EDIT 2</strong></em> - Adding this snippet for my discussion with @Michael.</p>\n<pre class=\"lang-java prettyprint-override\"><code>\n      enum RPS4\n      {\n      \n         ROCK\n         {\n            \n            public RPS4 winsAgainst()\n            {\n            \n               return SCISSORS;\n            }\n         \n         },\n         \n         PAPER\n         {\n         \n            public RPS4 winsAgainst()\n            {\n            \n               return ROCK;\n               \n            }\n            \n         },\n         \n         SCISSORS\n         {\n         \n            public RPS4 winsAgainst()\n            {\n            \n               return PAPER;\n            \n            }\n         \n         },\n         ;\n         \n         public final RPS4 winsAgainst;\n         \n         RPS4()\n         {\n         \n            this.winsAgainst = this.winsAgainst();\n         \n         }\n         \n         public abstract RPS4 winsAgainst();\n      \n      }\n   \n</code></pre>\n"
    },
    {
      "tags": [
        "java",
        "generics"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 18632985,
            "display_name": "Hoang Minh Quang FX15045"
          },
          "edited": false,
          "comment_id": 132926881,
          "body": "I think that a list of a more specific type, such as List&lt;Point&lt;Float&gt;&gt;, cannot be assigned to a variable of a more general type, such as List&lt;Point&lt;? extends Float&gt;&gt;."
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 5133585,
            "display_name": "Sweeper"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1675412099,
          "answer_id": 75333056,
          "body": "<p>The constructor of <code>Plane</code> in your call takes a <code>List&lt;Points&lt;? extends Float&gt;&gt;</code>, but you are passing it a <code>List&lt;Points&lt;Float&gt;&gt;</code>.</p>\n<p>The relationship between <code>Points&lt;? extends Float&gt;</code> and <code>Points&lt;Float&gt;</code> is exactly like that of <code>Number</code> and <code>Integer</code> - one is the subtype of another. Compare:</p>\n<pre><code>// in both cases, you are assigning an instance of a subtype to a variable of a supertype\nPoints&lt;? extends Float&gt; p = new Points&lt;Float&gt;();\nNumber n = Integer.valueOf(1);\n</code></pre>\n<p>So trying to pass (or implicitly convert) a <code>List&lt;Points&lt;Float&gt;&gt;</code> into a <code>List&lt;Points&lt;? extends Float&gt;&gt;</code> is just like trying to do that with a <code>List&lt;Integer&gt;</code> and <code>List&lt;Number&gt;</code>. As you probably know already, <a href=\"https://stackoverflow.com/q/2745265/5133585\">it doesn't work at all</a> because allowing you to do this would make it unsafe to add things into the list:</p>\n<pre><code>List&lt;Integer&gt; integers = new ArrayList&lt;&gt;();\nList&lt;Number&gt; numbers = integers; // suppose this is allowed...\nnumbers.add(0.1f); // I can now add a float into the integer list!\n</code></pre>\n<p>In practice though, I <em>think</em> the same thing cannot happen with <code>List&lt;Points&lt;? extends Float&gt;&gt;</code> and <code>List&lt;Points&lt;Float&gt;&gt;</code>, because it is not possible to create another concrete subtype of <code>Points&lt;? extends Float&gt;</code> that is also not a subtype of <code>Points&lt;Float&gt;</code>. This is mainly because <code>Float</code> is <code>final</code>. However, the Java compiler isn't designed to see this.</p>\n<pre><code>List&lt;Points&lt;Float&gt;&gt; floatPoints = new ArrayList&lt;&gt;();\nList&lt;Points&lt;? extends Float&gt;&gt; extendsFloatPoints = floatPoints; // suppose this is allowed\nextendsFloatPoints.add(/* whatever you can add here can be added to floatPoints */);\n</code></pre>\n<hr>\n<p>One way to fix the error, is as you have found, to add <code>? extends</code>. In your case, this means:</p>\n<pre><code>private List&lt;? extends Points&lt;? extends T&gt;&gt; points;\npublic Plane() { }\npublic Plane(List&lt;? extends Points&lt;? extends T&gt;&gt; points) {\n    this.points = points;\n}\n</code></pre>\n<p>Note that this is <em>in addition</em> to the <code>? extends</code> in the type parameter of <code>Points</code>. This is analogous to turning <code>List&lt;Number&gt; numbers = new ArrayList&lt;Integer&gt;();</code> into <code>List&lt;? extends Number&gt; numbers = new ArrayList&lt;Integer&gt;();</code></p>\n<p>This essentially prevents you from adding anything into the list except nulls.</p>\n<p>Another way to solve the problem is to create a <code>List&lt;Points&lt;? extends Float&gt;&gt;</code> from the very beginning and pass that into the constructor. It is totally possible to do:</p>\n<pre><code>List&lt;Points&lt;? extends Float&gt;&gt; lp = new ArrayList&lt;&gt;();\n\nlp.add(new Points&lt;Float&gt;(1f, 2f));\n// add more points...\n\nPlane&lt;Float&gt; plane = new Plane&lt;&gt;(lp);\n</code></pre>\n<p>A third way is to just get rid of all the wildcard all together, and just use <code>List&lt;Points&lt;T&gt;&gt;</code> everywhere. I don't see much value in using them, since most of the <code>Number</code> subclasses are <code>final</code> anyway.</p>\n"
        },
        {
          "owner": {
            "user_id": 3553434,
            "display_name": "æ—¶é—´åªä¼šä¸€ç›´èµ°"
          },
          "up_vote_count": 2,
          "is_accepted": true,
          "creation_date": 1675412188,
          "answer_id": 75333065,
          "body": "<p>You are actually close to the correct answer.</p>\n<blockquote>\n<p>So i think Point&lt;? extends Float&gt; p = new Point() is the correct code</p>\n</blockquote>\n<p>Yes, this code is exactly correctï¼Œand you think of them as having an inheritance relationship</p>\n<p>It is easier to illustrate the problem if you compare Float and Number.</p>\n<p><code>Float</code> is extends <code>Number</code>, so <code>Float[]</code> is extends <code>Number[]</code> we call that '<strong>Covariance</strong>'.</p>\n<p>but <code>Point&lt;Float&gt;</code> is not extends <code>Point&lt;Number&gt;</code>, we call that generics is '<strong>Invariance</strong>'</p>\n<p>But the magic is <code>Point&lt;Float&gt;</code> <em><strong>'extends'</strong></em> <code>Point&lt;? extends Number&gt;</code>(At least we can see them as having an inheritance relationship)</p>\n<p>So, we can use <code>Point&lt;? extends Number&gt; p = new Point&lt;Float&gt;()</code> and <code>Point&lt;? extends Float&gt; p = new Point&lt;Float&gt;()</code>.</p>\n<p>In your code, you want to assign <code>List&lt;Point&lt;Float&gt;&gt;</code> to <code>List&lt;Point&lt;? extends Float&gt;&gt;</code>(cause T is Float, so <code>List&lt;Point&lt;? extends T&gt;&gt;</code> is <code>List&lt;Point&lt;? extends Float&gt;&gt;</code>)</p>\n<p>but as generics is '<strong>Invariance</strong>', although <code>Point&lt;Float&gt;</code> <em><strong>'extends'</strong></em> <code>Point&lt;? extends Float&gt;</code>, but <code>List&lt;Point&lt;Float&gt;&gt;</code> not extends <code>List&lt;Point&lt;? extends Float&gt;&gt;</code>.</p>\n<p><strong>what you should do is change the <code>List&lt;Point&lt;? extends T&gt;&gt;</code> to <code>List&lt;? extends Point&lt;? extends T&gt;&gt;</code></strong></p>\n"
        }
      ],
      "owner": {
        "user_id": 21122257,
        "display_name": "ForFree"
      },
      "view_count": 162,
      "up_vote_count": 5,
      "accepted_answer_id": 75333065,
      "answer_count": 2,
      "score": 5,
      "creation_date": 1675409142,
      "question_id": 75332666,
      "body": "<p>I can't assign value to List.</p>\n<p>I have two class like this:</p>\n<pre><code>public class Point&lt;T extends Number&gt; {\n    private T x;\n    private T y;\n    public Point() { }\n    public Point(T x, T y) {\n        this.x = x;\n        this.y = y;\n    }\n}\n\npublic class Plane&lt;T extends Number&gt; {\n    private List&lt;Point&lt;? extends T&gt;&gt; points;\n    public Plane() { }\n    public Plane(List&lt;Point&lt;? extends T&gt;&gt; points) {\n        this.points = points;\n    }\n}\n</code></pre>\n<p>Then I use List to init a value and use the List to init Plane like this:</p>\n<pre><code>List&lt;Point&lt;Float&gt;&gt; lp = new ArrayList&lt;Point&lt;Float&gt;&gt;();\nPlane&lt;Float&gt; plane = new Plane&lt;Float&gt;(lp); \n</code></pre>\n<p>I get a error <code>java.util.List&lt;Point&lt;java.lang.Float&gt;&gt; can not cast to java.util.List&lt;Point&lt;? extends java.lang.Float&gt;&gt;</code></p>\n<p>I found this page <a href=\"https://stackoverflow.com/questions/4343202/difference-between-super-t-and-extends-t-in-java\">Difference between &lt;? super T&gt; and &lt;? extends T&gt; in Java</a>, and that said we can use</p>\n<p><code>List&lt;? extends Number&gt; foo3 = new ArrayList&lt;Integer&gt;();</code>.</p>\n<p>So i think <code>Point&lt;? extends Float&gt; p = new Point&lt;Float&gt;()</code> is the correct code</p>\n<p>Back to my code, I think class Plane's constructor parameters witch type <code>List&lt;Point&lt;? extends T&gt;&gt; points</code> can receive type <code>List&lt;Point&lt;Float&gt;&gt;</code>, but i get that error!</p>\n<p>Can you tell me whyï¼Ÿ</p>\n<p>I search in googleï¼Œ why can't use List&lt;someclass&gt; to  List&lt;someclass&lt;? extend Float&gt;&gt;</p>\n"
    },
    {
      "tags": [
        "java",
        "maven",
        "pom.xml",
        "maven-plugin",
        "java-17"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 296328,
            "display_name": "khmarbaise"
          },
          "edited": false,
          "comment_id": 132492949,
          "body": "The plugin version you are using is ca. <a href=\"https://search.maven.org/artifact/org.apache.maven.plugins/maven-war-plugin\" rel=\"nofollow noreferrer\">10 years old</a>. You should use the most recent version of plugins <a href=\"https://maven.apache.org/plugins/\" rel=\"nofollow noreferrer\">maven.apache.org/plugins</a>"
        },
        {
          "owner": {
            "user_id": 17024722,
            "display_name": "Ruch"
          },
          "edited": false,
          "comment_id": 132493114,
          "body": "I&#39;m really sorry but I&#39;m new to this. Can you please tell me exact thing ? you mean maven version ? or war-plugin version ? My maven war plug in is &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt;&lt;version&gt;3.3.1&lt;/ver&zwnj;&#8203;sion&gt; and my maven-compiler plugin is &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;&lt;version&gt;3.8.1&zwnj;&#8203;&lt;/version&gt;"
        },
        {
          "owner": {
            "user_id": 296328,
            "display_name": "khmarbaise"
          },
          "edited": false,
          "comment_id": 132496265,
          "body": "The plugin version...."
        },
        {
          "owner": {
            "user_id": 7989121,
            "display_name": "brat"
          },
          "edited": false,
          "comment_id": 132526048,
          "body": "Perhaps showing how your pom looks like might help people help you? Although, don&#39;t dump the whole thing if its too big. Perhaps showing the top part where versions are usually displayed and the specific dependency tag for the maven plugin might suffice."
        },
        {
          "owner": {
            "user_id": 17024722,
            "display_name": "Ruch"
          },
          "edited": false,
          "comment_id": 132585366,
          "body": "Hi @brat , I&#39;ve updated the answer with the response of mvn dependency:tree . Can you please check and help me on that ?"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 11283654,
            "display_name": "Oshan Pitigala"
          },
          "up_vote_count": 3,
          "is_accepted": false,
          "creation_date": 1673870488,
          "answer_id": 75133915,
          "body": "<p>Try below options</p>\n<ol>\n<li><p>In your pom.xml, configure the below plugins</p>\n<ul>\n<li>maven-compiler-plugin -&gt; 3.10.1</li>\n<li>maven-war-plugin -&gt; 3.3.2</li>\n</ul>\n</li>\n<li><p>Try cleaning the project and updating the maven dependencies (right-click project -&gt; Maven -&gt; Update Project)</p>\n</li>\n<li><p>If it doesn't work, there might be an issue with your Maven install.\nYou may try uninstalling the M2Eclipse plugin, deleting the .m2 folder on your drive, and then reinstalling M2Eclipse.</p>\n</li>\n</ol>\n<hr />\n<p><em>PS:</em></p>\n<p><em>I noticed that you have used servlet 3 dependencies in your project. Since you are using java 17, you might upgrade them accordingly to the latest available versions</em></p>\n"
        }
      ],
      "owner": {
        "user_id": 17024722,
        "display_name": "Ruch"
      },
      "view_count": 2498,
      "up_vote_count": 5,
      "answer_count": 1,
      "score": 5,
      "creation_date": 1673422330,
      "question_id": 75079601,
      "body": "<p>I am trying to build my office project where I've upgraded from java 11 to 17.</p>\n<p>I've updated my maven according to the compatible java version and after getting a a lot of help on the rest of the errors I'm still stuck on this one.</p>\n<p>Things I've updated till now:<br />\nEclipse version, java version , java version , surefire plugin details, mirrorOf tag in settings.xml.</p>\n<p>Details of the versions are mentioned below :</p>\n<ul>\n<li><p>Java version - 17 .</p>\n</li>\n<li><p>Java Home - C:\\Program Files\\Java\\jdk-17.0.5</p>\n</li>\n<li><p>java path - C:\\Program Files\\Java\\jdk-17.0.5\\bin  -</p>\n</li>\n<li><p>java version in my pom - 17</p>\n</li>\n<li><p>maven version installed in my system - 3.8.5</p>\n</li>\n<li><p>maven_home - C:\\project\\Softwares\\Maven\\apache-maven-3.8.5\\bin</p>\n</li>\n<li><p>maven in my pom.xml  - 3.8.1</p>\n</li>\n</ul>\n<p>Now after setting up everything , this is the error. Please help me in rectifying this :</p>\n<pre><code>\nUnable to load the mojo 'war' in the plugin 'org.apache.maven.plugins:maven-war-plugin:2.2' due to an API incompatibility: org.codehaus.plexus.component.repository.exception.ComponentLookupException: Cannot access defaults field of Properties\n</code></pre>\n<p>EDIT 1  : Adding the pom.xml 4.0.0</p>\n<pre><code>    &lt;groupId&gt;com.apc&lt;/groupId&gt;\n    &lt;artifactId&gt;randonname&lt;/artifactId&gt;\n    &lt;version&gt;22.1.2&lt;/version&gt;\n    &lt;packaging&gt;war&lt;/packaging&gt;\n    &lt;name&gt;SE/name&gt;\n    &lt;properties&gt;\n        &lt;version.spring&gt;5.3.19&lt;/version.spring&gt;\n        &lt;version.hibernate&gt;5.4.0.Final&lt;/version.hibernate&gt;\n        &lt;version.batic&gt;1.10&lt;/version.batic&gt;\n        &lt;version.compiler&gt;17&lt;/version.compiler&gt;\n        &lt;!-- Only unit tests are run by default. --&gt;\n        &lt;skip.integration.tests&gt;true&lt;/skip.integration.tests&gt;\n    &lt;/properties&gt;\n\n    &lt;dependencies&gt;\n        &lt;!-- Spring dependencies Start --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-aop&lt;/artifactId&gt;\n            &lt;version&gt;${version.spring}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-expression&lt;/artifactId&gt;\n            &lt;version&gt;${version.spring}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-beans&lt;/artifactId&gt;\n            &lt;version&gt;${version.spring}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-context&lt;/artifactId&gt;\n            &lt;version&gt;${version.spring}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-context-support&lt;/artifactId&gt;\n            &lt;version&gt;${version.spring}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-core&lt;/artifactId&gt;\n            &lt;version&gt;${version.spring}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-web&lt;/artifactId&gt;\n            &lt;version&gt;${version.spring}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;\n            &lt;version&gt;${version.spring}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-orm&lt;/artifactId&gt;\n            &lt;version&gt;${version.spring}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-test&lt;/artifactId&gt;\n            &lt;version&gt;${version.spring}&lt;/version&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-security-config&lt;/artifactId&gt;\n            &lt;version&gt;5.7.1&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-security-web&lt;/artifactId&gt;\n            &lt;version&gt;5.7.1&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.security.extensions&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-security-saml2-core&lt;/artifactId&gt;\n            &lt;version&gt;1.0.3.RELEASE&lt;/version&gt;\n            &lt;exclusions&gt;\n                \n                &lt;exclusion&gt;\n                    &lt;groupId&gt;xml-apis&lt;/groupId&gt;\n                    &lt;artifactId&gt;xml-apis&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n            &lt;/exclusions&gt;\n            &lt;scope&gt;compile&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.json&lt;/groupId&gt;\n            &lt;artifactId&gt;json&lt;/artifactId&gt;\n            &lt;version&gt;20171018&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;!-- Spring dependencies End --&gt;\n        &lt;!-- Pagination with display tag. --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;displaytag&lt;/groupId&gt;\n            &lt;artifactId&gt;displaytag&lt;/artifactId&gt;\n            &lt;version&gt;1.2&lt;/version&gt;\n            &lt;exclusions&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n                    &lt;artifactId&gt;jcl104-over-slf4j&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;com.lowagie&lt;/groupId&gt;\n                    &lt;artifactId&gt;itext&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n                    &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;commons-beanutils&lt;/groupId&gt;\n                    &lt;artifactId&gt;commons-beanutils&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n            &lt;/exclusions&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;asm&lt;/groupId&gt;\n            &lt;artifactId&gt;asm-attrs&lt;/artifactId&gt;\n            &lt;version&gt;1.5.3&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;asm&lt;/groupId&gt;\n            &lt;artifactId&gt;asm&lt;/artifactId&gt;\n            &lt;version&gt;3.3.1&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;cglib&lt;/groupId&gt;\n            &lt;artifactId&gt;cglib&lt;/artifactId&gt;\n            &lt;version&gt;2.2&lt;/version&gt;\n            &lt;exclusions&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;asm&lt;/groupId&gt;\n                    &lt;artifactId&gt;asm&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n            &lt;/exclusions&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.aspectj&lt;/groupId&gt;\n            &lt;artifactId&gt;aspectjrt&lt;/artifactId&gt;\n            &lt;version&gt;1.6.5&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.aspectj&lt;/groupId&gt;\n            &lt;artifactId&gt;aspectjweaver&lt;/artifactId&gt;\n            &lt;version&gt;1.6.5&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n            &lt;artifactId&gt;hibernate-validator&lt;/artifactId&gt;\n            &lt;version&gt;${version.hibernate}&lt;/version&gt;\n            &lt;exclusions&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;org.jboss.logging&lt;/groupId&gt;\n                    &lt;artifactId&gt;jboss-logging&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n            &lt;/exclusions&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n            &lt;artifactId&gt;hibernate-core&lt;/artifactId&gt;\n            &lt;version&gt;${version.hibernate}&lt;/version&gt;\n        &lt;!--&lt;exclusions&gt;\n            &lt;exclusion&gt;\n                    &lt;groupId&gt;dom4j&lt;/groupId&gt;\n    &lt;artifactId&gt;dom4j&lt;/artifactId&gt;\n            &lt;/exclusion&gt;\n        &lt;/exclusions&gt;--&gt;\n\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n            &lt;artifactId&gt;hibernate-ehcache&lt;/artifactId&gt;\n            &lt;version&gt;${version.hibernate}&lt;/version&gt;\n            &lt;exclusions&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;net.sf.jsr107cache&lt;/groupId&gt;\n                    &lt;artifactId&gt;jsr107cache&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;net.sf.ehcache&lt;/groupId&gt;\n                    &lt;artifactId&gt;ehcache&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n            &lt;/exclusions&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;net.sf.ehcache&lt;/groupId&gt;\n            &lt;artifactId&gt;ehcache&lt;/artifactId&gt;\n            &lt;version&gt;2.10.1&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;!--&lt;dependency&gt;\n            &lt;groupId&gt;javax.sql&lt;/groupId&gt;\n            &lt;artifactId&gt;jdbc2_0-stdext&lt;/artifactId&gt;\n            &lt;version&gt;1.0&lt;/version&gt;\n        &lt;/dependency&gt;--&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.tapestry&lt;/groupId&gt;\n            &lt;artifactId&gt;tapestry-core&lt;/artifactId&gt;\n            &lt;version&gt;5.2.6&lt;/version&gt;\n            &lt;exclusions&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;log4j&lt;/groupId&gt;\n                    &lt;artifactId&gt;log4j&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n                    &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;artifactId&gt;javassist&lt;/artifactId&gt;\n                    &lt;groupId&gt;javassist&lt;/groupId&gt;\n                &lt;/exclusion&gt;\n            &lt;/exclusions&gt;\n        &lt;/dependency&gt;\n        &lt;!-- Java EE Related Start --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;javax.servlet&lt;/groupId&gt;\n            &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt;\n            &lt;version&gt;3.0.1&lt;/version&gt;\n            &lt;scope&gt;provided&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;javax.servlet&lt;/groupId&gt;\n            &lt;artifactId&gt;jsp-api&lt;/artifactId&gt;\n            &lt;version&gt;2.0&lt;/version&gt;\n            &lt;scope&gt;provided&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;jstl&lt;/groupId&gt;\n            &lt;artifactId&gt;jstl&lt;/artifactId&gt;\n            &lt;version&gt;1.2&lt;/version&gt;\n            &lt;type&gt;jar&lt;/type&gt;\n            &lt;!-- &lt;scope&gt;provided&lt;/scope&gt; --&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;javax.mail&lt;/groupId&gt;\n            &lt;artifactId&gt;mail&lt;/artifactId&gt;\n            &lt;version&gt;1.4.2&lt;/version&gt;\n            &lt;exclusions&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;javax.activation&lt;/groupId&gt;\n                    &lt;artifactId&gt;activation&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n            &lt;/exclusions&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;javax.transaction&lt;/groupId&gt;\n            &lt;artifactId&gt;jta&lt;/artifactId&gt;\n            &lt;version&gt;1.1&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;javax.annotation&lt;/groupId&gt;\n            &lt;artifactId&gt;javax.annotation-api&lt;/artifactId&gt;\n            &lt;version&gt;1.3.2&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;javax.xml.ws&lt;/groupId&gt;\n            &lt;artifactId&gt;jaxws-api&lt;/artifactId&gt;\n            &lt;version&gt;2.2.6&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;javax.jws&lt;/groupId&gt;\n            &lt;artifactId&gt;javax.jws-api&lt;/artifactId&gt;\n            &lt;version&gt;1.1&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;!-- Java EE Related End --&gt;\n        &lt;!-- Logging Related dependencies Start --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n            &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;\n            &lt;version&gt;1.6.1&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;commons-logging&lt;/groupId&gt;\n            &lt;artifactId&gt;commons-logging&lt;/artifactId&gt;\n            &lt;version&gt;1.1&lt;/version&gt;\n            &lt;exclusions&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;log4j&lt;/groupId&gt;\n                    &lt;artifactId&gt;log4j&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;avalon-framework&lt;/groupId&gt;\n                    &lt;artifactId&gt;avalon-framework&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;logkit&lt;/groupId&gt;\n                    &lt;artifactId&gt;logkit&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;javax.servlet&lt;/groupId&gt;\n                    &lt;artifactId&gt;servlet-api&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n            &lt;/exclusions&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\n            &lt;artifactId&gt;log4j-api&lt;/artifactId&gt;\n            &lt;version&gt;2.17.1&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\n            &lt;artifactId&gt;log4j-core&lt;/artifactId&gt;\n            &lt;version&gt;2.17.1&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;!-- Logging Related dependencies End --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;\n            &lt;artifactId&gt;commons-pool2&lt;/artifactId&gt;\n            &lt;version&gt;2.6.0&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;joda-time&lt;/groupId&gt;\n            &lt;artifactId&gt;joda-time&lt;/artifactId&gt;\n            &lt;version&gt;2.10.1&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;commons-beanutils&lt;/groupId&gt;\n            &lt;artifactId&gt;commons-beanutils-bean-collections&lt;/artifactId&gt;\n            &lt;version&gt;1.8.3&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;commons-beanutils&lt;/groupId&gt;\n            &lt;artifactId&gt;commons-beanutils-core&lt;/artifactId&gt;\n            &lt;version&gt;1.8.3&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;\n            &lt;artifactId&gt;commons-lang3&lt;/artifactId&gt;\n            &lt;version&gt;3.3.2&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.googlecode.jsontoken&lt;/groupId&gt;\n            &lt;artifactId&gt;jsontoken&lt;/artifactId&gt;\n            &lt;version&gt;1.0&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;commons-codec&lt;/groupId&gt;\n            &lt;artifactId&gt;commons-codec&lt;/artifactId&gt;\n            &lt;version&gt;1.9&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;junit&lt;/groupId&gt;\n            &lt;artifactId&gt;junit&lt;/artifactId&gt;\n            &lt;version&gt;4.12&lt;/version&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.easymock&lt;/groupId&gt;\n            &lt;artifactId&gt;easymock&lt;/artifactId&gt;\n            &lt;version&gt;4.0.2&lt;/version&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.easymock&lt;/groupId&gt;\n            &lt;artifactId&gt;easymockclassextension&lt;/artifactId&gt;\n            &lt;version&gt;3.2&lt;/version&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.microsoft.sqlserver&lt;/groupId&gt;\n            &lt;artifactId&gt;mssql-jdbc&lt;/artifactId&gt;\n            &lt;version&gt;8.2.2.jre11&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.gutor.configurators.validator&lt;/groupId&gt;\n            &lt;artifactId&gt;gutor-design-validator&lt;/artifactId&gt;\n            &lt;version&gt;0.0.1&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;net.sf.jasperreports&lt;/groupId&gt;\n            &lt;artifactId&gt;jasperreports&lt;/artifactId&gt;\n            &lt;version&gt;5.1.0&lt;/version&gt;\n            &lt;exclusions&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;xml-apis&lt;/groupId&gt;\n                    &lt;artifactId&gt;xml-apis&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;xml-apis&lt;/groupId&gt;\n                    &lt;artifactId&gt;xml-&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                \n                &lt;exclusion&gt;\n                    &lt;groupId&gt;org.bouncycastle&lt;/groupId&gt;\n                    &lt;artifactId&gt;bcprov-jdk14&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;bouncycastle&lt;/groupId&gt;\n                    &lt;artifactId&gt;bcmail-jdk14&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;bouncycastle&lt;/groupId&gt;\n                    &lt;artifactId&gt;bcprov-jdk14&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;org.bouncycastle&lt;/groupId&gt;\n                    &lt;artifactId&gt;bctsp-jdk14&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;org.codehaus.castor&lt;/groupId&gt;\n                    &lt;artifactId&gt;castor&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;\n                    &lt;artifactId&gt;jackson-annotations&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;\n                    &lt;artifactId&gt;jackson-core&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;\n                    &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;jfree&lt;/groupId&gt;\n                    &lt;artifactId&gt;jcommon&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;jfree&lt;/groupId&gt;\n                    &lt;artifactId&gt;jfreechart&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n            &lt;/exclusions&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;ar.com.fdvs&lt;/groupId&gt;\n            &lt;artifactId&gt;DynamicJasper&lt;/artifactId&gt;\n            &lt;version&gt;4.0.4&lt;/version&gt;\n            &lt;exclusions&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;jasperreports&lt;/groupId&gt;\n                    &lt;artifactId&gt;jasperreports&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n            &lt;/exclusions&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;\n            &lt;artifactId&gt;poi&lt;/artifactId&gt;\n            &lt;version&gt;4.1.2&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;\n            &lt;artifactId&gt;commons-collections4&lt;/artifactId&gt;\n            &lt;version&gt;4.1&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;!-- Adding the dependency for Oracle WS, this jar (soap.jar) is reused \n                from the DP libs. --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.apc.oracle.pricing&lt;/groupId&gt;\n            &lt;artifactId&gt;oracle-ws&lt;/artifactId&gt;\n            &lt;version&gt;1.0&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.apc.oracle.pricing&lt;/groupId&gt;\n            &lt;artifactId&gt;http_client&lt;/artifactId&gt;\n            &lt;version&gt;1.0&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.apc.designtools&lt;/groupId&gt;\n            &lt;artifactId&gt;dp-configurator-integration&lt;/artifactId&gt;\n            &lt;version&gt;0.4&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.apc.designtools&lt;/groupId&gt;\n            &lt;artifactId&gt;dp-quotingsystem-integration&lt;/artifactId&gt;\n            &lt;version&gt;0.4&lt;/version&gt;\n            &lt;exclusions&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n                    &lt;artifactId&gt;spring-asm&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n            &lt;/exclusions&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.jdom&lt;/groupId&gt;\n            &lt;artifactId&gt;jdom&lt;/artifactId&gt;\n            &lt;version&gt;1.1&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;!-- https://mvnrepository.com/artifact/javax.xml/jaxrpc --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;javax.xml&lt;/groupId&gt;\n    &lt;artifactId&gt;jaxrpc&lt;/artifactId&gt;\n    &lt;version&gt;1.1&lt;/version&gt;\n&lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;axis&lt;/groupId&gt;\n            &lt;artifactId&gt;axis&lt;/artifactId&gt;\n            &lt;version&gt;1.4&lt;/version&gt;\n            \n            &lt;exclusions&gt;\n                \n                &lt;exclusion&gt;\n    &lt;groupId&gt;axis&lt;/groupId&gt;\n    &lt;artifactId&gt;axis-jaxrpc&lt;/artifactId&gt;\n\n                    \n                &lt;/exclusion&gt;\n                \n            &lt;/exclusions&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;axis&lt;/groupId&gt;\n            &lt;artifactId&gt;axis-wsdl4j&lt;/artifactId&gt;\n            &lt;version&gt;1.5.1&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.axis2&lt;/groupId&gt;\n            &lt;artifactId&gt;axis2-adb&lt;/artifactId&gt;\n            &lt;version&gt;1.4.1&lt;/version&gt;\n            &lt;exclusions&gt;\n                &lt;exclusion&gt;\n    &lt;groupId&gt;jaxen&lt;/groupId&gt;\n    &lt;artifactId&gt;jaxen&lt;/artifactId&gt;\n\n                    \n                &lt;/exclusion&gt;\n            \n                &lt;exclusion&gt;\n    &lt;groupId&gt;xerces&lt;/groupId&gt;\n    &lt;artifactId&gt;xercesImpl&lt;/artifactId&gt;\n\n                    \n                &lt;/exclusion&gt;\n                \n                &lt;exclusion&gt;\n                    &lt;groupId&gt;xml-apis&lt;/groupId&gt;\n                    &lt;artifactId&gt;xml-apis&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;javax.servlet&lt;/groupId&gt;\n                    &lt;artifactId&gt;servlet-api&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;org.apache.ws.commons.axiom&lt;/groupId&gt;\n                    &lt;artifactId&gt;axiom&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;org.apache.ws.commons.axiom&lt;/groupId&gt;\n                    &lt;artifactId&gt;am-dom&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;javax.activation&lt;/groupId&gt;\n                    &lt;artifactId&gt;activation&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;org.apache.httpcomponents&lt;/groupId&gt;\n                    &lt;artifactId&gt;httpcore&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;org.apache.httpcomponents&lt;/groupId&gt;\n                    &lt;artifactId&gt;httpcore-nio&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;wsdl4j&lt;/groupId&gt;\n                    &lt;artifactId&gt;wsdl4j&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;org.apache.woden&lt;/groupId&gt;\n                    &lt;artifactId&gt;woden-api&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;org.apache.woden&lt;/groupId&gt;\n                    &lt;artifactId&gt;woden-impl-dom&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;annogen&lt;/groupId&gt;\n                    &lt;artifactId&gt;annogen&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;org.apache.geronimo.specs&lt;/groupId&gt;\n                    &lt;artifactId&gt;geronimo-jms_1.1_spec&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;org.apache.geronimo.specs&lt;/groupId&gt;\n                    &lt;artifactId&gt;geronimo-activation_1.1_spec&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;org.apache.geronimo.specs&lt;/groupId&gt;\n                    &lt;artifactId&gt;specs&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;org.apache.geronimo.specs&lt;/groupId&gt;\n                    &lt;artifactId&gt;geronimo-javamail_1.4_spec&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;org.apache.geronimo.specs&lt;/groupId&gt;\n                    &lt;artifactId&gt;geronimo-stax-api_1.0_spec&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;commons-logging&lt;/groupId&gt;\n                    &lt;artifactId&gt;commons-logging&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;org.igniterealtime&lt;/groupId&gt;\n                    &lt;artifactId&gt;smack&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;commons-lang&lt;/groupId&gt;\n                    &lt;artifactId&gt;commons-lang&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;org.codehaus.woodstox&lt;/groupId&gt;\n                    &lt;artifactId&gt;wstx-asl&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n            &lt;/exclusions&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.xmlgraphics&lt;/groupId&gt;\n            &lt;artifactId&gt;batik-transcoder&lt;/artifactId&gt;\n            &lt;version&gt;${version.batic}&lt;/version&gt;\n            &lt;exclusions&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;xml-apis&lt;/groupId&gt;\n                    &lt;artifactId&gt;xml-apis-ext&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;xml-apis&lt;/groupId&gt;\n                    &lt;artifactId&gt;xml-apis&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                \n                &lt;exclusion&gt;\n                    &lt;groupId&gt;org.apache.xmlgraphics&lt;/groupId&gt;\n    &lt;artifactId&gt;batik-ext&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                \n            &lt;/exclusions&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.xmlgraphics&lt;/groupId&gt;\n            &lt;artifactId&gt;batik-codec&lt;/artifactId&gt;\n            &lt;version&gt;${version.batic}&lt;/version&gt;\n            &lt;exclusions&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;xml-apis&lt;/groupId&gt;\n                    &lt;artifactId&gt;xml-&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n            &lt;exclusion&gt;\n                    &lt;groupId&gt;xml-apis&lt;/groupId&gt;\n                    &lt;artifactId&gt;xml-apis-ext&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n            &lt;/exclusions&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.xmlgraphics&lt;/groupId&gt;\n            &lt;artifactId&gt;batik-extension&lt;/artifactId&gt;\n            &lt;version&gt;${version.batic}&lt;/version&gt;\n            &lt;exclusions&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;xml-apis&lt;/groupId&gt;\n                    &lt;artifactId&gt;xml-apis&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;xml-apis&lt;/groupId&gt;\n                    &lt;artifactId&gt;xml-apis-ext&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                \n                &lt;exclusion&gt;\n                    &lt;groupId&gt;org.apache.xmlgraphics&lt;/groupId&gt;\n    &lt;artifactId&gt;batik-ext&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n            &lt;/exclusions&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.xmlgraphics&lt;/groupId&gt;\n            &lt;artifactId&gt;batik-gui-util&lt;/artifactId&gt;\n            &lt;version&gt;${version.batic}&lt;/version&gt;\n            \n            &lt;exclusions&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;xml-apis&lt;/groupId&gt;\n                    &lt;artifactId&gt;xml-&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n            &lt;/exclusions&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.xmlgraphics&lt;/groupId&gt;\n            &lt;artifactId&gt;batik-swing&lt;/artifactId&gt;\n            &lt;version&gt;${version.batic}&lt;/version&gt;\n            \n            &lt;exclusions&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;xml-apis&lt;/groupId&gt;\n                    &lt;artifactId&gt;xml-&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n            &lt;exclusion&gt;\n                    &lt;groupId&gt;org.apache.xmlgraphics&lt;/groupId&gt;\n    &lt;artifactId&gt;batik-ext&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;xml-apis&lt;/groupId&gt;\n                    &lt;artifactId&gt;xml-apis&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;xml-apis&lt;/groupId&gt;\n                    &lt;artifactId&gt;xml-apis-ext&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n            &lt;/exclusions&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.googlecode.charts4j&lt;/groupId&gt;\n            &lt;artifactId&gt;charts4j&lt;/artifactId&gt;\n            &lt;version&gt;1.3&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;net.glxn&lt;/groupId&gt;\n            &lt;artifactId&gt;qrgen&lt;/artifactId&gt;\n            &lt;version&gt;1.2&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.quartz-scheduler&lt;/groupId&gt;\n            &lt;artifactId&gt;quartz&lt;/artifactId&gt;\n            &lt;version&gt;2.2.3&lt;/version&gt;\n        &lt;/dependency&gt;\n        \n        \n    \n        \n        &lt;dependency&gt;\n            &lt;groupId&gt;opensymphony&lt;/groupId&gt;\n            &lt;artifactId&gt;quartz-all&lt;/artifactId&gt;\n            &lt;version&gt;1.6.3&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;\n            &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;\n            &lt;version&gt;2.9.4&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.eclipse.persistence&lt;/groupId&gt;\n            &lt;artifactId&gt;org.eclipse.persistence.moxy&lt;/artifactId&gt;\n            &lt;version&gt;2.5.0&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.auth0&lt;/groupId&gt;\n            &lt;artifactId&gt;java-jwt&lt;/artifactId&gt;\n            &lt;version&gt;2.1.0&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.google.code.gson&lt;/groupId&gt;\n            &lt;artifactId&gt;gson&lt;/artifactId&gt;\n            &lt;version&gt;2.5&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;\n            &lt;artifactId&gt;poi-ooxml&lt;/artifactId&gt;\n            &lt;version&gt;4.1.2&lt;/version&gt;\n            &lt;exclusions&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;xml-apis&lt;/groupId&gt;\n                    &lt;artifactId&gt;xml-&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;!--&lt;exclusion&gt;\n                &lt;groupId&gt;org.apache.xmlbeans&lt;/groupId&gt;\n                &lt;artifactId&gt;xmlbeans&lt;/artifactId&gt;\n            &lt;/exclusion&gt;--&gt;\n            &lt;/exclusions&gt;\n        &lt;/dependency&gt;\n        &lt;!-- https://mvnrepository.com/artifact/org.apache.poi/ooxml-schemas --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;\n            &lt;artifactId&gt;ooxml-schemas&lt;/artifactId&gt;\n            &lt;version&gt;1.4&lt;/version&gt;\n            &lt;exclusions&gt;\n            &lt;!--    &lt;exclusion&gt;\n    &lt;groupId&gt;org.apache.xmlbeans&lt;/groupId&gt;\n    &lt;artifactId&gt;xmlbeans&lt;/artifactId&gt;\n                &lt;/exclusion&gt;--&gt;\n                \n                \n                &lt;exclusion&gt;\n                    &lt;groupId&gt;xml-apis&lt;/groupId&gt;\n                    &lt;artifactId&gt;xml-&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n            &lt;/exclusions&gt;\n        &lt;/dependency&gt;\n        &lt;!-- https://mvnrepository.com/artifact/org.apache.poi/poi-ooxml-schemas --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;\n            &lt;artifactId&gt;poi-ooxml-schemas&lt;/artifactId&gt;\n            &lt;version&gt;4.1.2&lt;/version&gt;\n            &lt;exclusions&gt;\n                \n                &lt;!--&lt;exclusion&gt;\n    &lt;groupId&gt;org.apache.xmlbeans&lt;/groupId&gt;\n    &lt;artifactId&gt;xmlbeans&lt;/artifactId&gt;\n                &lt;/exclusion&gt;--&gt;\n                \n                &lt;exclusion&gt;\n                    &lt;groupId&gt;xml-apis&lt;/groupId&gt;\n                    &lt;artifactId&gt;xml-&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n            &lt;/exclusions&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.jayway.jsonpath&lt;/groupId&gt;\n            &lt;artifactId&gt;json-path&lt;/artifactId&gt;\n            &lt;version&gt;2.4.0&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;!-- Kafka dependencies - Start --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.kafka&lt;/groupId&gt;\n            &lt;artifactId&gt;kafka-clients&lt;/artifactId&gt;\n            &lt;version&gt;2.6.0&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.kafka&lt;/groupId&gt;\n            &lt;artifactId&gt;kafka-streams&lt;/artifactId&gt;\n            &lt;version&gt;2.6.0&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;!-- Kafka dependencies - End --&gt;\n    &lt;/dependencies&gt;\n    \n\n</code></pre>\n<p>also please refer this for plugins added in my project\n<a href=\"https://i.stack.imgur.com/rwwcl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rwwcl.png\" alt=\"enter image description here\" /></a>\n<a href=\"https://i.stack.imgur.com/TTE9t.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n<p>EDIT 2 : Even though , I've added the latest maven -war in my pom but while running the build, the maven is picking the 2.2 version .\nPlease see the snapshot here <a href=\"https://i.stack.imgur.com/eDJ1u.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eDJ1u.png\" alt=\"enter image description here\" /></a></p>\n"
    },
    {
      "tags": [
        "java",
        "spring",
        "postgresql",
        "docker",
        "docker-compose"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 8281848,
            "display_name": "MSpiller"
          },
          "edited": false,
          "comment_id": 133709414,
          "body": "Do you really need to run the unit tests while the docker container is built? Wouldn&#39;t it make more sense to run the unit tests separate and only build your application&#39;s container when they pass?"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 1406656,
            "display_name": "PaPu"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1679392705,
          "answer_id": 75799696,
          "body": "<p>As I understand you need insert endpoint of postgres where <code>db</code> in <code>jdbc:postgresql://db:5432</code>\nOr if you have docker-compose.yml, service name of postgresql should be <code>db</code></p>\n"
        },
        {
          "owner": {
            "user_id": 11715259,
            "display_name": "N1ngu"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1679501174,
          "answer_id": 75814666,
          "body": "<p>Skip tests while building the image, see <a href=\"https://stackoverflow.com/q/7456006/11715259\">Maven package/install without test (skip tests)</a></p>\n<p>Once the image is built, you can run the tests by starting a container in an environment where a DB endpoint is available.</p>\n"
        },
        {
          "owner": {
            "user_id": 13942448,
            "display_name": "jccampanero"
          },
          "up_vote_count": 3,
          "is_accepted": true,
          "creation_date": 1679525982,
          "answer_id": 75817961,
          "body": "<p>Roughly speaking, when you build your image under the hood docker creates a series of intermediate containers, one for every line in your Dockerfile.</p>\n<p>You are trying to connect from one of this intermediate containers, the one which is packaging your application, to another container running Postgres in your host.</p>\n<p>I am not sure if it will work - the subject had been broadly covered here in <a href=\"https://stackoverflow.com/questions/24319662/from-inside-of-a-docker-container-how-do-i-connect-to-the-localhost-of-the-mach\">SO</a> - but, if you are using MacOS or Windows, and your Postgres container exposes the port to the host, you could try modifying the connection string in your Spring properties and use the network address <code>host.docker.internal</code> to try reaching the database:</p>\n<pre><code># datasource\nspring.datasource.url=jdbc:postgresql://host.docker.internal:5432/myApp?currentSchema=gpclinic&amp;createDatabaseIfNotExist=true\nspring.datasource.username=uname\nspring.datasource.password=pword\n</code></pre>\n<p>You mentioned compose as well, but again I am not sure whether it is possible. Please, see <a href=\"https://stackoverflow.com/questions/71553245/connect-to-another-dockerized-app-from-intermediate-containers-which-would-be-cr\">this related SO question</a>.</p>\n<p>Having said that, please, be aware that the solution has different drawbacks, among others:</p>\n<ul>\n<li>It makes your docker build not portable, think about building it in Linux or in a CI/CD system.</li>\n<li>Probably you will need to set some kind of Spring profile or similar stuff for dealing with the properties value change.</li>\n</ul>\n<p>I think that, as suggested in other answers, it is preferable to skip the unit tests execution while building your image. You can achieve this in several ways, for example (<code>clean</code> is not necessary, but I usually clean before packaging the application):</p>\n<pre><code># Compile and package the application to an executable JAR\nRUN mvn clean package -skipTests\n</code></pre>\n<p>Or:</p>\n<pre><code># Compile and package the application to an executable JAR\nRUN mvn clean package -Dmaven.test.skip=true\n</code></pre>\n<p>The same approach is addressed in <a href=\"https://stackoverflow.com/questions/55226062/maven-fail-in-spring-project-build-trying-to-establish-connection-with-database\">this SO related question</a>, for instance.</p>\n<p>Following this approach, if you really need to run your tests, it is preferable to use a devoted step in a CI/CD system pipeline, for example, instead of running it in the docker build.</p>\n<p>Finally, please, consider why you are accessing a database in a unit test: in my opinion, and please, forgive me, because SO answer shouldn't be opinion based, it is something that you can find in an integration test, for example, but I think it is not commonly used in unit tests.</p>\n<p>Even in the case that using a database is a must, for simplicity, predictability, in order to improve portability and build isolation, please, consider use an in-memory one like <a href=\"https://www.h2database.com/html/main.html\" rel=\"nofollow noreferrer\">H2</a> with the necessary information, and run your tests against it instead.</p>\n"
        },
        {
          "owner": {
            "user_id": 14645910,
            "display_name": "chatla harishwar"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1679906927,
          "answer_id": 75853767,
          "body": "<p>I think the Below Answer might Help you</p>\n<p>May be You can Add h2 database properites in a seperate properties file</p>\n<p>application-test.properties.</p>\n<pre><code>spring.datasource.url=jdbc:h2:mem:testdb\nspring.datasource.driverClassName=org.h2.Driver\nspring.datasource.username=user\nspring.datasource.password=password\nspring.jpa.database-platform=org.hibernate.dialect.H2Dialect\n</code></pre>\n<p>And may be Change the Scope in original application.properties</p>\n<pre><code>spring.profiles.active=test\n</code></pre>\n<p>And you can Third Dependency for h2 Database as it will not be dependent on any other Database ..h2 Database runs in your JVM</p>\n<pre><code>&lt;!-- https://mvnrepository.com/artifact/com.h2database/h2 --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;com.h2database&lt;/groupId&gt;\n    &lt;artifactId&gt;h2&lt;/artifactId&gt;\n    &lt;scope&gt;test&lt;/scope&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>So in this Case you Dont need any container to Run the Tests...Once the Tests Passes your package will be built.</p>\n"
        }
      ],
      "owner": {
        "user_id": 12268910,
        "display_name": "java12399900"
      },
      "view_count": 246,
      "up_vote_count": 7,
      "accepted_answer_id": 75817961,
      "answer_count": 4,
      "score": 5,
      "creation_date": 1679161915,
      "question_id": 75777666,
      "body": "<p>I have a standard spring boot application with this docker file:</p>\n<pre><code>FROM maven:latest AS maven\n\nWORKDIR /usr/src/app\nCOPY . /usr/src/app\n# Compile and package the application to an executable JAR\nRUN mvn package\n\nFROM amazoncorretto:17-alpine-jdk\n\nARG JAR_FILE=app.jar\n\nWORKDIR /opt/app\n\n# Copy the jar from the maven stage to the /opt/app directory of the current stage.\nCOPY --from=maven /usr/src/app/target/${JAR_FILE} /opt/app/\n\nEXPOSE 8080\n\nENTRYPOINT [&quot;java&quot;,&quot;-jar&quot;,&quot;app.jar&quot;]\n</code></pre>\n<p>My <code>application.properties</code> file has the connection spring to my postgres db running in a docker container:</p>\n<pre><code># datasource\nspring.datasource.url=jdbc:postgresql://db:5432/myApp?currentSchema=gpclinic&amp;createDatabaseIfNotExist=true\nspring.datasource.username=uname\nspring.datasource.password=pword\n</code></pre>\n<p>When I run:</p>\n<pre><code>docker build -t myApp .\n</code></pre>\n<p>I get a failure as the unit tests fail because the DB container is not running.</p>\n<p>Will I need a Postgres container running to pass my tests? Or what is the best way to get around this?</p>\n"
    },
    {
      "tags": [
        "java",
        "spring-boot",
        "hibernate",
        "spring-data-jpa"
      ],
      "answers": [
        {
          "owner": {
            "user_id": 6484502,
            "display_name": "Huka"
          },
          "up_vote_count": 2,
          "is_accepted": false,
          "creation_date": 1682584239,
          "answer_id": 76118341,
          "body": "<p>You can downgrade H2 to the version <code>1.4.200</code></p>\n<p>My colleague suggest that we can change this condition from:</p>\n<p><code>AND (COALESCE(:accountNames) IS NULL OR account.accountName IN :accountNames)</code></p>\n<p>to:</p>\n<p><code>AND (:#{null eq #accountNames} is true or account.accountName in :accountNames)</code></p>\n<p>I've tested with Oracle and H2 (Mode Oracle) with Spring Boot 2.7</p>\n"
        }
      ],
      "owner": {
        "user_id": 21349983,
        "display_name": "JVDD"
      },
      "view_count": 585,
      "up_vote_count": 5,
      "answer_count": 1,
      "score": 5,
      "creation_date": 1678200361,
      "question_id": 75663455,
      "body": "<p>I have an account entity:</p>\n<pre><code>@Entity\n@Data\n@Builder\n@AllArgsConstructor\n@NoArgsConstructor\npublic class Account {\n    @Id\n    @GeneratedValue\n    @JsonIgnore\n    private Long id;\n    private String accountName;\n    private String supplierName;\n    private String customerName;\n    private Double amount;\n</code></pre>\n<p>and an account repository with jpa query that should filter accounts by a list of account names or no filter when the list is null:</p>\n<pre><code>@RepositoryRestResource\npublic interface AccountRestResource extends PagingAndSortingRepository&lt;Account, Long&gt;, CrudRepository&lt;Account, Long&gt; {\n    @Query(&quot;SELECT DISTINCT account.customerName &quot; +\n            &quot;FROM Account account &quot; +\n            &quot;WHERE UPPER(account.customerName) LIKE CONCAT('%',UPPER(:filter),'%') &quot; +\n            &quot;AND ((:accountNames) IS NULL OR account.accountName IN (:accountNames)) &quot; +\n            &quot;ORDER BY account.customerName&quot;)\n    Page&lt;String&gt; findDistinctCustomerNames(List&lt;String&gt; accountNames, String filter, Pageable page);\n}\n</code></pre>\n<p>After upgrading to the latest Spring Boot 3 upgrade this Query fails from time to time with (irregularly... I'd say 1 in 5)</p>\n<blockquote>\n<p>org.springframework.orm.jpa.JpaSystemException: Unknown wrap conversion requested: java.util.ArrayList to java.lang.String : <code>org.hibernate.type.descriptor.java.StringJavaType</code> (java.lang.String)</p>\n</blockquote>\n<p>Pom contains following dependencies:</p>\n<pre><code>    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-data-rest&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;jakarta.inject&lt;/groupId&gt;\n            &lt;artifactId&gt;jakarta.inject-api&lt;/artifactId&gt;\n            &lt;version&gt;2.0.1&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.postgresql&lt;/groupId&gt;\n            &lt;artifactId&gt;postgresql&lt;/artifactId&gt;\n            &lt;scope&gt;runtime&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.liquibase&lt;/groupId&gt;\n            &lt;artifactId&gt;liquibase-core&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;\n            &lt;artifactId&gt;lombok&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- Test--&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.h2database&lt;/groupId&gt;\n            &lt;artifactId&gt;h2&lt;/artifactId&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n</code></pre>\n<p>I don't have problems when the list is NULL but when I try the query with a single item in the list . Reverting to the Spring Boot 2.7.X resolves the issue.</p>\n<p>I have a repo with a test to reproduce the error: <a href=\"https://github.com/Jef-VDD/hibernate-demo\" rel=\"noreferrer\">https://github.com/Jef-VDD/hibernate-demo</a></p>\n"
    },
    {
      "tags": [
        "java",
        "maven",
        "kotlin",
        "okhttp",
        "snyk"
      ],
      "answers": [
        {
          "owner": {
            "user_id": 3160089,
            "display_name": "Endzeit"
          },
          "up_vote_count": 2,
          "is_accepted": true,
          "creation_date": 1676686226,
          "answer_id": 75490754,
          "body": "<p>As with all vulnerable software libraries, you need to assess whether or not you're actually affected by the vulnerability that is included.</p>\n<p>Details on the vulnerability are listed in your Snyk report.\nThe problematic functions are <code>createTempDir</code> and <code>createTempFile</code> from the package <code>kotlin.io</code>. As outlined in your report as well as <a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.io/create-temp-dir.html\" rel=\"nofollow noreferrer\">the Kotlin documentation</a>, these functions are a possible source of leaking information, due to the created file / directory having having too wide permissions; that is, everyone with access to the file system can read the files.</p>\n<p>Is this a problem?<br />\nIf you (and any dependencies you're including in your software) is NOT using one of the aforementioned functions, you're not vulnerable.<br />\nAlso, if you (or the dependency) is adjusting the file permissions after calling one of these functions and before inserting any information, you're not affected.<br />\nIn case the functions are used and the permissions are not adjusted, still that might not pose a problem, as long as the data stored in the files do not need to be protected, e.g. are NOT secrets or personal information.</p>\n<p>To address your questions directly:</p>\n<ol>\n<li>Unfortunately, there is not easy way to fix this. You either would have to use a version of <code>kotlin-stdlib</code> where the function was not introduced yet, exclude the <code>kotlin-stdlib</code> from your classpath entirely or use a version where the functions are no longer included; which is not released yet. However, options 1 and 2 do not make any sense, because if the software keeps working, that means noone is using the functions and you're not affected anyway.</li>\n<li>No and yes. Everyone relying on the <code>kotlin-stdlib</code> in one of the affected versions, has the function on its classpath. However, as long as it is not used, or the usage does not pose a problem as explained above, the software is not vulnerable.</li>\n</ol>\n<p>The OkHttp project <a href=\"https://github.com/square/okhttp/issues/7423\" rel=\"nofollow noreferrer\">seems to know</a> of the vulnerability, but seems not to be affected.</p>\n"
        }
      ],
      "owner": {
        "user_id": 21234935,
        "display_name": "Yevhen Vasyliev"
      },
      "view_count": 138,
      "up_vote_count": 5,
      "accepted_answer_id": 75490754,
      "answer_count": 1,
      "score": 5,
      "creation_date": 1676649197,
      "question_id": 75486505,
      "body": "<p>I'm using <code>Snyk</code> service to check my projects for vulnerabilities.</p>\n<p>Projects with <code>OkHttp</code> dependency have one common vulnerability:</p>\n<pre><code>Vulnerable module: org.jetbrains.kotlin:kotlin-stdlib\nIntroduced through: com.squareup.okhttp3:okhttp@4.10.0\n</code></pre>\n<p>You can check the full report here: <a href=\"https://snyk.io/test/github/yvasyliev/deezer-api\" rel=\"noreferrer\">https://snyk.io/test/github/yvasyliev/deezer-api</a></p>\n<p>In <strong>Overview</strong> section there is a note:</p>\n<blockquote>\n<p>Note: As of version 1.4.21, the vulnerable functions have been marked as deprecated. Due to still being useable, this advisory is kept as &quot;unfixed&quot;.</p>\n</blockquote>\n<p>I have two questions:</p>\n<ol>\n<li>Can I fix this vulnerability in Maven project and how?</li>\n<li>If vulnerability cannot be fixed, then does it mean that every signle Kotlin application has this vulnerability by default (since it's comming from kotlin-stdlib)?</li>\n</ol>\n<p>The latest stable version of <code>OkHttp</code> is added to project by <code>Maven</code>:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;dependency&gt;\n    &lt;groupId&gt;com.squareup.okhttp3&lt;/groupId&gt;\n    &lt;artifactId&gt;okhttp&lt;/artifactId&gt;\n    &lt;version&gt;4.10.0&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n"
    },
    {
      "tags": [
        "java",
        "c#",
        ".net",
        "ssl",
        "ssl-certificate"
      ],
      "answers": [
        {
          "owner": {
            "user_id": 12342238,
            "display_name": "JonasH"
          },
          "up_vote_count": 2,
          "is_accepted": false,
          "creation_date": 1676024762,
          "answer_id": 75409798,
          "body": "<p>I can't answer your specific questions but here is some thoughts:</p>\n<p>You have not mentioned anything about how the server authenticates clients. So you might consider implementing something like client certificates. If you control both you probably want some way to ensure random attackers cannot connect.</p>\n<p>You might consider creating a threat model. In many cases it is the things that you haven't thought about that cause problems.</p>\n<ul>\n<li>If you are handling national security data or financial data you might want an external audit. Such might even be required in some cases.</li>\n<li>If there is no way an attacker could sell, use, or ransom the data, then you will probably not be directly targeted. So you might worry more about mass attacks against known vulnerabilities, i.e. keep all your software up to date.</li>\n<li>Consider other ways to mitigate risks. Are your server/client running in least privilege possible? Are you using a DMZ? Are firewalls correctly configured? Are credentials for support etc well managed?</li>\n</ul>\n"
        }
      ],
      "owner": {
        "user_id": 1015802,
        "display_name": "groverboy"
      },
      "view_count": 202,
      "up_vote_count": 5,
      "answer_count": 1,
      "score": 5,
      "creation_date": 1676008148,
      "question_id": 75407392,
      "body": "<p>We develop a Java application that serves requests over TCP. We also develop client libraries for the application, where each library supports a different language/platform (Java, .NET, etc.).</p>\n<p>Until recently, TCP traffic was confined to a secure network. To support usage on an insecure network we implemented TLS using the recipes in <a href=\"https://github.com/atomiteam/java-plain-and-tls-socket-examples\" rel=\"nofollow noreferrer\">java-plain-and-tls-socket-examples</a>. There are recipes here for both server and client, and a script to generate an X.509 certificate. Below is a summary of the recipe that we are using for TLS with <em>server-only</em> authentication:</p>\n<ul>\n<li>Create an X.509 root certificate that is self-signed.</li>\n<li>Configure the server with a <em>keystore</em> file that contains the certificate's identifying data plus the public and private keys.</li>\n<li>Configure the client with a <em>trust store</em> file that contains the same identifying data plus only the public key.</li>\n</ul>\n<p>This looks like a setup for certificate pinning, as the client has a copy of the server certificate <em>before</em> connecting. Apparently, when connecting, the client will use this data somehow to validate the certificate that the server sends.</p>\n<p>We assume for now that this approach is valid for securing TCP traffic. Signing by a certificate authority seems unnecessary because we control both server and client.</p>\n<p>Initial testing shows that the implementation is working in our Java server and Java client (both running locally):</p>\n<ul>\n<li>Client accepts a server certificate that matches data in the client's trust store.</li>\n<li>Client rejects a server certificate that does not matches data in the client's trust store.</li>\n<li><a href=\"https://www.tcpdump.org/\" rel=\"nofollow noreferrer\">tcpdump</a> shows that TCP packets contain encrypted data.</li>\n</ul>\n<h2>.NET Client</h2>\n<p>We use <a href=\"https://learn.microsoft.com/en-us/dotnet/api/system.net.security.sslstream?view=net-5.0\" rel=\"nofollow noreferrer\">SslStream</a> to encrypt TCP traffic. As the documentation suggests, we do not specify a TLS version; instead we throw an exception if the version is below 1.2.</p>\n<p>We're not confident about how to use <a href=\"https://learn.microsoft.com/en-us/dotnet/api/system.security.cryptography.x509certificates.x509chainpolicy.customtruststore?view=net-5.0#system-security-cryptography-x509certificates-x509chainpolicy-customtruststore\" rel=\"nofollow noreferrer\">X509Chain.ChainPolicy.CustomTrustStore</a> correctly, because the documentation omits information like use cases for this type, and for option types like <code>X509KeyStorageFlags</code> and <code>X509VerificationFlags</code>.</p>\n<p>The code below aims to mimic the recipe outlined above, i.e. configure a trust store data structure for the client to use when validating a server certificate. This approach seems equivalent to importing the certificate into the operating system's trust store.</p>\n<pre class=\"lang-cs prettyprint-override\"><code>// Import the trust store.\nprivate X509Certificate2Collection GetCertificates(string storePath, string storePassword)\n{\n    byte[] bytes = File.ReadAllBytes(storePath);\n\n    var result = new X509Certificate2Collection();\n    result.Import(bytes, storePassword, X509KeyStorageFlags.EphemeralKeySet);\n    return result;\n}\n\n// Callback function to validate a certificate received from the server.\n// fCertificates stores the result of function GetCertificates.\nprivate bool ValidateServerCertificate(\n    object sender,\n    X509Certificate certificate,\n    X509Chain chain,\n    SslPolicyErrors sslPolicyErrors)\n{\n    // Do not allow this client to communicate with unauthenticated servers.\n    //\n    // With a self-signed certficate, sslPolicyErrors should be always equal to\n    // SslPolicyErrors.RemoteCertificateChainErrors.\n    var result = (SslPolicyErrors.RemoteCertificateChainErrors == sslPolicyErrors);\n    if (result)\n    {\n        // The values below are default values: set them to be explicit.\n        chain.ChainPolicy.VerificationFlags = X509VerificationFlags.NoFlag;\n        chain.ChainPolicy.RevocationMode = X509RevocationMode.NoCheck;\n    \n        chain.ChainPolicy.TrustMode = X509ChainTrustMode.CustomRootTrust;\n        chain.ChainPolicy.CustomTrustStore.AddRange(fCertificates);\n        result = chain.Build((X509Certificate2)certificate);\n    }\n\n    return result;\n}\n\n// Initialize SslStream.\nprivate SslStream GetStream(TcpClient tcpClient, string targetHost)\n{\n    SslStream sslStream = new SslStream(\n        tcpClient.GetStream(),\n        false,\n        new RemoteCertificateValidationCallback(ValidateServerCertificate),\n        null\n    );\n\n    try\n    {\n        sslStream.AuthenticateAsClient(targetHost);\n\n        // require TLS 1.2 or higher\n        if (sslStream.SslProtocol &lt; SslProtocols.Tls12)\n        {\n            throw new AuthenticationException($&quot;The SSL protocol ({sslStream.SslProtocol}) must be {SslProtocols.Tls12} or higher.&quot;);\n        }\n    }\n    catch (AuthenticationException caught)\n    {\n        sslStream.Dispose();\n        throw caught;\n    }\n\n    return sslStream;\n}\n</code></pre>\n<p>Initial testing has yielded results that vary depending on the operating system:</p>\n<ul>\n<li>.NET 6 ASP.NET web client on Ubuntu on WSL2:\n<ul>\n<li>Accepts a valid server certificate:\n<ul>\n<li>The callback function argument <code>sslPolicyErrors</code> is equal to <code>SslPolicyErrors.RemoteCertificateChainErrors</code> (expected).</li>\n<li>Encrypts TCP packets (verified using <a href=\"https://www.tcpdump.org/\" rel=\"nofollow noreferrer\">tcpdump</a>).</li>\n<li>Automatically uses TLS 1.3.</li>\n</ul>\n</li>\n<li>Rejects an invalid server certificate: <code>X509Chain.Build</code> returns <code>false</code> and the only chain status item is &quot;UntrustedRoot, self signed certificate&quot;.</li>\n</ul>\n</li>\n<li>.NET 6 MAUI client on MacOS:\n<ol>\n<li>Rejects a valid server certificate: the callback function argument <code>sslPolicyErrors</code> includes these values:\n<ul>\n<li><code>SslPolicyErrors.RemoteCertificateNameMismatch</code> (unexpected).</li>\n<li><code>SslPolicyErrors.RemoteCertificateChainErrors</code> (expected).</li>\n</ul>\n</li>\n<li>If we change the code to ignore <code>sslPolicyErrors</code> then it:\n<ul>\n<li>Accepts a valid server certificate and automatically uses TLS 1.2.</li>\n<li>Rejects an invalid server certificate (as above).</li>\n</ul>\n</li>\n</ol>\n</li>\n</ul>\n<h2>Questions</h2>\n<ol>\n<li>In what ways, if any, could security be compromised with this .NET code?</li>\n<li>Upon reviewing discussions about &quot;certificate name mismatch&quot; (see <code>SslPolicyErrors.RemoteCertificateNameMismatch</code> above), it seems that our server certificate should include a <code>subjectAltName</code> field to specify allowed DNS names. Is this necessary, or would it be reasonable, as we are using certificate pinning, to ignore <code>sslPolicyErrors</code> when validating the server certificate?</li>\n</ol>\n"
    },
    {
      "tags": [
        "java",
        "spring",
        "spring-boot",
        "spring-data"
      ],
      "answers": [
        {
          "owner": {
            "user_id": 7237884,
            "display_name": "Panagiotis Bougioukos"
          },
          "up_vote_count": 2,
          "is_accepted": true,
          "creation_date": 1675471829,
          "answer_id": 75342298,
          "body": "<p>This is clearly a bug for hibernate project.</p>\n<p>Have opened a ticket for it <a href=\"https://hibernate.atlassian.net/browse/HHH-16135\" rel=\"nofollow noreferrer\">here</a> with both the bug described in the question from <strong>kism3t</strong> and also with what seems to be a workaround to bypass the issue.</p>\n<p>Have checked the current non stable released versions of hibernate <code>6.2.0</code> and the bug is still there. So probably is undetected yet.</p>\n<p>For the moment the following workaround seems to bypass the issue</p>\n<pre><code>   @Entity\n   public class User {\n\n      @OneToOne(fetch = FetchType.LAZY, mappedBy = &quot;user&quot;) \n      private UserSettings userSettings;\n\n      @OneToOne(fetch = FetchType.LAZY, mappedBy = &quot;user&quot;) \n      private UserTermsOfUse userTermsOfUse;\n  }\n</code></pre>\n<p>If the owning side of the <code>@OneToOne</code> declares the same fetchType of <code>Lazy</code> somehow the issue is bypassed.</p>\n<p>So it works with</p>\n<pre><code>@Entity\npublic class UserTermsOfUse {\n\n    ....\n\n    @OneToOne(fetch = FetchType.LAZY)  // &lt;-------------\n    private User user;\n}\n</code></pre>\n<p>and</p>\n<pre><code>@Entity\npublic class UserSettings {\n\n    ....\n\n    @OneToOne(fetch = FetchType.LAZY)  // &lt;-------------\n    private User user;\n}\n</code></pre>\n<h2>Update</h2>\n<p>This was indeed a bug of hibernate project. It is solved in version <strong>6.1.7.Final</strong> and future versions.</p>\n"
        }
      ],
      "owner": {
        "user_id": 3042145,
        "display_name": "kism3t"
      },
      "view_count": 263,
      "up_vote_count": 5,
      "accepted_answer_id": 75342298,
      "answer_count": 1,
      "score": 5,
      "creation_date": 1675239566,
      "question_id": 75307264,
      "body": "<p>After migrating to Spring Boot 3.0 our integration test showed that deleting a user did not work properly.</p>\n<p>The User has two properties, where both are defined the same (at least thats what I think, see below).</p>\n<p>What I figured is, when I load the User object one of the properties of User are not loaded. Only if I define the property, which can not be loaded, as EAGER. If I now try to delete the User, this does not work because there is still the one property in DB which reference to the User.</p>\n<p>I can not figure out whats the problem maybe I am missing something</p>\n<p>My User Entity</p>\n<pre><code>@Entity\n@Data\n@Table(name = &quot;user_model&quot;)\npublic class User extends BaseEntity {\n    @Id\n    @GeneratedValue(generator = &quot;system-uuid&quot;)\n    @GenericGenerator(name = &quot;system-uuid&quot;, strategy = &quot;uuid&quot;)\n    private String id;\n    \n    ...\n\n    @OneToOne(fetch = FetchType.LAZY, mappedBy = &quot;user&quot;, cascade = CascadeType.ALL, orphanRemoval = true)\n    private UserSettings userSettings;\n\n    @OneToOne(fetch = FetchType.LAZY, mappedBy = &quot;user&quot;, cascade = CascadeType.ALL, orphanRemoval = true)\n    private UserTermsOfUse userTermsOfUse;\n    \n    ...\n}\n</code></pre>\n<p>User Terms Of Use which works to load</p>\n<pre><code>@Entity\n@Table(name = &quot;user_termsofuse&quot;)\n@Data\npublic class UserTermsOfUse extends BaseEntity {\n\n    @Id\n    @GeneratedValue(generator = &quot;system-uuid&quot;)\n    @GenericGenerator(name = &quot;system-uuid&quot;, strategy = &quot;uuid&quot;)\n    private String id;\n\n    @OneToOne(fetch = FetchType.EAGER, cascade = CascadeType.ALL)\n    @JoinColumn(name = &quot;user_id&quot;, referencedColumnName = &quot;id&quot;)\n    @ToString.Exclude\n    private User user;\n\n    @Column(name = &quot;accepted_termsofuse&quot;)\n    private String acceptedTermsOfUse;\n\n}\n</code></pre>\n<p>My Settings which does not load:</p>\n<pre><code>@Entity\n@Table(name = &quot;user_settings&quot;)\n@Data\npublic class UserSettings extends BaseEntity {\n\n    @Id\n    @GeneratedValue(generator = &quot;system-uuid&quot;)\n    @GenericGenerator(name = &quot;system-uuid&quot;, strategy = &quot;uuid&quot;)\n    private String id;\n\n    @OneToOne(fetch = FetchType.EAGER, cascade = CascadeType.ALL)\n    @JoinColumn(name = &quot;user_id&quot;, referencedColumnName = &quot;id&quot;)\n    @ToString.Exclude\n    private User user;\n\n    private String language;\n\n    private String lastActiveClientId;\n\n}\n</code></pre>\n<p>As you can see in my screenshot, when I load the entity User by ID it only shows the User Terms of Use ant not the User Settings\n<a href=\"https://i.stack.imgur.com/66YQA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/66YQA.png\" alt=\"enter image description here\" /></a></p>\n<p>Just to make clear, they are within the DB :)\n<a href=\"https://i.stack.imgur.com/5hMfb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5hMfb.png\" alt=\"enter image description here\" /></a></p>\n<p>Hope Someone can point me to a correct direction</p>\n<p><strong>UPDATE</strong></p>\n<p>I made a sample project to prove it does not work. The test fails with an <code>NullPonterException</code> once I try to access the <code>UserSettings</code>.</p>\n<p><a href=\"https://github.com/de313e/SpringEagerLoadingIssue\" rel=\"nofollow noreferrer\">https://github.com/de313e/SpringEagerLoadingIssue</a></p>\n"
    },
    {
      "tags": [
        "java",
        "spring",
        "spring-boot",
        "jackson"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 7237884,
            "display_name": "Panagiotis Bougioukos"
          },
          "edited": false,
          "comment_id": 132575186,
          "body": "did you check my answer? It should be able to solve the problem. If that is the case please consider accepting the answer in favor of future readers"
        },
        {
          "owner": {
            "user_id": 6625422,
            "display_name": "Henry Fung"
          },
          "edited": false,
          "comment_id": 132579005,
          "body": "@PanagiotisBougioukos Sorry I only get to my workplace today so I couldn&#39;t try out the answer before that. Your answer did solve the problem"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 9681755,
            "display_name": "Dirk Deyne"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1673513692,
          "answer_id": 75093691,
          "body": "<p>Can be done with a custom <code>StdSerializer</code> like</p>\n<pre class=\"lang-java prettyprint-override\"><code>class CustomBooleanSerializer extends StdSerializer&lt;Boolean&gt; {\n\n    public CustomBooleanSerializer(){\n        super(Boolean.class);\n    }\n\n    @Override\n    public void serialize(Boolean value, JsonGenerator generator, SerializerProvider provider) throws IOException {\n        generator.writeNumber(value ? 1 : 0);\n    }\n}\n</code></pre>\n<p>And configure this via a <code>Jackson2ObjectMapperBuilderCustomizer</code></p>\n<pre class=\"lang-java prettyprint-override\"><code>@Bean\npublic Jackson2ObjectMapperBuilderCustomizer jsonCustomizer() {\n  return builder -&gt;\n    builder.serializationInclusion(JsonInclude.Include.USE_DEFAULTS) // &lt;-- optional\n           .serializers(new CustomBooleanSerializer());\n}\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 19519118,
            "display_name": "surendra ingle"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1673514367,
          "answer_id": 75093829,
          "body": "<p>Because of the serializer, the boolean value is converted into the form of true  or false</p>\n<pre><code>public class NumericBooleanSerializer extends JsonSerializer&lt;Boolean&gt; {\n    \n    public void serialize(Boolean b, JsonGenerator jsonGenerator, SerializerProvider serializerProvider) throws IOException {\n        jsonGenerator.writeNumber(b ? 1 : 0);\n    }\n}\n</code></pre>\n<p>that will serialize booleans as 1 or 0.</p>\n"
        },
        {
          "owner": {
            "user_id": 7237884,
            "display_name": "Panagiotis Bougioukos"
          },
          "up_vote_count": 2,
          "is_accepted": true,
          "creation_date": 1673520601,
          "answer_id": 75095148,
          "body": "<h2>No need for global Serializer</h2>\n<p>,just to enforce the <code>@JsonFormat(shape = Shape.NUMBER)</code> annotation globally for boolean fields.</p>\n<p>You can just override the global rule that applies to boolean fields as to use your custom one of <code>Shape.NUMBER</code> so that you don't have to do it in every boolean field of every class.</p>\n<p>So instead of having for <code>serialization/deserialization</code> in each filed of each class the</p>\n<pre><code>@JsonFormat(shape = Shape.NUMBER)\nprivate Boolean success;\n</code></pre>\n<p>You can do it with the following code globally:</p>\n<pre><code>@Bean\npublic ObjectMapper registerObjectMapper(){\n   ObjectMapper mapper = new ObjectMapper();            \n   mapper.configOverride(Boolean.class)\n         .setFormat(JsonFormat.Value.forShape(JsonFormat.Shape.NUMBER));\n   mapper.configOverride(boolean.class)\n         .setFormat(JsonFormat.Value.forShape(JsonFormat.Shape.NUMBER));\n   return mapper;\n }\n</code></pre>\n<h2>How to apply global Serializer in case it is necessary</h2>\n<p>But if you insist on registering a global serializer so that the format is used just for serialization and not deserialization then you can do it with:</p>\n<pre><code>@Bean\npublic ObjectMapper registerObjectMapper(){\n    ObjectMapper mapper = new ObjectMapper();\n    SimpleModule module = new SimpleModule(&quot;MyBooleanSerializer&quot;);\n    module.addSerializer(Boolean.class, new MyBooleanSerializer());\n    module.addSerializer(boolean.class, new MyBooleanSerializer());\n    mapper.registerModule(module);\n   \n    return mapper;\n}\n</code></pre>\n<p>And</p>\n<pre><code>public class MyBooleanSerializer extends JsonSerializer&lt;Boolean&gt; {\n    @Override\n    public void serialize(\n                    Boolean value, \n                    JsonGenerator gen, \n                    SerializerProvider serializers) throws IOException {\n\n        gen.writeString(value ? &quot;1&quot; : &quot;0&quot;);\n\n    }\n}\n</code></pre>\n<h2>There is a catch</h2>\n<p>See closely in second solution the</p>\n<pre><code>module.addSerializer(Boolean.class, new MyBooleanSerializer());\nmodule.addSerializer(boolean.class, new MyBooleanSerializer());\n</code></pre>\n<p>and in first solution the</p>\n<pre><code>  .configOverride(Boolean.class)\n  .configOverride(boolean.class)\n</code></pre>\n<p>For <code>Jackson</code> the primitive <code>boolean</code> as field and the Wrapper <code>Boolean</code> class need to be registered separately in order to be able to work.</p>\n"
        }
      ],
      "owner": {
        "user_id": 6625422,
        "display_name": "Henry Fung"
      },
      "view_count": 455,
      "up_vote_count": 5,
      "accepted_answer_id": 75095148,
      "answer_count": 3,
      "score": 5,
      "creation_date": 1673511997,
      "question_id": 75093378,
      "body": "<p>Let's say I want to serialize <code>Boolean</code> into <code>Number</code> <strong>by default</strong>.</p>\n<p>I know I can do it field-by-field</p>\n<pre class=\"lang-java prettyprint-override\"><code>@JsonFormat(shape = Shape.NUMBER)\nprivate Boolean success;\n</code></pre>\n<p>But can I &quot;register&quot; my custom Serializer so that when I return an Object from my API, the <code>Boolean</code>s in the class will be serialized into <code>Number</code> in the json response.</p>\n<p>I have the following Serializer</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class MyBooleanSerializer extends JsonSerializer&lt;Boolean&gt; {\n    @Override\n    public void serialize(\n                    Boolean value, \n                    JsonGenerator gen, \n                    SerializerProvider serializers) throws IOException {\n\n        gen.writeString(value ? &quot;1&quot; : &quot;0&quot;);\n\n    }\n}\n</code></pre>\n<p>And I have the following class</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Data\npublic class MyResponse {\n    private Boolean success;\n    private String message;\n}\n</code></pre>\n<p>It will be used like this</p>\n<pre class=\"lang-java prettyprint-override\"><code>@GetMapping(&quot;/hello&quot;)\npublic MyResponse hello() {\n    Boolean success = true;\n    String message = &quot;Hi there&quot;;\n    return new MyResponse(success, message);\n}\n</code></pre>\n<p>And when I <code>GET</code> this API, I am expecting this response</p>\n<pre class=\"lang-json prettyprint-override\"><code>{\n  success: 1,\n  message: &quot;Hi there&quot;\n}\n</code></pre>\n<p>I am expecting some Beans to be injected. I have tried</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Bean\n@Primary\nObjectMapper objectMapper() {\n    SimpleModule module = new SimpleModule();\n    module.addSerializer(new MyBooleanSerializer());\n    return new ObjectMapper()\n            .setSerializationInclusion(JsonInclude.Include.NON_NULL)\n            .registerModule(module);\n}\n</code></pre>\n<p>but it does not work.</p>\n<p>I have read <a href=\"https://howtodoinjava.com/jackson/jackson-booleans/\" rel=\"nofollow noreferrer\">this</a> tutorial and seems like it needs to create the <code>jsonMapper</code> every time I want to serialize an object. All I want is whenever I return <code>MyResponse</code> from an API, the <code>Boolean</code>s are serialized into <code>Number</code>s.</p>\n"
    },
    {
      "tags": [
        "java",
        "spring-boot",
        "swagger",
        "swagger-ui",
        "springfox"
      ],
      "answers": [
        {
          "owner": {
            "user_id": 11543023,
            "display_name": "djmonki"
          },
          "up_vote_count": 2,
          "is_accepted": false,
          "creation_date": 1679820592,
          "answer_id": 75846732,
          "body": "<p>With Spring specifically, you have to use the more generic <code>List&lt;String&gt;</code> for it to interpret your parameter as an array of strings. Technically, there is no difference between <code>List&lt;String&gt;</code> and <code>ArrayList&lt;String&gt;</code>, but Spring chooses to use <code>List&lt;String&gt;</code>.</p>\n<p>So your code should be updated to:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@ApiOperation(value = &quot;Get the value drivers for a part by its as JSON output&quot;)\n@GetMapping(AppConstants.VDJSON)\nValueDriver getValueDriverJson(\n        @RequestParam(value=&quot;pnrList&quot;)\n        final List&lt;String&gt; pnrList);\n</code></pre>\n<p>So your Swagger output should then be:</p>\n<pre class=\"lang-json prettyprint-override\"><code>&quot;/vdbptool/api/v1/vdjson&quot;: {\n\n&quot;get&quot;: {\n    &quot;tags&quot;: [\n        &quot;value-driver-codes-controller&quot;\n    ],\n    &quot;summary&quot;: &quot;Get the value drivers for a part by its PNR in LIST format as JSON output&quot;,\n    &quot;operationId&quot;: &quot;getValueDriverJsonUsingGET&quot;,\n&quot;parameters&quot;: [\n        {\n            &quot;name&quot;: &quot;pnrList&quot;,\n            &quot;in&quot;: &quot;query&quot;,\n            &quot;description&quot;: &quot;pnrList&quot;,\n            &quot;required&quot;: true,\n            &quot;style&quot;: &quot;form&quot;,\n            &quot;explode&quot;: true,\n            &quot;schema&quot;: {\n                &quot;type&quot;: &quot;array&quot;,\n                &quot;items&quot;: {\n                    &quot;type&quot;: &quot;string&quot;\n                }\n            }\n        }\n    ],\n\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 2374302,
            "display_name": "Axel Amthor"
          },
          "up_vote_count": 0,
          "is_accepted": true,
          "creation_date": 1679982643,
          "answer_id": 75862721,
          "body": "<p>Finally solved the problem. Thanks to this guide: <a href=\"https://springdoc.org/migrating-from-springfox.html\" rel=\"nofollow noreferrer\">https://springdoc.org/migrating-from-springfox.html</a> I have easily changed from SpringFox to Openapi-ui.\nGradle:</p>\n<pre><code>    //implementation 'io.springfox:springfox-boot-starter:3.0.0'\n    //implementation 'io.springfox:springfox-oas:3.0.0'\n\n    // https://mvnrepository.com/artifact/org.springdoc/springdoc-openapi-ui\n    implementation 'org.springdoc:springdoc-openapi-ui:1.6.15'\n</code></pre>\n<p>Output now:</p>\n<p><a href=\"https://i.stack.imgur.com/TyjAc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TyjAc.png\" alt=\"enter image description here\" /></a></p>\n<p>And:</p>\n<p><a href=\"https://i.stack.imgur.com/OWyrK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OWyrK.png\" alt=\"enter image description here\" /></a></p>\n<p>So, I assume that SpringFox is slightly outdated, last changes almost three years ago:\n<a href=\"https://i.stack.imgur.com/jjcpN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jjcpN.png\" alt=\"enter image description here\" /></a></p>\n"
        }
      ],
      "owner": {
        "user_id": 2374302,
        "display_name": "Axel Amthor"
      },
      "view_count": 190,
      "up_vote_count": 5,
      "accepted_answer_id": 75862721,
      "answer_count": 2,
      "score": 5,
      "creation_date": 1679494635,
      "question_id": 75813423,
      "body": "<p>I have a very simple REST API (Spring-Boot) which should accept a list of strings as query parameters:</p>\n<pre><code>@ApiOperation(value = &quot;Get the value drivers for a part by its as JSON output&quot;)\n@GetMapping(AppConstants.VDJSON)\nValueDriver getValueDriverJson(\n        @RequestParam(value=&quot;pnrList&quot;)\n        final ArrayList&lt;String&gt; pnrList);\n</code></pre>\n<p>This generates a swagger output like this:</p>\n<pre><code>&quot;/vdbptool/api/v1/vdjson&quot;: {\n\n&quot;get&quot;: {\n    &quot;tags&quot;: [\n        &quot;value-driver-codes-controller&quot;\n    ],\n    &quot;summary&quot;: &quot;Get the value drivers for a part by its PNR in LIST format as JSON output&quot;,\n    &quot;operationId&quot;: &quot;getValueDriverJsonUsingGET&quot;,\n    &quot;parameters&quot;: [\n        {\n            &quot;name&quot;: &quot;pnrList&quot;,\n            &quot;in&quot;: &quot;query&quot;,\n            &quot;description&quot;: &quot;pnrList&quot;,\n            &quot;required&quot;: true,\n            &quot;style&quot;: &quot;form&quot;,\n            &quot;explode&quot;: true,\n            &quot;schema&quot;: {\n                &quot;type&quot;: &quot;string&quot;\n            }\n        }\n    ],.\n</code></pre>\n<p>in swagger ui this looks like</p>\n<p><a href=\"https://i.stack.imgur.com/On86W.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/On86W.png\" alt=\"enter image description here\" /></a></p>\n<p>The problem seems to be the type of the parameter, which is &quot;string&quot; instead of &quot;array&quot; - whatever I have tried.</p>\n<p>Expected Output:\n<a href=\"https://i.stack.imgur.com/sA2b0.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/sA2b0.png\" alt=\"enter image description here\" /></a></p>\n<p>My Gradle:</p>\n<pre><code>dependencies {\n\n...\n\nimplementation 'io.springfox:springfox-boot-starter:3.0.0'\nimplementation 'io.springfox:springfox-oas:3.0.0'\n</code></pre>\n<p>What am I missing here in order to get the proper parameter type (&quot;array&quot;) generated into the OAS 3.0 spec via Springfox ...?</p>\n"
    },
    {
      "tags": [
        "java",
        "spring-boot",
        "spring-security"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 1840146,
            "display_name": "Toerktumlare"
          },
          "edited": false,
          "comment_id": 133676524,
          "body": "you can start by reading the spring security documentation and implement the handling of JWTs in accordance with the official documentation instead of implementing something custom from possibly some random bad blogpost. Spring has had built in support for JWTs since 2017 <a href=\"https://docs.spring.io/spring-security/reference/5.8/servlet/oauth2/resource-server/index.html\" rel=\"nofollow noreferrer\">docs.spring.io/spring-security/reference/5.8/servlet/oauth2/&zwnj;&#8203;&hellip;</a> its impossible for us to help you if havn&#39;t followed the official docs. So start by reading them"
        },
        {
          "owner": {
            "user_id": 5235665,
            "display_name": "hotmeatballsoup"
          },
          "edited": false,
          "comment_id": 133774571,
          "body": "Hi @Toerktumlare if you need Spring Security in one of your future Spring Boot projects, I can confirm that Andrey&#39;s <code>AbstractHttpConfigurer</code>-based solution below works for me perfectly, he&#39;s been a true <b>life saver</b>!"
        },
        {
          "owner": {
            "user_id": 1840146,
            "display_name": "Toerktumlare"
          },
          "edited": false,
          "comment_id": 133774816,
          "body": "both of your solutions are overly complex and not following any of the rfc&#39;s for security. Custom security is bad practice, and just because something &quot;works&quot; does not mean it is correct. Good luck with your custom security solution."
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 3426309,
            "display_name": "Andrey B. Panfilov"
          },
          "up_vote_count": 1,
          "is_accepted": true,
          "creation_date": 1679325392,
          "answer_id": 75792090,
          "body": "<p>We are doing something like:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Bean\npublic SecurityFilterChain filterChain(HttpSecurity httpSecurity) throws Exception {\n  AuthenticationManager authenticationManager = httpSecurity.getSharedObject(AuthenticationManagerBuilder.class)\n    .userDetailsService(realmService)\n    .passwordEncoder(passwordEncoder);\n\n...\n\n  httpSecurity.addFilter(apiAuthenticationFilter(ctx -&gt; httpSecurity.getSharedObject(AuthenticationManager.class)));\n\n...\n\n}\n\npublic ApiAuthenticationFilter apiAuthenticationFilter(AuthenticationManagerResolver&lt;?&gt; authenticationManagerResolver) {\n  return new ApiAuthenticationFilter(\n    authenticationManagerResolver, \n    tokenService, \n    objectMapper, \n    authenticationFactory\n  );\n}\n</code></pre>\n<p>Since instance of <code>AuthenticationManager</code> is required in runtime only, that is enough to pass supplier to filter during configuration phase</p>\n<hr />\n<p>UPD.</p>\n<p>Well, now it is clear why you need a reference to <code>AuthenticationManager</code>.</p>\n<p><strong>First option</strong>:</p>\n<p>In case of <code>ApiAuthorizationFilter</code> you are actually do not need to extend <code>BasicAuthenticationFilter</code> - just let <code>spring-security</code> to do it's job and enable basic authentication via <code>httpSecurity.httpBasic()</code>. For <code>ApiAuthenticationFilter</code> it is possible to pass <code>AuthenticationManagerResolver</code> or <code>Supplier&lt;AuthenticationManager&gt;</code> to it:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Bean\npublic SecurityFilterChain filterChain(HttpSecurity httpSecurity) throws Exception {\n  httpSecurity.getSharedObject(AuthenticationManagerBuilder.class)\n    .userDetailsService(realmService)\n    .passwordEncoder(passwordEncoder);\n\n...\n\n  httpSecurity.addFilter(apiAuthenticationFilter(() -&gt; httpSecurity.getSharedObject(AuthenticationManager.class)));\n\n...\n\n}\n\npublic ApiAuthenticationFilter apiAuthenticationFilter(Supplier&lt;AuthenticationManager&gt; authenticationManagerSupplier) {\n  return new ApiAuthenticationFilter(\n    authenticationManagerSupplier, \n    tokenService, \n    objectMapper, \n    authenticationFactory\n  );\n}\n\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>public class ApiAuthenticationFilter extends UsernamePasswordAuthenticationFilter {\n\n    private AuthenticationManager authenticationManager;\n    private Supplier&lt;AuthenticationManager&gt; authenticationManagerSupplier;\n    private ObjectMapper objectMapper;\n    private ApiAuthenticationFactory authenticationFactory;\n    private TokenService tokenService;\n\n    public ApiAuthenticationFilter(\n            Supplier&lt;AuthenticationManager&gt; authenticationManagerSupplier,\n            TokenService tokenService,\n            ObjectMapper objectMapper,\n            ApiAuthenticationFactory authenticationFactory) {\n\n        super();\n        this.tokenService = tokenService;\n        this.objectMapper = objectMapper;\n        this.authenticationFactory = authenticationFactory;\n\n        init();\n\n    }\n\n    private void init() {\n        setFilterProcessesUrl(&quot;/v1/auth/sign-in&quot;);\n    }\n\n    @Override\n    public Authentication attemptAuthentication(\n            HttpServletRequest request,\n            HttpServletResponse response) throws AuthenticationException {\n\n        try {\n\n            SignInRequest signInRequest = objectMapper.readValue(request.getInputStream(), SignInRequest.class);\n\n            Authentication authentication = authenticationFactory\n                    .createAuthentication(signInRequest.getEmail(), signInRequest.getPassword());\n\n            // perform authentication and -- if successful -- populate granted authorities\n            return getAuthenticationManager().authenticate(authentication);\n\n        } catch (IOException e) {\n            throw new BadCredentialsException(&quot;malformed sign-in request payload&quot;, e);\n        }\n\n    }\n\n    @Override\n    protected void successfulAuthentication(\n            HttpServletRequest  request,\n            HttpServletResponse response,\n            FilterChain filterChain,\n            Authentication authentication) {\n\n        // called if-and-only-if the attemptAuthentication method above is successful\n\n        ApiAuthentication apiAuthentication = (ApiAuthentication) authentication;\n        TokenPair tokenPair = tokenService.generateTokenPair(apiAuthentication);\n        response.setStatus(HttpServletResponse.SC_OK);\n        try {\n            response.getWriter().write(objectMapper.writeValueAsString(tokenPair));\n        } catch (IOException e) {\n            throw new ApiServiceException(e);\n        }\n\n    }\n\n    @Override\n    protected AuthenticationManager getAuthenticationManager() {\n        if (this.authenticationManager == null) {\n            this.authenticationManager = authenticationManagerSupplier.get();\n        }\n        return this.authenticationManager;\n    }\n\n}\n</code></pre>\n<p><strong>Second option</strong></p>\n<p>Write your own implementation of <code>AbstractHttpConfigurer</code>, should look like:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class ApiSecurityBuilderConfigurer&lt;H extends HttpSecurityBuilder&lt;H&gt;&gt;\n        extends AbstractHttpConfigurer&lt;ApiSecurityBuilderConfigurer&lt;H&gt;, H&gt; {\n\n    private TokenService tokenService;\n\n    private ObjectMapper objectMapper;\n\n    private ApiAuthenticationFactory apiAuthenticationFactory;\n    \n    public ApiSecurityBuilderConfigurer&lt;H&gt; tokenService(TokenService tokenService) {\n        this.tokenService = tokenService;\n        return this;\n    }\n\n    public ApiSecurityBuilderConfigurer&lt;H&gt; objectMapper(ObjectMapper objectMapper) {\n        this.objectMapper = objectMapper;\n        return this;\n    }\n\n    public ApiSecurityBuilderConfigurer&lt;H&gt; apiAuthenticationFactory(ApiAuthenticationFactory ApiAuthenticationFactory) {\n        this.ApiAuthenticationFactory = ApiAuthenticationFactory;\n        return this;\n    }\n\n    @Override\n    public void configure(H builder) throws Exception {\n        AuthenticationManager authenticationManager = builder.getSharedObject(AuthenticationManager.class);\n        builder.addFilter(apiAuthenticationFilter(authenticationManager));\n    }\n\n    public ApiAuthenticationFilter apiAuthenticationFilter(AuthenticationManager authenticationManager) {\n        return new ApiAuthenticationFilter(authenticationManager, tokenService, objectMapper, authenticationFactory);\n    }\n\n}\n</code></pre>\n<pre><code>@Bean\npublic SecurityFilterChain filterChain(HttpSecurity httpSecurity) throws Exception {\n  httpSecurity.apply(new ApiSecurityBuilderConfigurer())\n    .tokenService(tokenService)\n    .objectMapper(objectMapper)\n    .apiAuthenticationFactory(apiAuthenticationFactory);\n\n...\n\n}\n</code></pre>\n"
        }
      ],
      "owner": {
        "user_id": 5235665,
        "display_name": "hotmeatballsoup"
      },
      "view_count": 226,
      "up_vote_count": 5,
      "accepted_answer_id": 75792090,
      "answer_count": 1,
      "score": 5,
      "creation_date": 1679144583,
      "question_id": 75776068,
      "body": "<p>Java 11 and Spring Security 2.7.x here. I am trying to upgrade my config <em>away</em> from the (deprecated) <code>WebSecurityConfigurerAdapter</code>-based implementation to one using <code>SecurityFilterChain</code>.</p>\n<p>What's important about my implementation is that I have the ability to define and configure/wire up my own:</p>\n<ul>\n<li>Authentication Filter (<code>UsernamePasswordAuthenticationFilter</code> impl)</li>\n<li>Authorization Filter (<code>BasicAuthenticationFilter</code> impl)</li>\n<li>Custom authentication error handler (<code>AuthenticationEntryPoint</code> impl)</li>\n<li>Custom authorization error handler (<code>AccessDeniedHandler</code> impl)</li>\n</ul>\n<p>Here's my current setup based on reading a bunch of blogs and articles:</p>\n<pre><code>public class ApiAuthenticationFilter extends UsernamePasswordAuthenticationFilter {\n\n    private AuthenticationManager authenticationManager;\n    private ObjectMapper objectMapper;\n    private ApiAuthenticationFactory authenticationFactory;\n    private TokenService tokenService;\n\n    public ApiAuthenticationFilter(\n            AuthenticationManager authenticationManager,\n            TokenService tokenService,\n            ObjectMapper objectMapper,\n            ApiAuthenticationFactory authenticationFactory) {\n\n        super(authenticationManager);\n        this.tokenService = tokenService;\n        this.objectMapper = objectMapper;\n        this.authenticationFactory = authenticationFactory;\n\n        init();\n\n    }\n\n    private void init() {\n        setFilterProcessesUrl(&quot;/v1/auth/sign-in&quot;);\n    }\n\n    @Override\n    public Authentication attemptAuthentication(\n            HttpServletRequest request,\n            HttpServletResponse response) throws AuthenticationException {\n\n        try {\n\n            SignInRequest signInRequest = objectMapper.readValue(request.getInputStream(), SignInRequest.class);\n\n            Authentication authentication = authenticationFactory\n                    .createAuthentication(signInRequest.getEmail(), signInRequest.getPassword());\n\n            // perform authentication and -- if successful -- populate granted authorities\n            return authenticationManager.authenticate(authentication);\n\n        } catch (IOException e) {\n            throw new BadCredentialsException(&quot;malformed sign-in request payload&quot;, e);\n        }\n\n    }\n\n    @Override\n    protected void successfulAuthentication(\n            HttpServletRequest  request,\n            HttpServletResponse response,\n            FilterChain filterChain,\n            Authentication authentication) {\n\n        // called if-and-only-if the attemptAuthentication method above is successful\n\n        ApiAuthentication apiAuthentication = (ApiAuthentication) authentication;\n        TokenPair tokenPair = tokenService.generateTokenPair(apiAuthentication);\n        response.setStatus(HttpServletResponse.SC_OK);\n        try {\n            response.getWriter().write(objectMapper.writeValueAsString(tokenPair));\n        } catch (IOException e) {\n            throw new ApiServiceException(e);\n        }\n\n    }\n\n}\n\npublic class ApiAuthorizationFilter extends BasicAuthenticationFilter implements SecurityConstants {\n\n    private ApiAuthenticationFactory authenticationFactory;\n    private AuthenticationService authenticationService;\n    private String jwtSecret;\n\n    public ApiAuthorizationFilter(\n            AuthenticationManager authenticationManager,\n            ApiAuthenticationFactory authenticationFactory,\n            AuthenticationService authenticationService,\n            @Value(&quot;${myapp.jwt-secret}&quot;) String jwtSecret) {\n\n        super(authenticationManager);\n        this.authenticationFactory = authenticationFactory;\n        this.authenticationService = authenticationService;\n        this.jwtSecret = jwtSecret;\n\n    }\n\n    @Override\n    protected void doFilterInternal(\n            HttpServletRequest request,\n            HttpServletResponse response,\n            FilterChain filterChain) throws IOException, ServletException {\n\n        String authHeader = request.getHeader(AUTHORIZATION_HEADER);\n\n        // allow the request through if no valid auth header is set; spring security\n        // will throw access denied exceptions downstream if the request is for an\n        // authenticated url\n        if (authHeader == null || !authHeader.startsWith(BEARER_TOKEN_PREFIX)) {\n            filterChain.doFilter(request, response);\n            return;\n        }\n\n        // otherwise an auth header was specified so lets take a look at it and grant access based\n        // on what we find\n        try {\n\n            DecodedJWT decodedJWT = JwtUtils.verifyToken(authHeader.replace(BEARER_TOKEN_PREFIX, &quot;&quot;), jwtSecret);\n            String subject = decodedJWT.getSubject();\n            ApiAuthentication authentication = authenticationFactory.createAuthentication(subject, null);\n\n            // TODO: I believe I need to look up granted authorities here and set them\n\n            authenticationService.setCurrentAuthentication(authentication);\n            filterChain.doFilter(request, response);\n\n        } catch (JWTVerificationException jwtVerificationEx) {\n            throw new AccessDeniedException(&quot;access denied&quot;, jwtVerificationEx);\n        }\n\n    }\n\n}\n\n@EnableWebSecurity\n@EnableGlobalMethodSecurity(prePostEnabled = true, securedEnabled = true, jsr250Enabled = true)\npublic class SecurityConfigV2 {\n\n    private boolean securityDebug;\n\n    private ObjectMapper objectMapper;\n    private ApiAuthenticationFactory authenticationFactory;\n    private TokenService tokenService;\n\n    private AuthenticationService authenticationService;\n    private String jwtSecret;\n    private ApiUnauthorizedHandler unauthorizedHandler;\n    private ApiSignInFailureHandler signInFailureHandler;\n\n    private BCryptPasswordEncoder passwordEncoder;\n    private RealmService realmService;\n\n    @Autowired\n    public SecurityConfigV2(\n            @Value(&quot;${spring.security.debug:false}&quot;) boolean securityDebug,\n            ObjectMapper objectMapper,\n            ApiAuthenticationFactory authenticationFactory,\n            TokenService tokenService,\n            AuthenticationService authenticationService,\n            @Value(&quot;${myapp.authentication.jwt-secret}&quot;) String jwtSecret,\n            ApiUnauthorizedHandler unauthorizedHandler,\n            ApiSignInFailureHandler signInFailureHandler,\n            BCryptPasswordEncoder passwordEncoder,\n            RealmService realmService) {\n        this.securityDebug = securityDebug;\n        this.objectMapper = objectMapper;\n        this.authenticationFactory = authenticationFactory;\n        this.tokenService = tokenService;\n        this.authenticationService = authenticationService;\n        this.jwtSecret = jwtSecret;\n        this.unauthorizedHandler = unauthorizedHandler;\n        this.signInFailureHandler = signInFailureHandler;\n        this.passwordEncoder = passwordEncoder;\n        this.realmService = realmService;\n    }\n\n    @Bean\n    public SecurityFilterChain filterChain(HttpSecurity httpSecurity) throws Exception {\n\n        // build authentication manager\n        AuthenticationManager authenticationManager = httpSecurity.getSharedObject(AuthenticationManagerBuilder.class)\n            .userDetailsService(realmService)\n            .passwordEncoder(passwordEncoder)\n            .and()\n            .build();   // &lt;-- calling it once up here, to get an AuthenticationManager instance\n\n        // enable CSRF\n        // TODO: enable once you are ready to provide 'CSRF tokens'\n        //  https://stackoverflow.com/a/75646727/5235665\n        httpSecurity.csrf().disable();\n\n        // add CORS filter\n        httpSecurity.cors();\n\n        // add anonoymous/permitted paths (that is: what paths are allowed to bypass authentication)\n        httpSecurity.authorizeRequests()\n            .antMatchers(HttpMethod.OPTIONS, &quot;/**&quot;).permitAll()\n            .antMatchers(HttpMethod.GET, &quot;/actuator/health&quot;).permitAll()\n            .antMatchers(HttpMethod.POST, &quot;/v*/tokens/refresh&quot;).permitAll();\n\n        // restrict all other paths and set them to authenticated\n        httpSecurity.authorizeRequests().anyRequest().authenticated();\n\n        // add authn + authz filters -- using AuthenticationManager instance here\n        httpSecurity.addFilter(apiAuthenticationFilter(authenticationManager));\n        httpSecurity.addFilter(apiAuthorizationFilter(authenticationManager));\n\n        // configure exception-handling for authn and authz\n        httpSecurity.exceptionHandling().accessDeniedHandler(unauthorizedHandler);\n        httpSecurity.exceptionHandling().authenticationEntryPoint(signInFailureHandler);\n\n        // configure stateless http sessions (appropriate for RESTful web services)\n        httpSecurity.sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS);\n\n        // and building it a 2nd time here, to complete the filter\n        // but I believe this is what causes the error\n        return httpSecurity.build();\n    }\n\n    public ApiAuthenticationFilter apiAuthenticationFilter(AuthenticationManager authenticationManager) {\n\n        ApiAuthenticationFilter authenticationFilter = new ApiAuthenticationFilter(\n                authenticationManager, tokenService, objectMapper, authenticationFactory);\n        return authenticationFilter;\n\n    }\n\n    public ApiAuthorizationFilter apiAuthorizationFilter(AuthenticationManager authenticationManager) {\n\n        ApiAuthorizationFilter authorizationFilter = new ApiAuthorizationFilter(\n            authenticationManager,\n            authenticationFactory,\n            authenticationService,\n            jwtSecret);\n\n        return authorizationFilter;\n\n    }\n\n    @Bean\n    public WebSecurityCustomizer webSecurityCustomizer() {\n        return (web) -&gt; web.debug(securityDebug)\n            .ignoring()\n            .antMatchers(&quot;/css/**&quot;, &quot;/js/**&quot;, &quot;/img/**&quot;, &quot;/lib/**&quot;, &quot;/favicon.ico&quot;);\n    }\n\n    @Bean\n    public CorsConfigurationSource corsConfigurationSource() {\n\n        CorsConfiguration corsConfiguration = new CorsConfiguration();\n        corsConfiguration.setAllowedMethods(Arrays.asList(&quot;GET&quot;, &quot;POST&quot;, &quot;PUT&quot;, &quot;PATCH&quot;, &quot;DELETE&quot;, &quot;OPTIONS&quot;));\n        corsConfiguration.setAllowedHeaders(Arrays.asList(&quot;Authorization&quot;, &quot;Content-Type&quot;));\n\n        UrlBasedCorsConfigurationSource corsConfigurationSource = new UrlBasedCorsConfigurationSource();\n        corsConfigurationSource.registerCorsConfiguration(&quot;/**&quot;, corsConfiguration);\n\n        return corsConfigurationSource;\n\n    }\n\n}\n</code></pre>\n<p>When I start up my app I am getting:</p>\n<pre><code>org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name \n'org.springframework.security.config.annotation.web.configuration.WebSecurityConfiguration': \nUnsatisfied dependency expressed through method 'setFilterChains' parameter 0; nested exception is \norg.springframework.beans.factory.BeanCreationException: \nError creating bean with name 'filterChain' defined \nin class path resource [myapp/ws/security/v2/SecurityConfigV2.class]: \nBean instantiation via factory method failed; nested exception is \norg.springframework.beans.BeanInstantiationException: \nFailed to instantiate [org.springframework.security.web.SecurityFilterChain]: \nFactory method 'filterChain' threw exception; \nnested exception is org.springframework.security.config.annotation.AlreadyBuiltException: \nThis object has already been built\n</code></pre>\n<p>The Google Gods say this is because I'm calling <code>httpSecurity.build()</code> <strong>twice</strong> which is not allowed. However:</p>\n<ul>\n<li>My authn and authz filter require an <code>AuthenticationManager</code> instance; and</li>\n<li>It seems that the only way (please tell me if I'm wrong!) to get an <code>AuthenticationManager</code> instance is to run <code>httpSecurity.build()</code>; <strong>but</strong></li>\n<li>I need the authn/authz filter <em>before</em> I can call <code>httpSecurity.build()</code></li>\n</ul>\n<p>Can anyone help nudge me across the finish line here? Thanks for any and all help!</p>\n"
    },
    {
      "tags": [
        "java",
        "google-chrome",
        "selenium-webdriver",
        "selenium-chromedriver",
        "google-chrome-devtools"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 5189811,
            "display_name": "Oluwafemi Sule"
          },
          "edited": false,
          "comment_id": 133554930,
          "body": "How about hardcoding the port and  configuring the remote origins to be <code>options.addArguments(&quot;--remote-allow-origins=&quot;+ service.getUrl())</code>"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 21383462,
            "display_name": "Bruno Rodrigues"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1678630782,
          "answer_id": 75713753,
          "body": "<p>You can try something like this</p>\n<pre class=\"lang-java prettyprint-override\"><code>ChromeOptions options = new ChromeOptions();\nSystem.setProperty(&quot;webdriver.chrome.driver&quot;, &quot;drivers/chromedriver.exe&quot;);\n\noptions.addArguments(&quot;--remote-allow-origins=*&quot;);\nWebDriver driver = new ChromeDriver(options);\ndriver.manage().timeouts().implicitlyWait(10, TimeUnit.SECONDS);\ndriver.navigate().to(&quot;http://localhost:8080/leiloes&quot;);\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 13355310,
            "display_name": "shankar prasad"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1680031730,
          "answer_id": 75870341,
          "body": "<p>The WebSocket issue is now fixed from selenium 4.8.2/4.8.3, there's no need to add &quot;--remote-allow-origins=*&quot; to the chrome options during invocation. Instead we can now directly update the selenium dependencies in our pom.xml.</p>\n<h1>Update Logs:\nv4.8.3</h1>\n<ul>\n<li>Supported CDP versions: 85, 109, 110, 111</li>\n<li>Fix bug preventing adding items to ArrayList for Selenium Manager command</li>\n</ul>\n<h1>v4.8.2</h1>\n<ul>\n<li>Supported CDP versions: 85, 109, 110, 111</li>\n<li>[grid] Enabling <code>detectDrivers</code> original behaviour.</li>\n<li>Fix NPE regression in 4.8.0 (#11701)</li>\n<li>Implement DriverFinder completely independent of Service classes (#11491)</li>\n<li>[grid] Allow LocalNode to be extended for customisation (#11718)</li>\n<li>InvalidSelectorException extends WebDriverException (#11727)</li>\n<li>Deprecate CDP instance methods in FirefoxDriver</li>\n<li>Adding allowHosts to GeckoDriverService</li>\n<li>[grid] Passing language env var to child containers</li>\n<li>[grid] Removing unknown capability extensions for IE</li>\n<li>[bidi] Ensure removing listeners does not cause an error</li>\n<li>Process Selenium Manager output as JSON (#11663)</li>\n<li>[grid] Support remote downloads in Grid (#11702)</li>\n<li>Adding <code>remote-allow-origins</code> for Chrome</li>\n<li>Invoking Selenium Manager only with `--browser</li>\n<li>[grid] Adding <code>remote-allow-origins</code> for Chrome stereotypes</li>\n<li>Overloaded constructors to configure connect and read timeouts for WebDriver objects (#11532)</li>\n</ul>\n"
        }
      ],
      "owner": {
        "user_id": 5645656,
        "display_name": "Cardinal System"
      },
      "view_count": 7954,
      "up_vote_count": 5,
      "answer_count": 2,
      "score": 5,
      "creation_date": 1678284507,
      "question_id": 75674124,
      "body": "<p>I am having a WebSocket issue with Selenium WebDriver, the same issue described <a href=\"https://groups.google.com/g/chromedriver-users/c/xL5-13_qGaA\" rel=\"nofollow noreferrer\">here</a>. The solution to the problem was to add the <code>--remote-allow-origins=*</code> argument to my driver's ChromeOptions. However, I do not want to use a wildcard for this parameter. I want to set it to something that will only allow a connection from my application.</p>\n<p>I believe the solution will involve predetermining the WebDriver's port. This is my best attempt, but it is not working:</p>\n<pre><code>ChromeOptions options = new ChromeOptions();\noptions.addArguments(&quot;--incognito&quot;, &quot;--app=&quot; + linkedform);\n\nint port;\ntry (ServerSocket serverSocket = new ServerSocket(0)) {\n    port = serverSocket.getLocalPort();\n} catch (IOException e) {\n    throw new RuntimeException(e);\n}\n\noptions.addArguments(&quot;--remote-allow-origins=http://localhost:&quot; + port);\nChromeDriverService service = new ChromeDriverService.Builder().usingPort(port).build();\nthis.chrome = new ChromeDriver(service, options);\n</code></pre>\n<p>Am I going down the right track? Is this even possible?</p>\n"
    },
    {
      "tags": [
        "java",
        "android",
        "in-app-billing",
        "play-billing-library"
      ],
      "answers": [
        {
          "owner": {
            "user_id": 10857976,
            "display_name": "Abbas Ghassemi"
          },
          "up_vote_count": 1,
          "is_accepted": true,
          "creation_date": 1674931124,
          "answer_id": 75269989,
          "body": "<p>It is accessible in class <code>Purchase</code>.</p>\n<pre><code>Purchase.getOriginalJson();\n</code></pre>\n<p>Places you can access it:</p>\n<pre><code>billingClient.startConnection(new BillingClientStateListener() {\n    @Override\n    public void onBillingSetupFinished(BillingResult billingResult) {\n        if (billingResult.getResponseCode() == BillingClient.BillingResponseCode.OK) {\n            QueryPurchasesParams queryPurchasesParams = QueryPurchasesParams.newBuilder().setProductType(BillingClient.ProductType.INAPP).build();\n            billingClient.queryPurchasesAsync(queryPurchasesParams, (billingResult1, list) -&gt; runOnUiThread(() -&gt; {\n                for (Purchase purchase: list) {\n                    Log.d(&quot;originalJson&quot;, purchase.getOriginalJson());\n                }\n            }));\n        }\n    }\n\n    @Override\n    public void onBillingServiceDisconnected() { }\n});\n</code></pre>\n<p>And:</p>\n<pre><code>@Override\npublic void onPurchasesUpdated(@NonNull BillingResult billingResult, @Nullable List&lt;Purchase&gt; purchases) {\n    runOnUiThread(() -&gt; {\n        if (billingResult.getResponseCode() == BillingClient.BillingResponseCode.OK &amp;&amp; purchases != null) {\n            for (Purchase purchase: purchases) {\n                Log.d(&quot;originalJson&quot;, purchase.getOriginalJson());\n            }\n        }\n    }\n}\n</code></pre>\n<p>Good luck.</p>\n"
        }
      ],
      "owner": {
        "user_id": 4851751,
        "display_name": "Doron Yakovlev Golani"
      },
      "view_count": 499,
      "up_vote_count": 5,
      "accepted_answer_id": 75269989,
      "answer_count": 1,
      "score": 5,
      "creation_date": 1674148719,
      "question_id": 75175978,
      "body": "<p>I am upgrading from Google Play Billing version 4.0.0 to version 5.1.0.\nIn version 4 <code>SkuDetails</code> has the function <code>getOriginalJson()</code> that contains a json object that I send to my back end. I dug in the <a href=\"https://developer.android.com/reference/com/android/billingclient/api/ProductDetails\" rel=\"noreferrer\">API</a> and could not find an official equivalent in version 5.1.0.</p>\n<p>There are 2 places where I can see that this information may be available in <code>com.android.billingclient.api.ProductDetails</code> - an interal <code>JSONObject</code> member that we are not supposed to access and as part of the <code>toString()</code> function where this information is appended to <code>parsedJson</code>. I can probably extract what I need from the <code>toString()</code>, but I was wondering if there something better/official.</p>\n"
    },
    {
      "tags": [
        "java",
        "android",
        "android-layout",
        "textview",
        "imageview"
      ],
      "owner": {
        "user_id": 21238708,
        "display_name": "Jatin guglani"
      },
      "view_count": 53,
      "up_vote_count": 6,
      "answer_count": 0,
      "score": 5,
      "creation_date": 1683098731,
      "question_id": 76161364,
      "body": "<p>Is there a way to have a Textview that can adjust its content when an image or another Textview is placed inside it(overlapped) (as shown in the images below)</p>\n<p><a href=\"https://i.stack.imgur.com/1ojk9m.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1ojk9m.png\" alt=\"enter image description here\" /></a></p>\n<p><a href=\"https://i.stack.imgur.com/03IjEm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/03IjEm.png\" alt=\"enter image description here\" /></a></p>\n<p>Things That I have tried so far:</p>\n<ol>\n<li><p>LeadingMarginSpan.LeadingMarginSpan2: I'm only able to place an image at the top left corner but I want to place an image in different positions (center,  right, bottom, etc).</p>\n</li>\n<li><p>I came across a library <a href=\"https://github.com/deano2390/flowtextview\" rel=\"nofollow noreferrer\">FlowtextView</a> but I would rather want to implement it on my own.</p>\n</li>\n</ol>\n<p>In macOS, we can achieve the same for containers containing text, the textstorage can be modified to add <a href=\"https://developer.apple.com/documentation/appkit/nstextcontainer/1444569-exclusionpaths\" rel=\"nofollow noreferrer\">exclusion paths</a> around which text would flow. The frame of the overlapping container can be converted into an NSBezierpath and set as an exclusion for the text. (as shown in the image below)</p>\n<p><a href=\"https://i.stack.imgur.com/0n3dgm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0n3dgm.png\" alt=\"enter image description here\" /></a></p>\n<p>Is there any way to achieve the same in Android?</p>\n"
    },
    {
      "tags": [
        "java",
        "android",
        "java-native-interface"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 1548468,
            "display_name": "Botje"
          },
          "edited": false,
          "comment_id": 133835335,
          "body": "Are there perhaps pending exceptions on the stack? In particular, have you enabled the checking JNI layer to make sure everything else is okay?"
        },
        {
          "owner": {
            "user_id": 4756299,
            "display_name": "Andrew Henle"
          },
          "edited": false,
          "comment_id": 133839971,
          "body": "Reinforcing what @Botje stated:  if <code>arrayList</code> is <code>NULL</code> in your posted code, <code>(*env)-&gt;CallObjectMethod(env, arrayList, midGet, 0);</code> is going to throw a <code>NullPointerException</code>.  You can&#39;t call an object method on a <code>null</code> object."
        },
        {
          "owner": {
            "user_id": 5218554,
            "display_name": "Bao HQ"
          },
          "edited": false,
          "comment_id": 133841948,
          "body": "arrayList is not NULL, the first element of the arrayList is NULL"
        },
        {
          "owner": {
            "user_id": 1548468,
            "display_name": "Botje"
          },
          "edited": false,
          "comment_id": 133870258,
          "body": "Another unlikely guess: did somebody change the definition of the NULL macro from under you? The Android JNI implementation checks for equality to a <code>nullptr</code> of the right type."
        },
        {
          "owner": {
            "user_id": 5218554,
            "display_name": "Bao HQ"
          },
          "edited": false,
          "comment_id": 133892606,
          "body": "We have checked that, we don&#39;t see any modifications"
        }
      ],
      "owner": {
        "user_id": 5218554,
        "display_name": "Bao HQ"
      },
      "view_count": 102,
      "up_vote_count": 5,
      "answer_count": 0,
      "score": 5,
      "creation_date": 1680080965,
      "question_id": 75875219,
      "body": "<p>The purpose is to compare a byte array against the NULL value</p>\n<pre><code>jmethodID midGet = (*env)-&gt;GetMethodID(env, classArrayList, &quot;get&quot;, &quot;(I)Ljava/lang/Object;&quot;);\njbyteArray arr = (*env)-&gt;CallObjectMethod(env, arrayList, midGet, 0);\nif (!(*env)-&gt;IsSameObject(env, arr, NULL)) {\n    // Always falls in here when testing with Android 13\n    // For Android &lt;13, this block is not executed\n}\n</code></pre>\n<p>arrayList is passed in from Java layer</p>\n<pre><code>ArrayList&lt;byte[]&gt; arrayList = new ArrayList&lt;&gt;();\narrayList.add(null);\n</code></pre>\n<p>The IsSameObject method returns unexpected value in Android 13. Please help me figure out. Thanks!</p>\n"
    },
    {
      "tags": [
        "java",
        "websocket",
        "keycloak",
        "openid-connect",
        "quarkus"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 874814,
            "display_name": "Babl"
          },
          "edited": false,
          "comment_id": 132667422,
          "body": "So still not sure what is the problem? In short  1-&gt; Why do you want to make <code>onOpen()</code> return anything?  2-&gt; Yes you can 3-&gt; Yes it does"
        },
        {
          "owner": {
            "user_id": 955755,
            "display_name": "Murrah"
          },
          "edited": false,
          "comment_id": 132670799,
          "body": "Thanks. I want to return a Uni to resolve the exception that is being thrown as mentioned above. ie it says: <code>Make the secured method return an async type, i.e. Uni, Multi or CompletionStage,</code>. It seems that is required in order for the async resolution of the authentication with Keycloak, which needs to happen in order to know whether the endpoint should be allowed or not, and to validate the access token."
        },
        {
          "owner": {
            "user_id": 874814,
            "display_name": "Babl"
          },
          "edited": false,
          "comment_id": 132675080,
          "body": "Hmm, that&#39;s strange, as that should not be a problem. Do you have a small POC where we can reproduce the problem?"
        }
      ],
      "owner": {
        "user_id": 955755,
        "display_name": "Murrah"
      },
      "view_count": 399,
      "up_vote_count": 5,
      "answer_count": 0,
      "score": 5,
      "creation_date": 1673923314,
      "question_id": 75141521,
      "body": "<p>I have gone down many rabbit holes and cannot get this working. I am hoping someone can help me.</p>\n<p>I am using Keycloak and my REST endpoints are successfully secured like this abbreviated example:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Path(&quot;/api&quot;)\npublic class MyResource {\n    @Inject\n    SecurityIdentity securityIdentity;\n\n    @Inject\n    JsonWebToken jwt;\n\n    @GET\n    @Path(&quot;/mydata&quot;)\n    @RolesAllowed(&quot;user&quot;)\n    @NoCache\n    public Uni&lt;Response&gt; getMyData(Request request) { \n        // Get a claim from the Keycloak JWT\n        String mySpecialClaim = (String) jwt.claim(&quot;myCustomClaim&quot;).get();\n \n        // Do some work...\n        String resJson = &quot;{result of work here}&quot;;\n\n        return Uni.createFrom().item(resJson)\n              .onItem()\n              .transform(item -&gt; item != &quot;&quot; ? Response.ok(item) : Response.status(Response.Status.NO_CONTENT))\n              .onItem()\n              .transform(Response.ResponseBuilder::build);\n    }\n}\n</code></pre>\n<p>The access token is supplied by the client app which manages the Keycloak authentication and which sends the API request with a Bearer token. Standard stuff, all working. :-)</p>\n<p>Now, I want to do something similar with a WebSocket endpoint.</p>\n<p>I am using the <a href=\"https://quarkus.io/guides/websockets\" rel=\"nofollow noreferrer\">Quarkus Websockets</a> sample as my guide and can get it all working without Authorization - ie making unsecured calls.</p>\n<p>I am stuck trying to secure the WebSocket connection.</p>\n<p>The closest I have come to finding a solution is this post in the Quarkus GitHub issues:\n<a href=\"https://github.com/quarkusio/quarkus/issues/29919#issuecomment-1356917147\" rel=\"nofollow noreferrer\">https://github.com/quarkusio/quarkus/issues/29919</a></p>\n<p>I have coded that up as per the sample code in the post. Logging shows the <code>reactive route</code> and <code>WebSocketSecurityConfigurator</code> are both being called and the <code>access_token</code> from the JS WebSocket client is present and presumably being processed by the Quarkus default security processes, as it does for REST end points. All good.</p>\n<p>The missing piece is how to code the <code>onOpen()</code> and <code>onMessage()</code> methods in my WebSocket endpoint so they are secure, reactive, and I can access the JWT to get the claims I need.</p>\n<p>Can anyone elaborate on this code fragment from the Quarkus issue post mentioned above, please? I have added what I think I need as per the sample further below.</p>\n<p>The fragment from the issue post:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Authenticated\n@ServerEndpoint(\n        value =&quot;/ws&quot;,\n        configurator = WebSocketSecurityConfigurator.class\n)\npublic class WebSocket {\n    @Inject\n    UserInfo userInfo;\n    // ...\n}\n</code></pre>\n<p>My additions:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Authenticated\n@ServerEndpoint(\n        value =&quot;/services/{clientid}&quot;,\n        configurator = WebSocketSecurityConfigurator.class\n)\n\npublic class WebSocket {\n    @Inject\n    SecurityIdentity securityIdentity;\n\n    @Inject\n    JsonWebToken jwt;\n\n    @Inject\n    UserInfo userInfo;\n    \n    @OnOpen\n    @RolesAllowed(&quot;user&quot;) // Is this possible here? Or do I use the JWT and test myself?\n    public void onOpen(Session session, @PathParam(&quot;clientid&quot;) String clientid) {\n        // Get a claim from the Keycloak JWT\n        String mySpecialClaim = (String) jwt.claim(&quot;myCustomClaim&quot;).get();\n \n        // Do some setup work...\n        // eg cache the session in a map, etc\n    }\n\n    @OnMessage\n    public void onMessage(String message, @PathParam(&quot;clientid&quot;) String clientid) {\n        // Get a claim from the Keycloak JWT\n        String myOtherSpecialClaim = (String) jwt.claim(&quot;myOtherCustomClaim&quot;).get();\n \n        // Do some work using the message...\n        String someMessage = &quot;tell the world&quot;;\n\n        // Broadcast something ...\n        myBroadcastFunction(someMessage);\n    }\n}\n</code></pre>\n<p>In the non-secure version, the <code>onOpen()</code> and <code>onMessage()</code> methods return <code>void</code> because, of course, unlike a REST endpoint, one broadcasts the result instead of returning it.</p>\n<p>In this secured version that does not work. If I only have an onOpen() method, and code it like this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@OnOpen\npublic void onOpen(Session session, @PathParam(&quot;clientid&quot;) String clientid) {\n    Log.info(&quot;websocket onOpen session=&quot; + session.getId());\n}\n</code></pre>\n<p>It throws:</p>\n<pre><code>Unhandled error in annotated endpoint org.flowt.orgserver.gateway.WebSocketGateway_Subclass@732f20f8\n\njava.lang.RuntimeException: java.lang.RuntimeException: java.lang.RuntimeException: \n\nio.quarkus.runtime.BlockingOperationNotAllowedException: Blocking security check attempted in code running on the event loop. \nMake the secured method return an async type, i.e. Uni, Multi or CompletionStage, \nor use an authentication mechanism that sets the SecurityIdentity in a blocking manner prior to delegating the call\n</code></pre>\n<p>I would like not to block the event loop, so the first suggestion is the preferred one.</p>\n<p>But how should I code that?</p>\n<ol>\n<li>If I make the onOpen() return a Uni, how do I subscribe to it so it runs?</li>\n<li>Can I still access the JWT to get the claims I need?</li>\n<li>Do annotations like <code>@RolesAllowed(&quot;user&quot;)</code> still work in this context?</li>\n</ol>\n<p>I wont waste space here with all my failed attempts. I am thinking I am not the first person to need to do this and there must be some kind of pattern to implement. The Quarkus docs are silent on this.</p>\n<p><strong>Can anyone tell me how to code the <code>onOpen()</code> and <code>onMessage()</code> methods using Quarkus so that the WebSocket endpoints are secured and the JWT is available inside those methods?</strong></p>\n<p><strong>EDIT =======</strong></p>\n<p>To resolve the blocking exception, the Quarkus docs <a href=\"https://quarkus.io/guides/security-built-in-authentication-support-concept#proactive-authentication\" rel=\"nofollow noreferrer\">here</a> say</p>\n<pre><code>To work around this you need to @Inject an instance\nof io.quarkus.security.identity.CurrentIdentityAssociation, \nand call the Uni&lt;SecurityIdentity&gt; getDeferredIdentity(); method. \nYou can then subscribe to the resulting Uni and will be \nnotified when authentication is complete and the identity \nis available.\n</code></pre>\n<p>I cannot work out how to implement that instruction. Debugging into the Quarkus code I see that my access_token is being processed, the user is retrieved from Keycloak but the deferredIdentity is not being set. Therefore <code>onOpen()</code> never runs.</p>\n<p>Clearly this is not what the docs mean me to do!</p>\n<p>Here is my class:</p>\n<pre class=\"lang-java prettyprint-override\"><code>package org.flowt.orgserver.gateway;\n\nimport javax.enterprise.context.ApplicationScoped;\nimport javax.inject.Inject;\n\nimport javax.websocket.Session;\nimport javax.websocket.OnOpen;\nimport javax.websocket.server.PathParam;\nimport javax.websocket.server.ServerEndpoint;\n\nimport io.quarkus.logging.Log;\nimport io.quarkus.security.Authenticated;\nimport io.quarkus.security.identity.CurrentIdentityAssociation;\nimport io.quarkus.security.identity.SecurityIdentity;\n\nimport io.smallrye.mutiny.Uni;\n\n@ApplicationScoped\n@Authenticated\n@ServerEndpoint(value = &quot;/services/{clientid}&quot;, configurator = WebSocketSecurityConfigurator.class)\npublic class WebSocketGateway {\n\n    @Inject\n    SecurityIdentity securityIdentity;\n\n    @Inject\n    CurrentIdentityAssociation identities;\n\n    @OnOpen\n    public Uni&lt;Void&gt; onOpen(Session session, @PathParam(&quot;clientid&quot;) String clientid) {\n        // This never runs\n        Log.info(&quot;=========================== onOpen session=&quot; + session.getId());\n\n        return identities.getDeferredIdentity()\n                .onItem()\n                .transformToUni(identity -&gt; {\n                    // Just to see if we reach here\n                    Log.info(&quot;identity=&quot; + identity.toString());\n                    return Uni.createFrom().voidItem();\n                });\n    }\n}\n\n</code></pre>\n<p>And just to reiterate: the REST endpoints in this same app for the same logged in user work perfectly.</p>\n<p>Thanks,\nMurray</p>\n"
    },
    {
      "tags": [
        "java",
        "spring-boot",
        "kafka-consumer-api",
        "spring-kafka"
      ],
      "answers": [
        {
          "owner": {
            "user_id": 8680142,
            "display_name": "Kevin Lee"
          },
          "up_vote_count": 0,
          "is_accepted": true,
          "creation_date": 1673512653,
          "answer_id": 75093492,
          "body": "<p>Config in consumer, such as <code>max.partition.fetch.bytes</code> or <code>fetch.max.bytes</code> both are <strong>not a absolute maximum</strong>.</p>\n<blockquote>\n<p>Records are fetched in batches by the consumer, and if the first record batch in the first non-empty partition of the fetch is larger than this value, the record batch will still be returned to ensure that the consumer can make progress</p>\n</blockquote>\n<p>kafka recommend to define via <code>message.max.bytes</code> (broker config) or <code>max.message.bytes</code> (topic config).</p>\n<p>You can find all detail about kafka config here: <a href=\"https://kafka.apache.org/documentation/#consumerconfigs_max.partition.fetch.bytes\" rel=\"nofollow noreferrer\">max.partition.fetch.bytes</a></p>\n<p>Hope that helps.</p>\n"
        }
      ],
      "owner": {
        "user_id": 6438972,
        "display_name": "Santoshkumar Kalasa"
      },
      "view_count": 164,
      "up_vote_count": 5,
      "accepted_answer_id": 75093492,
      "answer_count": 1,
      "score": 5,
      "creation_date": 1673103241,
      "question_id": 75041276,
      "body": "<p>I want to consumer to consume messages in  batch based on the length/size of the message batch means batch of 1kb and max poll.record with 100. at max it polls 100 message or 1kb of message.</p>\n<pre><code>max.poll.records =100  \n</code></pre>\n<p>How do I set 1kb of message at max in the batch ?\nI have tried with <code>max.partition.fetch.bytes=1024</code> but I am getting 100 message even message batch  is larger than 1024 bytes. How to control this behaviour ?</p>\n<p>How do I set at max 1kb of message with cap of 100 message per batch at max ?</p>\n"
    },
    {
      "tags": [
        "java",
        "android",
        "android-studio",
        "java-home"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 21008344,
            "display_name": "Taimoor Sikander"
          },
          "edited": false,
          "comment_id": 132568375,
          "body": "If someone faces this error after the Android Studio update to Android Studio Electric Eel | 2022.1.1 then simply follow the following steps:  Go To the android studio directory (Default C:\\Program Files\\Android\\Android Studio) remove jre folder run cmd as administrator  cd C:\\Program Files\\Android\\Android Studio mklink /D &quot;jre&quot; &quot;jbr&quot; Thanks to this link"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 21008344,
            "display_name": "Taimoor Sikander"
          },
          "up_vote_count": 31,
          "is_accepted": true,
          "creation_date": 1673765323,
          "answer_id": 75123410,
          "body": "<p>SOLVED:</p>\n<p>For Windows</p>\n<p>Go To the android studio directory</p>\n<p>(Default C:\\Program Files\\Android\\Android Studio)</p>\n<p>remove jre folder</p>\n<p>run cmd as administrator</p>\n<pre><code>cd C:\\Program Files\\Android\\Android Studio\nmklink /D &quot;jre&quot; &quot;jbr&quot;\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 20332387,
            "display_name": "jazzfree1213"
          },
          "up_vote_count": 4,
          "is_accepted": false,
          "creation_date": 1674071294,
          "answer_id": 75164561,
          "body": "<p>THANKS a LOT. You solve my problem. Only to note that you have to remove all the folders inside C:\\Program Files\\Android\\Android Studio\\jre  by hand</p>\n<p>-1. run cmd as administrator</p>\n<ol start=\"0\">\n<li><em>cd &quot;C:\\Program Files\\Android\\Android Studio&quot;</em></li>\n<li>remove first files from all subfolders of jre  &gt;  <em>del /s .\\jre</em></li>\n<li>remove jre folder &gt;  <em>rmdir /s .\\jre</em></li>\n<li>make link to jbr folder containing <em>bin\\java.exe</em> named as jre  &gt; <em>mklink /D &quot;jre&quot; &quot;jbr&quot;</em></li>\n</ol>\n<p>Thanks</p>\n"
        },
        {
          "owner": {
            "user_id": 7505376,
            "display_name": "Crain"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1674652197,
          "answer_id": 75234456,
          "body": "<p>These two steps were enough for me:</p>\n<ol>\n<li>Set JAVA_HOME to ...\\Android\\AndroidStudio\\jbr</li>\n<li>Rename or delete ...\\Android\\AndroidStudio\\jar</li>\n</ol>\n"
        },
        {
          "owner": {
            "user_id": 5498788,
            "display_name": "llfbandit"
          },
          "up_vote_count": 2,
          "is_accepted": false,
          "creation_date": 1677065231,
          "answer_id": 75532087,
          "body": "<p>This is an issue with gradle cache mecanism.</p>\n<p>You need to locate <code>.gradle/daemon/&lt;version&gt;/registry.bin</code> file and delete it.</p>\n<p><em>Note: you can delete all the <code>daemon</code> sub-folders.</em></p>\n<p>You can now compile your project with your JAHA_HOME environment variable as Gradle will regenerate those.</p>\n"
        },
        {
          "owner": {
            "user_id": 7983864,
            "display_name": "Shahood ul Hassan"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1677130442,
          "answer_id": 75540928,
          "body": "<ol>\n<li><p>Delete the folder: <code>C:\\Program Files\\Android\\Android Studio\\jre</code></p>\n</li>\n<li><p>Restart Android Studio</p>\n</li>\n</ol>\n<p>It solves the issue!</p>\n"
        },
        {
          "owner": {
            "user_id": 21307895,
            "display_name": "Puguh"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1677630231,
          "answer_id": 75598555,
          "body": "<p>Accepted question will break future Android Studio patch.\nSolution for this question is so simple, just delete folder .gradle in your %USER_HOME% (C:/Users/your_user).\nMake sure you close Android Studio and all Java.exe process before delete .gradle folder.</p>\n<p>Edit:\nUpgrade to Flutter 3.7.6 and this bug will be solved.\nIt can be checked here:\n<a href=\"https://github.com/flutter/flutter/wiki/Hotfixes-to-the-Stable-Channel\" rel=\"nofollow noreferrer\">https://github.com/flutter/flutter/wiki/Hotfixes-to-the-Stable-Channel</a></p>\n"
        }
      ],
      "owner": {
        "user_id": 21008344,
        "display_name": "Taimoor Sikander"
      },
      "view_count": 3366,
      "up_vote_count": 4,
      "accepted_answer_id": 75123410,
      "answer_count": 6,
      "score": 4,
      "creation_date": 1673719755,
      "question_id": 75120204,
      "body": "<p><strong>Android Studio Electric Eel</strong> - The supplied javaHome seems invalid. I cannot find the Java executable. Tried location: <code>C:\\Program Files\\Android\\Android Studio\\jre\\bin\\java.exe</code></p>\n<p>The error occurs after upgrading my Android Studio to Electric Eel,  the latest version. I tried multiple solutions to this problem, but nothing worked.\nMy JAVA_HOME and ANDROID_HOME variables are set. I even tried to reinstall Java JDK-19 and reinstalled the Android Studio, but I still have the same issue.</p>\n<p>I even tried to reinstall Java JDK-19 and reinstalled Android Studio, but I still have the same issue.</p>\n"
    },
    {
      "tags": [
        "java",
        "google-chrome",
        "selenium-webdriver",
        "selenium-chromedriver",
        "selenium-java"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 12175652,
            "display_name": "Rolandas Ulevicius"
          },
          "edited": false,
          "comment_id": 133575374,
          "body": "what issue? what problem?"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 21335232,
            "display_name": "Bhairu"
          },
          "up_vote_count": 4,
          "is_accepted": false,
          "creation_date": 1678698037,
          "answer_id": 75719759,
          "body": "<pre><code>ChromeOptions options=new ChromeOptions();    \noptions.addArguments(&quot;--remote-allow-origins=*&quot;);    \n//Launching the browser\ndriver=new ChromeDriver(options);\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 21386874,
            "display_name": "JBM"
          },
          "up_vote_count": 6,
          "is_accepted": true,
          "creation_date": 1678711457,
          "answer_id": 75722029,
          "body": "<p>I followed the below answer: <a href=\"https://stackoverflow.com/a/75703971/21386874\">https://stackoverflow.com/a/75703971/21386874</a></p>\n<pre><code>options.addArguments(&quot;--remote-allow-origins=*&quot;); \n</code></pre>\n<p>I tried but it is not working.\nIn my project, I got the below error.<br />\nError:</p>\n<blockquote>\n<p>org.openqa.selenium.remote.http.ConnectionFailedException: Unable to establish websocket connection to http://localhost:49877/devtools/browser/3a3af47d-732a-4337-a91c-18c8ced545cd\nBuild info: version: '4.5.3', revision: '4b786a1e430'</p>\n</blockquote>\n<p>Ans:</p>\n<p>I downloaded the newest chromedriver.exe with the 111.0.5563.64 version.\nAlso, I added one more dependency:</p>\n<pre><code>&lt;dependency&gt;\n  &lt;groupId&gt;org.seleniumhq.selenium&lt;/groupId&gt;\n  &lt;artifactId&gt;selenium-http-jdk-client&lt;/artifactId&gt;\n  &lt;version&gt;4.5.0&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>And added this code line at the first line into the <code>@BeforeTest</code> method:</p>\n<pre><code>System.setProperty(&quot;webdriver.http.factory&quot;, &quot;jdk-http-client&quot;);\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 7429447,
            "display_name": "undetected Selenium"
          },
          "up_vote_count": 8,
          "is_accepted": false,
          "creation_date": 1678866163,
          "answer_id": 75741758,
          "body": "<p>Using <a href=\"/questions/tagged/google-chrome\" class=\"post-tag\" title=\"show questions tagged &#39;google-chrome&#39;\" aria-label=\"show questions tagged &#39;google-chrome&#39;\" rel=\"tag\" aria-labelledby=\"tag-google-chrome-tooltip-container\">google-chrome</a> <em><strong>v111.0</strong></em> this error message...</p>\n<pre><code>org.openqa.selenium.remote.http.ConnectionFailedException: Unable to establish websocket connection to http://localhost:49877/devtools/browser/3a3af47d-732a-4337-a91c-18c8ced545cd\n</code></pre>\n<p>and this error message...</p>\n<pre><code>2023-03-08T21:06:50.3319163Z WARNING: Invalid Status code=403 text=Forbidden\n2023-03-08T21:06:50.3320374Z java.io.IOException: Invalid Status code=403 text=Forbidden\n</code></pre>\n<p>and even this error message...</p>\n<pre><code>java.lang.NullPointerException: Cannot invoke &quot;org.asynchttpclient.ws.WebSocket.sendCloseFrame(int, String)&quot; because &quot;this.socket&quot; is null\n</code></pre>\n<p>...is the result of <em><code>devtools_http_handler</code></em> rejecting an incoming WebSocket connection from the http://localhost origin.</p>\n<hr />\n<h2>Details</h2>\n<p>This issue is the result of <em><code>Origin</code></em> header when set is being auto-resolved into meaningless value in <strong>Netty 4.x</strong> currently being used by Selenium. This issue was discussed in details in <a href=\"https://github.com/netty/netty/issues/9673\" rel=\"noreferrer\">Origin header is always sent from WebSocket client</a> and was addressed through <a href=\"https://github.com/netty/netty/pull/12941\" rel=\"noreferrer\">Fix generating the Origin header value for websocket handshake request</a>.</p>\n<hr />\n<h2>Solution</h2>\n<p>As per the <a href=\"https://www.selenium.dev/blog/2022/using-java11-httpclient/\" rel=\"noreferrer\"><em>Selenium Blog</em></a> there are a couple of approaches to solve this issue.</p>\n<ul>\n<li><p><em><strong>Using</strong></em> <a href=\"/questions/tagged/java-11\" class=\"post-tag\" title=\"show questions tagged &#39;java-11&#39;\" aria-label=\"show questions tagged &#39;java-11&#39;\" rel=\"tag\" aria-labelledby=\"tag-java-11-tooltip-container\">java-11</a> <em><strong>HTTP Client in Selenium</strong></em>: Selenium uses an HTTP client and associated WebSocket client for multiple purposes. <a href=\"https://github.com/AsyncHttpClient/async-http-client\" rel=\"noreferrer\">AsyncHttpClient</a> is an open-source library built on top of Netty. It allows the execution of HTTP requests and responses asynchronously. Additionally it also provides WebSocket support.But <em>AsyncHttpClient</em> is no more maintained since June 2021 as <em>Java 11+</em> provides a built-in HTTP and WebSocket client. Selenium can utilize it to replace AsyncHttpClient.</p>\n<ul>\n<li><p><em>Prerequisites</em>:</p>\n<pre><code>Project configured to use Java 11+\nUsing Selenium 4.5.0 as a minumum version\n</code></pre>\n</li>\n<li><p><em>Integrating the Java 11+ client</em>: As Java 11+ HTTP client sits in its own artifact it can be imported into your project that use Java 11+ as follows:</p>\n<pre><code>&lt;dependency&gt;\n  &lt;groupId&gt;org.seleniumhq.selenium&lt;/groupId&gt;\n  &lt;artifactId&gt;selenium-java&lt;/artifactId&gt;\n  &lt;version&gt;4.5.0&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n  &lt;groupId&gt;org.seleniumhq.selenium&lt;/groupId&gt;\n  &lt;artifactId&gt;selenium-http-jdk-client&lt;/artifactId&gt;\n  &lt;version&gt;4.5.0&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n</li>\n<li><p><em>Setting the system property</em>: You need to set the system property to indicate that Java 11+ Http client needs to be used. By default, it uses the <em>AsyncHttpClient</em>:</p>\n<pre><code>System.setProperty(&quot;webdriver.http.factory&quot;, &quot;jdk-http-client&quot;);\n</code></pre>\n</li>\n</ul>\n</li>\n<li><p><em><strong>Using</strong></em> <a href=\"/questions/tagged/java-8\" class=\"post-tag\" title=\"show questions tagged &#39;java-8&#39;\" aria-label=\"show questions tagged &#39;java-8&#39;\" rel=\"tag\" aria-labelledby=\"tag-java-8-tooltip-container\">java-8</a> <em><strong>in Selenium</strong></em>: As the ChromeDriver <a href=\"https://groups.google.com/g/chromedriver-users/c/xL5-13_qGaA/m/cGk_5MvTAAAJ\" rel=\"noreferrer\">verbose log</a> suggests:</p>\n<pre><code>[32332:259:0214/190812.204658:ERROR:devtools_http_handler.cc(766)] Rejected an incoming WebSocket connection from the http://localhost:58642 origin. Use the command line flag --remote-allow-origins=http://localhost:58642 to allow connections from this origin or --remote-allow-origins=* to allow all origins.\n</code></pre>\n</li>\n</ul>\n<p>A quick fix to this issue would be to add the argument <em><code>--remote-allow-origins=*</code></em> as follows:</p>\n<ul>\n<li><p><em>Java</em>:</p>\n<pre><code>ChromeOptions options = new ChromeOptions();\noptions.addArguments(&quot;--remote-allow-origins=*&quot;);\nWebDriver driver = new ChromeDriver(options);\n</code></pre>\n</li>\n</ul>\n<hr />\n<h2>References</h2>\n<p>Links to useful references:</p>\n<ul>\n<li><a href=\"https://github.com/SeleniumHQ/selenium/issues/11750\" rel=\"noreferrer\">Chrome 111 is not compatible with default HTTP Client</a></li>\n<li><a href=\"https://bugs.chromium.org/p/chromium/issues/detail?id=1422444\" rel=\"noreferrer\">Issue 1422444: Selenium Chromedriver no longer works with Chrome 111 update</a></li>\n<li><a href=\"https://chromiumdash.appspot.com/commit/0154caeefc74530d5cb57ce71608beb1b77bca39\" rel=\"noreferrer\">DevTools: reject debugging web socket connections with a defined Origin header</a></li>\n</ul>\n"
        },
        {
          "owner": {
            "user_id": 21411865,
            "display_name": "Nitee Asswani"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1679318423,
          "answer_id": 75790792,
          "body": "<p>I was facing the same error for different versions and this got resolved for me. The problem might be with the java, selenium and testNG versions compatibility. You can try with java 11 , selenium version as 4.5 or above and testNG version as 7.5</p>\n"
        },
        {
          "owner": {
            "user_id": 21485818,
            "display_name": "B.Harish Kumar"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1679715207,
          "answer_id": 75839523,
          "body": "<p>I downloaded chromedriver_win32.zip for ChromeDriver 111.0.5563.64 version &amp; on workspace I added below code.</p>\n<pre><code>ChromeOptions options = new ChromeOptions();\noptions.addArguments(&quot;--remote-allow-origins=*&quot;);\nWebDriver driver = new ChromeDriver(options);\n</code></pre>\n<p>After this issue resolved</p>\n"
        }
      ],
      "owner": {
        "user_id": 21386874,
        "display_name": "JBM"
      },
      "view_count": 8569,
      "up_vote_count": 5,
      "accepted_answer_id": 75722029,
      "answer_count": 5,
      "score": 4,
      "creation_date": 1678686717,
      "question_id": 75718422,
      "body": "<p>I tried to invoke the website using Selenium and Chrome browser v111.</p>\n<p>The browser is opening but the website is not invoking.\nIt is working properly but after updating chrome &quot;Version 111.0.5563.65 (Official Build) (64-bit)&quot; I'm getting this problem:</p>\n<pre><code>org.openqa.selenium.remote.http.ConnectionFailedException: Unable to establish websocket connection\n</code></pre>\n<p>I tried,\nEclipse IDE for Enterprise Java Developers (includes Incubating components)\nVersion: 2020-12 (4.18.0)\nBuild id: 20201210-1552.</p>\n<p>This is the code:</p>\n<pre><code> package com.testng.library_Files;\n\n import org.openqa.selenium.WebDriver;\n import org.openqa.selenium.chrome.ChromeDriver;\n import org.openqa.selenium.chrome.ChromeOptions;\n import org.testng.annotations.Test;\n\n public class one {\n     WebDriver driver=null;\n\n     @Test(priority = 1)\n     public void DoSetup()\n     {\n         //System.setProperty(&quot;webdriver.chrome.driver&quot;,&quot;./src/main/java/drivers/chromedriver.exe&quot;);\n         ChromeOptions options= new ChromeOptions(); \n         options.setHeadless(true);\n         //driver= new ChromeDriver(options);\n         driver= new ChromeDriver();\n     }\n\n     @Test(priority = 2)\n     public void LaunchURL()\n     {\n         driver.get(&quot;https://www.google.com&quot;);\n     }\n }\n</code></pre>\n<p>Please help me to solve this issue.</p>\n"
    },
    {
      "tags": [
        "java",
        "simpledateformat"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 214525,
            "display_name": "f1sh"
          },
          "edited": false,
          "comment_id": 132451610,
          "body": "I suspect the difference is some sort of overflow. Create a breakpoint and debug this to find out more. The real question is why you don&#39;t solve the actual problem and cut off the time part. And why the pattern contains 2-digit years but your input has 4-digit years."
        },
        {
          "owner": {
            "user_id": 992484,
            "display_name": "MadProgrammer"
          },
          "edited": false,
          "comment_id": 132451634,
          "body": "<code>ddMMyy</code> doesn&#39;t really match your input - but you really shouldn&#39;t be using <code>SimpleDateFormat</code> anymore and instead prefer <code>DateTimeFormatter</code> instead"
        },
        {
          "owner": {
            "user_id": 992484,
            "display_name": "MadProgrammer"
          },
          "edited": false,
          "comment_id": 132451670,
          "body": "I changed it to <code>ddMMyyyy</code> and <code>09012022</code> and it works"
        },
        {
          "owner": {
            "user_id": 127863,
            "display_name": "jqno"
          },
          "edited": false,
          "comment_id": 132451720,
          "body": "Yes, I know that SimpleDateFormat is not very good, and I know that the input doesn&#39;t match the format, and that the input is weird in the first place. This is just what I encountered in a legacy codebase, and I&#39;m simply curious to understand what&#39;s happening in the existing code, before I attempt to refactor."
        },
        {
          "owner": {
            "user_id": 992484,
            "display_name": "MadProgrammer"
          },
          "edited": false,
          "comment_id": 132451728,
          "body": "So, using <code>yyyy</code> and <code>2023000000000</code> it generates a year of <code>70403584</code> so I&#39;m &quot;assuming&quot; that&#39;s it&#39;s trying to consume  all the trailing <code>0</code>s"
        },
        {
          "owner": {
            "user_id": 5772882,
            "display_name": "Ole V.V."
          },
          "edited": false,
          "comment_id": 132452004,
          "body": "If this is a bug in your legacy code and you need to fix the bug and test the code again, how much code wold you need to rewrite in order to avoid using <code>SimpleDateFormat</code> here? Certainly an option I would seriously consider."
        },
        {
          "owner": {
            "user_id": 5772882,
            "display_name": "Ole V.V."
          },
          "edited": false,
          "comment_id": 132452116,
          "body": "I have reproduced. I agree with the others, though, that  if <code>2023</code> in your string is the year, then the you need <code>yyyy</code> (not <code>yy</code>) to parse it."
        },
        {
          "owner": {
            "user_id": 768644,
            "display_name": "rzwitserloot"
          },
          "edited": false,
          "comment_id": 132452409,
          "body": "@jqno As a fellow dutchie, note that your legacy code is intricately bound up with fairly careless conversion between epoch-milli form and y/m/d form (GregorianCalendar and Date contain the careless code, to be clear), and very recent versions of the JVM (if you&#39;re on coretto 17, you&#39;ll have this mess, most other JDK editions don&#39;t, yet, but will soon), <code>Europe&#47;Amsterdam</code> is broken, and any birthdates pre-1940 will shift by a day. Perhaps this disaster will let you claim the resources to fully refactor away from the legacy here."
        },
        {
          "owner": {
            "user_id": 5772882,
            "display_name": "Ole V.V."
          },
          "edited": false,
          "comment_id": 132452474,
          "body": "Which is the desired behaviour in your production code? Asking because both strings begin with <code>090120</code> , which appears to me to be correct for 9 January 2020. Are you wanting the exception or do you want parsing without exception? In the latter case, do you need to get the year correct (2023 and 2020 in your two examples)?"
        },
        {
          "owner": {
            "user_id": 127863,
            "display_name": "jqno"
          },
          "edited": false,
          "comment_id": 132452514,
          "body": "@rzwitserloot We&#39;re still stuck on Java 8 for the foreseeable future and also we&#39;re dealing with dates no earlier than 1990, so unfortunately this probably won&#39;t sway the powers that be. But thanks for the heads-up though!"
        },
        {
          "owner": {
            "user_id": 5772882,
            "display_name": "Ole V.V."
          },
          "edited": false,
          "comment_id": 132452531,
          "body": "This parses correctly since Java 9: <code>LocalDateTime.parse(&quot;09012020000000000&quot;, DateTimeFormatter.ofPattern(&quot;ddMMuuuuHHmmssSSS&quot;))</code>. Same if year is 2020 instead of 2023. In Java 8 itâ€™s just a little more complicated."
        },
        {
          "owner": {
            "user_id": 127863,
            "display_name": "jqno"
          },
          "edited": false,
          "comment_id": 132452574,
          "body": "@OleV.V. Fun fact, the desired behaviour in this case is the exception, which will cause the parser to fall-through to a second date format to attempt, which uses yyyy instead of yy. I honestly can&#39;t think of a better example for programming-by-coincidence than this."
        },
        {
          "owner": {
            "user_id": 5772882,
            "display_name": "Ole V.V."
          },
          "edited": false,
          "comment_id": 132453248,
          "body": "So the quick fix would be to throw the exception manually regardless of the string you get (not knowing the rest of your code itâ€™s hard for me to tell whether there is a better solution, I hope there is)."
        },
        {
          "owner": {
            "user_id": 768644,
            "display_name": "rzwitserloot"
          },
          "edited": false,
          "comment_id": 132454029,
          "body": "@jqno for what its worth, if you want &#39;least impact&#39;, you could clone <code>SimpleDateFormat</code> and replace line 1940 in <code>SimpleDateFormat</code>, which reads: <code>value = number.intValue();</code> with <code>value =  number.longValue() &gt; Integer.MAX_VALUE ? -1 : number.intValue();</code>, and use this cloned copy..."
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 112968,
            "display_name": "knittl"
          },
          "up_vote_count": 7,
          "is_accepted": false,
          "creation_date": 1673265810,
          "answer_id": 75057000,
          "body": "<p>The reason is integer overflow. But seriously, fix the legacy code.</p>\n<pre><code>jshell&gt; (int)9012023000000000L\n$1 ==&gt; 496985600\n\njshell&gt; (int)9012022000000000L\n$2 ==&gt; -503014400\n</code></pre>\n<p>A negative year is out of range for the year component. A crazy large year is still considered valid.</p>\n<p>Set a breakpoint on <a href=\"https://github.com/JetBrains/jdk8u_jdk/blob/master/src/share/classes/java/text/SimpleDateFormat.java#L1543\" rel=\"nofollow noreferrer\">line 1543 of SimpleDateFormat.java</a>. The exception itself is thrown in <a href=\"https://github.com/openjdk-mirror/jdk7u-jdk/blob/master/src/share/classes/java/util/GregorianCalendar.java#L2583\" rel=\"nofollow noreferrer\">Line 2583 of GregorianCalendar.java</a>:</p>\n<blockquote>\n<pre><code>for (int field = 0; field &lt; FIELD_COUNT; field++) {\n    int value = internalGet(field);\n    if (isExternallySet(field)) {\n        // Quick validation for any out of range values\n        if (value &lt; getMinimum(field) || value &gt; getMaximum(field)) {\n            throw new IllegalArgumentException(getFieldName(field));\n        }\n    }\n    originalFields[field] = value;\n}\n</code></pre>\n</blockquote>\n<p>The actual &quot;year&quot; value that ends up in this method is <code>-929596416</code> (<code>(int)2022000000000L</code>). Year 2023 does not throw because the long value coerced into an integer ends up being <code>70403584</code> â€“ which is allowed. The GregorianCalendar rejects values smaller than 1 (<code>&lt; 1</code>) and greater than 292278994 (<code>&gt; 292278994</code>).</p>\n"
        },
        {
          "owner": {
            "user_id": 768644,
            "display_name": "rzwitserloot"
          },
          "up_vote_count": 11,
          "is_accepted": true,
          "creation_date": 1673265968,
          "answer_id": 75057035,
          "body": "<p>OBVIOUS ANSWER: Get rid of this obsolete crud that never worked properly and do it right.</p>\n<h2>Let's first explain this result</h2>\n<p>I'm not sure why, but you wanted to know why this happens. I dived into the source of <code>SimpleDateFormat</code> for you.</p>\n<p>Given that the <code>yy</code> part is the last, it takes all remaining digits. Thus, the <code>&quot;2022000000000&quot;</code> part of the string is parsed into a <code>Long</code> of value <code>2022000000000</code>. This is then immediately converted to an <code>int</code>, and that's quite problematic; <code>2022000000000</code> overflows and turns into int value <code>-929596416</code>. A standard <code>java.text.CalendarBuilder</code> instance is then told to set its <code>YEAR</code> field to that value (-929596416). Which is fine.</p>\n<p>When parsing is done, that builder is asked to produce a <code>GregorianCalendar</code> value. This doesn't work - the GregorianCalendar accepts -929596416 as YEAR value just fine, but <code>SimpleDateFormat</code> then asks this GregCal instance to calculate the time in millis since the epoch, and <strong>that</strong> fails; an exception throws an exception indicating this. This exception is caught by the SimpleDateFormat code and results in the <code>Unparseable date</code> exception that you are getting.</p>\n<p>With 2023, you get the same effect: That is turned into an <code>int</code> without checking if it overflows; that overflows just the same, and results in int value <code>70403584</code>. <strong>GregorianCalendar DOES accept this year</strong>. This then results in what you saw: Year 70403584 - which is explained as follows:</p>\n<pre><code>long y = 2023000000000L;\nint i = (int) y;\nSystem.out.println(i); // prints 70403584\n</code></pre>\n<p>A deeper dive then is: Why is 70403584 fine, and -929596416 isn't?</p>\n<p>Mostly, 'because'. The GregCal internal methods <code>getMinimum(field)</code> and <code>getMaximum(field)</code>, when passing the YEAR field (constant value 1) are respectively 1 and 292278994. That means 70403584 is accepted, and -929596416 is not. You told it to be non-lenient. &quot;Lenient&quot; here (the old <code>j.u.Calendar</code> stuff) is mostly a silly concept (trying to define what is acceptable in non-lenient mode is virtually impossible. Various utterly ridiculous dates nevertheless are acceptable even in non-lenient mode).</p>\n<p>We can verify this:</p>\n<pre><code>GregorianCalendar cal = new GregorianCalendar();\ncal.setLenient(false);\ncal.set(Calendar.YEAR, -5);\nSystem.out.println(cal.getTime());\n</code></pre>\n<p>gives you:</p>\n<pre><code>Exception in thread &quot;main&quot; java.lang.IllegalArgumentException: YEAR\n    at java.base/java.util.GregorianCalendar.computeTime(GregorianCalendar.java:2609)\n    at java.base/java.util.Calendar.updateTime(Calendar.java:3411)\n    at java.base/java.util.Calendar.getTimeInMillis(Calendar.java:1805)\n    at java.base/java.util.Calendar.getTime(Calendar.java:1776)\n</code></pre>\n<p><strong>THE EXECUTIVE CONCLUSION</strong>: If you were expecting lenient mode to reject these patterns, I have some nasty news for you: non-lenient mode <strong>does not work and never did</strong> and you should not be relying on it. Specifically here, overflows are not checked (you'd think that in non-lenient mode, any overflow of any value means the value is rejected, but, alas), and 2023000000000 so happens to overflow into a ridiculous but nevertheless, acceptable (even in non-lenient) year, whereas 2022000000000 does not.</p>\n<h2>So how do you fix this?</h2>\n<p>You can't. SimpleDateFormat and GregorianCalendar are horrible API and broken implementations. The only fix is to ditch it. Use <code>java.time</code>. Make a new formatter using <code>java.time.DateTimeFormatter</code>, parse this value into a <code>LocalDate</code>, and go from there. You'll solve a whole host of timezone related craziness on the fly, too! (Because <code>java.util.Date</code> is lying and doesn't represent dates. It represents instants, hence why <code>.getYear()</code> and company are deprecated, because you can't ask an instant for a year without a timezone, and Date doesn't have one. Calendar is intricately interwoven with it all - hence, storing dates on one timezone and reading them on another causes wonkiness. LocalDate avoids all that).</p>\n<p>EDIT: As a fellow dutchie, note that the most recent JDKs break the <code>Europe/Amsterdam</code> timezone (grumble grumble OpenJDK team doesn't understand what damage they are causing) - which means any conversion between epoch-millis and base dates is extra problematic for software running in dutch locales. For example, if you are storing birthdates and you dip through conversion like this, <strong>everybody born before 1940 will break</strong> and their birthday will shift by a day. <code>LocalDate</code> avoids this by never storing anything as epoch-millis in the first place.</p>\n"
        }
      ],
      "owner": {
        "user_id": 127863,
        "display_name": "jqno"
      },
      "view_count": 214,
      "up_vote_count": 5,
      "accepted_answer_id": 75057035,
      "answer_count": 2,
      "score": 4,
      "creation_date": 1673263927,
      "question_id": 75056668,
      "body": "<p>I'm working with legacy code that tries to parse dates that include an optional time component that's usually padded with zeroes, using the a format string <code>ddMMyy</code> that doesn't really match the input. In the spirit of true legacy code, nobody ever bothered to clean it up because it accidentally does what it's supposed to do. Except, in 2023, it no longer does.</p>\n<p>Here's a (drastically simplified) version of the code:</p>\n<pre class=\"lang-java prettyprint-override\"><code>import java.text.ParseException;\nimport java.text.SimpleDateFormat;\n\npublic class WeirdDateFormat {\n    public static void main(String...args) throws ParseException {\n        var df = new SimpleDateFormat(&quot;ddMMyy&quot;);\n        df.setLenient(false);\n\n        System.out.println(df.parse(&quot;09012023000000000&quot;));\n        System.out.println(df.parse(&quot;09012022000000000&quot;));\n    }\n}\n</code></pre>\n<p>It prints:</p>\n<pre><code>Mon Jan 09 00:00:00 CET 70403584\nException in thread &quot;main&quot; java.text.ParseException: Unparseable date: &quot;09012022000000000&quot;\n    at java.base/java.text.DateFormat.parse(DateFormat.java:399)\n    at WeirdDateFormat.main(WeirdDateFormat.java:10)\n</code></pre>\n<p>In other words, the first date (9 January 2023) parses fine, but gives a date with the year 70403584.\nThe second date (9 January 2022) fails to parse and throws an exception.</p>\n<p>(If we set lenient to <code>true</code>, the second date doesn't throw but ends up in the year 239492593.)</p>\n<p>WTF is happening here? Why does it sometimes fail to parse, and sometimes not? And where do these bizarre year numbers come from?</p>\n<p>(Found the issue in production running Java 8, but the behaviour on Java 17 is the same.)</p>\n<p><strong>EDIT</strong> Yes, I know, I know, I must fix the legacy code. No need to keep telling me, you're preaching to the choir! Unfortunately, my drastically simplified version of the code doesn't show you all the other legacy defects of the code base that <em>also</em> have to be addressed. I just want to understand what's going on here so I'll be better informed when I actually do refactor this code.</p>\n"
    },
    {
      "tags": [
        "java",
        "regex",
        "regex-negation"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 7264739,
            "display_name": "Destroy666"
          },
          "edited": false,
          "comment_id": 134076988,
          "body": "Please edit the question with more details instead of just answering in comments."
        },
        {
          "owner": {
            "user_id": 5527985,
            "display_name": "bobble bubble"
          },
          "edited": false,
          "comment_id": 134077949,
          "body": "What&#39;s the goal? Another idea: <a href=\"https://regex101.com/r/zMmICB/2\" rel=\"nofollow noreferrer\"><code>^(.*\\p{L}) +\\b</code></a> (<i>first group</i> holds beginning)."
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 5459839,
            "display_name": "trincot"
          },
          "up_vote_count": 5,
          "is_accepted": false,
          "creation_date": 1681550582,
          "answer_id": 76021371,
          "body": "<p>You could use a look-ahead assertion:</p>\n<p>Assert that the candidate space is followed by at least one non-white space character and any further white space (if any) is surrounded by digits or occurs at the end of the string.</p>\n<p>For that &quot;surrounding&quot; condition you can again use look-around assertions. This regex will only match white space that is surrounded by digits or occurs at the end of the string with a preceding digit: <code>&quot;(?&lt;=\\\\d)\\\\s+(?!\\\\D)&quot;</code>. Only that type of white space and <code>\\\\s*$</code> will be allowed <strong>after</strong> the potentially matched space with this assertion:</p>\n<pre><code>&quot;(?=\\\\S+((?&lt;=\\\\d)\\\\s+(?!\\\\D)\\\\S*)*\\\\s*$)&quot;\n</code></pre>\n<p>Now we could add the requirement of the candidate space itself: that it should either have no digit before it, or no digit following it:</p>\n<pre><code>&quot;(?:\\\\s(?=\\\\D)|(?&lt;!\\\\d)\\\\s)(?=\\\\S+((?&lt;=\\\\d)\\\\s+(?!\\\\D)\\\\S*)*\\\\s*$)&quot;\n</code></pre>\n<p>Code:</p>\n<pre><code>Pattern pattern = Pattern.compile(&quot;(?:\\\\s(?=\\\\D)|(?&lt;!\\\\d)\\\\s)(?=\\\\S+((?&lt;=\\\\d)\\\\s+(?!\\\\D)\\\\S*)*\\\\s*$)&quot;);\nMatcher matcher = pattern.matcher(input);\nint lastIndex=-1;\nif (matcher.find()) { // We only expect at most one match\n    lastIndex = matcher.start();\n    // Do something with lastIndex\n}\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 7430869,
            "display_name": "Trung Duong"
          },
          "up_vote_count": 4,
          "is_accepted": false,
          "creation_date": 1681550826,
          "answer_id": 76021390,
          "body": "<p>You could try this regex pattern: <code>(\\s)(?:[-\\d\\s/]+|\\w+)$</code></p>\n<pre><code>  Pattern pattern = Pattern.compile(&quot;(\\\\s)(?:[-\\\\d\\\\s/]+|\\\\w+)$&quot;);\n  Matcher matcher = pattern.matcher(input);\n  int lastIndex = -1;\n  if (matcher.find()) {\n    lastIndex = matcher.start();\n  } \n</code></pre>\n<p>See demo here: <a href=\"https://regex101.com/r/Dw1tVm/1\" rel=\"nofollow noreferrer\">Regex</a> and <a href=\"https://onecompiler.com/java/3z5r488yf\" rel=\"nofollow noreferrer\">Java</a>.</p>\n"
        },
        {
          "owner": {
            "user_id": 5424988,
            "display_name": "The fourth bird"
          },
          "up_vote_count": 3,
          "is_accepted": false,
          "creation_date": 1681555186,
          "answer_id": 76021725,
          "body": "<p>If you only want to have the last occurrence, you can use <code>.*</code> and have the dot match a newline finding the last occurrence over all lines. Note that <code>\\s</code> also matches a newline.</p>\n<pre><code>(?s)^.*(\\s(?&lt;!\\d.)(?=\\d)|\\s(?&lt;=\\d.)(?!\\d|\\s*$)|\\s(?&lt;=[^\\d\\s].)(?=[^\\d\\s]))\n</code></pre>\n<p><a href=\"https://regex101.com/r/VwiosT/1\" rel=\"nofollow noreferrer\">Regex demo</a> | <a href=\"https://ideone.com/FeW1A8\" rel=\"nofollow noreferrer\">Java demo</a></p>\n<p>Then you can use <code>matcher.find()</code> and get the index from group 1 using <code>matcher.start(1)</code></p>\n<pre><code>String regex = &quot;(?s)^.*(\\\\s(?&lt;!\\\\d.)(?=\\\\d)|\\\\s(?&lt;=\\\\d.)(?!\\\\d|\\\\s*$)|\\\\s(?&lt;=[^\\\\d\\\\s].)(?=[^\\\\d\\\\s]))&quot;;\nString string = &quot;jumnsch@domain.com m 5180-3807-3679-8221 612 3/1/2010\\n\\n&quot;\n        + &quot;hello this card number 4444 5555 6666 7777\\n\\n&quot;\n        + &quot;hello this bob&quot;;\n\nPattern pattern = Pattern.compile(regex);\nMatcher matcher = pattern.matcher(string);\n\nif (matcher.find()) {\n    System.out.println(&quot;[&quot; + matcher.group(1) + &quot;]&quot;);\n    System.out.println(matcher.start(1));\n}\n</code></pre>\n<p>Output</p>\n<pre><code>[ ]\n109\n</code></pre>\n<p>If you have single lines, you can use <code>\\h</code> to match a horizontal whitespace character.</p>\n<pre><code>^.*(\\h(?&lt;!\\d.)(?=\\d)|\\h(?&lt;=\\d.)(?!\\d|\\h*$)|\\h(?&lt;=[^\\d\\h].)(?=[^\\d\\h]))\n</code></pre>\n<p><a href=\"https://regex101.com/r/3BRR1b/1\" rel=\"nofollow noreferrer\">Regex demo</a></p>\n"
        },
        {
          "owner": {
            "user_id": 256196,
            "display_name": "Bohemian"
          },
          "up_vote_count": 1,
          "is_accepted": true,
          "creation_date": 1681592871,
          "answer_id": 76024766,
          "body": "<p>If double spaces are not present:</p>\n<pre><code>((?&lt;=\\D) | (?=\\D))(?!$|.*((?&lt;=\\D) | (?=\\D)(?!$)))\n</code></pre>\n<p>See <a href=\"https://rubular.com/r/ukGgZpwG7B013u\" rel=\"nofollow noreferrer\">live demo</a>.</p>\n"
        }
      ],
      "owner": {
        "user_id": 20622284,
        "display_name": "lemon chow"
      },
      "view_count": 118,
      "up_vote_count": 5,
      "accepted_answer_id": 76024766,
      "answer_count": 4,
      "score": 4,
      "creation_date": 1681548522,
      "question_id": 76021231,
      "body": "<p>should not consider the white space at the end of the string or the white space in between two digits, but it can be either preceding or followed by a digit but not in between digits.\nI wrote a regex expression ,but it is not working for all conditions according to my requirement.</p>\n<pre><code>Pattern pattern =Pattern.compile(&quot;\\\\s(?![\\\\d\\\\s]*\\\\d$)&quot;);\nMatcher matcher=pattern.matcher(input);\nint lastIndex=-1;\nwhile(matcher.find()){\nlastIndex=matcher.start());\n}\n</code></pre>\n<p>how can i achieve my requirement using regex expression and any other way to get last occurrence without while loop?\nExample</p>\n<pre><code>jumnsch@domain.com m 5180-3807-3679-8221 612 3/1/2010\n                    ^\nhello this card number 4444 5555 6666 7777\n                      ^\nhello this bob\n          ^\n</code></pre>\n"
    },
    {
      "tags": [
        "java",
        "constructor-overloading"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 3824919,
            "display_name": "Tom"
          },
          "edited": false,
          "comment_id": 132638186,
          "body": "You&#39;re looking for a &quot;builder&quot;, so when you want to know more, search for &quot;builder pattern&quot;. That those answers suggest ways to keep using var args is very disappointing. That varargs constructor isn&#39;t as useful as you may think. It is actually a code smell and can be incorrectly used very easily, for example by using <code>new FooClass(1, second, third)</code>. I works fine, the compiler won&#39;t complain that you never passed &quot;first&quot;, but your constructor assumes that you did. Therefore you could end up with an incorrectly built object."
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 768644,
            "display_name": "rzwitserloot"
          },
          "up_vote_count": 3,
          "is_accepted": false,
          "creation_date": 1674066275,
          "answer_id": 75163696,
          "body": "<p>You can't. As the error says, <code>this</code> is available, but <strong>only</strong> if it is the first line (and therefore inherently you can only write one such call, total).</p>\n<p>In theory you can do it, but whether it's clean - that's up for debate:</p>\n<pre><code>this(id, myStrings[0],\n  myStrings.length &gt; 1 ? myString[1] : null,\n  myStrings.length &gt; 2 ? myString[2] : null);\n</code></pre>\n<p>There is no general solution to it - you find a way to reduce the whole thing to a single <code>this()</code> invocation, utilizing only static methods and basic expressions, or, you can't do it. In this specific case there was a way to get there with basic expressions, but that option isn't always available.</p>\n"
        },
        {
          "owner": {
            "user_id": 256196,
            "display_name": "Bohemian"
          },
          "up_vote_count": 3,
          "is_accepted": false,
          "creation_date": 1674066308,
          "answer_id": 75163705,
          "body": "<p>Obey the error message, by condensing the code into one line:</p>\n<pre><code>FooClass(final int id, final String... myStrings) {\n    this(id, myStrings[0], myStrings.length == 1 ? null : myStrings[1], myStrings.length == 2 ? null : myStrings[2]);\n}\n</code></pre>\n<hr />\n<p>The usual approach is a factory method, which works for arbitrarily complex code:</p>\n<pre><code>public static FooClass create(int id, String... myStrings) {\n    if (myStrings.length == 1) {\n        return FooClass(id, myStrings[0], null, null);\n    } else if (myStrings.length == 2) {\n        return FooClass(id, myStrings[0], myStrings[1], null);\n    } else {\n        return FooClass(id, myStrings[0], myStrings[1], myStrings[2]);\n    }\n}\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 11434552,
            "display_name": "Nexevis"
          },
          "up_vote_count": 5,
          "is_accepted": true,
          "creation_date": 1674066579,
          "answer_id": 75163752,
          "body": "<p>In Java, a call to <code>this</code> or <code>super</code> MUST be the first line of the constructor.</p>\n<pre><code>class FooClass {\n    int id;\n    String first;\n    String second;\n    String third;\n\n    FooClass(final int id, final String first) {\n        this(id, first, null);\n    }\n    \n    FooClass(final int id, final String first, final String second) {\n        this(id, first, second, null);\n    }\n    \n    FooClass(final int id, final String first, final String second, final String third) {\n        this.id = id;\n        this.first = first;\n        this.second = second;\n        this.third = third;\n    }\n    \n}\n</code></pre>\n<p>One approach to get similar functionality to varargs is to simply write multiple constructors that chain upwards with default values passed.</p>\n<p>This could get cumbersome though if the number of parameters is high, but the example is only using 3 <code>String</code> values.</p>\n<p>Here is what calling them would look like:</p>\n<pre><code>//Example calls\npublic static void main(String [] args) {\n    FooClass foo1 = new FooClass(1, &quot;foo1&quot;);\n    FooClass foo2 = new FooClass(2, &quot;foo1&quot;, &quot;foo2&quot;);\n    FooClass foo3 = new FooClass(3, &quot;foo1&quot;, &quot;foo2&quot;, &quot;foo3&quot;);\n}\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 17795888,
            "display_name": "Chaosfire"
          },
          "up_vote_count": 2,
          "is_accepted": false,
          "creation_date": 1674066834,
          "answer_id": 75163797,
          "body": "<p>You can do it by writing <code>static</code> method to take care of extracting a value from the array.</p>\n<pre><code>private static String getValue(int index, String... strings) {\n  if (strings == null || index &gt;= strings.length) {\n    return null;\n  }\n  return strings[index];\n}\n</code></pre>\n<p>Then use this method with the all args constructor like this:</p>\n<pre><code>public class FooClass {\n\n  //fields\n\n  public FooClass(final int id, final String first, final String second, final String third) {\n    //assign values\n  }\n\n  FooClass(final int id, final String... myStrings){\n    this(id, getValue(0, myStrings), getValue(1, myStrings), getValue(2, myStrings));\n  }\n\n  private static String getValue(int index, String... strings) {\n    ...\n  }\n}\n</code></pre>\n<p>It's debatable, if this is cleaner or not, i'd say it depends on the style adopted in the current project.</p>\n"
        }
      ],
      "owner": {
        "user_id": 12125351,
        "display_name": "wannaBeDev"
      },
      "view_count": 68,
      "up_vote_count": 4,
      "accepted_answer_id": 75163752,
      "answer_count": 4,
      "score": 4,
      "creation_date": 1674065772,
      "question_id": 75163582,
      "body": "<p>I have a simple class with a constructor of all available fields and i want to add an overloaded constructor with varargs to allow the creating of objects even if some fields are unknown.</p>\n<pre><code>class FooClass {\n    int id;\n    String first;\n    String second;\n    String third;\n\n    FooClass(final int id, final String first, final String second, final String third) {\n        this.id = id;\n        this.first = first;\n        this.second = second;\n        this.third = third;\n    }\n\n    FooClass(final int id, final String... myStrings){\n        if(myStrings.length == 1) {\n            this.id     = id;\n            this.first  = myStrings[0];\n        } else if (myStrings.length == 2) {\n            this.id     = id;\n            this.first  = myStrings[0];\n            this.second = myStrings[1];\n        } else {\n            this.id     = id;\n            this.first  = myStrings[0];\n            this.second = myStrings[1];\n            this.third  = myStrings[2];\n        }\n    }\n}\n</code></pre>\n<p>I wanted to refactor the second constructor to avoid repeating <code>this.id, this.first ...</code> as follows, but I am getting a compile error</p>\n<pre><code>FooClass(final int id, final String... myStrings){\n        if(myStrings.length == 1) {\n            this(id, myStrings[0], null, null);\n        } else if (myStrings.length == 2) {\n            this(id, myStrings[0], myStrings[1], null);\n        } else {\n            this(id, myStrings[0], myStrings[1], myStrings[2]);\n        }\n    }\n</code></pre>\n<p>The error is:</p>\n<blockquote>\n<p>Call to 'this()' must be first statement in constructor body</p>\n</blockquote>\n<p>What is the correct way to call the base constructor from the varargs constructor with <code>null</code> values? Or a better way to implement what I described above?</p>\n"
    },
    {
      "tags": [
        "java",
        "spring-boot",
        "spring-data-jpa"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 637853,
            "display_name": "Thomas"
          },
          "edited": false,
          "comment_id": 132470107,
          "body": "Might be because extending <code>JpaRepository</code> already makes it a repo so Spring would handle it accordingly even without the annotation."
        },
        {
          "owner": {
            "user_id": 13466689,
            "display_name": "Faheem azaz Bhanej"
          },
          "edited": false,
          "comment_id": 132470139,
          "body": "@Thomas Does it&#39;s a good way to wokring with spring like that? because previously when I was working on spring boot this warning was not came in a repository."
        },
        {
          "owner": {
            "user_id": 9879898,
            "display_name": "sge"
          },
          "edited": false,
          "comment_id": 132470265,
          "body": "according to the javadoc at org.springframework.data.repository.Repository spring will discover interfaces that extend this interface during classpath scanning."
        },
        {
          "owner": {
            "user_id": 637853,
            "display_name": "Thomas"
          },
          "edited": false,
          "comment_id": 132470318,
          "body": "I&#39;d assume it&#39;s Spring&#39;s annotation processor that&#39;s generating that warning, right? Can you share a stack trace? Additionally, I can&#39;t tell when or why that warning was added but I&#39;d assume there&#39;s a good reason for this which probably is not grave enough to warrant an error."
        },
        {
          "owner": {
            "user_id": 637853,
            "display_name": "Thomas"
          },
          "edited": false,
          "comment_id": 132470689,
          "body": "That stack trace doesn&#39;t seem to be related to your question at all. When I asked for one I was asking for the trace that shows the warning. If there is none because it&#39;s in your IDE only then what IDE are you using, how did you configure annotation processing etc.?"
        },
        {
          "owner": {
            "user_id": 13466689,
            "display_name": "Faheem azaz Bhanej"
          },
          "edited": false,
          "comment_id": 132471392,
          "body": "@Thomas I am using a <code>Sprintg Tool Suites 4</code> IDE and I know this stack trace is not related to my question"
        },
        {
          "owner": {
            "user_id": 637853,
            "display_name": "Thomas"
          },
          "edited": false,
          "comment_id": 132471536,
          "body": "If the stack trace isn&#39;t related to your question why did you post it?"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 15000097,
            "display_name": "Georgii Lvov"
          },
          "up_vote_count": 6,
          "is_accepted": true,
          "creation_date": 1673338152,
          "answer_id": 75067111,
          "body": "<p>You are extending <code>JpaRepository&lt;T, ID&gt;</code> interface, it means that spring boot must autoconfigure this repository bean for you, namely, it will be configured a proxy bean of <a href=\"https://docs.spring.io/spring-data/data-jpa/docs/current/api/org/springframework/data/jpa/repository/support/SimpleJpaRepository.html\" rel=\"noreferrer\"><code>SimpleJpaRepository&lt;T, ID&gt;</code></a>.</p>\n<p>In simple words, we do not just create a bean using <code>@Repository</code> or <code>@Component</code> annotation, we extend the <code>spring-data</code> interface and then our repository bean will be autoconfigured.</p>\n"
        },
        {
          "owner": {
            "user_id": 19400589,
            "display_name": "Dheeraj Kashyap"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1673339434,
          "answer_id": 75067306,
          "body": "<p>The Solution depends upon what type of database you intend to use. &quot;Failed to configure a DataSource: 'url' attribute is not specified and no embedded datasource could be configured.&quot; Error you're getting is because you have not set the url for the database in the application.properties. To solve this issue I would recommend you to Open the application.properties and add the following according to your system:</p>\n<pre><code>spring.datasource.url=jdbc:mysql://localhost:3306/restapi\nspring.datasource.username=root\nspring.datasource.password=\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 7237884,
            "display_name": "Panagiotis Bougioukos"
          },
          "up_vote_count": 5,
          "is_accepted": false,
          "creation_date": 1673351210,
          "answer_id": 75069517,
          "body": "<h2>When to use <code>@Repository</code></h2>\n<p>You want to provide your own implementation of how to access the data layer and what should be done. In this case marking your implementation class with <code>@Repository</code> will allow you to have this class managed by spring so that you can autowire necessary fields to access data layer like <code>EntityManager</code> , <code>JdbcTemplate</code> ...etc. Although <code>Component</code>, and <code>@Repository</code> in the most fundamental level just register spring beans there are some slight enhancements using <code>@Repository</code> which might make it neccessary to use and also best practice in the current case.</p>\n<p>As per <a href=\"https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/stereotype/Repository.html\" rel=\"noreferrer\">doc1</a></p>\n<blockquote>\n<p>A class thus annotated with <code>@Repository</code> is eligible for Spring\nDataAccessException translation when used in conjunction with a\nPersistenceExceptionTranslationPostProcessor.,</p>\n</blockquote>\n<p>and <a href=\"https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/dao/annotation/PersistenceExceptionTranslationPostProcessor.html\" rel=\"noreferrer\">doc2</a></p>\n<blockquote>\n<p>PersistenceExceptionTranslationPostProcessor</p>\n<p>Bean post-processor that\nautomatically applies persistence exception translation to any bean\nmarked with Spring's @Repository annotation, adding a corresponding\nPersistenceExceptionTranslationAdvisor to the exposed proxy</p>\n</blockquote>\n<p>Example of above case use with <code>@Repository</code>.</p>\n<pre><code>@Repository\npublic class CustomCarRepositoryImpl implements CustomCarRepository {\n\n    @PersistenceContext\n    private EntityManager entityManager;\n\n    @Override\n    public List&lt;CarEntity&gt; findCarsWithSpeed(Integer speed) {\n\n        return entityManager.createQuery(&quot;Query to execute&quot;)\n                .setMaxResults(50).getResultList();\n    }\n }\n\npublic interface CustomCarRepository { \n     List&lt;CarEntity&gt; findCarsWithSpeed(Integer speed);\n}\n</code></pre>\n<p>Then you can autowire in your other components the <code>CustomCarRepository</code> and access the data layer as you have implemented.</p>\n<h2>When Not to use <code>@Repository</code></h2>\n<p>When you just declare your interface and you extend from any Spring child interface of <code>Repository</code> from <code>org.springframework.data.repository</code>.</p>\n<p>Example</p>\n<pre><code>public interface CarRepository extends JpaRepository&lt;CarEntity, Long&gt; {\n    List&lt;CarEntity&gt; findCarsWithSpeed(Integer speed);\n}\n</code></pre>\n<p>In that case <code>Spring Boot</code> will be able to create the repository bean for you automatically from <code>auto configuration</code>.</p>\n<p>The only further action needed is if your own interfaces extending from <code>Repository</code> do not exist in the same package or subpackage of where your <code>@Configuration</code> or <code>@SpringBootApplication</code> exists then you would need</p>\n<ul>\n<li>either <code>@EnableJpaRepositories(basePackages = {&quot;base-package-where-repositories-exist&quot;})</code></li>\n<li>or <code>@AutoConfigurationPackage(basePackages = {&quot;base-package-where-repositories-exist&quot;})</code></li>\n</ul>\n<p>as to help spring boot identify the package it should look for the auto configuration of that repository. ( The later <code>@AutoConfigurationPackage</code> will affect both repositories and other things required for auto configuration like entities scan and more. So it should be used with care in a project and not just for repositories.)</p>\n"
        }
      ],
      "owner": {
        "user_id": 13466689,
        "display_name": "Faheem azaz Bhanej"
      },
      "view_count": 851,
      "up_vote_count": 4,
      "accepted_answer_id": 75067111,
      "answer_count": 3,
      "score": 4,
      "creation_date": 1673336907,
      "question_id": 75066907,
      "body": "<p>I am working on Spring Boot project. I have repository file in my project but it will show me a warning message in repository class <code>Unnecessary @Repository</code>. I am extending a <code>JpaRepository&lt;&gt;</code> with my repository. My Spring version is <strong>4</strong> and JDK version is <strong>17</strong>.</p>\n<p>Here is my dependencies</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;\n&lt;/dependency&gt;\n\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n&lt;/dependency&gt;\n\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;\n    &lt;scope&gt;runtime&lt;/scope&gt;\n    &lt;optional&gt;true&lt;/optional&gt;\n&lt;/dependency&gt;\n\n&lt;dependency&gt;\n    &lt;groupId&gt;com.mysql&lt;/groupId&gt;\n    &lt;artifactId&gt;mysql-connector-j&lt;/artifactId&gt;\n    &lt;scope&gt;runtime&lt;/scope&gt;\n&lt;/dependency&gt;\n\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n    &lt;scope&gt;test&lt;/scope&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>Here is my repository</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Repository // Here I get a warning to remove this annotation becasue its unnecessary\npublic interface CollegeRepo extends JpaRepository&lt;College, Integer&gt;{\n    \n}\n</code></pre>\n"
    },
    {
      "tags": [
        "java",
        "spring",
        "multithreading",
        "process",
        "completable-future"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 836018,
            "display_name": "Jack"
          },
          "edited": false,
          "comment_id": 132378763,
          "body": "Does anybody else have never used <code>CompletableFuture</code> in Java multi threading?"
        },
        {
          "owner": {
            "user_id": 2711488,
            "display_name": "Holger"
          },
          "edited": false,
          "comment_id": 132382025,
          "body": "When you say â€œbut Thread may have more advantagesâ€ what advantages are you assuming? And what exactly do you expect for the second point? Your code example is already complete, just change the type of <code>result1</code> to <code>Integer</code>, as otherwise, it canâ€™t be <code>null</code> at all. Then, <code>if(result1 == null) return future2.get(); else return result1;</code> There is no way to â€œstop processâ€ with <code>CompletableFuture</code>."
        },
        {
          "owner": {
            "user_id": 836018,
            "display_name": "Jack"
          },
          "edited": false,
          "comment_id": 132383117,
          "body": "I want to get the first response among two requests rather than a specific one. For example, sometimes I get <code>future1</code>, sometimes <code>future2</code> as there is no guarantee. So, I want to get the first response and check its value. Then based on this value get the second response or stop the second thread. I do not have to solve the problem only using <code>CompletableFuture</code>. If you have any suggestion with Thread or Runnable, I would be appreciated if you share by posting a sample code."
        },
        {
          "owner": {
            "user_id": 2711488,
            "display_name": "Holger"
          },
          "edited": false,
          "comment_id": 132385637,
          "body": "A <code>CompletableFuture</code> <i>is</i> using <code>Runnable</code> and <code>Thread</code> behind the scenes. I donâ€™t know what advantage you think to gain by dealing with <code>Runnable</code> and <code>Thread</code> manually. If you want to stop tasks, you need an <code>ExecutorService</code> which returns <code>Future</code> objects truly supporting cancellation. However, that still requires active support for interruption in your tasks, i.e. the operations encapsulated by <code>fetchAsync</code>."
        },
        {
          "owner": {
            "user_id": 836018,
            "display_name": "Jack"
          },
          "edited": false,
          "comment_id": 132394380,
          "body": "@Holger Thanks for explanations. Why do not you post an example as answer as the other friends?"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 637853,
            "display_name": "Thomas"
          },
          "up_vote_count": 3,
          "is_accepted": false,
          "creation_date": 1672903139,
          "answer_id": 75014986,
          "body": "<blockquote>\n<p>So, should I stick to CompletableFuture or use all of them based on the scenario?</p>\n</blockquote>\n<p>Well, they all have different purposes and you'll probably use them all either directly or indirectly:</p>\n<ul>\n<li><code>Thread</code> represents a thread and while it can be subclassed in most cases you shouldn't do so. Many frameworks maintain thread pools, i.e. they spin up several threads that then can take tasks from a task pool. This is done to reduce the overhead that thread creation brings as well as to reduce the amount of contention (many threads and few cpu cores mean a lot of context switches so you'd normally try to have fewer threads that just work on one task after another).</li>\n<li><code>Runnable</code> was one of the first interfaces to represent tasks that a thread can work on. Another is <code>Callable</code> which has 2 major differences to <code>Runnable</code>: 1) it can return a value while <code>Runnable</code> has <code>void</code> and 2) it can throw checked exceptions. Depending on your case you can use either but since you want to get a result, you'll more likely use <code>Callable</code>.</li>\n<li><code>CompletableFuture</code> and <code>Future</code> are basically a way for cross-thread communication, i.e. you can use those to check whether the task is done already (non-blocking) or to wait for completion (blocking).</li>\n</ul>\n<p>So in many cases it's like this:</p>\n<ul>\n<li>you submit a <code>Runnable</code> or <code>Callable</code> to some executor</li>\n<li>the executor maintains a pool of <code>Thread</code>s to execute the tasks you submitted</li>\n<li>the executor returns a <code>Future</code> (one implementation being <code>CompletableFuture</code>) for you to check on the status and results of the task without having to synchronize yourself.</li>\n</ul>\n<p>However, there may be other cases where you directly provide a <code>Runnable</code> to a <code>Thread</code> or even subclass <code>Thread</code> but nowadays those are far less common.</p>\n<blockquote>\n<p>How can I do this? Should I use CompletableFuture.anyOf() for that?</p>\n</blockquote>\n<p><code>CompletableFuture.anyOf()</code> wouldn't work since you'd not be able to determine which of the 2 you'd pass in was successful first.</p>\n<p>Since you're interested in <code>result1</code> first (which btw can't be <code>null</code> if the type is <code>int</code>) you basically want to do the following:</p>\n<pre><code>Integer result1 = future1.get(); //block until result 1 is ready\nif( result1 != null ) {\n  return result1;\n} else {\n  return future2.get(); //result1 was null so wait for result2 and return it\n}\n</code></pre>\n<p>You'd not want to call <code>future2.get()</code> right away since that would block until both are done but instead you're first interested in <code>future1</code> only so if that produces a result you wouldn't have for <code>future2</code> to ever finish.</p>\n<p>Note that the code above doesn't handle exceptional completions and there's also probably a more elegant way of composing the futures like you want but I don't remember it atm (if I do I'll add it as an edit).</p>\n<p>Another note: you <em>could</em> call <code>future2.cancel()</code> if <code>result1</code> isn't null but I'd suggest you first check whether cancelling would even work (e.g. you'd have a hard time really cancelling a webservice request) and what the results of interrupting the service would be. If it's ok to just let it complete and ignore the result that's probably the easier way to go.</p>\n"
        },
        {
          "owner": {
            "user_id": 139985,
            "display_name": "Stephen C"
          },
          "up_vote_count": 4,
          "is_accepted": false,
          "creation_date": 1672903309,
          "answer_id": 75015021,
          "body": "<blockquote>\n<p>So, should I stick to <code>CompletableFuture</code> or use all of them based on the scenario?</p>\n</blockquote>\n<p>Use the one that is most appropriate to the scenario.  Obviously, we can't be more specific unless you explain the scenario.</p>\n<p>There are various factors to take into account.  For example:</p>\n<ul>\n<li><code>Thread</code> + <code>Runnable</code> doesn't have a natural way to wait for / return a result.  (But it is not hard to implement.)</li>\n<li>Repeatedly creating bare <code>Thread</code> objects is inefficient because thread creation is expensive.  Thread pooling is better but you shouldn't implement a thread pool yourself.</li>\n<li>Solutions that use an <code>ExecutorService</code> take care of thread pooling and allow you to use <code>Callable</code> and return a <code>Future</code>.  But for a once-off async computation this might be over-kill.</li>\n<li>Solutions that involve <code>ComputableFuture</code> allow you to compose and combine asynchronous tasks.  But if you don't need to do that, using <code>ComputableFuture</code> may be overkill.</li>\n</ul>\n<p>As you can see ... there is no single correct answer for all scenarios.</p>\n<hr />\n<blockquote>\n<p>Should I use <code>CompletableFuture.anyOf()</code> for that?</p>\n</blockquote>\n<p>No. The logic of your example requires that you must have the result for <code>future1</code> to determine whether or not you need the result for <code>future2</code>.  So the solution is something like this:</p>\n<pre><code>Integer i1 = future1.get();\nif (i1 == null) {\n    return future2.get();\n} else {\n    future2.cancel(true);\n    return i1;\n}\n</code></pre>\n<p>Note that the above works with plain <code>Future</code> as well as CompletableFuture.  If you were using <code>CompletableFuture</code> because you thought that <code>anyOf</code> was the solution, then you didn't need to do that.  Calling <code>ExecutorService.submit(Callable)</code> will give you a <code>Future</code> ...</p>\n<p>It will be more complicated if you need to deal with exceptions thrown by the tasks and/or timeouts.  In the former case, you need to catch <code>ExecutionException</code> and the extract its <code>cause</code> exception to get the exception thrown by the task.</p>\n<p>There is also the caveat that the second computation may ignore the interrupt and continue on regardless.</p>\n"
        },
        {
          "owner": {
            "user_id": 2711488,
            "display_name": "Holger"
          },
          "up_vote_count": 4,
          "is_accepted": true,
          "creation_date": 1672997730,
          "answer_id": 75029179,
          "body": "<p><code>CompletableFuture</code> is a tool which settles atop the <code>Executor</code>/<code>ExecutorService</code> abstraction, which has implementations dealing with <code>Runnable</code> and <code>Thread</code>. You usually have no reason to deal with <code>Thread</code> creation manually. If you find <code>CompletableFuture</code> unsuitable for a particular task you may try the other tools/abstractions first.</p>\n<p>If you want to proceed with the first (in the sense of faster) nonâ€‘null result, you can use something like</p>\n<pre class=\"lang-java prettyprint-override\"><code>CompletableFuture&lt;Integer&gt; future1 = fetchAsync(1);\nCompletableFuture&lt;Integer&gt; future2 = fetchAsync(2);\n\nInteger result = CompletableFuture.anyOf(future1, future2)\n    .thenCompose(i -&gt; i != null?\n        CompletableFuture.completedFuture((Integer)i):\n        future1.thenCombine(future2, (a, b) -&gt; a != null? a: b))\n    .join();\n</code></pre>\n<p><code>anyOf</code> allows you to proceed with the first result, but regardless of its actual value. So to use the first nonâ€‘null result we need to chain another operation which will resort to <code>thenCombine</code> if the first result is <code>null</code>. This will only complete when both futures have been completed but at this point we already know that the faster result was <code>null</code> and the second is needed. The overall code will still result in <code>null</code> when both results were <code>null</code>.</p>\n<p>Note that <code>anyOf</code> accepts arbitrarily typed futures and results in a <code>CompletableFuture&lt;Object&gt;</code>. Hence, <code>i</code> is of type <code>Object</code> and a type cast needed. An alternative with full type safety would be</p>\n<pre class=\"lang-java prettyprint-override\"><code>CompletableFuture&lt;Integer&gt; future1 = fetchAsync(1);\nCompletableFuture&lt;Integer&gt; future2 = fetchAsync(2);\n\nInteger result = future1.applyToEither(future2, Function.identity())\n    .thenCompose(i -&gt; i != null?\n        CompletableFuture.completedFuture(i):\n        future1.thenCombine(future2, (a, b) -&gt; a != null? a: b))\n    .join();\n</code></pre>\n<p>which requires us to specify a function which we do not need here, so this code resorts to <code>Function.identity()</code>. You could also just use <code>i -&gt; i</code> to denote an identity function; thatâ€™s <a href=\"https://stackoverflow.com/q/28032827/2711488\" title=\"Function.identity() or t-&gt;t?\">mostly a stylistic choice</a>.</p>\n<hr />\n<p>Note that most complications stem from the design that tries to avoid blocking threads by always chaining a dependent operation to be executed when the previous stage has been completed. The examples above follow this principle as the final <code>join()</code> call is only for demonstration purposes; you can easily remove it and return the future, if the caller expects a future rather than being blocked.</p>\n<p>If you are going to perform the final blocking <code>join()</code> anyway, because you need the result value immediately, you can also use</p>\n<pre class=\"lang-java prettyprint-override\"><code>Integer result = future1.applyToEither(future2, Function.identity()).join();\nif(result == null) {\n    Integer a = future1.join(), b = future2.join();\n    result = a != null? a: b;\n}\n</code></pre>\n<p>which might be easier to read and debug. This ease of use is the motivation behind the upcoming <a href=\"https://bugs.openjdk.org/browse/JDK-8277131\" rel=\"nofollow noreferrer\">Virtual Threads</a> feature. When an action is running on a virtual thread, you donâ€™t need to avoid blocking calls. So with this feature, if you still need to return a <code>CompletableFuture</code> without blocking the your caller thread, you can use</p>\n<pre class=\"lang-java prettyprint-override\"><code>CompletableFuture&lt;Integer&gt; resultFuture = future1.applyToEitherAsync(future2, r-&gt; {\n    if(r != null) return r;\n    Integer a = future1.join(), b = future2.join();\n    return a != null? a: b;\n}, Executors.newVirtualThreadPerTaskExecutor());\n</code></pre>\n<p>By requesting a virtual thread for the dependent action, we can use blocking <code>join()</code> calls within the function without hesitation which makes the code simpler, in fact, similar to the previous non-asynchronous variant.</p>\n<hr />\n<p>In all cases, the code will provide the faster result if it is nonâ€‘null, without waiting for the completion of the second future. But it does not stop the evaluation of the unnecessary future. Stopping an already ongoing evaluation is not supported by <code>CompletableFuture</code> at all. You can call <a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html#cancel(boolean)\" rel=\"nofollow noreferrer\"><code>cancel(â€¦)</code></a> on it, but this will will only <a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html#:%7E:text=Method%20cancel,.\" rel=\"nofollow noreferrer\">set the completion state (result) of the future to â€œexceptionally completed with a <code>CancellationException</code>â€</a></p>\n<p>So whether you call <code>cancel</code> or not, the already ongoing evaluation will continue in the background and only its final result will be ignored.</p>\n<p>This might be acceptable for some operations. If not, you would have to change the implementation of <code>fetchAsync</code> significantly. You could use an <code>ExecutorService</code> directly and <a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/ExecutorService.html#submit(java.util.concurrent.Callable)\" rel=\"nofollow noreferrer\"><code>submit</code></a> an operation to get a <code>Future</code> which support cancellation with interruption.</p>\n<p>But it also requires the operationâ€™s code to be sensitive to interruption, to have an actual effect:</p>\n<ul>\n<li><p>When calling blocking operations, use those methods that may abort and throw an <code>InterruptedException</code> and do not catch-and-continue.</p>\n</li>\n<li><p>When performing a long running computational intense task, poll <a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Thread.html#interrupted()\" rel=\"nofollow noreferrer\"><code>Thread.interrupted()</code></a> occasionally and bail out when <code>true</code>.</p>\n</li>\n</ul>\n"
        }
      ],
      "owner": {
        "user_id": 836018,
        "display_name": "Jack"
      },
      "view_count": 289,
      "up_vote_count": 4,
      "accepted_answer_id": 75029179,
      "answer_count": 3,
      "score": 4,
      "creation_date": 1672901096,
      "question_id": 75014712,
      "body": "<p>I am trying to implement multi threading in my Spring Boot app. I am just beginner on multi threading in Java and after making some search and reading articles on various pages, I need to be clarified about the following points. So;</p>\n<ol>\n<li><p>As far as I see, I can use <code>Thread</code>, <code>Runnable</code> or <code>CompletableFuture</code> in order to implement multi threading in a Java app. <code>CompletableFuture</code> seems a newer and cleaner way, but <code>Thread</code> may have more advantages. So, should I stick to <code>CompletableFuture</code> or use all of them based on the scenario?</p>\n</li>\n<li><p>Basically I want to send 2 concurrent requests to the same service method by using <code>CompletableFuture</code>:</p>\n<pre><code>CompletableFuture&lt;Integer&gt; future1 = fetchAsync(1);\nCompletableFuture&lt;Integer&gt; future2 = fetchAsync(2);\n\nInteger result1 = future1.get();\nInteger result2 = future2.get();\n</code></pre>\n</li>\n</ol>\n<p>How can I send these request concurrently and then return result based on the following condition:</p>\n<ul>\n<li>if the first result is not null, return result and stop process</li>\n<li>if the first result is null, return the second result and stop process</li>\n</ul>\n<p>How can I do this? Should I use <code>CompletableFuture.anyOf()</code> for that?</p>\n"
    },
    {
      "tags": [
        "java",
        "javafx",
        "slider",
        "media"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 36223,
            "display_name": "DaveB"
          },
          "edited": false,
          "comment_id": 132872214,
          "body": "I would be tempted to make the slider transparent, and then put it in a StackPane with another Pane containing the blue shapes at the bottom.  Set the size of the shape Pane to the same dimensions as the Slider and position the blue shapes in the Pane where you want them.  Probably less fiddly than trying to get linear gradients to work."
        },
        {
          "owner": {
            "user_id": 16899534,
            "display_name": "deepl"
          },
          "edited": false,
          "comment_id": 132873240,
          "body": "@DaveB how to position the blue shapes in the Pane?"
        },
        {
          "owner": {
            "user_id": 36223,
            "display_name": "DaveB"
          },
          "edited": false,
          "comment_id": 132874425,
          "body": "I added an answer."
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 9591245,
            "display_name": "Nina Koninckx"
          },
          "up_vote_count": 3,
          "is_accepted": false,
          "creation_date": 1675174543,
          "answer_id": 75298486,
          "body": "<p>I recommend you play around with linear gradients, I think those can solve you issues:</p>\n<pre><code>-fx-background-color: linear-gradient(from 30% 30% to 23% 30%, repeat,  #e9967a 62%, #ff8c00 88%);\n</code></pre>\n<p>For more info you can look at the documentation: <a href=\"https://docs.oracle.com/javafx/2/api/javafx/scene/doc-files/cssref.html\" rel=\"nofollow noreferrer\">https://docs.oracle.com/javafx/2/api/javafx/scene/doc-files/cssref.html</a></p>\n"
        },
        {
          "owner": {
            "user_id": 36223,
            "display_name": "DaveB"
          },
          "up_vote_count": 3,
          "is_accepted": true,
          "creation_date": 1675191368,
          "answer_id": 75301897,
          "body": "<p>As per my comment on the question, here's some code that will do the trick.  It takes just a little bit of messing about with the styling of the &quot;track&quot; element of the Slider to make it transparent, and then the rest falls in place.</p>\n<p>BTW:  This is Kotlin, but you should be able to figure out how it works, if you have any questions, I can update this with some explanations:</p>\n<pre><code>class FancySlider : Application() {\n   override fun start(stage: Stage) {\n      stage.scene = Scene(createContent()).apply {\n         FancySlider::class.java.getResource(&quot;/css/default.css&quot;)?.toString()?.let { stylesheets += it }\n      }\n      stage.show()\n   }\n\n   private fun createContent(): Region {\n      val stackPane = StackPane().apply {\n         val slider = Slider().apply {\n            minWidth = 300.0\n            styleClass += &quot;fancy-slider&quot;\n         }\n         val pane = Pane().apply {\n            val heightAdjust = 8.0\n            val widthAdjust = 10.0\n            maxHeightProperty().bind(slider.heightProperty().subtract(heightAdjust))\n            minHeightProperty().bind(slider.heightProperty().subtract(heightAdjust))\n            maxWidthProperty().bind(slider.widthProperty().subtract(widthAdjust))\n            minWidthProperty().bind(slider.widthProperty().subtract(widthAdjust))\n            children += createRectangle(this.widthProperty(), 0.43, 0.08)\n            children += createRectangle(this.widthProperty(), 0.12, 0.15)\n            children += createRectangle(this.widthProperty(), 0.75, 0.03)\n         }\n         children += listOf(pane, slider)\n         minHeight = 60.0\n         padding = Insets(20.0)\n      }\n      return stackPane\n   }\n\n   fun createRectangle(sliderWidthProperty: ReadOnlyDoubleProperty, startPos: Double, duration: Double) = Rectangle(1.0, 7.0).apply {\n      layoutXProperty().bind(sliderWidthProperty.multiply(startPos))\n      widthProperty().bind(sliderWidthProperty.multiply(duration))\n      fill = Color.DARKBLUE\n      styleClass += &quot;fancy-slider-rectangle&quot;\n   }\n}\n\nfun main() {\n   Application.launch(FancySlider::class.java)\n}\n</code></pre>\n<p>And the CSS stuff looks like this:</p>\n<pre><code>.fancy-slider .track {\n    -fx-background-color: transparent;\n    -fx-border-color: derive(-fx-text-box-border, -10%);\n    -fx-background-insets: 2;\n    -fx-border-radius: 0.25em;\n    -fx-background-radius: 0.25em\n    -fx-padding: 0.25em; /* 3 */\n}\n\n.fancy-slider-rectangle {\n  -fx-arc-width: 6.0;\n  -fx-arc-height: 6.0;\n}\n</code></pre>\n<p>A couple of notes:</p>\n<ol>\n<li><p>This is only for horizontal Sliders, you'd have to rework it for a verticle Slider.</p>\n</li>\n<li><p>The width and height bindings for the Pane are set with hard-coded adjustments, and I'm not sure what would happen if you could somehow change the height of the Slider.</p>\n</li>\n<li><p>The StackPane keeps everything lined up nicely, since it centres by default, so long as you get the right height and width for the Pane is should just align nicely.</p>\n</li>\n<li><p>You could implement this as a custom Node and expose an addRectangle() method which worked nicely with the Slider's conversions of it's value.</p>\n</li>\n</ol>\n<p>Anyways, it looks like this:</p>\n<p><a href=\"https://i.stack.imgur.com/ZEduQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZEduQ.png\" alt=\"enter image description here\" /></a></p>\n"
        },
        {
          "owner": {
            "user_id": 5844477,
            "display_name": "Sai Dandem"
          },
          "up_vote_count": 3,
          "is_accepted": false,
          "creation_date": 1675212709,
          "answer_id": 75304618,
          "body": "<p>If you are not very concerned about curved highlights, below is a way you can try with. This is on the same lines what @Nina Koninckx suggested.</p>\n<p>The general idea is, we paint the track color using linear gradient color stops.</p>\n<p>Lets say the default track color is <code>white</code> and you need to highlight the sections(50%-70% and 80%-90%) with <code>blue</code>. You define all individual sections with the percentage values. Like</p>\n<ul>\n<li>white 50% (default start with 0% so no need to specify)</li>\n<li>blue 50% , blue 70% ,</li>\n<li>white 70% , white 80% ,</li>\n<li>blue 80% , blue 90% ,</li>\n<li>white 90% , white 100%</li>\n</ul>\n<p>Combining all, the linear gradient styling will be like:</p>\n<pre><code>linear-gradient(from 0% 0% to 100% 0% , white 50% , blue 50% , blue 70% , white 70% , white 80% , blue 80% , blue 90% , white 90% , white 100% )\n</code></pre>\n<p>Then we create a variable( lets say <code>-track-color</code>) for slider in CSS, and we update the variable in the java code.</p>\n<p>Below is a quick demo of the example:</p>\n<pre><code>import javafx.application.Application;\nimport javafx.geometry.Insets;\nimport javafx.geometry.Pos;\nimport javafx.scene.Scene;\nimport javafx.scene.control.Slider;\nimport javafx.scene.layout.VBox;\nimport javafx.stage.Stage;\npublic class SliderStylingDemo extends Application {\n    @Override\n    public void start(Stage primaryStage) throws Exception {\n        Slider slider = new Slider(0, 100, 30) ;\n        slider.setMajorTickUnit(10);\n        slider.setShowTickMarks(true);\n        slider.setShowTickLabels(true);\n        String style = &quot;-track-color: linear-gradient(from 0% 0% to 100% 0% , white 50% , blue 50% , blue 70% , white 70% , white 80% , blue 80% , blue 90% , white 90% , white 100% )&quot;;\n        slider.setStyle(style);\n        VBox root = new VBox(slider);\n        root.setAlignment(Pos.CENTER);\n        root.setPadding(new Insets(20));\n        root.setSpacing(20);\n        Scene scene = new Scene(root, 600, 100);\n        scene.getStylesheets().add(getClass().getResource(&quot;sliderstyle.css&quot;).toExternalForm());\n        primaryStage.setScene(scene);\n        primaryStage.setTitle(&quot;Slider Styling Demo&quot;);\n        primaryStage.show();\n    }\n}\n</code></pre>\n<p><strong>CSS Code:</strong></p>\n<pre><code>.slider {\n    -track-color: -fx-control-inner-background;\n}\n.slider .track {\n      -fx-background-color:\n          -fx-shadow-highlight-color,\n          linear-gradient(to bottom, derive(-fx-text-box-border, -10%), -fx-text-box-border),\n          -track-color;\n}\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/zTuQh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zTuQh.png\" alt=\"enter image description here\" /></a></p>\n"
        }
      ],
      "owner": {
        "user_id": 16899534,
        "display_name": "deepl"
      },
      "view_count": 147,
      "up_vote_count": 4,
      "accepted_answer_id": 75301897,
      "answer_count": 3,
      "score": 4,
      "creation_date": 1675173281,
      "question_id": 75298221,
      "body": "<p>I'm creating a video player and I want to color only a portion (with custom values) in the slider like this:</p>\n<p><a href=\"https://i.stack.imgur.com/nXPPU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nXPPU.png\" alt=\"enter image description here\" /></a></p>\n<p>how can I do?</p>\n<p>I've colored the whole bar up to now, but I can't color just different portions:</p>\n<pre><code>            StackPane trackPane = (StackPane) seekSlider.lookup(&quot;.track&quot;);\n            trackPane.setStyle(&quot;-fx-background-color: #e5e5e5&quot;);\n</code></pre>\n"
    },
    {
      "tags": [
        "java",
        "utc",
        "java-time",
        "java.time.instant",
        "offsetdatetime"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 2411243,
            "display_name": "Zabuzard"
          },
          "edited": false,
          "comment_id": 134206366,
          "body": "Your <i>date</i> is not just a date, it also has time. It is also not a <i>local</i> date/time, it has offset information. You probably intended to parse this text as <code>OffsetDateTime</code> or perhaps as <code>ZonedDateTime</code>, and then go to <code>Instant</code>."
        },
        {
          "owner": {
            "user_id": 5772882,
            "display_name": "Ole V.V."
          },
          "edited": false,
          "comment_id": 134206580,
          "body": "<code>BASIC_ISO_DATE</code> will accept <code>20191130-0600</code>. As you can see, this is not the format of your string. Also <code>LocalDate</code> hasnâ€™t got a <code>toInstant</code> method (last time I checked)."
        },
        {
          "owner": {
            "user_id": 5772882,
            "display_name": "Ole V.V."
          },
          "edited": false,
          "comment_id": 134206608,
          "body": "In newer Java versions <code>Instant.parse()</code> directly accepts your string. <code>Instant.parse(date).toString()</code> yields <code>2019-11-30T06:01:00Z</code>."
        },
        {
          "owner": {
            "user_id": 5772882,
            "display_name": "Ole V.V."
          },
          "edited": false,
          "comment_id": 134206622,
          "body": "@Zabuzard Very nice edit! Thanks. user_che_ban, may this serve as inspiration for your next Stack Overflow questions?"
        },
        {
          "owner": {
            "user_id": 5772882,
            "display_name": "Ole V.V."
          },
          "edited": false,
          "comment_id": 134206745,
          "body": "Do you know for sure that you need the <code>.000</code> fraction of second when it is zero? You are asking for <a href=\"https://en.wikipedia.org/wiki/ISO_8601\" rel=\"nofollow noreferrer\">ISO 8601</a> format, and in ISO 8601 the fraction is optional when it is zero. So the receiver of your string probably doesnâ€™t care. Asking because the classes of java.time (<code>Instant</code> and also <code>OffsetDateTime</code>) print ISO 8601 from their <code>toString</code> methods but include the fraction of second only if it is non-zero."
        },
        {
          "owner": {
            "user_id": 3211648,
            "display_name": "user_che_ban"
          },
          "edited": false,
          "comment_id": 134206773,
          "body": "in the existing application they are setting the value like that , with <code>.000</code> , I am also following the same."
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 2411243,
            "display_name": "Zabuzard"
          },
          "up_vote_count": 4,
          "is_accepted": true,
          "creation_date": 1682410181,
          "answer_id": 76098938,
          "body": "<h2>tl;dr</h2>\n<pre class=\"lang-java prettyprint-override\"><code>String text = &quot;2019-11-30T00:01:00.000-06:00&quot;;\nOffsetDateTime offsetDateTime = OffsetDateTime.parse(text);\nInstant instant = offsetDateTime.toInstant();\n\nSystem.out.println(instant); // 2019-11-30T06:01:00Z\n\nDateTimeFormatter formatter = DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd'T'HH:mm:ss.SSS'Z'&quot;)\n  .withZone(ZoneOffset.UTC);\nSystem.out.println(formatter.format(instant)); // 2019-11-30T06:01:00.000Z\n</code></pre>\n<h2>Explanation</h2>\n<p>Your <em>date</em> is not just a date, it also has time. So <code>LocalDate</code> would not work. If at all, then <code>LocalDateTime</code>.</p>\n<p>But, it is also not a <strong>local</strong> date/time, it has offset information. You need to use <code>OffsetDateTime</code> instead, and then go to <code>Instant</code> from there.</p>\n<p>To actually get the desired output for your <code>Instant</code>, you also have to create a proper <code>DateTimeFormatter</code>, since the default representation does not include the millis.</p>\n"
        },
        {
          "owner": {
            "user_id": 1712135,
            "display_name": "deHaar"
          },
          "up_vote_count": 4,
          "is_accepted": false,
          "creation_date": 1682410306,
          "answer_id": 76098957,
          "body": "<p>Slightly different approach to what Zabuzard posted due to not using an <code>Instant</code> explicitlyâ€¦</p>\n<p>You will need to</p>\n<ul>\n<li>parse the <code>String</code>,</li>\n<li>adjust the offset from <code>-06:00</code> to UTC and then</li>\n<li>get the desired <code>String</code> representation by means of a <code>DateTimeFormatter</code></li>\n</ul>\n<p>Soâ€¦ <strong>tl;dr</strong>:</p>\n<pre><code>public static void main(String[] args) {\n    // example input\n    String someDateTime = &quot;2019-11-30T00:01:00.000-06:00&quot;;\n    // parse directly\n    OffsetDateTime odt = OffsetDateTime.parse(someDateTime);\n    // define a DateTimeFormatter for the desired output\n    DateTimeFormatter dtf = DateTimeFormatter\n                                .ofPattern(&quot;uuuu-MM-dd'T'HH:mm:ss.SSSXXX&quot;);\n    // print the parsing result using the DateTimeFormatter\n    System.out.println(&quot;Origin: &quot; \n            + odt.format(dtf));\n    // adjust the offset from -06:00 to UTC\n    OffsetDateTime utcOdt = odt.withOffsetSameInstant(ZoneOffset.UTC);\n    // print the result â€”Â again using the DateTimeFormatter\n    System.out.println(&quot;UTC:    &quot; \n            + utcOdt.format(dtf));\n}\n</code></pre>\n<p>Output:</p>\n<pre class=\"lang-none prettyprint-override\"><code>Origin: 2019-11-30T00:01:00.000-06:00\nUTC:    2019-11-30T06:01:00.000Z\n</code></pre>\n"
        }
      ],
      "owner": {
        "user_id": 3211648,
        "display_name": "user_che_ban"
      },
      "view_count": 71,
      "up_vote_count": 4,
      "accepted_answer_id": 76098938,
      "answer_count": 2,
      "score": 4,
      "creation_date": 1682409257,
      "question_id": 76098815,
      "body": "<h2>Conversion</h2>\n<p>I have a timestamp with an offset (<code>-6</code>) in the following format:</p>\n<pre class=\"lang-java prettyprint-override\"><code>2019-11-30T00:01:00.000-06:00\n</code></pre>\n<p>and I want to convert it to an UTC timestamp, like:</p>\n<pre class=\"lang-java prettyprint-override\"><code>2019-11-30T06:01:00.000Z\n</code></pre>\n<h2>Attempt</h2>\n<p>I tried it the following way:</p>\n<pre><code>String text = &quot;2019-11-30T00:01:00.000-06:00&quot;;\n\nLocalDate date = LocalDate.parse(text, DateTimeFormatter.BASIC_ISO_DATE);\n\nSystem.out.println(date.toInstant());\n</code></pre>\n<p>but it is not compiling:</p>\n<blockquote>\n<p>The method <code>toInstant()</code> is undefined for the type <code>LocalDate</code></p>\n</blockquote>\n<p>How am I supposed to do this correctly?</p>\n"
    },
    {
      "tags": [
        "java",
        "regex"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 5424988,
            "display_name": "The fourth bird"
          },
          "edited": false,
          "comment_id": 133046342,
          "body": "Perhaps like this <code>^[^(]*\\(([^*]+)\\*.*</code> and replace with group 1 <a href=\"https://regex101.com/r/ZpAjbD/1\" rel=\"nofollow noreferrer\">regex101.com/r/ZpAjbD/1</a>"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 548225,
            "display_name": "anubhava"
          },
          "up_vote_count": 3,
          "is_accepted": false,
          "creation_date": 1675965943,
          "answer_id": 75402700,
          "body": "<p>You may use this regex to match:</p>\n<pre class=\"lang-bash prettyprint-override\"><code>[^(]*\\(|\\*.*\n</code></pre>\n<p>and replace with an empty string.</p>\n<p><a href=\"https://regex101.com/r/pi04fN/1\" rel=\"nofollow noreferrer\">RegEx Demo</a></p>\n<p><strong>RegEx Demo:</strong></p>\n<ul>\n<li><code>[^(]*\\(</code>: Match 0 or more characters that are not <code>(</code> followed by a <code>(</code></li>\n<li><code>|</code>: OR</li>\n<li><code>\\*.*</code>: Match <code>*</code> and everything after that</li>\n</ul>\n<p><strong>Java Code:</strong></p>\n<pre class=\"lang-bash prettyprint-override\"><code>String s = &quot;1.2.3 (1.234*xY)&quot;;\nString r = s.replaceAll(&quot;[^(]*\\\\(|\\\\*.*&quot;, &quot;&quot;);\n//=&gt; &quot;1.234&quot;\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 5424988,
            "display_name": "The fourth bird"
          },
          "up_vote_count": 3,
          "is_accepted": true,
          "creation_date": 1675966198,
          "answer_id": 75402747,
          "body": "<p>You could try matching the whole string, and replace with capture group 1</p>\n<pre><code>^[^(]*\\(([^*]+)\\*.*\n</code></pre>\n<p>The pattern matches:</p>\n<ul>\n<li><code>^</code> start of string</li>\n<li><code>[^(]*\\(</code> Match any char except <code>(</code> and then match <code>(</code></li>\n<li><code>([^*]+)</code> Capture in group 1 matching any char except <code>*</code></li>\n<li><code>\\*.*</code> Match an asterix and the rest of the line</li>\n</ul>\n<p><a href=\"https://regex101.com/r/ic8MEr/1\" rel=\"nofollow noreferrer\">Regex demo</a> | <a href=\"https://ideone.com/pjwQUV\" rel=\"nofollow noreferrer\">Java demo</a></p>\n<pre><code>String string = &quot;1.2.3 (1.234*xY)&quot;;\nSystem.out.println(string.replaceFirst(&quot;^[^(]*\\\\(([^*]+)\\\\*.*&quot;, &quot;$1&quot;));\n</code></pre>\n<p>Output</p>\n<pre><code>1.234\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 5866580,
            "display_name": "RavinderSingh13"
          },
          "up_vote_count": 2,
          "is_accepted": false,
          "creation_date": 1676081881,
          "answer_id": 75417725,
          "body": "<p>With your shown samples and attempts please try following regex:</p>\n<pre class=\"lang-bash prettyprint-override\"><code>^.*?\\(([^*]*)\\*\\S+\\)$\n</code></pre>\n<p>Here is the <a href=\"https://regex101.com/r/4C5cUB/1\" rel=\"nofollow noreferrer\">Regex Online Demo</a> and here is the <a href=\"https://ideone.com/lwWY9o\" rel=\"nofollow noreferrer\">Java code Demo</a> for used regex.</p>\n<p><em><strong>Explanation:</strong></em> Adding detailed explanation for used Regex.</p>\n<pre class=\"lang-bash prettyprint-override\"><code>^       ##Matching starting of the value here.\n.*?\\(   ##Using lazy match here to match till ( here.\n(       ##Creating one and only capturing group of this regex here.\n  [^*]* ##Matching everything till * here.\n)       ##Closing capturing group here.\n\\*      ##Matching * here.\n\\S+     ##Matching non-spaces 1 or more occurrences here.\n\\)$     ##Matching literal ) here at the end of the value.\n</code></pre>\n"
        }
      ],
      "owner": {
        "user_id": 11744376,
        "display_name": "mlg dog"
      },
      "view_count": 118,
      "up_vote_count": 4,
      "accepted_answer_id": 75402747,
      "answer_count": 3,
      "score": 4,
      "creation_date": 1675965663,
      "question_id": 75402642,
      "body": "<p>I need to replace all characters in a string which come before an open parenthesis but come after an asterisk:</p>\n<p>Input:\n<code>1.2.3 (1.234*xY)</code></p>\n<p>Needed Output:\n1.234</p>\n<p>I tried the following:</p>\n<pre><code>string.replaceAll(&quot;.*\\\\(|\\\\*.*&quot;, &quot;&quot;);\n</code></pre>\n<p>but I ran into an issue here where <code>Matcher.matches()</code> is <code>false</code> even though there are two matches... What is the most elegant way to solve this?</p>\n"
    },
    {
      "tags": [
        "java",
        "release",
        "java-platform-module-system"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 40342,
            "display_name": "Joachim Sauer"
          },
          "edited": false,
          "comment_id": 132718259,
          "body": "It really depends on your target audience, but IMO the most comfortable approach is to install/bundle a JDK (or subset of one) with your application. That&#39;s what IntelliJ IDEA/Android Studio do, for example. Licensing-wise that&#39;s less cumbersome with non-Oracle distributions, usually. <a href=\"https://stackoverflow.com/questions/58250782/which-free-version-of-java-can-i-use-for-production-environments-and-or-commerci\">This answer</a> might help with picking the appropriate one."
        },
        {
          "owner": {
            "user_id": 2498188,
            "display_name": "Emily L."
          },
          "edited": false,
          "comment_id": 132718273,
          "body": "The target audience is joe-and-jane-gamer."
        },
        {
          "owner": {
            "user_id": 2498188,
            "display_name": "Emily L."
          },
          "edited": false,
          "comment_id": 132718293,
          "body": "@JoachimSauer do you have any reference to where I could look at common ways of doing that?"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 768644,
            "display_name": "rzwitserloot"
          },
          "up_vote_count": 8,
          "is_accepted": true,
          "creation_date": 1674486786,
          "answer_id": 75211416,
          "body": "<p>Oracle's point of view:</p>\n<ul>\n<li>There is no longer a JRE (SOURCE: Try to find a JRE that oracle offers you above version 8 - it doesn't exist).</li>\n<li>Instead, you write your app <em>with</em> modules, and use the <a href=\"https://openjdk.org/jeps/282\" rel=\"nofollow noreferrer\"><em>jlink</em></a> tool to make a 'tree shaken' JVM, this is a <a href=\"https://en.wikipedia.org/wiki/Java_virtual_machine\" rel=\"nofollow noreferrer\">JVM</a> with all the stuff that the modules you are using as basis don't even need. You produce one JVM for each and every platform you are interested in exporting as stand-alone installer thing.</li>\n<li>You then write an installer that installs the tree-shaken JVM, <em>and</em> your app, somewhere. The tree shaken JVM is <strong>not</strong> registered as 'system JVM', in fact that notion that there is a JVM installed on a PC and you can find it using e.g. registry keys or by looking in known places such as <code>C:\\Program Files\\JavaSoft</code> is obsolete. You don't do that, that JVM is only for that app, that app knows where to find it and nothing else on the system does. Each and every java-based app has its own copy of its own (tree shaken or not) JVM that only it uses.</li>\n<li>You, as the 'vendor', are on the hook for maintenance. If the JVM you shipped has a gaping security hole in it and that gets abused, it's your fault for not updating it, not oracle's. Oracle does not run <code>jusched.exe</code> or any other tooling to ensure it is kept up to date.</li>\n</ul>\n<p>An easy alternative to this is that you simply move the responsibility of having a java runtime that can run your app to the shoulders of your user. Tell THEM to go download a <a href=\"https://en.m.wikipedia.org/wiki/Java_Development_Kit\" rel=\"nofollow noreferrer\">JDK</a> (because a JDK can run java apps just as well, actually better, than a JRE can), tell THEM to ensure it's on the <code>$PATH</code> or in a known location / tells you where to find it / set <code>JAVA_HOME</code>, and <em>they</em> are responsible for keeping it up to date.</p>\n<p>Other vendors' point of view:</p>\n<ul>\n<li>Various other vendors do make a JRE for more modern versions. I have no idea if these JREs ship with <code>jusched.exe</code> or other update mechanisms, and how (or even <em>if</em>) these JREs register their existence in a way that your app / your installer can figure out where they are. You'd have to investigate.</li>\n</ul>\n<p>There is no need to actually treeshake a JVM, you can also just ship a full blown JDK with your app. For example, if your installer ends up doing this:</p>\n<ul>\n<li>Sets 'program install root' ('root') to <code>C:\\Program Files\\EmilysAwesomeGame</code></li>\n<li>Unpacks JDK17 for windows x64 into <code>ROOT\\jdk</code>.</li>\n<li>Unpacks all your dependency jars into <code>ROOT\\lib</code>.</li>\n<li>Unpacks your main app into <code>ROOT\\emilygame.jar</code></li>\n<li>Makes a <code>.BAT</code> file that runs <code>%~dp0\\jdk\\home\\bin\\java -jar %~dp0\\emilygame.jar</code> and that jar has a MANIFEST with a <code>Class-Path</code> entry containing e.g. <code>lib\\javafx.jar lib\\someotherdep.jar</code>, then.. that'll work fine, and replacing that bat file with an exe that does the same thing also works fine (and 'ship your own JVM in a subdir' is a model that tools like launch4j and similar have supported for a long time already).</li>\n</ul>\n<p>The downside of not treeshaking is that the JDK is pretty large, and includes all sorts of stuff you wouldn't be using. But, it's just a matter of saving on disk space, a non-treeshaken JDK isn't going to run any slower, those unused parts would simply end up never being loaded.</p>\n<p>A very common 'deployment model' is that you offer an msi with an exe for windows-x86 and tell everybody else to go install a JDK on their own responsibility and ship plain jars for everybody else (linux users, mac users, windows-aarch64, etc).</p>\n"
        },
        {
          "owner": {
            "user_id": 4262407,
            "display_name": "mipa"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1674488441,
          "answer_id": 75211751,
          "body": "<p>This question gets asked over and over again. Therefore there is an extensive diskussion of this topic here on SO. See: <a href=\"https://stackoverflow.com/tags/javafx/info\">https://stackoverflow.com/tags/javafx/info</a> The most relevant part for you is the section about &quot;Packaging&quot;.</p>\n"
        }
      ],
      "owner": {
        "user_id": 2498188,
        "display_name": "Emily L."
      },
      "view_count": 183,
      "up_vote_count": 4,
      "accepted_answer_id": 75211416,
      "answer_count": 2,
      "score": 4,
      "creation_date": 1674485668,
      "question_id": 75211213,
      "body": "<p>I have a publicly available Java 8 desktop application complete with MSI installer that I'd like to update to Java 17.</p>\n<p>The current user experience goes like this:</p>\n<ol>\n<li>User downloads MSI installer and runs it</li>\n<li>MSI installer checks for compatible Java 8 VM, if not present prompts the user to install one from <a href=\"http://java.com\" rel=\"nofollow noreferrer\">http://java.com</a>.</li>\n<li>User launches <code>application.exe</code> which is a shim that basically runs <code>java jar application.jar</code>.</li>\n</ol>\n<p>What I'm struggling to understand is what the user is expected to install in a Java 9+ world. If I send the user to for example: <a href=\"https://www.oracle.com/java/technologies/downloads/\" rel=\"nofollow noreferrer\">https://www.oracle.com/java/technologies/downloads/</a> they are greeted with downloading the Java Development Kit which is a confusing thing to install for a user (&quot;Is this right? I don't want to develop stuff??&quot;).</p>\n<p>In addition when you land on <a href=\"http://java.com\" rel=\"nofollow noreferrer\">http://java.com</a> it says &quot;if you were asked to download java, it's most likely this&quot;, which implies that if you release applications you should either use Java 8 (and forget the JavaFX disaster that is OpenJDK pre version 11, and just use Orcale Java)...</p>\n<p>I was under the impression that after Java 9, the promise of Jigsaw was to build a package that contains a native runtime and jar, all neatly bundled together so that the days of the end user having to install a JVM were over. However searching online, I see no support for this is Gradle or IntelliJ (or Eclipse for the matter) so this seems kind of like a dead pipedream?</p>\n<p>If I want to ship a Java 17 application, is the user expected to install the JDK? If not, how am I supposed to package and ship my application?</p>\n"
    },
    {
      "tags": [
        "java",
        "java-bytecode-asm",
        "jvm-bytecode"
      ],
      "answers": [
        {
          "owner": {
            "user_id": 2711488,
            "display_name": "Holger"
          },
          "up_vote_count": 8,
          "is_accepted": true,
          "creation_date": 1673866212,
          "answer_id": 75133172,
          "body": "<p>This is a sign that you have unreachable code in your generated bytecode. With stackmaps, every instruction not reachable by its preceding instruction must have a stack frame, even if not being the target of a branch. This is necessary to verify the code in a single linear pass.</p>\n<p>But for unreachable code, there is no known initial state and it would be very challenging to invent a valid initial state for an arbitrary sequence of instructions. ASMâ€™s solution is to replace the entire unreachable code with nop instructions, followed by a single <code>athrow</code> statement. For this sequence, itâ€™s possible to specify a valid initial stack frame; itâ€™s a frame having a single throwable on the stack. This sequence also has no impact on the subsequent, potentially reachable code.</p>\n<p>Since the code is unreachable, this replacement has no impact on the execution, as you already noticed in your test. And youâ€™re right, the JIT compiler wonâ€™t generate any native code for it.</p>\n<p>But to git rid of this disconcerting code, youâ€™d have to revise your compiler code, to find out at which part it generates unreachable code.</p>\n"
        }
      ],
      "owner": {
        "user_id": 45843,
        "display_name": "rwallace"
      },
      "view_count": 51,
      "up_vote_count": 5,
      "accepted_answer_id": 75133172,
      "answer_count": 1,
      "score": 4,
      "creation_date": 1673863542,
      "question_id": 75132671,
      "body": "<p>I'm writing a compiler that outputs JVM byte code, and using ASM 9.4 for the backend. This works fine, but I am puzzled about one particular quirk.</p>\n<p>I'm specifying <code>COMPUTE_FRAMES</code> to automatically compute the stack frames. It is said that the tradeoff is that this (understandably) makes code generation take more time, but it seems to be fast enough.</p>\n<p>What is <em>not</em> documented anywhere that I have been able to find, is that specifying <code>COMPUTE_FRAMES</code> causes a lot of redundant instructions to be generated. Specifically, an <code>athrow</code> at the end of each method, and in some cases, a bunch of long runs of <code>nop</code>s scattered through the method.</p>\n<p>This does not seem to be doing any harm; my initial test cases are passing okay, and I suppose the JIT compiler won't actually generate any machine code for the redundant instructions. But it is a little disconcerting. Why is it doing this? Am I doing anything wrong?</p>\n"
    },
    {
      "tags": [
        "java",
        "jvm",
        "javac"
      ],
      "answers": [
        {
          "owner": {
            "user_id": 3448419,
            "display_name": "apangin"
          },
          "up_vote_count": 7,
          "is_accepted": true,
          "creation_date": 1672695243,
          "answer_id": 74987239,
          "body": "<p>Because JVMS <a href=\"https://docs.oracle.com/javase/specs/jvms/se19/html/jvms-5.html#jvms-5.4.4\" rel=\"noreferrer\">doesn't allow access</a> to private members of a different class, whether it is an inner class or not. JDK 11 added the concept of <a href=\"https://openjdk.org/jeps/181\" rel=\"noreferrer\">nestmates</a> to overcome this limitation.</p>\n"
        },
        {
          "owner": {
            "user_id": 1898563,
            "display_name": "Michael"
          },
          "up_vote_count": 2,
          "is_accepted": false,
          "creation_date": 1672695429,
          "answer_id": 74987262,
          "body": "<p>The reason is that the outer and inner classes compile to different class files, which means they can't access each others' private members.</p>\n<p>The synthetic method is generated to effectively widen the access from private to package-private, but it achieves that via unnecessary indirection.</p>\n<p>In Java 11, they introduced a new concept for this purpose which does allow classes in different files to access each others' private members in certain cases (i.e. this one).</p>\n<p>See the JEP: <a href=\"https://openjdk.org/jeps/181\" rel=\"nofollow noreferrer\">https://openjdk.org/jeps/181</a></p>\n"
        },
        {
          "owner": {
            "user_id": 768644,
            "display_name": "rzwitserloot"
          },
          "up_vote_count": 3,
          "is_accepted": false,
          "creation_date": 1672695527,
          "answer_id": 74987270,
          "body": "<p>It's a simple conclusion based on a number of factors:</p>\n<ol>\n<li><p>At the JVM (class file / <code>java.exe</code>) level, <strong>inner classes simply do not exist. At all.</strong> Javac 'fakes' it, by naming your <code>Inner</code> class <code>Sample1$Inner</code> (that dollar isn't a rendering, that's its actual JVM-level name, a $ is just a symbol, just as valid as <code>I</code> or <code>n</code>), adding a parameter of type <code>Sample1</code> as first param to all constructors of Inner, replacing <code>new Sample1()</code> with <code>new Sample1(this)</code>, replacing <code>instanceOfOuter.new Sample1()</code> with <code>new Sample1(instanceOfOuter)</code>, having a <code>final</code> field of type <code>Sample1</code> (which those constructors set by using that first param), translating all calls to outer methods as being invoked on that field (given that there's no &quot;outer this&quot; at the JVM level, as there is no outer class), and so on. You can see all this using <code>javap -c</code>.</p>\n</li>\n<li><p><code>private</code> members <strong>cannot</strong> be accessed by any type other than itself, therefore, given that an inner class ceases to be that once compilation has concluded (because the JVM doesn't have the inner class concept in the first place), it needs a package-private (or protected or public, as you want) way to get at it.</p>\n</li>\n<li><p>The JVM <em>also</em> has no idea what synthetic means. It's a flag, yes, and the JVM completely ignores. It doesn't know what it implies, it doesn't affect how code is to be run or interpreted <em>at all</em>. It's <code>javac</code> that knows what synthetic means. Namely: flag anything you made up to glue together the carefully managed fakery to make inner classes seem like a thing when they are purely a java-the-language (i.e. compiler) feature and don't exist at the java-the-runtime level - and when reading class files, be blind to them. Act like these synthetic methods do not exist. As in, if javac is asked to compile code that attempts to call a synthetic method, act the same way as if compiling code that attempts to call a non-existant method.</p>\n</li>\n</ol>\n<p>As a comment has already noted, more recent versions of java <em>do</em> introduce this notion of inner classes at the JVM level, but not quite by enshrining the idea of 'inner class' in the JVM Specification, but by having the 'nestmates' concept, which lets class files list other class names that get to 'see' and call/interact with private elements. Modern javacs, if targeting modern JVMs ('modern' defined here as: &quot;Has the nestmates feature available&quot;), will use nestmates and forego all the synthetics.</p>\n"
        }
      ],
      "owner": {
        "user_id": 1059372,
        "display_name": "Eugene"
      },
      "view_count": 135,
      "up_vote_count": 4,
      "accepted_answer_id": 74987239,
      "answer_count": 3,
      "score": 4,
      "creation_date": 1672694583,
      "question_id": 74987182,
      "body": "<p>Having a class like this:</p>\n<pre><code>public class Sample1 {\n\n    public class Inner {\n        private int f;\n    }\n\n    void go() {\n        Inner in = new Inner();\n        int value = in.f;\n    }\n\n}\n</code></pre>\n<p>The byte-code for the <code>go</code> method (before java-11) calls that known synthetic method:</p>\n<pre><code>static int access$000(nestmates.Sample1$Inner);\n    descriptor: (Lnestmates/Sample1$Inner;)I\n    flags: ACC_STATIC, ACC_SYNTHETIC\n    Code:\n      stack=1, locals=1, args_size=1\n         0: aload_0\n         1: getfield      #1                  // Field f:I\n         4: ireturn\n</code></pre>\n<p>from:</p>\n<pre><code>0: new  #2  // class nestmates/Sample1$Inner\n3: dup\n4: aload_0\n5: invokespecial #3 // Method nestmates/Sample1$Inner.&quot;&lt;init&gt;&quot;:(Lnestmates/Sample1;)V\n8: astore_1\n9: aload_1\n10: invokestatic #4 // Method nestmates/Sample1$Inner.access$000:(Lnestmates/Sample1$Inner;)I\n</code></pre>\n<p>I've known about this for quite some time, but I've never questioned myself <em>why</em> this is like this? Why javac has to do this in the first place, and why not directly <code>getField</code> and this indirection via the static method. Thank you.</p>\n"
    },
    {
      "tags": [
        "java",
        "simpledateformat"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 2726925,
            "display_name": "Bruno Marotta"
          },
          "edited": false,
          "comment_id": 132493390,
          "body": "If they are strings you can just get the biggest one: <code>Collections.max(dates)</code>"
        },
        {
          "owner": {
            "user_id": 507738,
            "display_name": "MC Emperor"
          },
          "edited": false,
          "comment_id": 132493399,
          "body": "Please don&#39;t use <code>SimpleDateFormat</code>."
        },
        {
          "owner": {
            "user_id": 466862,
            "display_name": "Mark Rotteveel"
          },
          "edited": false,
          "comment_id": 132493411,
          "body": "<code>System.out.println(Collections.max(temp))</code> will use the <code>toString()</code> of <code>java.util.Date</code>, which doesn&#39;t use your desired format."
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 1863229,
            "display_name": "Tim Biegeleisen"
          },
          "up_vote_count": 3,
          "is_accepted": false,
          "creation_date": 1673425151,
          "answer_id": 75080059,
          "body": "<p>Assuming you want to display the max date in the same original format as the list, you need not convert to a bona fide date, assuming the date strings are always in the format <code>yyyyMM</code>.  In this case, the strings will sort properly as dates, and we can simply use <code>Collections#max</code> directly:</p>\n<pre class=\"lang-java prettyprint-override\"><code>List&lt;String&gt; dates=Arrays.asList(&quot;202210&quot;,&quot;202211&quot;,&quot;202212&quot;,&quot;202301&quot;); \nSystem.out.println(Collections.max(dates));  // 202301\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 841221,
            "display_name": "Aakash"
          },
          "up_vote_count": 2,
          "is_accepted": true,
          "creation_date": 1673425183,
          "answer_id": 75080062,
          "body": "<p>Since the array is of String type, you can simply find largest string in chronological order and use that. Your current logic to find the max will still work or you can use some <code>Collection</code> to do that for you.</p>\n<p>It will give you correct result since your format is <code>yyyyMM</code> which means a later year will always be larger than string value of a smaller year.</p>\n<p>E.g. &quot;202210&quot; will always be less than &quot;202211&quot; or &quot;202301&quot;</p>\n<p>Treating them as String will also save you computational time to parse them into <code>Date</code> object.</p>\n"
        },
        {
          "owner": {
            "user_id": 9907751,
            "display_name": "Firok"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1673425505,
          "answer_id": 75080110,
          "body": "<p>Just replace the last line <code>System.out.println(Collections.max(temp));</code> to <code>System.out.println(sdf.format(Collections.max(temp)));</code></p>\n"
        },
        {
          "owner": {
            "user_id": 1712135,
            "display_name": "deHaar"
          },
          "up_vote_count": 2,
          "is_accepted": false,
          "creation_date": 1673425654,
          "answer_id": 75080143,
          "body": "<p>You can â€” of course â€” sort the <code>String</code>s and get the last value, but if you want to use something comparable that represents a month in a year, use a <code>java.time.YearMonth</code>, e.g.</p>\n<pre><code>public static void main(String[] args) {\n    // example values\n    String[] monthsWithYears = { &quot;202210&quot;,&quot;202211&quot;,&quot;202212&quot;,&quot;202301&quot; };\n    // formatter capable of the String format\n    DateTimeFormatter dtf = DateTimeFormatter.ofPattern(&quot;uuuuMM&quot;);\n    // map to list of YearMonth and find the maximum\n    YearMonth maxYearMonth = Arrays.stream(monthsWithYears)\n                                   .map(s -&gt; YearMonth.parse(s, dtf))\n                                   .max(YearMonth::compareTo)\n                                   .get();\n    // print it(s toString() method implicitly)\n    System.out.println(&quot;Max year month is &quot; + maxYearMonth);\n}\n</code></pre>\n<p>Output:</p>\n<pre class=\"lang-none prettyprint-override\"><code>Max year month is 2023-01\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 4032222,
            "display_name": "henrik"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1673426438,
          "answer_id": 75080283,
          "body": "<p>An alternative solution using only a simple for-loop to determine the largest value with string comparison:</p>\n<pre class=\"lang-java prettyprint-override\"><code>List&lt;String&gt; dates=Arrays.asList(&quot;202210&quot;,&quot;202211&quot;,&quot;202212&quot;,&quot;202301&quot;);\nString max = &quot;000000&quot;;\nfor (int i = 0; i &lt; dates.size(); i++) {\n    if (dates.get(i).compareTo(max) &gt; 0) {\n        max = dates.get(i);\n    }\n}\n\nSystem.out.println(&quot;Max date is: &quot; + max); //Max date is: 202301\n</code></pre>\n"
        }
      ],
      "owner": {
        "display_name": "user20980801"
      },
      "view_count": 162,
      "up_vote_count": 4,
      "accepted_answer_id": 75080062,
      "answer_count": 5,
      "score": 4,
      "creation_date": 1673424938,
      "question_id": 75080021,
      "body": "<p>I want to find out the largest date from an array of dates in <code>yyyyMM</code> format. For example, suppose my arraylist of dates are:</p>\n<pre><code>[&quot;202210&quot;, &quot;202211&quot;, &quot;202212&quot;, &quot;202301&quot;]\n</code></pre>\n<p>then the correct value should be <code>202301</code></p>\n<p>I tried using the <code>SimpleDateFormat</code> class and then parse the dates and then find the max date, like this:</p>\n<pre><code>List&lt;String&gt; dates = Arrays.asList(&quot;202210&quot;, &quot;202211&quot; ,&quot;202212&quot;, &quot;202301&quot;);  \nSimpleDateFormat sdf = new SimpleDateFormat(&quot;yyyyMM&quot;, Locale.getDefault());\nList&lt;Date&gt; temp = new ArrayList&lt;&gt;();\ntry {\n    for (String date: dates) {\n        temp.add(sdf.parse(date));\n    }\n} catch (ParseException e) {\n    e.printStackTrace();\n}\nSystem.out.println(Collections.max(temp)); //shows Sun Jan 01 00:00:00 GMT 2023\n</code></pre>\n<p>How do I convert the <code>Sun Jan 01 00:00:00 GMT 2023</code> to <code>202301</code>?</p>\n"
    },
    {
      "tags": [
        "java",
        "java-time",
        "java.util.date"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 121859,
            "display_name": "Nap"
          },
          "edited": false,
          "comment_id": 132793975,
          "body": "@Sweeper yes, correct. I fixed the spacing to make the comment more clearer"
        },
        {
          "owner": {
            "user_id": 5772882,
            "display_name": "Ole V.V."
          },
          "edited": false,
          "comment_id": 132813830,
          "body": "Have you got a very good reason for needing an old-fashioned <code>java.util.Date</code>, like for a legacy API that you cannot upgrade? Otherwise you should simply avoid that old class. And <code>TimeZone</code> and <code>SimpleDateFormat</code>. java.time, the modern date and time API to which <code>LocalDateTime</code> belongs, gives you all the functionality you wish for."
        },
        {
          "owner": {
            "user_id": 121859,
            "display_name": "Nap"
          },
          "edited": false,
          "comment_id": 132836615,
          "body": "@OleV.V. It is for a bridge type approach for migrating from java.util to the new java.time, not all codes can be modified at once so as an intermediate solution."
        },
        {
          "owner": {
            "user_id": 5772882,
            "display_name": "Ole V.V."
          },
          "edited": false,
          "comment_id": 132839420,
          "body": "Then I know exactly what you are talking about. Thanks for context."
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 5133585,
            "display_name": "Sweeper"
          },
          "up_vote_count": 6,
          "is_accepted": true,
          "creation_date": 1674799876,
          "answer_id": 75254625,
          "body": "<p>Similar to <a href=\"https://stackoverflow.com/q/72347528/5133585\">this question</a>, the old API disagrees with <code>ZoneId.systemDefault()</code> about what offsets those locations should be at on the date 1800-01-01.</p>\n<p>You can see this in action:</p>\n<pre><code>System.out.println(ZoneId.of(&quot;Asia/Tokyo&quot;).getRules().getOffset(LocalDateTime.parse(&quot;1800-01-01T00:00:00&quot;)));\nvar format = new SimpleDateFormat(&quot;yyyy-MM-dd'T'HH:mm:ss&quot;);\nSystem.out.println(TimeZone.getTimeZone(&quot;Asia/Tokyo&quot;).getOffset(format.parse(&quot;1800-01-01T00:00:00&quot;).getTime()));\n</code></pre>\n<p>Output:</p>\n<pre><code>+09:18:59\n32400000\n</code></pre>\n<p>As said in the linked post, +09:18:59 is the <a href=\"https://www.timeanddate.com/time/local-mean-time.html\" rel=\"nofollow noreferrer\">Local Mean Time</a> in Japan, and 32400000ms is exactly 9 hours. This is because <a href=\"https://bugs.openjdk.org/browse/JDK-6281408?jql=text%20%7E%20%22local%20mean%20time%22\" rel=\"nofollow noreferrer\">the old APIs don't support Local Mean Time</a>. Note that <a href=\"https://en.wikipedia.org/wiki/Japan_Standard_Time#History\" rel=\"nofollow noreferrer\">Japan standardised their timezones in 1888</a>, which explains why the outputs from the two APIs are consistent for 1900-01-01.</p>\n<p>So <code>ZoneId</code> thinks the offset of Asia/Tokyo is 18 minutes and 59 seconds more than what <code>TimeZone</code> (which is used by <code>SimpleSateFormat</code> and <code>Date.toString</code> and so on) thinks it is.</p>\n<p>This is exactly why there is a &quot;shift&quot; in the output. <code>ldt.atZone(...)</code> generates</p>\n<pre><code>1800-01-01T00:00:00+09:18:59\n</code></pre>\n<p>and <code>toInstant</code> turns this into an instant.</p>\n<p>Assuming you are using <code>Date.toString</code> or some other old API that uses <code>TimeZone</code> to generate the string, the old API would think this instant is at +09:00:00 instead! What is the above date at +09:00:00? Well, just subtract the 18 minutes and 59 seconds (just like how you would subtract 9 hours to convert a UTC+9 date to UTC+0)!</p>\n<p>And that's how you get:</p>\n<pre><code>1799-12-31 23:41:01\n</code></pre>\n<hr>\n<p>As for solutions, there really is nothing wrong with the &quot;shifted&quot; <code>Date</code> that you got. If you just convert it back to a <code>ZonedDateTime</code> and format it with <code>DateTimeFormatter</code> for display, everything should work as normal. In fact, if you can, consider not converting to <code>Date</code> at all, and use <code>Instant</code>s instead.</p>\n<p>If you cannot do that, I would suggest that you should not mix the two APIs.</p>\n"
        }
      ],
      "owner": {
        "user_id": 121859,
        "display_name": "Nap"
      },
      "view_count": 162,
      "up_vote_count": 4,
      "accepted_answer_id": 75254625,
      "answer_count": 1,
      "score": 4,
      "creation_date": 1674796810,
      "question_id": 75254341,
      "body": "<p>I am having trouble with converting old dates from java.time.LocalDateTime to java.util.Date</p>\n<p>I tried a lot of variation and it still has the same shifted dates. I would assume that it is some weird calendar performed but it is failing.</p>\n<p>Date to parse <code>1800-01-01 00:00:00</code></p>\n<p>I used a very simple convert function.</p>\n<p><code>Date.from(ldt.atZone(ZoneId.systemDefault()).toInstant());</code></p>\n<div class=\"s-table-container\">\n<table class=\"s-table\">\n<thead>\n<tr>\n<th>TimeZone</th>\n<th>a.Converted via SimpleDateFormat</th>\n<th>b.Converted via DateFormatter to LocalDateTime to java.util.Date</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Asia/Tokyo</td>\n<td>1800-01-01 00:00:00 JST</td>\n<td>1799-12-31 23:41:01 JST</td>\n</tr>\n<tr>\n<td>Europe/Brussels</td>\n<td>1800-01-01 00:00:00 CET</td>\n<td>1800-01-01 00:04:30 CET</td>\n</tr>\n<tr>\n<td>Australia/Sydney</td>\n<td>1800-01-01 00:00:00 AEST</td>\n<td>1799-12-31 23:55:08 AEST</td>\n</tr>\n<tr>\n<td>UTC</td>\n<td>1800-01-01 00:00:00 UTC</td>\n<td>1800-01-01 00:00:00 UTC</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>a. Convert String to java.util.Date via SimpleDateFormat</p>\n<p>b. Convert String to java.time.LocalDatetime via DateFormatter, then convert it to java.util.Date</p>\n<p>Now I see it only works for the UTC timezone, I cannot just change the software timezone as it will mess with the others. Anyone know any other way to convert a java.time.LocalDateTime to java.util.Date for an old day?</p>\n<p><code>TimeZone.setDefault(TimeZone.getTimeZone(&quot;UTC&quot;));</code></p>\n<p>===== following is added after sweeper's answer to illustrate it is not for all ====</p>\n<p>The curious thing is it only happens to really old dates, it does not happen to 1900-01-01 00:00:00 but have not check yet at which point the trouble started. I was thinking that maybe because of and adjustment / change at some point in 18XX year.</p>\n<pre><code>System.out.println(ZoneId.of(&quot;Asia/Tokyo&quot;).getRules().getOffset(LocalDateTime.parse(&quot;1800-01-01T00:00:00&quot;)));\nSimpleDateFormat format1 = new SimpleDateFormat(&quot;yyyy-MM-dd'T'HH:mm:ss&quot;);\nSystem.out.println(TimeZone.getTimeZone(&quot;Asia/Tokyo&quot;).getOffset(format1.parse(&quot;1800-01-01T00:00:00&quot;).getTime()));\n        \nSystem.out.println(ZoneId.of(&quot;Asia/Tokyo&quot;).getRules().getOffset(LocalDateTime.parse(&quot;1900-01-01T00:00:00&quot;)));\nSimpleDateFormat format2 = new SimpleDateFormat(&quot;yyyy-MM-dd'T'HH:mm:ss&quot;);\nSystem.out.println(TimeZone.getTimeZone(&quot;Asia/Tokyo&quot;).getOffset(format2.parse(&quot;1900-01-01T00:00:00&quot;).getTime()));\n</code></pre>\n<p>Results to</p>\n<pre><code>+09:18:59\n32400000\n+09:00\n32400000\n</code></pre>\n"
    },
    {
      "tags": [
        "java",
        "jol"
      ],
      "answers": [
        {
          "owner": {
            "user_id": 9991282,
            "display_name": "SvenJu"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1682693131,
          "answer_id": 76130740,
          "body": "<p>Gradle 7.4.1 with java 17/19 via intellij-plugin no problem with record-sizes.\n<a href=\"https://i.stack.imgur.com/Euevc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Euevc.png\" alt=\"intellij-plugin with size\" /></a></p>\n<p>openjdk 19.0.2: Unsafe.java\n<a href=\"https://i.stack.imgur.com/TULGf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TULGf.png\" alt=\"Unsafe.java with UOE for Record\" /></a></p>\n"
        },
        {
          "owner": {
            "user_id": 1570415,
            "display_name": "Donald Raab"
          },
          "up_vote_count": 4,
          "is_accepted": true,
          "creation_date": 1682695047,
          "answer_id": 76130970,
          "body": "<p>The answer is <strong>Yes</strong>, Java Object Layout does work with Java Records and requires the option <code>-Djol.magicFieldOffset=true</code> to be passed on the command line. According to Aleksey, this option was added specifically to work with records.</p>\n<p>I was running the code from IntelliJ and was setting the option in program arguments text box instead of vmoptions text box (which I had to add first). Adding the option to vmoptions in Run/Debug Configurations fixed the issue.</p>\n"
        }
      ],
      "owner": {
        "user_id": 1570415,
        "display_name": "Donald Raab"
      },
      "view_count": 115,
      "up_vote_count": 4,
      "accepted_answer_id": 76130970,
      "answer_count": 2,
      "score": 4,
      "creation_date": 1682689849,
      "question_id": 76130264,
      "body": "<p>I'm attempting to use Java Object Layout (<a href=\"https://github.com/openjdk/jol\" rel=\"nofollow noreferrer\">JOL</a>) to measure the instance size of an object that holds onto instances of some Java Records. I am getting an <code>UnsupportedOperationException</code> with a description &quot;can't get field offset on a record class&quot; when using <code>GraphLayout.parseInstance</code>. I get the same error when using <code>ClassLayout.parseClass</code>.</p>\n<p>I was initially using Java 20, but have downgraded to Java 17. I tried the last two versions of JOL (0.17 and 0.16). I tried the recommendation from the stack trace &quot;Cannot get the field offset, try with -Djol.magicFieldOffset=true&quot;. It looks like Records are not supported in <code>HotspotUnsafe.fieldOffset</code> and specifically at line 647 in Unsafe.</p>\n<p>Here's an example of a class that passes and similar record that throws the exception.</p>\n<pre><code>public class Outer {\n    public static void main(String[] args) {\n        // Passes - outputs 72\n        System.out.println(GraphLayout.parseInstance(new A(1, &quot;one&quot;)).totalSize());\n\n        // Fails with UnsupportedOperationException\n        // &quot;can't get field offset on a record class: private final int Outer$B.value&quot;\n        // sun.misc.Unsafe.objectFieldOffset - line 648\n        System.out.println(GraphLayout.parseInstance(new B(1, &quot;one&quot;)).totalSize());\n    }\n\n    public static class A {\n        int value;\n        String name;\n\n        public A(int value, String name) {\n            this.value = value;\n            this.name = name;\n        }\n    }\n\n    public static record B(int value, String name) {\n    }\n}\n</code></pre>\n<p>I did some searching to find examples of using JOL with Java Records but did not find anything. Is this possible with JOL currently, using some configuration settings I may have missed?</p>\n"
    },
    {
      "tags": [
        "java",
        "spring",
        "jpa",
        "reflection",
        "mybatis"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 11002,
            "display_name": "tgdavies"
          },
          "edited": false,
          "comment_id": 133010289,
          "body": "That&#39;s not how fields on an entity class should work -- you should have a gender field with a getter and setter, and then a getDescription method, with no setter for description."
        },
        {
          "owner": {
            "user_id": 21122257,
            "display_name": "ForFree"
          },
          "edited": false,
          "comment_id": 133010351,
          "body": "@tgdavies No, describe can be completely replaced by gender, I will modify it right away, you will understand what I mean"
        },
        {
          "owner": {
            "user_id": 11002,
            "display_name": "tgdavies"
          },
          "edited": false,
          "comment_id": 133010456,
          "body": "What gets stored into the gender column in the DB? What happens when a <code>Human</code> object is created from a row of DB data. And what happens when <code>setAge</code> is called with a different value?"
        },
        {
          "owner": {
            "user_id": 11002,
            "display_name": "tgdavies"
          },
          "edited": false,
          "comment_id": 133010489,
          "body": "And I don&#39;t think your table is in 3NF."
        },
        {
          "owner": {
            "user_id": 21122257,
            "display_name": "ForFree"
          },
          "edited": false,
          "comment_id": 133010492,
          "body": "@tgdavies I understand what you mean. This entity class Human cannot be stored in the database, and the original data will be destroyed, but I don&#39;t need it to be stored. It has no writing method.  Or, you can think that it is not read from the database, its initialization data only comes from xml, yml, configuration center"
        },
        {
          "owner": {
            "user_id": 21122257,
            "display_name": "ForFree"
          },
          "edited": false,
          "comment_id": 133010506,
          "body": "@tgdavies Thanks for your answer, yes this is not 3NF compliant, I&#39;m just giving an example of fetching data, what I want to know is how to control the order of setter calls"
        },
        {
          "owner": {
            "user_id": 11002,
            "display_name": "tgdavies"
          },
          "edited": false,
          "comment_id": 133010599,
          "body": "If your instances are being created by Spring, then use constructor injection and don&#39;t have any setters at all."
        },
        {
          "owner": {
            "user_id": 845414,
            "display_name": "Johannes Kuhn"
          },
          "edited": false,
          "comment_id": 133016405,
          "body": "If you have a calculated property (such as <code>description</code> here), you either calculate the value in its getter, or if you cache it (as you do it here) then you need to recalculate it if any property it depends on changes. This means that <code>setAge</code> is missing a bunch of code."
        },
        {
          "owner": {
            "user_id": 2711488,
            "display_name": "Holger"
          },
          "edited": false,
          "comment_id": 133061846,
          "body": "This new class is pointless. Why does it calculate a string in the <code>setGender</code> method that is not used anywhere?"
        },
        {
          "owner": {
            "user_id": 995052,
            "display_name": "Kris"
          },
          "edited": false,
          "comment_id": 133097458,
          "body": "Setters and Getters are primarily aimed at controlling the read / modification of a single field. Its RESPONSIBILITY also is scoped for that."
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 14359869,
            "display_name": "antonio_s87"
          },
          "up_vote_count": 2,
          "is_accepted": false,
          "creation_date": 1676276569,
          "answer_id": 75433410,
          "body": "<p>If you have a table in the database containing age and gender you could use something like this:</p>\n<pre><code>@Entity\npublic class Human {\n    @Id\n    private String id;\n    private Integer age;\n    private String gender;\n    @Transient\n    private String describe;\n\n    public void setId(String id){\n        this.id = id;\n    }\n\n    public void setAge(Integer age){\n        this.age = age;\n    }\n\n    public void setGender(String gender){\n        this.gender = gender;\n    }\n\n    @PostLoad\n    public void initDescribe(){\n        if (this.age &lt; 30) {\n            this.describe = &quot;young &quot; + this.gender;\n        } else if ( this.age &lt;= 55 &amp;&amp; this.age &gt;= 30) {\n            this.describe = &quot;middle-aged &quot; + this.gender;\n        } else {\n            this.describe = &quot;old &quot; + this.gender;\n        }\n    }\n}\n</code></pre>\n<p>Since the describe field is not in the database table it can be annotated with @Transient and the @PostLoad annotation will ensure that the initDescribe() method is called after age and gender fields are set.</p>\n"
        },
        {
          "owner": {
            "user_id": 3553434,
            "display_name": "æ—¶é—´åªä¼šä¸€ç›´èµ°"
          },
          "up_vote_count": 3,
          "is_accepted": true,
          "creation_date": 1676444175,
          "answer_id": 75456402,
          "body": "<p>Test with:</p>\n<ul>\n<li>spring-core-5.2.12.RELEASE.jar</li>\n<li>spring-beans-5.2.12.RELEASE.jar</li>\n<li>java version &quot;1.8.0_121&quot;</li>\n</ul>\n<p>Looking forward to a better solution.</p>\n<p>Here is my code for testing and debugging:</p>\n<pre><code>import org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.context.ApplicationContext;\nimport org.springframework.context.annotation.AnnotationConfigApplicationContext;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.stereotype.Component;\n\npublic class RepositoryBean {\n    public static void main(String[] args) {\n        ApplicationContext AcContext = new AnnotationConfigApplicationContext(User.class, Configs.class);\n        System.out.println(AcContext.getBean(&quot;user&quot;, User.class));\n    }\n}\n\n@Configuration\nclass Configs {\n    @Bean\n    public String name() { return &quot;the name&quot;; }\n    @Bean\n    public int age() { return 100; }\n}\n\n@Component\nclass User {\n    private int age;\n    private String name;\n\n    public User() { }\n\n    @Autowired\n    public void setName(String name) { this.name = name; }\n\n    public User(String name, int age) {\n        this.name = name;\n        this.age = age;\n    }\n\n    public int getAge() { return age; }\n    public String getName() { return name; }\n\n    @Autowired\n    public void setAge(int age) {\n        this.age = age;\n//        text =  Objects.requireNonNull(this.name) + age;\n    }\n\n\n    @Override\n    public String toString() {\n        return &quot;User{&quot; +\n                &quot;name='&quot; + name + '\\'' +\n                &quot;, age=&quot; + age +\n                '}';\n    }\n}\n</code></pre>\n<hr />\n<p>I am full of curiosity about this question. I have tried to find the answer from the source code these days (only for spring, other middleware, I have no energy to do it)</p>\n<p>First of all, the conclusion is that when spring initializes beans, it cannot control the order in which the setter methods are called(According to the results of my investigation of the source code, there may be omissions. If there is an error in my conclusion, I hope everyone can help point out).</p>\n<p>Now, please take a look at the documentation of <a href=\"https://docs.oracle.com/javase/8/docs/api/java/lang/Class.html#getDeclaredMethods--\" rel=\"nofollow noreferrer\">Class#getDeclaredMethods</a>:</p>\n<blockquote>\n<p>The elements in the returned array are not sorted and are not in any particular order.</p>\n</blockquote>\n<p>Through reflection, when using getDeclaredMethods to get the Method array, there is no &quot;order&quot;. No &quot;order&quot; means that it is not sorted according to any rules, but the returned order seems to be regular every time it is called, i use the following code to test:</p>\n<pre><code>class User {\n    private int age;\n    private String name;\n    public void setName(String name) { this.name = name; }\n    public int getAge() { return age; }\n    public void setAge(int age) { this.age = age; }\n    public String getName() { return name; }\n}\npublic static void main(String[] args) {\n    Class&lt;User&gt; c = User.class;\n    Method[] m = c.getDeclaredMethods();\n    Arrays.stream(m).forEach(System.out::println);\n}\n</code></pre>\n<p>No matter how many times I run it(run about 20 times in a row, and run once in a while later), no matter what the setter method and attribute order in the User class are, the final output result, setAge is before setName:</p>\n<pre><code>public int com.anno.User.getAge()\npublic void com.anno.User.setAge(int)\npublic java.lang.String com.anno.User.getName()\npublic void com.anno.User.setName(java.lang.String)\n</code></pre>\n<p>or:</p>\n<pre><code>public void com.anno.User.setAge(int)\npublic int com.anno.User.getAge()\npublic java.lang.String com.anno.User.getName()\npublic void com.anno.User.setName(java.lang.String)\n</code></pre>\n<p>Therefore, in spring, when obtaining the method list through reflection, it is impossible to specify the order, and track the entire operation chain, and finally to the execution of the setter method, the method list still maintains the order in which it was obtained.</p>\n<p>During the entire initialization process, the processing of sorting the data in the method data is not seen.</p>\n<p>The method <code>org.springframework.util.ReflectionUtils#getDeclaredMethods(Class&lt;?&gt;, boolean)</code> use <code>Class#getDeclaredMethods</code> to gets the array of all methods in User:</p>\n<pre><code>private static Method[] getDeclaredMethods(Class&lt;?&gt; clazz, boolean defensive) {\n    Assert.notNull(clazz, &quot;Class must not be null&quot;);\n    Method[] result = declaredMethodsCache.get(clazz);\n    if (result == null) {\n        try {\n            Method[] declaredMethods = clazz.getDeclaredMethods();\n            List&lt;Method&gt; defaultMethods = findConcreteMethodsOnInterfaces(clazz);\n            if (defaultMethods != null) {\n                result = new Method[declaredMethods.length + defaultMethods.size()];\n                System.arraycopy(declaredMethods, 0, result, 0, declaredMethods.length);\n                int index = declaredMethods.length;\n                for (Method defaultMethod : defaultMethods) {\n                    result[index] = defaultMethod;\n                    index++;\n                }\n            }\n            else {\n                result = declaredMethods;\n            }\n            declaredMethodsCache.put(clazz, (result.length == 0 ? EMPTY_METHOD_ARRAY : result));\n        }\n        catch (Throwable ex) {\n            throw new IllegalStateException(&quot;Failed to introspect Class [&quot; + clazz.getName() +\n                    &quot;] from ClassLoader [&quot; + clazz.getClassLoader() + &quot;]&quot;, ex);\n        }\n    }\n    return (result.length == 0 || !defensive) ? result : result.clone();\n}\n</code></pre>\n<p>Other related methods are as follows, please check by yourself:</p>\n<ul>\n<li><code>org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor#postProcessProperties</code></li>\n<li><code>org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor#findAutowiringMetadata</code></li>\n<li><code>org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor#buildAutowiringMetadata</code></li>\n<li><code>org.springframework.util.ReflectionUtils#doWithLocalMethods</code></li>\n</ul>\n<p>The final conclusion is that no matter how the setter methods and attributes are arranged in the User entity, setAge will be called first when the bean is initialized.</p>\n<p><strong>In other words, the final setter method will only be called in the order of the methods in the method array returned by Class#getDeclaredMethods()</strong></p>\n<p>I'm not sure if other libraries provide the ability to specify the order in which the setter methods are called during reflection, so I can only assume that the order in which the setter methods are called cannot be guaranteed.</p>\n<h2>some advices</h2>\n<p>I think I understand your question, you seem to want to encapsulate the changing part into the setter method, so that even in your application, there are many places referencing this entity (say there are 100 places referencing it), you can just pass\nModify the setter method once to make the function effective for all referenced places.</p>\n<p>I think there is really no way to control its calling order. Apart from spring, we can't figure out all the implementations of other libraries.</p>\n<p>But we can do conversion during the development process, you can look at the concepts of PO (persistant object)\n, BO(business object), DTO(data transfer object), VO(value object).</p>\n<p>You can use PO, get the data from the xmlã€ymlã€configuration center or other data sources:</p>\n<pre><code>class HumanPO {\n    private Integer age;\n    private String gender;\n\n    public Integer getAge() { return age; }\n    public void setAge(Integer age) { this.age = age; }\n    public String getGender() { return gender; }\n    public void setGender(String gender) { this.gender = gender; }\n}\n</code></pre>\n<p>Then, convert it to a business object 'BO' where you can encapsulate logic:</p>\n<pre><code>class HumanBO {\n    private Integer age;\n    private String gender;\n    private String describe;\n\n\n    public static HumanBO PoConvertToBo(HumanPO humanPo) {\n        HumanBO rt = new HumanBO();\n        rt.setAge(humanPo.getAge());\n        rt.setGender(humanPo.getGender());\n        rt.setDescribe(humanPo.getGender());\n        return rt;\n    }\n\n    public Integer getAge() { return age; }\n    public void setAge(Integer age) { this.age = age; }\n    public String getGender() { return gender; }\n    public void setGender(String gender) { this.gender = gender; }\n    public String getDescribe() { return describe; }\n    public void setDescribe(String gender) {\n        String describe = &quot;&quot;;\n        if (this.age &lt; 30) {\n            describe = &quot;young &quot; + gender;\n        } else if ( this.age &lt;= 55 &amp;&amp; this.age &gt;= 30) {\n            describe = &quot;middle-aged &quot; + gender;\n        } else {\n            describe = &quot;old &quot; + gender;\n        }\n        this.describe = describe;\n    }\n}\n</code></pre>\n<p>Now, you can implement your changing needs by modifying HumanBO.</p>\n"
        }
      ],
      "owner": {
        "user_id": 21122257,
        "display_name": "ForFree"
      },
      "view_count": 327,
      "up_vote_count": 4,
      "accepted_answer_id": 75456402,
      "answer_count": 2,
      "score": 4,
      "creation_date": 1675824840,
      "question_id": 75380973,
      "body": "<p>I have encountered a rather difficult problem, Suppose there is an entity class, the code is as follows:</p>\n<pre><code>class Human {\n    private Integer age; // age of the human\n    private String describe; // description of the human based on their age\n\n    /**\n     * Setter method for the age of the human\n     *\n     * @param age the age of the human\n     */\n    public void setAge(Integer age) {\n        this.age = age;\n    }\n\n    /**\n     * Setter method for the description of the human\n     * The description is determined based on their age\n     *\n     * @param gender the gender of the human\n     */\n    public void setDescribe(String gender) {\n        String describe = &quot;&quot;;\n        if (this.age &lt; 30) {\n            describe = &quot;young &quot; + gender;\n        } else if ( this.age &lt;= 55 &amp;&amp; this.age &gt;= 30) {\n            describe = &quot;middle-aged &quot; + gender;\n        } else {\n            describe = &quot;old &quot; + gender;\n        }\n        this.describe = describe;\n    }\n}\n</code></pre>\n<p>As shown in the code (just an example, the attribute or class may be arbitrary), if I use spring and use spring to generate beans, I must ensure that method <code>setAge</code> is called first. How can I ensure this?</p>\n<p>If there is a table in the database that stores age and gender, how can I ensure that setAge is called first when I use jpa, mybatis or other libraries to reflect entities?</p>\n<p>I tried to search, but I didn't find the answer. The following are the keywords I searched and some related answers, but it doesn't seem to solve my doubtsï¼š</p>\n<p><em><strong>Spring init bean, how to ensure that a setter method is executed first</strong></em></p>\n<p><em><strong>Spring reflection entity class, how to ensure that a setter method is executed first</strong></em></p>\n<p><em><strong>spring call setter after other setter</strong></em></p>\n<p><em><strong>When jpa reflects entity classes  setter methods call order</strong></em></p>\n<p><a href=\"https://stackoverflow.com/questions/5139301/spring-setter-method-order\">Spring setter method order</a></p>\n<p><a href=\"https://stackoverflow.com/questions/15261760/spring-why-initialization-is-called-after-setter-method\">Spring - why initialization is called after setter method</a></p>\n<hr />\n<p>For tgdavies commentï¼Œif the demand of the product is to expand the gender description function and add the age descriptionï¼Œthe class like thisï¼š</p>\n<pre><code>class Human {\n    private Integer age;\n    private String gender;\n\n    public void setAge(Integer age) {\n        this.age = age;\n    }\n\n    public void setGender(String gender) {\n        String describe = &quot;&quot;;\n        if (this.age &lt; 30) {\n            describe = &quot;young &quot; + gender;\n        } else if ( this.age &lt;= 55 &amp;&amp; this.age &gt;= 30) {\n            describe = &quot;middle-aged&quot; + gender;\n        } else {\n            describe = &quot;old&quot; + gender;\n        }\n        this.gender = describe;\n    }\n}\n</code></pre>\n"
    },
    {
      "tags": [
        "java",
        "multithreading",
        "algorithm",
        "performance",
        "math"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 984823,
            "display_name": "Joop Eggen"
          },
          "edited": false,
          "comment_id": 132930032,
          "body": "N, m, n might be int and gcd maybe benefits (at start) from an iterative Implementation. One may use variables for msquared, nsquared."
        },
        {
          "owner": {
            "user_id": 1921273,
            "display_name": "MrSmith42"
          },
          "edited": false,
          "comment_id": 132930072,
          "body": "1st I would check if the approach is fast enough if gcd(..) would be O(1). So are simply the loops and counting also too slow? -&gt; If yes you might need some math to eleminate candidates upfront to check less pairs,."
        },
        {
          "owner": {
            "user_id": 1921273,
            "display_name": "MrSmith42"
          },
          "edited": false,
          "comment_id": 132930087,
          "body": "A boot would be a <b>not</b> recursive gcd(..)-method."
        },
        {
          "owner": {
            "user_id": 8041003,
            "display_name": "John Williams"
          },
          "edited": false,
          "comment_id": 132933016,
          "body": "Clearly gcd() is where the opportunities to optimise lie. I tried Stein&#39;s <a href=\"https://www.geeksforgeeks.org/steins-algorithm-for-finding-gcd/\" rel=\"nofollow noreferrer\">geeksforgeeks.org/steins-algorithm-for-finding-gcd</a> and the built in Java BigInteger.gcd(). Both made it worse!"
        },
        {
          "owner": {
            "user_id": 8041003,
            "display_name": "John Williams"
          },
          "edited": false,
          "comment_id": 132933057,
          "body": "I also tried to prepopulate a gcd array via dynamic programming but run out of memory at  10^9"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 5483526,
            "display_name": "Matt Timmermans"
          },
          "up_vote_count": 2,
          "is_accepted": false,
          "creation_date": 1675433501,
          "answer_id": 75336894,
          "body": "<p>You can avoid the GCD calculation altogether:</p>\n<ol>\n<li>Make a list of all primes &lt; sqrt(N)</li>\n<li>Iterate through all subsets of those primes with total product &lt; sqrt(N)</li>\n<li>For each subset, the primes in the set will be &quot;m primes&quot;, while the other primes will be &quot;n primes&quot;</li>\n<li>Let &quot;m_base&quot; be the product of all m primes</li>\n<li>For m, iterate through all combinations of at m primes with product &lt; sqrt(N)/m_base, yielding m = m_base * that combination and:</li>\n<li>Calculate the maximum value of n for each m</li>\n<li>For n, iterate through all combinations of n primes with product &lt; max</li>\n</ol>\n"
        },
        {
          "owner": {
            "user_id": 585411,
            "display_name": "btilly"
          },
          "up_vote_count": 3,
          "is_accepted": false,
          "creation_date": 1675491332,
          "answer_id": 75343331,
          "body": "<p>TD;LR: There is an approach that is slightly worse than <code>O(N^(2/3))</code>.  It consists of enumerating primitive triples with an efficient algorithm up to <code>N^(2/3)</code> and counting the resulting Pythagorean triples, and then using inclusion-exclusion to count Pythagorean primitive triples past that and finding a count of the rest.  The rest of this is a detailed explanation of how this all works.</p>\n<hr />\n<p>Your direct calculation over primitive triples cannot be made better than <code>O(N)</code>.  The reason why is that <a href=\"https://primes.utm.edu/notes/relprime.html\" rel=\"nofollow noreferrer\">over 60% of pairs of integers are relatively prime</a>.  So we can put a lower bound on the number of pairs of relative primes as follows.</p>\n<ol>\n<li>There are <code>floor(sqrt(n/2)) choose 2 = O(N)</code> pairs of integers at most <code>sqrt(n/2)</code>.  The ones that are relatively prime with one even give rise to a primitive Pythagorean triple.</li>\n<li>60% of them are relatively prime.</li>\n<li>This 60% is contained in the 75% that do not have both numbers even.  Therefore when we get rid of pairs with both numbers odd, at least 60% - 25% = 35% of pairs are relatively prime with one of them even.</li>\n<li>Therefore there are at least <code>O(n)</code> distinct Pythagorean triples to find whose hypotenuse is less than <code>n</code>.</li>\n</ol>\n<hr />\n<p>Given that there are <code>O(N)</code> primitive triples, you'll have to do at least <code>O(N)</code> work to enumerate them.  So you don't want to enumerate them all.  Instead we'll enumerate up to some point, and then we'll do something else with the rest.  But let's make the enumeration more efficient.</p>\n<p>Now as you noticed, your GCD checks are taking most of your time.  Can we enumerate all of them with hypotenuse less than, say, <code>L</code> more efficiently?</p>\n<p>Here is the most efficient approach that I found.</p>\n<ol>\n<li>Enumerate the primes up to <code>sqrt(L)</code> with any decent technique.  This is <code>O(sqrt(L) log(L)</code> with the Sieve of Eratosthenes, that is good enough.</li>\n<li>Using this list, we can produce the set of odd numbers up to <code>sqrt(L)</code>, complete with their prime factorizations, fairly efficiently.  (Just recursively produce prime factorizations that fit in the range.)</li>\n<li>Given an odd number and its prime factorizations, we can run through the even numbers and quickly find which are relatively prime.  That gives us the primitive Pythagorean triples.</li>\n</ol>\n<p>For step 3, create a <a href=\"https://docs.oracle.com/javase/7/docs/api/java/util/PriorityQueue.html\" rel=\"nofollow noreferrer\">PriorityQueue</a> whose elements start off pairs <code>(2*p, 2*p)</code> for each distinct prime factor <code>p</code>.  For example for <code>15</code> we'd have a queue with <code>(6, 6)</code> and <code>(10, 10)</code>.  We then do this:</p>\n<pre><code>i = the odd number we started with\nj = 2\nwhile i*i + j*j &lt; L:\n    if queue.peek()[0] == i:\n        while queue.peek()[0] == i:\n            (x, y) = queue.pop()\n            queue.add((x+y, y))\n    else:\n        i*i + j*j is the hypotenuse of a primitive Pythagorean triple\n</code></pre>\n<p>This is very slightly superlinear.  In fact the expected complexity of finding all the numbers out to <code>n</code> that are relatively prime to <code>i</code> is <code>O(n * log(log(log(i))))</code>.  Why?  Because the average number of distinct prime factors is on average <code>O(log(log(i)))</code>.  The queue operations are <code>O(log(THAT))</code> and we do on average <code>O(n)</code> queue operations.  (I'm waving my hands past some number theory, but the result is correct.)</p>\n<hr />\n<p>OK, what is our alternative to actually enumerating many of the primitive triples?</p>\n<p>The answer is to use inclusion-exclusion to count the number below some bound, <code>L</code>  Which I will demonstrate by counting the number of primitive triples whose hypotenuse is at most 100.</p>\n<p>The first step is to implement a function <code>EvenOddPairCount(L)</code> that counts how many pairs of even/odd numbers there are whose squares sum up to at most <code>L</code> .  To do this we traverse the fringe of maximal even/odds.  This takes <code>O(sqrt(L))</code> to traverse.  Here is that calculation for 100:</p>\n<pre><code>1*1 + 8*8, 4 pairs\n3*3 + 8*8, 4 pairs\n5*5 + 8*5, 4 pairs\n7*7 + 6*6, 3 pairs\n9*9 + 2*2, 1 pair\n</code></pre>\n<p>Which gives 16 pairs.</p>\n<p>Now the problem is that we have counted things like <code>3*3 + 6*6 = 45</code> that are not relatively prime.  But we can subtract off <code>EvenOddPairCount(L/9)</code> to find those that are both divisible by 3.  We can likewise subtract off <code>EvenOddPairCount(L/25)</code> to find the ones that are divisible by 5.  But now the ones divisible by 15 have been added once, and subtracted twice.  So we have to add back in <code>EvenOddPairCount(L/(15*15))</code> to again not count those.</p>\n<p>Keep going and you get a sum is over all distinct products <code>x</code> of odd primes of <code>EvenOddPairCount(L/(x*x))</code> where we add if we had an even number of prime factors (including 0), and subtract if we had an odd number.  Since we already have the odd primes, we can easily produce the sequence of inclusion-exclusion terms.  It starts off 1, -9, -25, -49, -121, -169, +225, -289, -361, +441 and so on.</p>\n<p>But how much work does this take?  If <code>l = sqrt(L)</code> it takes <code>l + l/3 + l/5 + l/7 + l/11 + l/13 + l/15 + ... + 1/l &lt; l*(1 + 1/2 + 1/3 + 1/4 + ... + 1/l) = O(l log(l)) = O(sqrt(L) log(L))</code>.</p>\n<p>And so we can calculate <code>PrimitiveTriples(L)</code> in time <code>O(sqrt(L) log(L))</code>.</p>\n<hr />\n<p>What does this buy us?  Well, <code>PrimitiveTriples(N) - PrimitiveTriples(N/2)</code> gives us the number of primitive Pythagorean triples whose hypotenuse is in the range from <code>N/2</code> to <code>N</code>.  And <code>2*(PrimitiveTriples(N/2) - PrimitiveTriples(N/3))</code> gives us the number of Pythagorean triples which are multiples of primitive ones in the range from <code>N/3</code> to <code>N/2</code>.  And <code>3*(PrimitiveTriples(N/3) - PrimitiveTriples(N/4)</code> gives us the number of Pythagorean triples in the range from <code>N/4</code> to <code>N/3</code>.</p>\n<p>Therefore we can enumerate small primitive Pythagorean triples, and figure out how many Pythagorean triples are a multiple of those.  And we can use inclusion-exclusion to count the multiples of large Pythagorean triples.  Where is the cutoff between the two strategies?</p>\n<p>Let's ignore the various <code>log</code> factors for the moment.  If we cut off at <code>N^c</code> then we do roughly <code>O(N^c)</code> work on the small.  And we need to calculate <code>N^(1-c)</code> thresholds of <code>PrimitiveTriples</code>, the last of which takes work roughly <code>O(N^(c/2))</code>.  So let's try setting <code>N^c = N^(1-c) * N^(c/2)</code>.  That works out when <code>c = (1-c) + c/2</code> which happens when <code>c = 2/3</code>.</p>\n<hr />\n<p>And this is the final algorithm.</p>\n<ol>\n<li>Find all primes up to <code>sqrt(N)</code>.</li>\n<li>Use those primes to enumerate all primitive triples up to <code>O(n^(2/3))</code> and figure out how many Pythagorean triples they give.</li>\n<li>Find all of the inclusion exclusion terms up to <code>N</code> (there are <code>O(sqrt(N))</code> of them and can be produced directly from the factorization).</li>\n<li>Calculate <code>PythagoreanTriples(N/d)</code> for all <code>d</code> up to <code>N^(1/3)</code>.  Use that to count the rest of the triples.</li>\n</ol>\n<p>And all of this runs in time <code>o(N^(2/3 + epsilon))</code> for any <code>epsilon</code> greater than 0.</p>\n"
        }
      ],
      "owner": {
        "user_id": 11428287,
        "display_name": "MC From Scratch"
      },
      "view_count": 155,
      "up_vote_count": 5,
      "answer_count": 2,
      "score": 4,
      "creation_date": 1675420538,
      "question_id": 75334472,
      "body": "<p>I want to count all pythagorean triples (primitive and non-primitive) whose hypotenuse is <code>&lt;=</code> N for a given <code>N</code>. <a href=\"http://oeis.org/A101930\" rel=\"nofollow noreferrer\">This OEIS link</a> gives this count for powers of <code>10</code>. A simple but somewhat efficient pseudocode can be easily derived from this link or from <a href=\"https://en.wikipedia.org/wiki/Pythagorean_triple\" rel=\"nofollow noreferrer\">wikipedia</a>, using the famous <strong>Euclid's</strong> formula. Interpreted in Java, this can be made into:</p>\n<pre><code>public class countPTS {\n    \n    public static void main(String[] args) \n    {\n        long N = 1000000L;\n        \n        long count = 0;\n        for (long m = 2 ; m * m + 1 &lt;= N ; m++)\n            for (long n = 1 + m % 2 ; n &lt; m &amp;&amp; n * n + m * m &lt;= N ; n += 2)\n                if (gcd(m , n) == 1)\n                    count += N / (n * n + m * m);\n        \n        System.out.println(count);\n    }\n    \n    public static long gcd(long a, long b)\n    { \n        if (a == 0) \n            return b; \n        return gcd(b % a, a); \n    } \n\n}\n</code></pre>\n<p>Which gives the correct results, but is a bit &quot;slow&quot;. Regardless of the actual time complexity of this algorithm in big <code>O</code> notation, it seems to grow like a little bit worse than <code>O(n)</code>. It can be easily checked that almost the entire time is spent in <code>gcd</code> calculations.</p>\n<p>If <code>C(N)</code> is the count of such triples, then this piece of code written and ran on the latest version of Eclipse IDE, using a modern PC and single threaded, yields <code>C(10^10) = 34465432859</code> in about <code>90</code> seconds. This makes me wonder how the high values in the OEIS link were obtained, the largest being <code>C(10^17)</code>.</p>\n<p>I suspect that an algorithm with a better time complexity was used, perhaps <code>O(n^2/3)</code> or <code>O(n^3/4)</code>, maybe with some more advanced mathematical insight. It is somewhat plausible that the above algorithm was ran but with significant improvements and perhaps multithreaded. Can anyone shed light on this topic and higher values?</p>\n"
    },
    {
      "tags": [
        "java",
        "maven",
        "lombok",
        "mapstruct"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 14442758,
            "display_name": "Z-100"
          },
          "edited": false,
          "comment_id": 134329990,
          "body": "Have you tried using <code>RDAccount</code>? is rDAccount simply a typo of yours?"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 2587166,
            "display_name": "Luca Basso Ricci"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1683193481,
          "answer_id": 76171761,
          "body": "<p>Usually accessor for properties is generated using first character property name uppercase so <code>rDAccount</code> is interpreted from <code>MapStruct</code> (and from Lombok too, I Suppose) as <code>RDAccount</code>.<br/>\nJust rename <code>rDAccount</code> as <code>RDAccount</code> and all should be fine.</p>\n"
        },
        {
          "owner": {
            "user_id": 17044833,
            "display_name": "Jaison "
          },
          "up_vote_count": 2,
          "is_accepted": false,
          "creation_date": 1683193842,
          "answer_id": 76171838,
          "body": "<p>In the mapper calls instead of <code>@Mapping(source = &quot;rDAccount&quot;, target = &quot;xfaceRDAccount&quot;)</code> try using <code>@Mapping(source = &quot;RDAccount&quot;, target = &quot;xfaceRDAccount&quot;)</code></p>\n<p>The getters and setters generated by lombok for rDAccount seems to getRDAccount and setRDAccount.</p>\n<p><a href=\"https://i.stack.imgur.com/jIsqK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jIsqK.png\" alt=\"Generated getter and setter\" /></a></p>\n"
        },
        {
          "owner": {
            "user_id": 7237884,
            "display_name": "Panagiotis Bougioukos"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1683283536,
          "answer_id": 76181358,
          "body": "<p>I believe the correct approach to use the <code>mapping</code> would be the following</p>\n<pre><code>@Mapping(source = &quot;sourceClass.rDAccount&quot;, target = &quot;xfaceRDAccount&quot;)\nTargetClass mapToTarget(SourceClass sourceClass);\n</code></pre>\n"
        }
      ],
      "owner": {
        "user_id": 20406551,
        "display_name": "Ankur Upadhayay"
      },
      "view_count": 76,
      "up_vote_count": 4,
      "answer_count": 3,
      "score": 4,
      "creation_date": 1683190872,
      "question_id": 76171379,
      "body": "<p>Hi I am trying to map my source to target but i am getting this error.</p>\n<p>Here is My Pom.xml</p>\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.mapstruct&lt;/groupId&gt;\n    &lt;artifactId&gt;mapstruct&lt;/artifactId&gt;\n    &lt;version&gt;1.5.5.Final&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;\n    &lt;artifactId&gt;lombok&lt;/artifactId&gt;\n    &lt;version&gt;1.18.26&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;\n    &lt;artifactId&gt;lombok-mapstruct-binding&lt;/artifactId&gt;\n    &lt;version&gt;0.2.0&lt;/version&gt;\n&lt;/dependency&gt;\n\n&lt;plugin&gt;\n    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n    &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n    &lt;configuration&gt;\n        &lt;annotationProcessorPaths&gt;\n            &lt;path&gt;\n                &lt;groupId&gt;org.mapstruct&lt;/groupId&gt;\n                &lt;artifactId&gt;mapstruct-processor&lt;/artifactId&gt;\n                &lt;version&gt;1.5.5.Final&lt;/version&gt;\n            &lt;/path&gt;\n            &lt;path&gt;\n                &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;\n                &lt;artifactId&gt;lombok&lt;/artifactId&gt;\n                &lt;version&gt;1.18.26&lt;/version&gt;\n            &lt;/path&gt;\n            &lt;path&gt;\n                &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;\n                &lt;artifactId&gt;lombok-mapstruct-binding&lt;/artifactId&gt;\n                &lt;version&gt;0.2.0&lt;/version&gt;\n            &lt;/path&gt;\n        &lt;/annotationProcessorPaths&gt;\n    &lt;/configuration&gt;\n&lt;/plugin&gt;\n</code></pre>\n<p>My Mapper:</p>\n<pre><code>import org.mapstruct.Mapper;\nimport org.mapstruct.Mapping;\n\n@Mapper(componentModel = &quot;spring&quot;)\npublic interface CustomMapper {\n\n    @Mapping(source = &quot;rDAccount&quot;, target = &quot;xfaceRDAccount&quot;)\n    TargetClass mapToTarget(SourceClass sourceClass);\n}\n</code></pre>\n<p>My SourceClass</p>\n<pre><code>import lombok.Data;\n\n@Data\npublic class SourceClass {\n    private String rDAccount;\n}\n</code></pre>\n<p>My TargetClass</p>\n<pre><code>import lombok.Data;\n\n@Data\npublic class TargetClass {\n    private String xfaceRDAccount;\n}\n</code></pre>\n<p>After running mvn clean install\nError I am getting: No property named &quot;rDAccount&quot; exists in source parameter(s). Did you mean &quot;RDAccount&quot;?</p>\n"
    },
    {
      "tags": [
        "java"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 2226708,
            "display_name": "The Shmoo"
          },
          "edited": false,
          "comment_id": 134148636,
          "body": "have you tried using intList.add(&quot;Hello World&quot;.hashCode());"
        },
        {
          "owner": {
            "user_id": 1552534,
            "display_name": "WJS"
          },
          "edited": false,
          "comment_id": 134148648,
          "body": "I fail to see how your code has anything to do with hashCode generation.  Please provide more information.    And be specific. <i><code>but I can only edit and add code between those two commands</code></i>  What commands?"
        },
        {
          "owner": {
            "user_id": 9535950,
            "display_name": "Thomas Behr"
          },
          "edited": false,
          "comment_id": 134148653,
          "body": "<code>a.equals(b)</code> will <i>always</i> return <code>false</code> if <code>a</code> is an instance of <code>Integer</code> and <code>b</code> is an instance of <code>String</code>. Moreover, how do you expect us to help you with your problem if you do not even state the problem in the question?"
        },
        {
          "owner": {
            "user_id": 511012,
            "display_name": "Ian Newson"
          },
          "edited": false,
          "comment_id": 134148676,
          "body": "What&#39;s the name and topic of the module you&#39;re studying? If it&#39;s about generics and type erasure in Java, it might be because it&#39;s possible to add the wrong type to lists in Java, although it&#39;s never recommended (the method name insertEvil hints that you should be trying to do it in an evil way)."
        },
        {
          "owner": {
            "user_id": 466862,
            "display_name": "Mark Rotteveel"
          },
          "edited": false,
          "comment_id": 134148702,
          "body": "Just do <code>((List) intList).add(0, &quot;Hello World&quot;)</code> (NVM, that is not going to work given the return type of <code>get(0)</code>)"
        },
        {
          "owner": {
            "user_id": 21688896,
            "display_name": "Student23452345"
          },
          "edited": false,
          "comment_id": 134148719,
          "body": "Sorry i try to be more accurate now. My module is called &quot;software&quot; and my task is it to get a true from the if statement without changing the if statement. I can only write things between //change starts here and //Change ends here."
        },
        {
          "owner": {
            "user_id": 2636929,
            "display_name": "Stultuske"
          },
          "edited": false,
          "comment_id": 134148763,
          "body": "do you know exactly how equals works?"
        },
        {
          "owner": {
            "user_id": 466862,
            "display_name": "Mark Rotteveel"
          },
          "edited": false,
          "comment_id": 134148791,
          "body": "Are you allowed to do anything there? Including ending the current method and defining another method?"
        },
        {
          "owner": {
            "user_id": 21688896,
            "display_name": "Student23452345"
          },
          "edited": false,
          "comment_id": 134148831,
          "body": "@Stultuske yes and it triggered me a lot because my teacher gave us this task. Until now one has get this correct."
        },
        {
          "owner": {
            "user_id": 21688896,
            "display_name": "Student23452345"
          },
          "edited": false,
          "comment_id": 134148838,
          "body": "@MarkRotteveel no Im not allowed to do this."
        },
        {
          "owner": {
            "user_id": 1552534,
            "display_name": "WJS"
          },
          "edited": false,
          "comment_id": 134148977,
          "body": "@maloomeister Compiler won&#39;t allow it."
        },
        {
          "owner": {
            "user_id": 1552534,
            "display_name": "WJS"
          },
          "edited": false,
          "comment_id": 134148987,
          "body": "Are you certain you have posted the correct, original code, sans any of your modifications?"
        },
        {
          "owner": {
            "user_id": 669576,
            "display_name": "001"
          },
          "edited": false,
          "comment_id": 134148994,
          "body": "Probably not what you want but: <code>System.out.println(&quot;Ok&quot;); System.exit(0);</code> in between the comments :)"
        },
        {
          "owner": {
            "user_id": 21688896,
            "display_name": "Student23452345"
          },
          "edited": false,
          "comment_id": 134149000,
          "body": "@WJS unfortunately this is copy paste and we asked him if this is a joke:)"
        },
        {
          "owner": {
            "user_id": 11441011,
            "display_name": "maloomeister"
          },
          "edited": false,
          "comment_id": 134149033,
          "body": "@WJS yeah, got that too."
        },
        {
          "owner": {
            "user_id": 21688896,
            "display_name": "Student23452345"
          },
          "edited": false,
          "comment_id": 134149094,
          "body": "@001 wow thats smart, i think its better than nothing"
        },
        {
          "owner": {
            "user_id": 653539,
            "display_name": "Tom&#225;Å¡ Z&#225;lusk&#253;"
          },
          "edited": false,
          "comment_id": 134158994,
          "body": "Nice <a href=\"https://xkcd.com/356/\" rel=\"nofollow noreferrer\">nerd snipper</a>. I tried to fake <code>intList</code> as <code>class intList {static String get(int i) {return &quot;Hello World&quot;;}}</code> (possible in Java 17) but no success - class declaration compiles fine but does not shade variable. May be it will inspire someone else. I agree with others it&#39;s mainly the puzzle to educate generics rather than expect some unconventional hack. Anyway it&#39;s hard to see any solution 100% covering your requirements. Put solution here please if you find out or get told, could be as self-answer. I am sure many people are interested in it as well."
        },
        {
          "owner": {
            "user_id": 511012,
            "display_name": "Ian Newson"
          },
          "edited": false,
          "comment_id": 134353484,
          "body": "Hi, did you reach out to your teacher and ask for a solution? I&#39;ve spent some time thinking about it, and I don&#39;t think it&#39;s possible."
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 5133585,
            "display_name": "Sweeper"
          },
          "up_vote_count": 3,
          "is_accepted": false,
          "creation_date": 1681998613,
          "answer_id": 76064862,
          "body": "<p>Since the method is named <code>insertEvil</code>, the point of this exercise is probably to teach you that it is possible to insert the &quot;wrong&quot; type of object to a <code>ArrayList&lt;T&gt;</code>, and that generics are not actually enforced at runtime. See: <a href=\"https://stackoverflow.com/questions/339699/java-generics-type-erasure-when-and-what-happens\">type erasure</a>.</p>\n<p>In this case, you need to insert a <code>String</code> into a <code>ArrayList&lt;Integer&gt;</code>.</p>\n<p>One way to do it is to cast it to a <a href=\"https://stackoverflow.com/questions/2770321/what-is-a-raw-type-and-why-shouldnt-we-use-it\">raw type</a>:</p>\n<pre><code>((ArrayList)intList).add(&quot;Hello World&quot;);\n</code></pre>\n<p>However, this doesn't actually cause your code to print &quot;OK&quot;, because the call to <code>intList.get</code> would attempt to cast the string you inserted back to an <code>Integer</code>, because <code>intList</code> is declared to be an <code>ArrayList&lt;Integer&gt;</code>. The cast will fail at runtime.</p>\n<p>To get this to work, you need <code>intList</code> to be a <code>ArrayList</code> or <code>ArrayList&lt;String&gt;</code>, so the call to <code>get</code> wouldn't try to cast the string to <code>Integer</code>.</p>\n<p>If you are only allowed to change the code between the two comments, the only ways I can think of are dirty tricks like declaring a new method. You can still declare a new method by just changing the lines between the two comments.</p>\n<p>For example, if the code between the two comments are replaced with:</p>\n<pre><code>helper(intList);\n}\nstatic void helper(ArrayList intList) {\nintList.add(&quot;Hello World&quot;);\n</code></pre>\n<p>Then it becomes:</p>\n<pre><code>static void insertEvil() {\n    var intList = new ArrayList&lt;Integer&gt;();\n    // Change starts here\n    helper(intList);\n}\nstatic void helper(ArrayList intList) {\n    intList.add(&quot;Hello World&quot;);\n    // Change ends here\n    if (intList.get(0).equals(&quot;Hello World&quot;)) {\n        System.out.println(&quot;Ok&quot;);\n    } else {\n        System.out.println(&quot;Failure&quot;);\n    }\n}\n</code></pre>\n<p>The idea is to pass <code>intList</code> to another method, to change what <code>intList</code> means in the <code>get</code> call. In the above code, <code>intList</code> in the <code>get</code> call now refers to the method parameter, instead of the variable declared in <code>insertEvil</code>.</p>\n<p>That said, I think it is highly likely that the intended solution is just <code>((ArrayList)intList).add(&quot;Hello World&quot;);</code>. Whoever designed this might not have considered that <code>get</code> would cast the element back to an <code>Integer</code>. (I nearly missed it too!)</p>\n"
        },
        {
          "owner": {
            "user_id": 1552534,
            "display_name": "WJS"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1681999506,
          "answer_id": 76065009,
          "body": "<blockquote>\n<p>I have get a &quot;OK&quot;, but I can only edit and add code between those two comments.</p>\n</blockquote>\n<p>Well, this works but I'm not certain if it was the desired solution. But there are no warnings or compiler errors.</p>\n<pre><code>static void insertEvil() {\n   var intList = new ArrayList&lt;Integer&gt;();\n   // Change starts here\n   if(intList instanceof List) {\n       System.out.println(&quot;Ok&quot;);\n       return;\n   }\n   // Change ends here\n   if (intList.get(0).equals(&quot;Hello World&quot;)) {\n       System.out.println(&quot;Ok&quot;);\n   } else {\n       System.out.println(&quot;Failure&quot;);\n   }\n}\n</code></pre>\n<p>But for that matter you could do anything, print OK and exit. So there must be more to this.</p>\n"
        }
      ],
      "owner": {
        "user_id": 21688896,
        "display_name": "Student23452345"
      },
      "view_count": 137,
      "up_vote_count": 4,
      "answer_count": 2,
      "score": 4,
      "creation_date": 1681996229,
      "question_id": 76064462,
      "body": "<p>I'm in university and struggling with this task. I tried for weeks, but I just can't understand this task. I have get a &quot;OK&quot;, but I can only edit and add code between those two comments.</p>\n<pre><code>static void insertEvil() {\n    var intList = new ArrayList&lt;Integer&gt;();\n    // Change starts here\n    intList.add(42);\n    // Change ends here\n    if (intList.get(0).equals(&quot;Hello World&quot;)) {\n        System.out.println(&quot;Ok&quot;);\n    } else {\n        System.out.println(&quot;Failure&quot;);\n    }\n}\n</code></pre>\n<p>I tried to &quot;transform&quot; an &quot;Hello World&quot; String into an Hashcode using hashcode(), but it is not working.</p>\n"
    },
    {
      "tags": [
        "java",
        "android",
        "android-edittext"
      ],
      "answers": [
        {
          "owner": {
            "user_id": 9851608,
            "display_name": "Zain"
          },
          "up_vote_count": 4,
          "is_accepted": true,
          "creation_date": 1676582095,
          "answer_id": 75477990,
          "body": "<p>Using both <code>adjustPan</code> and <code>WindowInsetsAnimation</code> seems to over-animating the content.</p>\n<blockquote>\n<p><a href=\"https://developer.android.com/guide/topics/manifest/activity-element\" rel=\"nofollow noreferrer\">adjustPan</a> - The activity's main window is not resized to make room for the soft keyboard. Rather, the contents of the window are automatically panned so that the current focus is never obscured by the keyboard and users can always see what they are typing. This is generally less desirable than resizing, because the user may need to close the soft keyboard to get at and interact with obscured parts of the window.</p>\n</blockquote>\n<p>This means that the activity is pushing its upper part until it's possible to make a room for the <code>EditText</code> widget (or its editable part) visible so that the user can see what they are typing.</p>\n<p>And I do believe that Google developers provided the insets API to get the obsolete overwhelming stuff deprecated soon or later; for instance recently setting <code>adjustResize</code> programmatically <a href=\"https://developer.android.com/reference/android/view/WindowManager.LayoutParams#SOFT_INPUT_ADJUST_RESIZE\" rel=\"nofollow noreferrer\">is now deprecated</a> as of API Level 30 and replaced with the inset API.</p>\n<p>More verification of the inconvenience between <code>adjustPan</code> and <code>WindowInsetsAnimation</code>, try the below couple of scenarios in your sample repo:</p>\n<ol>\n<li>Remove <code>android:windowSoftInputMode=&quot;adjustPan&quot;</code></li>\n<li>Remove <code>ViewCompat.setWindowInsetsAnimationCallback(rootView, callback);</code></li>\n</ol>\n<p>Either scenario will work solely without having to worry about the jumpy/bouncy layout. But in case of the scenario no. <em>1</em>, the red view appears because the activity area doesn't occupy the entire window screen (this requires to have a <a href=\"https://developer.android.com/develop/ui/views/layout/edge-to-edge\" rel=\"nofollow noreferrer\">full screen app</a>) with <code>WindowCompat.setDecorFitsSystemWindows(getWindow(), false);</code>. <a href=\"https://www.kodeco.com/18393648-window-insets-and-keyboard-animations-tutorial-for-android-11\" rel=\"nofollow noreferrer\">This tutorial</a> deeply targets different aspects of insets API.</p>\n<p>What I think the cause of this jumpy/bouncy behavior is that the <code>adjustPan</code> tries to do its job when the keyboard is shown; but eventually hard-coding the margins in the <code>WindowInsetsAnimation</code> wins the round and makes the layout bounce back at the end of the animation.</p>\n<p>So, it's recommended to remove that <code>adjustPan</code> to keep the new fancy inset APIs up and running.</p>\n<p>Or at least keep it at the manifest file, but disable it just before starting the animation and re-enable it again at the end of the animation (i.e., disable its panning behavior during the animation) using <code>onPrepare()</code> and <code>onEnd()</code> callbacks:</p>\n<pre><code>WindowInsetsAnimationCompat\n        .Callback callback = new WindowInsetsAnimationCompat.Callback(\n        WindowInsetsAnimationCompat.Callback.DISPATCH_MODE_STOP\n) {\n\n    @Override\n    public void onPrepare(@NonNull WindowInsetsAnimationCompat animation) {\n        super.onPrepare(animation);\n        // disable adjustPan\n        getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_ADJUST_NOTHING);\n    }\n\n    @Override\n    public void onEnd(@NonNull WindowInsetsAnimationCompat animation) {\n        super.onEnd(animation);\n        getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_ADJUST_PAN);\n    }\n\n    @NonNull\n    @Override\n    public WindowInsetsCompat onProgress(@NonNull WindowInsetsCompat insets, @NonNull List&lt;WindowInsetsAnimationCompat&gt; runningAnimations) {\n        // ... code is omitted for simplicity \n    }\n};\n</code></pre>\n<p>But make sure that you also have a full screen app:</p>\n<pre><code>WindowCompat.setDecorFitsSystemWindows(getWindow(), false);\n</code></pre>\n"
        }
      ],
      "owner": {
        "user_id": 72437,
        "display_name": "Cheok Yan Cheng"
      },
      "view_count": 221,
      "up_vote_count": 4,
      "accepted_answer_id": 75477990,
      "answer_count": 1,
      "score": 4,
      "creation_date": 1676096988,
      "question_id": 75418485,
      "body": "<p>Currently, we have an app with the following requirements</p>\n<ol>\n<li>Must use <code>android:windowSoftInputMode=&quot;adjustPan&quot;</code></li>\n<li>Use <code>ViewCompat.setWindowInsetsAnimationCallback</code> and <code>ViewCompat.setOnApplyWindowInsetsListener</code> to interact with soft keyboard visibility with smooth animation.</li>\n</ol>\n<p>Here is our code, when interacting with soft keyboard visibility. It works pretty well in the case, when our <code>EditText</code> is not scrollable.</p>\n<p>The animation went pretty well, when keyboard is showing and hiding.</p>\n<hr />\n<h2>MainActivity.java</h2>\n<pre><code>public class MainActivity extends AppCompatActivity {\n    EditText editText;\n    LinearLayout toolbar;\n    FrameLayout keyboardView;\n\n    private int systemBarsHeight = 0;\n    private int keyboardHeightWhenVisible = 0;\n    private boolean keyboardVisible = false;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_main);\n\n        editText = findViewById(R.id.edit_text);\n        toolbar = findViewById(R.id.toolbar);\n        keyboardView = findViewById(R.id.keyboard_view);\n\n        final View rootView = getWindow().getDecorView().getRootView();\n\n        ViewCompat.setOnApplyWindowInsetsListener(rootView, (v, insets) -&gt; {\n            boolean imeVisible = insets.isVisible(WindowInsetsCompat.Type.ime());\n\n            systemBarsHeight = insets.getInsets(WindowInsetsCompat.Type.systemBars()).bottom;\n\n            keyboardVisible = imeVisible;\n\n            if (keyboardVisible) {\n                keyboardHeightWhenVisible = insets.getInsets(WindowInsetsCompat.Type.ime()).bottom;\n            }\n\n            // https://stackoverflow.com/questions/75325095/how-to-use-windowinsetscompat-correctly-to-listen-to-keyboard-height-change-in-a\n            return ViewCompat.onApplyWindowInsets(v, insets);\n        });\n\n        WindowInsetsAnimationCompat.Callback callback = new WindowInsetsAnimationCompat.Callback(\n                WindowInsetsAnimationCompat.Callback.DISPATCH_MODE_STOP\n        ) {\n            @NonNull\n            @Override\n            public WindowInsetsCompat onProgress(@NonNull WindowInsetsCompat insets, @NonNull List&lt;WindowInsetsAnimationCompat&gt; runningAnimations) {\n                // Find an IME animation.\n                WindowInsetsAnimationCompat imeAnimation = null;\n                for (WindowInsetsAnimationCompat animation : runningAnimations) {\n                    if ((animation.getTypeMask() &amp; WindowInsetsCompat.Type.ime()) != 0) {\n                        imeAnimation = animation;\n                        break;\n                    }\n                }\n                if (imeAnimation != null) {\n                    int keyboardViewHeight;\n                    if (keyboardVisible) {\n                        keyboardViewHeight = (int) (keyboardHeightWhenVisible * imeAnimation.getInterpolatedFraction()) - systemBarsHeight;\n                    } else {\n                        keyboardViewHeight = (int) (keyboardHeightWhenVisible * (1.0-imeAnimation.getInterpolatedFraction())) - systemBarsHeight;\n                    }\n\n                    keyboardViewHeight = Math.max(0, keyboardViewHeight);\n\n                    ViewGroup.LayoutParams params = keyboardView.getLayoutParams();\n                    params.height = keyboardViewHeight;\n                    keyboardView.setLayoutParams(params);\n\n                    Log.i(&quot;CHEOK&quot;, &quot;keyboardVisible = &quot; + keyboardVisible + &quot;, keyboardViewHeight = &quot; + keyboardViewHeight);\n                }\n                return insets;\n\n            }\n        };\n\n        ViewCompat.setWindowInsetsAnimationCallback(rootView, callback);\n    }\n}\n</code></pre>\n<h2>activity_main.xml</h2>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\n&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\n    xmlns:tools=&quot;http://schemas.android.com/tools&quot;\n    android:layout_width=&quot;match_parent&quot;\n    android:layout_height=&quot;match_parent&quot;\n    android:orientation=&quot;vertical&quot;\n    tools:context=&quot;.MainActivity&quot;&gt;\n\n    &lt;EditText\n        android:id=&quot;@+id/edit_text&quot;\n\n        android:padding=&quot;16dp&quot;\n        android:scrollbars=&quot;vertical&quot;\n        android:layout_width=&quot;match_parent&quot;\n        android:layout_height=&quot;0dp&quot;\n        android:layout_weight=&quot;1&quot;\n        android:gravity=&quot;top&quot; /&gt;\n\n    &lt;LinearLayout\n        android:id=&quot;@+id/toolbar&quot;\n\n        android:layout_width=&quot;match_parent&quot;\n        android:layout_height=&quot;48dp&quot;\n        android:orientation=&quot;horizontal&quot;\n        android:background=&quot;#ffff00&quot; /&gt;\n\n    &lt;FrameLayout\n        android:id=&quot;@+id/keyboard_view&quot;\n\n        android:background=&quot;#ff0000&quot;\n        android:layout_width=&quot;match_parent&quot;\n        android:layout_height=&quot;0dp&quot; /&gt;\n&lt;/LinearLayout&gt;\n</code></pre>\n<hr />\n<p>Here is the outcome.</p>\n<h2>When EditText is not scrollable</h2>\n<p><a href=\"https://i.stack.imgur.com/klPpE.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/klPpE.gif\" alt=\"enter image description here\" /></a></p>\n<hr />\n<p>However, our app becomes &quot;jumpy&quot;, when the content of <code>EditText</code> is scrollable.</p>\n<h2>When EditText is scrollable, our app becomes &quot;jumpy&quot;</h2>\n<p><a href=\"https://i.stack.imgur.com/fTGwb.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fTGwb.gif\" alt=\"enter image description here\" /></a></p>\n<hr />\n<p>Does anyone know what is the root cause of this problem, and how we can resolve such?</p>\n<p>A demo to demonstrate such an issue, can be downloaded from <a href=\"https://github.com/yccheok/programming-issue/tree/main/jumpy\" rel=\"nofollow noreferrer\">https://github.com/yccheok/programming-issue/tree/main/jumpy</a></p>\n"
    },
    {
      "tags": [
        "java",
        "oop",
        "design-patterns",
        "uml"
      ],
      "answers": [
        {
          "owner": {
            "user_id": 8041003,
            "display_name": "John Williams"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1675719387,
          "answer_id": 75366820,
          "body": "<p>Composition is a specialized form of aggregation. In composition, if the parent object is destroyed, then the child objects also cease to exist. Composition is actually a strong type of aggregation and is sometimes referred to as a â€œdeathâ€ relationship.</p>\n"
        },
        {
          "owner": {
            "user_id": 3379653,
            "display_name": "qwerty_so"
          },
          "up_vote_count": 4,
          "is_accepted": true,
          "creation_date": 1675762606,
          "answer_id": 75371407,
          "body": "<p>Because it's historical state of the art an not true for UML 2.5. Aggregation as attribute of a Property is explained on p. 110 of UML 2.5:</p>\n<blockquote>\n<ul>\n<li>none | Indicates that the Property has no aggregation semantics.</li>\n<li>shared | Indicates that the Property has shared aggregation semantics. Precise semantics of shared aggregation varies by application area and modeler.</li>\n<li>composite | Indicates that the Property is aggregated compositely, i.e., the composite object has responsibility for the existence and storage of the composed objects (see the definition of parts in 11.2.3).</li>\n</ul>\n</blockquote>\n<p>So actually both stand side-by-side with <em>shared</em> having no semantics whatsoever. Former UML specs had some definition which made <em>shared</em> some kind of subset. But that is just history. Though, you don't get it out of people's heads.</p>\n"
        }
      ],
      "owner": {
        "user_id": 6658607,
        "display_name": "janedoe"
      },
      "view_count": 79,
      "up_vote_count": 4,
      "accepted_answer_id": 75371407,
      "answer_count": 2,
      "score": 4,
      "creation_date": 1675714745,
      "question_id": 75366160,
      "body": "<p>Referring to an Image I found online. It labels Composition as a subset of Aggregation.\nAs per my understanding Composition is a form of tight coupling like when we instantiate an object inside another object. While Aggregation is a form of loose coupling kind of like a Dependancy Injection. They both seem different so why would Composition be a subset of Aggregation?</p>\n<p>Image:\n<a href=\"https://algodaily.com/lessons/association-aggregation-composition-casting\" rel=\"nofollow noreferrer\">https://algodaily.com/lessons/association-aggregation-composition-casting</a></p>\n"
    },
    {
      "tags": [
        "java",
        "spring",
        "spring-boot",
        "hibernate"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 11720841,
            "display_name": "ISquared"
          },
          "edited": false,
          "comment_id": 132964777,
          "body": "I did, it says &#39;Cannot resolve symbol&#39; for BinaryConverter"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 2889760,
            "display_name": "Gavin King"
          },
          "up_vote_count": 5,
          "is_accepted": false,
          "creation_date": 1675690414,
          "answer_id": 75361973,
          "body": "<p>You have not really given enough information here, but <em>probably</em> the solution is:</p>\n<pre><code>@JdbcType(VarbinaryJdbcType.class)\n</code></pre>\n<p>or:</p>\n<pre><code>@JdbcTypeCode(Types.VARBINARY)\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 11720841,
            "display_name": "ISquared"
          },
          "up_vote_count": 0,
          "is_accepted": false,
          "creation_date": 1676125806,
          "answer_id": 75420859,
          "body": "<p>Quick update in case anyone else encounters this, it appears Hibernate 6 is taking care of this exact type conversion on its own, without the need for additional settings, so simply getting rid off the attribute:</p>\n<pre><code>@Type(type=&quot;org.hibernate.type.BinaryType&quot;)\n\n</code></pre>\n<p>solved the problem and the project appears to be running fine.</p>\n"
        }
      ],
      "owner": {
        "user_id": 11720841,
        "display_name": "ISquared"
      },
      "view_count": 765,
      "up_vote_count": 4,
      "answer_count": 2,
      "score": 4,
      "creation_date": 1675622475,
      "question_id": 75354646,
      "body": "<p>I am doing a Spring Boot course written in Spring Boot 2.19, Hibernate 5.3.12 and Java 8.\nI am using Java 17, Hibernate 6.1.6 and Spring Boot 3.0.2.</p>\n<p>I sorted many things that didn't match, but one problem I can't find the solution to is that :</p>\n<pre><code>@Type(type=&quot;org.hibernate.type.BinaryType&quot;)\n</code></pre>\n<p>is apparently deprecated since Hibernate 6 (I get the error &quot;Cannot resolve method <strong>type</strong>&quot;)</p>\n<p>However, none of the solutions I found were related to binary data and I couldn't find anything relevant in the docs .. I guess because I'm so new to this area I probably can't see the answer when it hits me!</p>\n<p>Based on various sources I tried:</p>\n<pre><code>@Convert(converter = org.hibernate.type.BinaryConverter.class)\n</code></pre>\n<pre><code>@Type(BinaryType) \n</code></pre>\n<p>IDE does not suggest anything for Binary.. in either of the cases..</p>\n<p>I guess I could just download the lower version dependency of hibernate, but I am curious still how does this work in the newest Hibernate version?</p>\n"
    },
    {
      "tags": [
        "java",
        "android",
        "kotlin",
        "localdatetime",
        "java.time.instant"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 1081110,
            "display_name": "Dawood ibn Kareem"
          },
          "edited": false,
          "comment_id": 132723575,
          "body": "I&#39;m guessing that your default time zone isn&#39;t UTC."
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 10819573,
            "display_name": "Arvind Kumar Avinash"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1674506676,
          "answer_id": 75214856,
          "body": "<p>You need to use <a href=\"https://docs.oracle.com/javase/8/docs/api/java/time/LocalTime.html#now-java.time.ZoneId-\" rel=\"nofollow noreferrer\"><code>LocalTime#now(ZoneId zone)</code></a> with <code>ZoneOffset.UTC</code> in order to get the local time at UTC; otherwise, the system picks up the local time of system's timezone.</p>\n<p><strong>Demo</strong>:</p>\n<pre><code>import java.time.Instant;\nimport java.time.LocalDateTime;\nimport java.time.ZoneOffset;\nimport java.time.temporal.ChronoUnit;\nimport java.util.concurrent.TimeUnit;\n\nclass Main {\n    public static void main(String[] args) {\n        Instant now = Instant.now();\n        var now1 = TimeUnit.SECONDS.convert(now.toEpochMilli(), TimeUnit.MILLISECONDS) - 60;\n        var now2 = TimeUnit.SECONDS.convert(now.minusSeconds(60).toEpochMilli(), TimeUnit.MILLISECONDS);\n        var now3 = LocalDateTime.now(ZoneOffset.UTC).minusSeconds(60).toEpochSecond(ZoneOffset.UTC);\n        var now4 = System.currentTimeMillis() / 1000 - 60;\n        System.out.println(now1);\n        System.out.println(now2);\n        System.out.println(now3);\n        System.out.println(now4);\n    }\n}\n</code></pre>\n<p><strong>Output from a sample run</strong>:</p>\n<pre><code>1674506413\n1674506413\n1674506413\n1674506413\n</code></pre>\n<p><a href=\"https://ideone.com/4Tgg8q\" rel=\"nofollow noreferrer\"><kbd>ONLINE DEMO</kbd></a></p>\n<p>Learn more about the modern Date-Time API from <strong><a href=\"https://docs.oracle.com/javase/tutorial/datetime/index.html\" rel=\"nofollow noreferrer\">Trail: Date Time</a></strong>.</p>\n"
        },
        {
          "owner": {
            "user_id": 642706,
            "display_name": "Basil Bourque"
          },
          "up_vote_count": 4,
          "is_accepted": true,
          "creation_date": 1674507798,
          "answer_id": 75215029,
          "body": "<h1>tl;dr</h1>\n<ul>\n<li>Your JVMâ€™s current default time zone is three hours ahead of UTC. Thus your result.<br />( 1_674_512_251L - 1_674_501_451L ) = 3 hours.</li>\n<li>ðŸ‘‰ You are making inappropriate use of <a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/time/LocalDateTime.html\" rel=\"nofollow noreferrer\"><code>LocalDateTime</code></a> class.</li>\n</ul>\n<h1>Moment versus not-a-moment</h1>\n<blockquote>\n<p>I am trying to use LocalDateTime to manipulate dates</p>\n</blockquote>\n<p>Don't.</p>\n<p>If you are representing a moment, a specific point on the timeline, ðŸ‘‰ do <em>not</em> use <code>LocalDateTime</code>. That class holds a date with a time-of-day but lacks the context of a time zone or offset-from-UTC. To represent a moment use:</p>\n<ul>\n<li><a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/time/Instant.html\" rel=\"nofollow noreferrer\"><code>Instant</code></a> â€” A moment as seen in UTC (an offset from UTC of zero hours-minutes-seconds).</li>\n<li><a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/time/OffsetDateTime.html\" rel=\"nofollow noreferrer\"><code>OffsetDateTime</code></a> - A moment as seen with a particular offset.</li>\n<li><a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/time/ZonedDateTime.html\" rel=\"nofollow noreferrer\"><code>ZonedDateTime</code></a> - A moment as seen through a particular time zone.</li>\n</ul>\n<p>I cannot imagine any scenario where calling <code>LocalDateTime.now</code> is the right thing to do.</p>\n<p>Example code:</p>\n<pre class=\"lang-java prettyprint-override\"><code>Instant instant = Instant.now() ;\n\nZoneOffset offset = ZoneId.of( &quot;Africa/Dar_es_Salaam&quot; ).getRules().getOffset( instant ) ;\nOffsetDateTime odt = OffsetDateTime.now( offset ) ;\n\nZoneId zone = ZoneId.of( &quot;Africa/Dar_es_Salaam&quot; ) ;\nZonedDateTime zonedDateTime = ZonedDateTime.now( zone ) \n</code></pre>\n<p>Dump to console.</p>\n<pre class=\"lang-java prettyprint-override\"><code>System.out.println( instant + &quot; | &quot; + instant.getEpochSecond() ) ;\nSystem.out.println( odt + &quot; | &quot; + odt.toEpochSecond() ) ;\nSystem.out.println( zonedDateTime + &quot; | &quot; + zonedDateTime.toEpochSecond() ) ;  \n</code></pre>\n<p>See this <a href=\"https://ideone.com/gM2Y5t\" rel=\"nofollow noreferrer\">code run at Ideone.com</a>. Note that all three are within the same second, give or take a second as the clock may rollover to the next second by the second or third call to <code>now</code>.</p>\n<blockquote>\n<p>2023-01-24T14:27:06.416597Z | 1674570426</p>\n<p>2023-01-24T17:27:06.478680+03:00 | 1674570426</p>\n<p>2023-01-24T17:27:06.487289+03:00[Africa/Dar_es_Salaam] | 1674570426</p>\n</blockquote>\n<h1><code>LocalDateTime#toEpochSecond</code></h1>\n<p>Calling the <code>toEpochSecond</code> method on <code>LocalDateTime</code> is tricky conceptually. As a concept, <code>LocalDateTime</code> has no <a href=\"https://en.wikipedia.org/wiki/Epoch_(computing)\" rel=\"nofollow noreferrer\">epoch reference</a> point. It is just a date with a time. For example, â€œnoon on January 23 of 2023â€ by itself has no specific meaning, cannot be nailed down to a point on the timeline. So it is meaningless to compare â€œnoon on January 23 of 2023â€ to a reference point such as the first moment of 1970 as seen in UTC, 1970-01-01T00:00Z.</p>\n<p>Practically, the <code>LocalDateTime</code> class is implemented as if it were in UTC. So internally, the class counts a number of whole seconds since 1970-01-01T00:00Z plus a count of nanoseconds for a fractional second. But you <strong>should not be thinking of this implementation detail when writing code for business logic</strong>. For business logic, calling <code>LocalDateTime#toEpochSecond</code>  makes no sense.</p>\n<h2>Technically speaking</h2>\n<p>So the technical answer to your Question is that your delta of 3 hours (1_674_501_451L - 1_674_512_251L) came from the fact that your JVMâ€™s current default time zone at that moment used an offset of +03:00, three hours ahead of UTC. So <strong>your call to <code>LocalDateTime.now</code> captured a date and time three hours ahead</strong> of UTC. But then you asked for <strong><code>toEpochSecond</code> which treats that very same date and time as if it were in UTC</strong>.</p>\n<h2>Logically speaking</h2>\n<p>Of course that date and time were <em>not</em> meant to represent a moment in UTC. So logically speaking, your code is nonsensical. You should not be comparing a count from epoch for a <code>LocalDateTime</code> (which is a non-moment) to other classes such as <code>Instant</code> (which <em>is</em> a moment).</p>\n<p>In other words, you are <a href=\"https://en.wikipedia.org/wiki/Apples_and_oranges\" rel=\"nofollow noreferrer\">comparing apples and oranges</a>.</p>\n<h3>Serializing date-time data</h3>\n<p>So, if <code>LocalDateTime#toEpochSecond</code> is inappropriate for business logic, why does that class offer such a method?</p>\n<p>That method is useful for serializing a <code>LocalDateTime</code> value for storage or data-exchange. Some other systems may present date-with-time values in this manner.</p>\n<h4>ISO 8601</h4>\n<p>However, using a count-from-reference is a poor way to communicate date-time values. The values are ambiguous, as their granularity is implicit, and their particular epoch reference point is also implicit. And, such values make validation and debugging difficult for human readers.</p>\n<p>I strongly recommend <strong>using standard <a href=\"https://en.wikipedia.org/wiki/ISO_8601\" rel=\"nofollow noreferrer\">ISO 8601</a> text rather than a count</strong> when storing or exchanging date-time values outside Java. Regarding your example standard textual format would be:</p>\n<blockquote>\n<p>2023-01-23T22:17:31</p>\n</blockquote>\n<hr />\n<p>General advice: <strong>Avoid <code>LocalDateTime</code> class</strong> unless you are <em>very</em> clear on its appropriate use.</p>\n<p>For business apps, we are generally tracking moments. For example, &quot;when does this contract come into effect&quot;, &quot;when was this employee hired&quot;, &quot;when does the purchase of this house close&quot;. So <code>LocalDateTime</code> is not called for.</p>\n<p>The two business scenarios for <code>LocalDateTime</code> are (a) making appointments where we want the moment to float if time zone rules change, such as clinic, salon, and studio bookings, and (b) where we mean several moments, each with the same wall-clock time but occurring at different points on the timeline, such as &quot;Announce this corporate message at noon in each of our company factories in Delhi, DÃ¼sseldorf, and Detroit.&quot;. Search Stack Overflow to learn more on this, as I and others have posted multiple times already.</p>\n<hr />\n<p><a href=\"https://ideone.com/QavXcy\" rel=\"nofollow noreferrer\">On Ideone.com</a>, see some code I noodled around with in writing this Answer.</p>\n"
        }
      ],
      "owner": {
        "user_id": 5942579,
        "display_name": "Emmanuel Mtali"
      },
      "view_count": 148,
      "up_vote_count": 4,
      "accepted_answer_id": 75215029,
      "answer_count": 2,
      "score": 4,
      "creation_date": 1674501581,
      "question_id": 75214079,
      "body": "<p>I am trying to use LocalDateTime to manipulate dates in my application but I have noticed that getting epoch seconds from it returns different values from what I expected</p>\n<pre><code>val now1 = Instant.now().epochSecond - 60\nval now2 = Instant.now().minusSeconds(60).epochSecond\nval now3 = LocalDateTime.now().minusSeconds(60).toEpochSecond(ZoneOffset.UTC)\nval now4 = System.currentTimeMillis() / 1000 - 60\n</code></pre>\n<p>Output</p>\n<pre><code>Now1 = 1674501451\nNow2 = 1674501451\nNow3 = 1674512251\nNow4 = 1674501451\n</code></pre>\n<p>Notice how Now3 has a different value. What is happening?</p>\n"
    },
    {
      "tags": [
        "java",
        "flutter",
        "android-studio",
        "flutter-doctor"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 7432242,
            "display_name": "deczaloth"
          },
          "edited": false,
          "comment_id": 132604897,
          "body": "Hi, thanks for suggesting an edit to my answer. I can not add it to my answer since i have not tested that step, but i added it as a comment in case someone faces could find that extra step useful!"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 7432242,
            "display_name": "deczaloth"
          },
          "up_vote_count": 3,
          "is_accepted": false,
          "creation_date": 1673868804,
          "answer_id": 75133637,
          "body": "<p>I had that problem today after updating <strong>Android Studio</strong>, and found an answer here:</p>\n<p><a href=\"https://github.com/flutter/flutter/issues/118502\" rel=\"nofollow noreferrer\">https://github.com/flutter/flutter/issues/118502</a></p>\n<hr />\n<p>The solution is basically:</p>\n<ol>\n<li>Go to your <strong>AndroidStudio</strong> folder (normally <code>C:\\Program Files\\Android\\Android Studio</code> in <strong>Windows</strong>)</li>\n<li>Copy the content of <strong>jbr</strong> and paste the content into <strong>jre</strong> folder</li>\n</ol>\n"
        },
        {
          "owner": {
            "user_id": 14380077,
            "display_name": "Ivan"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1674323327,
          "answer_id": 75195375,
          "body": "<p>Quick workaround from here: <a href=\"https://github.com/flutter/flutter/issues/118502#issuecomment-1384954269\" rel=\"nofollow noreferrer\">https://github.com/flutter/flutter/issues/118502#issuecomment-1384954269</a></p>\n<p>Run in the terminal:</p>\n<pre><code>cd /Applications/Android\\ Studio.app/Contents\nln -s jbr jre\n</code></pre>\n<p>*solution for MacOS</p>\n"
        }
      ],
      "owner": {
        "user_id": 14634256,
        "display_name": "ALI USAMA"
      },
      "view_count": 295,
      "up_vote_count": 4,
      "answer_count": 2,
      "score": 4,
      "creation_date": 1673853895,
      "question_id": 75131234,
      "body": "<p>I'm facing this issue on windows after upgrading <strong>Android Studio</strong> to <strong>Electric Eel</strong>.</p>\n<p><code>flutter doctor</code> returns:</p>\n<pre><code>Doctor summary (to see all details, run flutter doctor -v):\n[âˆš] Flutter (Channel stable, 3.3.10, on Microsoft Windows [Version 10.0.22621.1105], locale en-US)\nChecking Android licenses is taking an unexpectedly long time...[âˆš] Android toolchain - develop for Android devices (Android SDK version 33.0.1)\n[âˆš] Chrome - develop for the web\n[!] Visual Studio - develop for Windows (Visual Studio Community 2022 17.4.3)\n    X The current Visual Studio installation is incomplete. Please reinstall Visual Studio.\n[!] Android Studio (version 2022.1)\n    X Unable to find bundled Java version.\n[âˆš] VS Code (version 1.74.3)\n[âˆš] Connected device (4 available)\n[âˆš] HTTP Host Availability\n\n! Doctor found issues in 2 categories.\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/Nbw5T.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Nbw5T.png\" alt=\"Android Studio (version 2022.1) Unable to find bundled Java version.\" /></a></p>\n<hr />\n<p>I've tried adding a JAVA_HOME kind of solution but didn't work for me.</p>\n"
    },
    {
      "tags": [
        "java",
        "javafx",
        "3d",
        "javafx-3d"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 1155209,
            "display_name": "jewelsea"
          },
          "edited": false,
          "comment_id": 132477215,
          "body": "There is an <a href=\"https://stackoverflow.com/questions/19459012/how-to-create-custom-3d-model-in-javafx-8\">example here</a>."
        },
        {
          "owner": {
            "user_id": 7587451,
            "display_name": "Giovanni Contreras"
          },
          "edited": false,
          "comment_id": 132477518,
          "body": "thanks @jewelsea  , CheckBox approach . Good idea &#39;cause drawmode has 2 options ."
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 7587451,
            "display_name": "Giovanni Contreras"
          },
          "up_vote_count": 4,
          "is_accepted": true,
          "creation_date": 1673229469,
          "answer_id": 75052570,
          "body": "<p><strong>Changing draw mode with radio buttons</strong></p>\n<p><a href=\"https://i.stack.imgur.com/QAC75.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QAC75.gif\" alt=\"drawmode javafx\" /></a></p>\n<p>In this approach a <a href=\"https://openjfx.io/javadoc/18/javafx.graphics/javafx/scene/shape/Box.html\" rel=\"nofollow noreferrer\"><code>Box</code></a> instance change its <a href=\"https://openjfx.io/javadoc/18/javafx.graphics/javafx/scene/shape/DrawMode.html\" rel=\"nofollow noreferrer\"><code>DrawMode</code></a> with radiobuttons.</p>\n<p>This is a single class javafx you can try .</p>\n<p><strong>App.java</strong></p>\n<pre><code>public class App extends Application {\n\n    @Override\n    public void start(Stage stage) {\n\n        var perspective = new PerspectiveCamera(true);\n        perspective.setNearClip(0.1);\n        perspective.setFarClip(500);\n        perspective.setTranslateZ(-150);\n        \n        \n        \n        Shape3D cube = new Box(50, 50, 50);\n        cube.setCullFace(CullFace.NONE);\n        cube.setMaterial(new PhongMaterial(Color.CORAL));\n\n        var toggleGroup = new ToggleGroup();\n        var solid = new RadioButton(&quot;solid&quot;);\n        solid.setToggleGroup(toggleGroup);\n        solid.setSelected(true);\n        var wire = new RadioButton(&quot;wireframe&quot;);\n        wire.setToggleGroup(toggleGroup);\n\n        var hBox = new HBox(solid, wire);\n\n        toggleGroup.selectedToggleProperty().addListener((o) -&gt; {\n            Toggle selectedToggle = toggleGroup.getSelectedToggle();\n\n            if (selectedToggle == solid) {\n                cube.setDrawMode(DrawMode.FILL);\n            }\n            if (selectedToggle == wire) {\n                cube.setDrawMode(DrawMode.LINE);\n\n            }\n\n        });\n\n        var group3d = new Group(perspective, cube);\n\n        var subscene = new SubScene(group3d, 300, 400, true, SceneAntialiasing.BALANCED);\n        subscene.setCamera(perspective);\n\n        var stack = new StackPane(subscene, hBox);\n\n        stage.setScene(new Scene(stack, 300, 400));\n        stage.show();\n    }\n\n    public static void main(String[] args) {\n        launch();\n    }\n\n}\n</code></pre>\n"
        }
      ],
      "owner": {
        "user_id": 7587451,
        "display_name": "Giovanni Contreras"
      },
      "view_count": 88,
      "up_vote_count": 4,
      "accepted_answer_id": 75052570,
      "answer_count": 1,
      "score": 4,
      "creation_date": 1673229469,
      "question_id": 75052569,
      "body": "<p>3d software allow  user to change draw mode dinamically. It can be implemented on javafx ?</p>\n"
    },
    {
      "tags": [
        "java",
        "postgresql",
        "hibernate"
      ],
      "answers": [
        {
          "owner": {
            "user_id": 2889760,
            "display_name": "Gavin King"
          },
          "up_vote_count": 3,
          "is_accepted": false,
          "creation_date": 1673124026,
          "answer_id": 75043614,
          "body": "<p>It's hard to be sure, since you have not told us what the <em>Java</em> type of the field you're trying to map with the <code>@Lob</code> annotation is, but hell, just this once I'll have a go at reading your mind, and <em>speculate</em> that what you've written is this:</p>\n<pre><code>@Lob \nbyte[] binaryData;\n</code></pre>\n<p>Now, the Postgres JDBC driver doesn't support using the LOB APIs to read/write <code>bytea</code> columns, and Hibernate knows about this, so it does the next-most-sensible thing, and assumes that this field maps to an <code>oid</code> column. This turns out to not be what you want.</p>\n<p>Of course, you could try bypassing Hibernate's knowledge of Postgres by writing:</p>\n<pre><code>@Lob @Column(columnDefinition=&quot;bytea&quot;) \nbyte[] binaryData;\n</code></pre>\n<p>And then you would get an error from Postgres or its driver (I forget which), because, as I said, the postgres driver doesn't support this.</p>\n<p>So what to do?</p>\n<p>Well, sure, you could try hacking the Hibernate <code>Dialect</code> as you have done above, to tell Hibernate to:</p>\n<ol>\n<li>use <code>bytea</code> for the JDBC type <code>BLOB</code>, and</li>\n<li>bind JDBC <code>BLOB</code>s using the usual handling for the JDBC type <code>BINARY</code> or <code>VARBINARY</code> or whatever.</li>\n</ol>\n<p>And yeah, you could still make that work easily enough in H6.</p>\n<p>Or, you know, <em>you could just remove the stupid <code>@Lob</code> annotation which isn't doing any useful work here</em>, and let Hibernate treat your field as a <code>varbinary</code>, which maps to <code>bytea</code> by default.</p>\n<pre><code>byte[] binaryData;\n</code></pre>\n<p>Now, look, there might be something more to what you're doing here, but then you'll need to help me out here by actually posting the details of the field and how you've mapped it.</p>\n"
        },
        {
          "owner": {
            "user_id": 21156400,
            "display_name": "mrenne"
          },
          "up_vote_count": 2,
          "is_accepted": false,
          "creation_date": 1675673301,
          "answer_id": 75359082,
          "body": "<p>We had exactly the same problem and manage to fix it with this dialect class (kotlin):</p>\n<pre class=\"lang-kotlin prettyprint-override\"><code>class CustomSQLDialect : PostgreSQLDialect(DatabaseVersion.make(9, 5)) {\n    override fun columnType(sqlTypeCode: Int): String {\n        return when (sqlTypeCode) {\n            SqlTypes.BLOB -&gt; &quot;bytea&quot;\n            else -&gt; super.columnType(sqlTypeCode)\n        }\n    }\n\n    override fun castType(sqlTypeCode: Int): String {\n        return when (sqlTypeCode) {\n            SqlTypes.BLOB -&gt; &quot;bytea&quot;\n            else -&gt; super.castType(sqlTypeCode)\n        }\n    }\n\n    override fun contributeTypes(typeContributions: TypeContributions, serviceRegistry: ServiceRegistry) {\n        super.contributeTypes(typeContributions, serviceRegistry)\n        val jdbcTypeRegistry = typeContributions.typeConfiguration\n            .jdbcTypeRegistry\n        jdbcTypeRegistry.addDescriptor(Types.BLOB, BinaryJdbcType.INSTANCE)\n    }\n}\n</code></pre>\n"
        }
      ],
      "owner": {
        "user_id": 3666206,
        "display_name": "BAMF4bacon"
      },
      "view_count": 731,
      "up_vote_count": 4,
      "answer_count": 2,
      "score": 4,
      "creation_date": 1673110027,
      "question_id": 75042081,
      "body": "<p>With the release of <strong>Hibernate 6</strong>, once again I am scratching my head trying to figure out how to get Hibernate to convert a <strong>@Lob</strong> to <strong>bytea</strong> for a <strong>PostGres</strong> database.  I also need the code to be testable with H2 (or any in memory database).</p>\n<p>I am using Postgres 10+ (v13), so that takes care of that requirement.</p>\n<p>This is what I used before, which was tricky, because I also needed it to work with H2.  (The PostGres dialect was only loaded in production, not tests.)</p>\n<p>Sadly, getting bytea to work is &quot;outside the scope&quot; of the Hibernate 6 user guide. See 2.2.47.\n<a href=\"https://docs.jboss.org/hibernate/orm/6.0/userguide/html_single/Hibernate_User_Guide.html\" rel=\"nofollow noreferrer\">https://docs.jboss.org/hibernate/orm/6.0/userguide/html_single/Hibernate_User_Guide.html</a></p>\n<p>The migration guide also seems silent on the topic.\n<a href=\"https://github.com/hibernate/hibernate-orm/blob/6.0/migration-guide.adoc\" rel=\"nofollow noreferrer\">https://github.com/hibernate/hibernate-orm/blob/6.0/migration-guide.adoc</a></p>\n<p>The entire API for SQLDialect family has been rewritten, so I am back to square 1.</p>\n<pre><code>public class CustomPostgresSQL10Dialect extends PostgreSQL10Dialect{\n\n  public CustomPostgresSQL10Dialect() {\n    super();\n    registerColumnType(Types.BLOB, &quot;bytea&quot;);\n  }\n\n  @Override\n  public SqlTypeDescriptor remapSqlTypeDescriptor(SqlTypeDescriptor sqlTypeDescriptor) {\n    if (sqlTypeDescriptor.getSqlType() == java.sql.Types.BLOB) {\n      return BinaryTypeDescriptor.INSTANCE;\n    }\n\n    return super.remapSqlTypeDescriptor(sqlTypeDescriptor);\n  }\n}\n</code></pre>\n"
    },
    {
      "tags": [
        "java",
        "kotlin",
        "gradle",
        "android-gradle-plugin",
        "gradle-plugin"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 466862,
            "display_name": "Mark Rotteveel"
          },
          "edited": false,
          "comment_id": 134163821,
          "body": "You need to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and the full exception stacktrace. There are a number of breaking changes in Gradle 8, so maybe you&#39;re using a plugin or something else which is not (yet) compatible with Gradle 8."
        },
        {
          "owner": {
            "user_id": 466862,
            "display_name": "Mark Rotteveel"
          },
          "edited": false,
          "comment_id": 134164399,
          "body": "And the full exception stacktrace?"
        },
        {
          "owner": {
            "user_id": 4649860,
            "display_name": "Chirag Thummar"
          },
          "edited": false,
          "comment_id": 134165999,
          "body": "It is in cipher form because I have enabled R8. Although I&#39;ll share it"
        },
        {
          "owner": {
            "user_id": 466862,
            "display_name": "Mark Rotteveel"
          },
          "edited": false,
          "comment_id": 134173627,
          "body": "Add it to the question itself, not in comments."
        },
        {
          "owner": {
            "user_id": 466862,
            "display_name": "Mark Rotteveel"
          },
          "edited": false,
          "comment_id": 134207161,
          "body": "You should post an <b>answer</b> with your solution. Don&#39;t use the comments for that."
        },
        {
          "owner": {
            "user_id": 466862,
            "display_name": "Mark Rotteveel"
          },
          "edited": false,
          "comment_id": 134207702,
          "body": "I have rolled back your edit. Answers should be posted as an answer, not made part of the question. Please post it as an <b>answer</b>."
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 19640780,
            "display_name": "Cosmin DrÄƒguÅŸanu"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1682083541,
          "answer_id": 76073611,
          "body": "<p>Most probably you are using a plugin that is not compatible with Gradle 8.0. If it is not necessary to upgrade to Gradle 8.0 I suggest you downgrade back to 7.4.2 until those plugins will become compatible . Another way would be to check the plugins that would not be compatible and try to replace them when they can be added.</p>\n"
        },
        {
          "owner": {
            "user_id": 4649860,
            "display_name": "Chirag Thummar"
          },
          "up_vote_count": 2,
          "is_accepted": false,
          "creation_date": 1682418239,
          "answer_id": 76100126,
          "body": "<p>I was facing this issue because of the <strong>Parcelize plugin</strong>. I'm using the Parcelize plugin to pass Custom Object ArrayList between activities.</p>\n<p>After a lot of trials finally found the solution of changing <em><strong>proguard-rules.pro</strong></em> files.</p>\n<p>Here is my content of <em><strong>proguard-rules.pro</strong></em> file</p>\n<pre><code># Add project specific ProGuard rules here.\n# You can control the set of applied configuration files using the\n# proguardFiles setting in build.gradle.\n#\n# For more details, see\n#   http://developer.android.com/guide/developing/tools/proguard.html\n\n# If your project uses WebView with JS, uncomment the following\n# and specify the fully qualified class name to the JavaScript interface\n# class:\n#-keepclassmembers class fqcn.of.javascript.interface.for.webview {\n#   public *;\n#}\n\n# Uncomment this to preserve the line number information for\n# debugging stack traces.\n#-keepattributes SourceFile,LineNumberTable\n\n# If you keep the line number information, uncomment this to\n# hide the original source file name.\n#-renamesourcefileattribute SourceFile\n\n-dontwarn rx.**\n\n-dontwarn okio.**\n\n-dontwarn com.squareup.okhttp.**\n-keep class com.squareup.okhttp.** { *; }\n-keep interface com.squareup.okhttp.** { *; }\n\n-dontwarn retrofit.**\n-keep class retrofit.** { *; }\n-keepclasseswithmembers class * {\n    @retrofit.http.* &lt;methods&gt;;\n}\n\n-keepattributes Signature\n-keepattributes *Annotation*\n\n\n-dontwarn javax.annotation.**\n\n# A resource is loaded with a relative path so the package of this class must be preserved.\n-adaptresourcefilenames okhttp3/internal/publicsuffix/PublicSuffixDatabase.gz\n\n# Animal Sniffer compileOnly dependency to ensure APIs are compatible with older versions of Java.\n-dontwarn org.codehaus.mojo.animal_sniffer.*\n\n# OkHttp platform used only on JVM and when Conscrypt and other security providers are available.\n-dontwarn okhttp3.internal.platform.**\n-dontwarn org.conscrypt.**\n-dontwarn org.bouncycastle.**\n-dontwarn org.openjsse.**\n\n-repackageclasses\n-ignorewarnings\n\n# Retrofit does reflection on generic parameters. InnerClasses is required to use Signature and\n# EnclosingMethod is required to use InnerClasses.\n-keepattributes Signature, InnerClasses, EnclosingMethod\n\n# Retrofit does reflection on method and parameter annotations.\n-keepattributes RuntimeVisibleAnnotations, RuntimeVisibleParameterAnnotations\n\n# Keep annotation default values (e.g., retrofit2.http.Field.encoded).\n-keepattributes AnnotationDefault\n\n# Retain service method parameters when optimizing.\n-keepclassmembers,allowshrinking,allowobfuscation interface * {\n    @retrofit2.http.* &lt;methods&gt;;\n}\n\n# Ignore JSR 305 annotations for embedding nullability information.\n-dontwarn javax.annotation.**\n\n# Guarded by a NoClassDefFoundError try/catch and only used when on the classpath.\n-dontwarn kotlin.Unit\n\n# Top-level functions that can only be used by Kotlin.\n-dontwarn retrofit2.KotlinExtensions\n-dontwarn retrofit2.KotlinExtensions$*\n\n# With R8 full mode, it sees no subtypes of Retrofit interfaces since they are created with a Proxy\n# and replaces all potential values with null. Explicitly keeping the interfaces prevents this.\n-if interface * { @retrofit2.http.* &lt;methods&gt;; }\n-keep,allowobfuscation interface &lt;1&gt;\n\n# Keep inherited services.\n-if interface * { @retrofit2.http.* &lt;methods&gt;; }\n-keep,allowobfuscation interface * extends &lt;1&gt;\n\n# Keep generic signature of Call, Response (R8 full mode strips signatures from non-kept items).\n-keep,allowobfuscation,allowshrinking interface retrofit2.Call\n-keep,allowobfuscation,allowshrinking class retrofit2.Response\n\n# With R8 full mode generic signatures are stripped for classes that are not\n# kept. Suspend functions are wrapped in continuations where the type argument\n# is used.\n-keep,allowobfuscation,allowshrinking class kotlin.coroutines.Continuation\n\n\n# Animal Sniffer compileOnly dependency to ensure APIs are compatible with older versions of Java.\n-dontwarn org.codehaus.mojo.animal_sniffer.*\n\n#-keep public class com.itextpdf.**\n-keep class com.itextpdf.** { *; }\n-dontwarn com.itextpdf.*\n\n-renamesourcefileattribute SourceFile\n\n-dontwarn retrofit2.**\n-keep class retrofit2.** {*;}\n\n##---------------Begin: proguard configuration for Gson  ----------\n# Gson uses generic type information stored in a class file when working with fields. Proguard\n# removes such information by default, so configure it to keep all of it.\n-keepattributes Signature\n\n# For using GSON @Expose annotation\n-keepattributes *Annotation*\n\n# Gson specific classes\n-dontwarn sun.misc.**\n#-keep class com.google.gson.stream.** { *; }\n\n# Application classes that will be serialized/deserialized over Gson\n-keep class com.google.gson.examples.android.model.** { &lt;fields&gt;; }\n\n# Prevent proguard from stripping interface information from TypeAdapter, TypeAdapterFactory,\n# JsonSerializer, JsonDeserializer instances (so they can be used in @JsonAdapter)\n-keep class * extends com.google.gson.TypeAdapter\n-keep class * implements com.google.gson.TypeAdapterFactory\n-keep class * implements com.google.gson.JsonSerializer\n-keep class * implements com.google.gson.JsonDeserializer\n\n# Prevent R8 from leaving Data object members always null\n-keepclassmembers,allowobfuscation class * {\n  @com.google.gson.annotations.SerializedName &lt;fields&gt;;\n}\n\n\n-keep class com.google.gson.reflect.TypeToken\n-keep class * extends com.google.gson.reflect.TypeToken\n-keep public class * implements java.lang.reflect.Type\n\n\n# Retain generic signatures of TypeToken and its subclasses with R8 version 3.0 and higher.\n-keep,allowobfuscation,allowshrinking class com.google.gson.reflect.TypeToken\n-keep,allowobfuscation,allowshrinking class * extends com.google.gson.reflect.TypeToken\n\n##---------------End: proguard configuration for Gson  ----------\n-dontwarn org.slf4j.**\n\n-keepdirectories src/main/res/font/*\n\n\n\n-dontusemixedcaseclassnames\n-verbose\n-keepattributes *Annotation*\n\n# For native methods, see http://proguard.sourceforge.net/manual/examples.html#native\n-keepclasseswithmembernames class * {\n    native &lt;methods&gt;;\n}\n\n# keep setters in Views so that animations can still work.\n# see http://proguard.sourceforge.net/manual/examples.html#beans\n-keepclassmembers public class * extends android.view.View {\n   void set*(***);\n   *** get*();\n}\n\n# We want to keep methods in Activity that could be used in the XML attribute onClick\n-keepclassmembers class * extends android.app.Activity {\n   public void *(android.view.View);\n}\n\n# For enumeration classes, see http://proguard.sourceforge.net/manual/examples.html#enumerations\n-keepclassmembers enum * {\n    public static **[] values();\n    public static ** valueOf(java.lang.String);\n}\n\n-keep class * implements android.os.Parcelable {\n  public static final android.os.Parcelable$Creator *;\n}\n\n-keepclassmembers class **.R$* {\n    public static &lt;fields&gt;;\n}\n\n# Firebase\n-keep class com.google.android.gms.** { *; }\n-keep class com.google.firebase.** { *; }\n\n# in order to provide the most meaningful crash reports, add the following line:\n-keepattributes SourceFile,LineNumberTable\n# If you are using custom exceptions, add this line so that custom exception types are skipped during obfuscation:\n-keep public class * extends java.lang.Exception\n\n-keep class com.crashlytics.** { *; }\n-dontwarn com.crashlytics.**\n\n# Jackson\n-keep @com.fasterxml.jackson.annotation.JsonIgnoreProperties class * { *; }\n-keep class com.fasterxml.** { *; }\n-keep class org.codehaus.** { *; }\n-keepnames class com.fasterxml.jackson.** { *; }\n-keepclassmembers public final enum com.fasterxml.jackson.annotation.JsonAutoDetect$Visibility {\n    public static final com.fasterxml.jackson.annotation.JsonAutoDetect$Visibility *;\n}\n\n# General\n-keepattributes SourceFile,LineNumberTable,*Annotation*,EnclosingMethod,Signature,Exceptions,InnerClasses\n</code></pre>\n<p><strong>This code is for parcelize plugin</strong></p>\n<pre><code># For enumeration classes, see http://proguard.sourceforge.net/manual/examples.html#enumerations\n    -keepclassmembers enum * {\n        public static **[] values();\n        public static ** valueOf(java.lang.String);\n    }\n    \n    -keep class * implements android.os.Parcelable {\n      public static final android.os.Parcelable$Creator *;\n    }\n    \n    -keepclassmembers class **.R$* {\n        public static &lt;fields&gt;;\n    }\n</code></pre>\n"
        },
        {
          "owner": {
            "user_id": 6750327,
            "display_name": "Hooman"
          },
          "up_vote_count": 1,
          "is_accepted": false,
          "creation_date": 1682942056,
          "answer_id": 76146720,
          "body": "<p>Disable R8 full mode in your gradle.properties</p>\n<pre><code>android.enableR8.fullMode=false\n</code></pre>\n"
        }
      ],
      "owner": {
        "user_id": 4649860,
        "display_name": "Chirag Thummar"
      },
      "view_count": 1082,
      "up_vote_count": 4,
      "answer_count": 3,
      "score": 4,
      "creation_date": 1682081220,
      "question_id": 76073318,
      "body": "<p>I have recently upgraded Android Studio to Flamingo and also upgraded Gradle from 7.4.2 to 8.0.0. All things working fine in version 7.4.2.</p>\n<p>When I generate a signed APK using Gradle 8.0.0, it's giving me a runtime error of <code>java.lang.ClassCastException</code>.</p>\n<p>I have tried many solutions like adding Proguard rules for Retrofit, Okio, OkHttp, etc., but it still give me an error like this.</p>\n<p>Note: When I downgraded from 8.0.0 to 7.4.2, it's working.</p>\n<p>So anyone can help me to find out problem with AGP 8.0.0.</p>\n<p><em><strong>build.gradle(app)</strong></em></p>\n<pre><code>plugins {\n    id 'com.android.application'\n    id 'org.jetbrains.kotlin.android'\n    id 'kotlin-kapt'\n    id 'kotlin-parcelize'\n    id 'com.google.dagger.hilt.android'\n    id 'com.google.gms.google-services'\n    id 'com.google.firebase.crashlytics'\n}\n\n\nandroid {\n    \n    compileSdk 33\n\n    defaultConfig {\n        \n        minSdk 24\n        targetSdk 33\n        versionCode 22\n        versionName &quot;1.0.16&quot;\n        multiDexEnabled true\n\n        testInstrumentationRunner &quot;androidx.test.runner.AndroidJUnitRunner&quot;\n        /*vectorDrawables {\n            useSupportLibrary true\n        }*/\n\n        def localPropertiesFile = rootProject.file(&quot;local.properties&quot;)\n        def localProperties = new Properties()\n        localProperties.load(new FileInputStream(localPropertiesFile))\n        buildConfigField &quot;String&quot;, &quot;API_KEY&quot;, localProperties['API_KEY']\n\n\n\n    }\n\n    \n    buildTypes {\n        release {\n            minifyEnabled true\n            shrinkResources true\n            signingConfig signingConfigs.release\n            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'\n        }\n    }\n    compileOptions {\n        sourceCompatibility JavaVersion.VERSION_17\n        targetCompatibility JavaVersion.VERSION_17\n    }\n    kotlinOptions {\n        jvmTarget = '17'\n    }\n    buildFeatures {\n        compose true\n        viewBinding = true\n    }\n    composeOptions {\n        kotlinCompilerExtensionVersion '1.4.2'\n    }\n    packagingOptions {\n        resources {\n            excludes += '/META-INF/{AL2.0,LGPL2.1}'\n        }\n    }\n    bundle {\n        language {\n            enableSplit = false\n        }\n    }\n}\n\ndependencies {\n\n    implementation 'androidx.core:core-ktx:1.10.0'\n    implementation 'androidx.appcompat:appcompat:1.6.1'\n    implementation 'com.google.android.material:material:1.8.0'\n    implementation 'androidx.constraintlayout:constraintlayout:2.1.4'\n    implementation 'androidx.multidex:multidex:2.0.1'\n\n    \n    implementation 'com.google.accompanist:accompanist-permissions:0.24.11-rc'\n    implementation 'com.google.accompanist:accompanist-webview:0.24.11-rc'\n    implementation 'com.google.accompanist:accompanist-pager:0.24.13-rc'\n    implementation &quot;com.google.accompanist:accompanist-pager-indicators:0.24.13-rc&quot;\n    implementation &quot;com.google.accompanist:accompanist-drawablepainter:0.25.1&quot;\n    implementation &quot;com.google.accompanist:accompanist-flowlayout:0.31.0-alpha&quot;\n\n\n   \n    implementation 'androidx.activity:activity-compose:1.7.1'\n    implementation platform('androidx.compose:compose-bom:2022.10.00')\n    implementation 'androidx.compose.ui:ui'\n    implementation 'androidx.compose.ui:ui-graphics'\n    implementation 'androidx.compose.ui:ui-tooling-preview'\n    implementation 'androidx.compose.material:material'\n//    implementation 'androidx.compose.material3:material3'\n    implementation &quot;androidx.navigation:navigation-compose:2.5.3&quot;\n    implementation 'com.google.firebase:protolite-well-known-types:18.0.0'\n    implementation &quot;androidx.compose.ui:ui-viewbinding&quot;\n    implementation project(path: ':pdfviewer')\n\n  \n    testImplementation 'junit:junit:4.13.2'\n    androidTestImplementation 'androidx.test.ext:junit:1.1.5'\n    androidTestImplementation 'androidx.test.espresso:espresso-core:3.5.1'\n    androidTestImplementation &quot;androidx.compose.ui:ui-test-junit4&quot;\n\n    \n    implementation &quot;com.google.dagger:hilt-android:2.45&quot;\n    debugImplementation &quot;androidx.compose.ui:ui-test-manifest&quot;\n    kapt &quot;com.google.dagger:hilt-compiler:2.45&quot;\n    kapt &quot;androidx.hilt:hilt-compiler:1.0.0&quot;\n    implementation 'androidx.hilt:hilt-navigation-compose:1.0.0'\n\n  \n    implementation &quot;androidx.activity:activity-ktx:1.7.1&quot;\n\n  \n    implementation &quot;androidx.lifecycle:lifecycle-extensions:2.2.0&quot;\n    implementation &quot;androidx.lifecycle:lifecycle-livedata-ktx:2.6.1&quot;\n    implementation &quot;androidx.lifecycle:lifecycle-runtime-ktx:2.6.1&quot;\n    implementation &quot;androidx.lifecycle:lifecycle-viewmodel-ktx:2.6.1&quot;\n    implementation &quot;androidx.lifecycle:lifecycle-process:2.6.1&quot;\n    kapt &quot;androidx.lifecycle:lifecycle-compiler:2.6.1&quot;\n\n    /* *****************************************************\n       **** Retrofit2\n       ****************************************************** */\n    implementation 'com.squareup.retrofit2:retrofit:2.9.0'\n    implementation 'com.squareup.retrofit2:converter-gson:2.9.0'\n    implementation &quot;com.squareup.okhttp3:okhttp:4.9.0&quot;\n    implementation &quot;com.squareup.okhttp3:logging-interceptor:4.9.0&quot;\n    implementation 'com.squareup.retrofit2:converter-moshi:2.9.0'\n\n   \n    implementation 'org.jetbrains.kotlinx:kotlinx-coroutines-core:1.6.4'\n    implementation 'org.jetbrains.kotlinx:kotlinx-coroutines-android:1.6.4'\n\n   \n    implementation &quot;androidx.room:room-runtime:2.5.1&quot;\n    kapt &quot;androidx.room:room-compiler:2.5.1&quot;\n\n    \n    implementation &quot;androidx.room:room-ktx:2.5.1&quot;\n\n   \n    implementation 'androidx.core:core-splashscreen:1.0.1'\n\n    \n    def billing_version = &quot;5.2.0&quot;\n    implementation &quot;com.android.billingclient:billing:$billing_version&quot;\n    implementation &quot;com.android.billingclient:billing-ktx:$billing_version&quot;\n    implementation 'com.google.firebase:firebase-crashlytics-buildtools:2.9.5'\n\n   \n    implementation platform('com.google.firebase:firebase-bom:31.1.0')\n    implementation 'com.google.firebase:firebase-config-ktx'\n    implementation 'com.google.firebase:firebase-analytics-ktx'\n    implementation 'com.google.firebase:firebase-crashlytics-ktx'\n    implementation 'com.google.firebase:firebase-messaging-ktx'\n    implementation 'com.google.android.gms:play-services-ads:22.0.0'\n\n   \n    implementation 'com.airbnb.android:lottie-compose:4.0.0'\n\n\n}\n\nkapt {\n    correctErrorTypes true\n}\n</code></pre>\n<p><strong>Project Gradle File</strong></p>\n<pre><code>buildscript {\n    ext {\n        compose_ui_version = '1.5.0-alpha02'\n        kotlin_version = '1.8.10'\n    }\n        dependencies {\n            // Add this line\n            classpath 'com.google.gms:google-services:4.3.15'\n            classpath 'com.google.firebase:firebase-crashlytics-gradle:2.9.5'\n            classpath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version&quot;\n        }\n    repositories {\n        mavenCentral()\n    }\n}// Top-level build file where you can add configuration options common to all sub-projects/modules.\nplugins {\n    id 'com.android.application' version '8.0.0' apply false\n    id 'com.android.library' version '8.0.0' apply false\n    id 'org.jetbrains.kotlin.android' version '1.8.10' apply false\n    id 'com.google.dagger.hilt.android' version '2.44' apply false\n}\n</code></pre>\n"
    },
    {
      "tags": [
        "java",
        "excel-formula",
        "apache-poi"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 402281,
            "display_name": "Feuermurmel"
          },
          "edited": false,
          "comment_id": 133834872,
          "body": "Welcome to StackOverflow! ðŸ‘‹ I haven&#39;t run into this problem, but it looks to me like a bug/incompatibility of Apache POI. Can add the exception that&#39;s thrown when evaluating the cell, i.e. by adding <code>e. printStackTrace()</code> within the <code>catch</code> clause?"
        },
        {
          "owner": {
            "user_id": 18521060,
            "display_name": "B&#249;i Minh"
          },
          "edited": false,
          "comment_id": 133835072,
          "body": "Thankyou for answer my question, i have try and got more details of problem (updated in the question): <code>org.apache.poi.ss.formula.FormulaParseException: Parse error near char 7 &#39;ã€&#39; in specified formula &#39;SUM(E4,ã€ä¸€æ—¥ã€‘!B2)&#39;. Expected cell ref or constant literal</code>"
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 3915431,
            "display_name": "Axel Richter"
          },
          "up_vote_count": 3,
          "is_accepted": true,
          "creation_date": 1680091847,
          "answer_id": 75877017,
          "body": "<p>This is one of the cases where Microsoft contradicts its own rules. If we look at <a href=\"https://support.microsoft.com/en-us/office/create-or-change-a-cell-reference-c7b8b95d-c594-4488-947e-c835903cebaa\" rel=\"nofollow noreferrer\">Create or change a cell reference</a> -&gt; Create a cell reference to another worksheet, we find:</p>\n<blockquote>\n<p>Note: If the name of the other worksheet contains nonalphabetical\ncharacters, you must enclose the name (or the path) within single\nquotation marks (').</p>\n</blockquote>\n<p>But if the worksheet name is <code>ã€ä¸€æ—¥ã€‘</code> Excel will <em>not</em> enclose the name within single quotation marks ('). Why not? Clearly neither ã€ nor ã€‘are alphabetical characters, are they?</p>\n<p>So Apache POI fails evaluating this, because it relies on the Microsoft rules. See <a href=\"https://svn.apache.org/viewvc/poi/tags/REL_5_2_3/poi/src/main/java/org/apache/poi/ss/formula/FormulaParser.java?view=markup#l1208\" rel=\"nofollow noreferrer\">FormulaParser.java</a> : <code>// unquoted sheet names must start with underscore or a letter</code>.</p>\n<p>You can check this using following test:</p>\n<pre><code>...\n  String formula = cell.getCellFormula();\n  //formula = formula.replace(&quot;ã€ä¸€æ—¥ã€‘&quot;, &quot;'ã€ä¸€æ—¥ã€‘'&quot;); cell.setCellFormula(formula); //set the sheet name to be a quoted sheet name\n  try {\n   System.out.println(&quot;Evaluate formula &quot; + formula + &quot; ...&quot;);\n   //evaluator.evaluateInCell(cell);\n   CellValue cellValue = evaluator.evaluate(cell);\n   System.out.println(&quot;Success! Result: &quot;+ cellValue);\n  } catch (Exception e) {\n   System.out.println(String.format(&quot;Error in the cell: %s, reason: %s&quot;, cell.getAddress(), e.getMessage()));\n  }\n...\n</code></pre>\n<p>If you uncomment the code line:</p>\n<pre><code>  //formula = formula.replace(&quot;ã€ä¸€æ—¥ã€‘&quot;, &quot;'ã€ä¸€æ—¥ã€‘'&quot;); cell.setCellFormula(formula); //set the sheet name to be a quoted sheet name\n</code></pre>\n<p>then formula evaluation should work because the sheet name <code>ã€ä¸€æ—¥ã€‘</code> is quoted now.</p>\n<p>Me tested using current Apache POI version 5.2.3.</p>\n<hr />\n<p>The above is the description of the cause of the issue. It is not a solution. It is not even a workaround. To replace unquoted sheet names with quoted ones one would must know all possible affected sheet names. That's not possible.</p>\n<p>The solution would be that Apache POI changes their code in <a href=\"https://svn.apache.org/viewvc/poi/tags/REL_5_2_3/poi/src/main/java/org/apache/poi/ss/formula/FormulaParser.java\" rel=\"nofollow noreferrer\">FormulaParser.java</a>. Beginning in <a href=\"https://svn.apache.org/viewvc/poi/tags/REL_5_2_3/poi/src/main/java/org/apache/poi/ss/formula/FormulaParser.java?view=markup#l1526\" rel=\"nofollow noreferrer\">private ParseNode parseSimpleFactor()</a>, to <a href=\"https://svn.apache.org/viewvc/poi/tags/REL_5_2_3/poi/src/main/java/org/apache/poi/ss/formula/FormulaParser.java?view=markup#l326\" rel=\"nofollow noreferrer\">private ParseNode parseRangeExpression()</a>, up to <a href=\"https://svn.apache.org/viewvc/poi/tags/REL_5_2_3/poi/src/main/java/org/apache/poi/ss/formula/FormulaParser.java?view=markup#l440\" rel=\"nofollow noreferrer\"> private ParseNode parseRangeable()</a>. But that would need a reliable rule of what sheet names may be unquoted and what must be quoted. But that rule seems not to exist. So: you don't have any chance, use it! ;-).</p>\n"
        }
      ],
      "owner": {
        "user_id": 18521060,
        "display_name": "B&#249;i Minh"
      },
      "view_count": 68,
      "up_vote_count": 4,
      "accepted_answer_id": 75877017,
      "answer_count": 1,
      "score": 4,
      "creation_date": 1680079233,
      "question_id": 75874925,
      "body": "<p>I have a formula in a cell in a sheet as shown.\nThe special thing here is that because the sheet name is written in Japanese, it contains a special character: &quot;ã€&quot;.\nExample:  <a href=\"https://i.stack.imgur.com/x521k.png\" rel=\"nofollow noreferrer\">Formula</a></p>\n<p>When using the &quot;evaluateInCell(cell)&quot; function provided by Apache Poi, it didn't seem to work with that special character.</p>\n<p>The reference code is below.</p>\n<pre><code>case FORMULA: {\n                String formula = cell.getCellFormula();\n                \n                try {\n                    System.out.println(formula +&quot; excute...&quot;);\n                    evaluator.evaluateInCell(cell);\n                    System.out.println(formula+&quot; excute success...&quot;);\n                } catch (Exception e) {\n                    System.out.println(String.format(&quot;Paste the value error in the Cell: %s&quot;, cell.getAddress()) + &quot;   :&quot;);\n\n                    System.out.println(formula+&quot; failed&quot;);\n                }\n                break;\n            }\n</code></pre>\n<p>Example Run result:\n<a href=\"https://i.stack.imgur.com/oC6S3.png\" rel=\"nofollow noreferrer\">Result</a></p>\n<p>I have tried some ways like adding quotes, slashes but it seems to just turn the formula into String.\nHow can I deal with this kind of problem?</p>\n<p>Extra:</p>\n<p>Here the error if not have try...catch (or using e.printStackTrace()):</p>\n<pre><code>org.apache.poi.ss.formula.FormulaParseException: Parse error near char 7 'ã€' in specified formula 'SUM(E4,ã€ä¸€æ—¥ã€‘!B2)'. Expected cell ref or constant literal\n</code></pre>\n<p>I want somehow without affecting the Excel file (Like change name of the sheet by hand) but still can execute the formula in that excel cell and get the result.</p>\n"
    },
    {
      "tags": [
        "java",
        "apache-kafka",
        "spring-kafka"
      ],
      "answers": [
        {
          "owner": {
            "user_id": 9959152,
            "display_name": "Ryuzaki L"
          },
          "up_vote_count": 2,
          "is_accepted": false,
          "creation_date": 1678780070,
          "answer_id": 75730273,
          "body": "<p>The <a href=\"https://kafka.apache.org/10/javadoc/org/apache/kafka/clients/producer/RecordMetadata.html\" rel=\"nofollow noreferrer\">RecordMetadata</a> object is returned on <code>KafkaProducer.send</code> while producing the data into topic</p>\n<blockquote>\n<p>The send() method is asynchronous. When called it adds the record to a buffer of pending record sends and immediately returns. This allows the producer to batch together individual records for efficiency.</p>\n</blockquote>\n<blockquote>\n<p>The producer consists of a pool of buffer space that holds records that haven't yet been transmitted to the server as well as a background I/O thread that is responsible for turning these records into requests and transmitting them to the cluster. Failure to close the producer after use will leak these resources.</p>\n</blockquote>\n<p>Since the <code>send</code> method returns <code>Future&lt;RecordMetadata&gt;</code> and result of every record is executed my asynchronous thread, you can add <a href=\"https://kafka.apache.org/10/javadoc/org/apache/kafka/clients/producer/KafkaProducer.html#send-org.apache.kafka.clients.producer.ProducerRecord-org.apache.kafka.clients.producer.Callback-\" rel=\"nofollow noreferrer\">call back</a> to print the <code>offset</code>, <code>partition</code> and record information or the exception on failure</p>\n<pre><code>  ProducerRecord&lt;byte[],byte[]&gt; record = new \n  ProducerRecord&lt;byte[],byte[]&gt;(&quot;the-topic&quot;, key, value);\n  producer.send(myRecord,\n           new Callback() {\n               public void onCompletion(RecordMetadata metadata, Exception e) {\n                   if(e != null) {\n                      e.printStackTrace();\n                   } else {\n                      System.out.println(&quot;The offset of the record we just sent is: &quot; + metadata.offset());\n                   }\n               }\n           });\n</code></pre>\n<p><strong>Note :</strong> While producing the record into Kafka topic, due to the asynchronous mechanism the thread invoking <code>send</code> method will be different than the threads executing the <code>Future&lt;RecordMetadata&gt;</code> result.</p>\n"
        },
        {
          "owner": {
            "user_id": 1240763,
            "display_name": "Gary Russell"
          },
          "up_vote_count": 1,
          "is_accepted": true,
          "creation_date": 1678799627,
          "answer_id": 75733618,
          "body": "<p>As the other answer says, <code>RecordMetadata</code> is created on the producer side.</p>\n<p>If you are talking about <code>ConsumerRecordMetadata</code> (a Spring concept), it is not intended for use when you consume the raw <code>ConsumerRecord</code>; it is used when you have a POJO listener (for just the <code>value()</code>) but you still want to obtain metadata.</p>\n"
        }
      ],
      "owner": {
        "user_id": 21386865,
        "display_name": "Pauls Baby"
      },
      "view_count": 124,
      "up_vote_count": 4,
      "accepted_answer_id": 75733618,
      "answer_count": 2,
      "score": 4,
      "creation_date": 1678777372,
      "question_id": 75729969,
      "body": "<p>What is advantage of using RecordMetadata to get topic, partition etc rather than taking it from consumer record itself if those are available in it?</p>\n<p>I was able to get topic, partition etc using corresponding methods from consumer record itself like:</p>\n<pre><code>consumerRecord.topic()\n</code></pre>\n<p>Then what is the advantage of RecordMetadata to obtain these?</p>\n<p>Are there any performance improvements for that?</p>\n"
    },
    {
      "tags": [
        "java",
        "javafx"
      ],
      "comments": [
        {
          "owner": {
            "user_id": 203657,
            "display_name": "kleopatra"
          },
          "edited": false,
          "comment_id": 132872332,
          "body": "nothing off the shelf, afaik"
        },
        {
          "owner": {
            "user_id": 2189127,
            "display_name": "James_D"
          },
          "edited": false,
          "comment_id": 132873330,
          "body": "What&#39;s the concern about &quot;scaling to many tables&quot;? Is it just the amount of code? It isn&#39;t too hard to factor the listeners on the selection models into a separate class and make a straightforward method call to set up the &quot;multiway select&quot;."
        },
        {
          "owner": {
            "user_id": 260203,
            "display_name": "Brad K."
          },
          "edited": false,
          "comment_id": 132874288,
          "body": "The fact that the programmer creating each of those listeners would have to ensure that they abide by the soft &quot;contract&quot; to not manipulate any selection models when another selection model is executing."
        }
      ],
      "answers": [
        {
          "owner": {
            "user_id": 2189127,
            "display_name": "James_D"
          },
          "up_vote_count": 3,
          "is_accepted": true,
          "creation_date": 1675193149,
          "answer_id": 75302205,
          "body": "<p>I don't think there is a fundamentally simpler way of doing what you're already doing. You can refactor this though in a way that might be more &quot;scalable&quot;:</p>\n<pre><code>public class SelectionManager {\n    private boolean selecting ;\n    private &lt;S,T&gt; void setUpMultiSelection(TableView&lt;S&gt; firstTable, TableView&lt;T&gt; secondTable, BiPredicate&lt;S,T&gt; shouldSelect) {\n        firstTable.getSelectionModel().getSelectedItems().addListener((Change&lt;? extends S&gt; c) -&gt; {\n            if (selecting) return;\n            selecting = true ;\n            secondTable.getSelectionModel().clearSelection();\n            for (T t : secondTable.getItems()) {\n                for (S s : firstTable.getSelectionModel().getSelectedItems()) {\n                    if (shouldSelect.test(s, t)) {\n                        secondTable.getSelectionModel().select(t);\n                    }\n                }\n            }\n            selecting = false;\n        });\n        secondTable.getSelectionModel().getSelectedItems().addListener((Change&lt;? extends T&gt; c) -&gt; {\n            if (selecting) return ;\n            selecting = true;\n            firstTable.getSelectionModel().clearSelection();\n            for (S s : firstTable.getItems()) {\n                for (T t : secondTable.getSelectionModel().getSelectedItems()) {\n                    if (shouldSelect.test(s, t)) {\n                        firstTable.getSelectionModel().select(s);\n                    }\n                }\n            }\n            selecting = false;\n        });\n    }\n}\n</code></pre>\n<p>and then</p>\n<pre><code>    private Region buildView() {\n        TableView&lt;Part&gt; partsTable = setupPartsTableView();\n        TableView&lt;Assembly&gt; assembliesTable = setupAssembliesTableView();\n//        assembliesTable.getSelectionModel().getSelectedItems().addListener(new ListChangeListener&lt;Assembly&gt;() {\n//            @Override\n//            public void onChanged(Change&lt;? extends Assembly&gt; c) {\n//                if (!selecting) {\n//                    selecting = true;\n//\n//                    TableViewSelectionModel&lt;Part&gt; sm = partsTable.getSelectionModel();\n//                    sm.clearSelection();\n//                    for (Assembly a : c.getList()) {\n//                        for (Part p : a.partsProperty()) {\n//                            sm.select(p);\n//                        }\n//                    }\n//                    selecting = false;\n//                }\n//\n//            }\n//        });\n//\n//        partsTable.getSelectionModel().getSelectedItems().addListener(new ListChangeListener&lt;Part&gt;() {\n//            @Override\n//            public void onChanged(Change&lt;? extends Part&gt; c) {\n//                if (!selecting) {\n//                    selecting = true;\n//                    TableViewSelectionModel&lt;Assembly&gt; sm = assembliesTable.getSelectionModel();\n//                    sm.clearSelection();\n//                    for (Part p : c.getList()) {\n//                        for (Assembly a : assemblies) {\n//                            if (a.partsProperty().contains(p)) {\n//                                sm.select(a);\n//                            }\n//                        }\n//                    }\n//                    selecting = false;\n//                }\n//            }\n//        });\n        SelectionManager selectionManager = new SelectionManager();\n        selectionManager.setUpMultiSelection(assembliesTable, partsTable,\n                (assembly, part) -&gt; assembly.partsProperty().contains(part)\n        );\n\n        return new SplitPane(assembliesTable, partsTable);\n    }\n</code></pre>\n<p>The point to note here is that if you use the same instance of <code>SelectionManager</code> for multiple &quot;multi-selections&quot;, it will use the same mutex. On the other hand, a different <code>SelectionManager</code> instance will have its own mutex. This (or some variation on it) should enable you to fairly easily configure this over many tables in any way you need.</p>\n"
        }
      ],
      "owner": {
        "user_id": 260203,
        "display_name": "Brad K."
      },
      "view_count": 46,
      "up_vote_count": 4,
      "accepted_answer_id": 75302205,
      "answer_count": 1,
      "score": 4,
      "creation_date": 1675181046,
      "question_id": 75299857,
      "body": "<p>I need to perform a multiway selection among multiple JavaFX <code>TableView</code>s such that when selecting one or more rows in one <code>TableView</code>, all other <code>TableView</code>s with related information will also be selected/highlighted (actually, highlighting is more appropriate, but selection is built-in, so...)</p>\n<p>I've come up with a slighly janky method, but it doesn't really scale very well to many <code>TableView</code>s.</p>\n<pre><code>package multiwayselect;\n\nimport javafx.application.*;\nimport javafx.beans.property.*;\nimport javafx.collections.ListChangeListener.Change;\nimport javafx.collections.*;\nimport javafx.scene.*;\nimport javafx.scene.control.*;\nimport javafx.scene.control.TableView.TableViewSelectionModel;\nimport javafx.scene.layout.*;\nimport javafx.stage.*;\n\npublic class MultiwaySelectDemo extends Application {\n\n    private final ObservableList&lt;Part&gt; parts = FXCollections.observableArrayList();\n    private final ObservableList&lt;Assembly&gt; assemblies = FXCollections.observableArrayList();\n\n    public static void main(String[] args) {\n        launch(args);\n    }\n\n    @Override\n    public void start(Stage stage) throws Exception {\n        buildModel();\n        stage.setTitle(&quot;multi-way selection demo&quot;);\n        final Region root = buildView();\n        stage.setScene(new Scene(root));\n        stage.show();\n    }\n\n    private void buildModel() {\n        Part cpu = new Part(1, &quot;CPU Ryzen 5&quot;);\n        Part ram8 = new Part(2, &quot;RAM 8GB DDR4 (1x8GB)&quot;);\n        Part ram16 = new Part(5, &quot;RAM 16GB DDR4 (2x8GB)&quot;);\n        Part mobo1 = new Part(3, &quot;MOBO ATX B550&quot;);\n        Part mobo2 = new Part(7, &quot;MOBO ATX X570 RGB&quot;);\n        Part chassis = new Part(4, &quot;CASE Standard ATX Case&quot;);\n        Part chassis1 = new Part(8, &quot;CASE Gamer ATX Case w/RGB&quot;);\n        Assembly basicBox = new Assembly(1, &quot;Basic AMD Box&quot;, cpu, ram8, mobo1, chassis);\n        Assembly gamerBox = new Assembly(2, &quot;Gamer AMD Box&quot;, cpu, ram16, mobo2, chassis1);\n        assemblies.addAll(basicBox, gamerBox);\n        for (Assembly a : assemblies) {\n            for (Part p : a.parts) {\n                if (!parts.contains(p)) {\n                    parts.add(p);\n                }\n            }\n        }\n    }\n\n    private boolean selecting = false;\n\n    private Region buildView() {\n        TableView&lt;Part&gt; partsTable = setupPartsTableView();\n        TableView&lt;Assembly&gt; assembliesTable = setupAssembliesTableView();\n        assembliesTable.getSelectionModel().getSelectedItems().addListener(new ListChangeListener&lt;Assembly&gt;() {\n            @Override\n            public void onChanged(Change&lt;? extends Assembly&gt; c) {\n                if (!selecting) {\n                    selecting = true;\n\n                    TableViewSelectionModel&lt;Part&gt; sm = partsTable.getSelectionModel();\n                    sm.clearSelection();\n                    for (Assembly a : c.getList()) {\n                        for (Part p : a.partsProperty()) {\n                            sm.select(p);\n                        }\n                    }\n                    selecting = false;\n                }\n\n            }\n        });\n\n        partsTable.getSelectionModel().getSelectedItems().addListener(new ListChangeListener&lt;Part&gt;() {\n            @Override\n            public void onChanged(Change&lt;? extends Part&gt; c) {\n                if (!selecting) {\n                    selecting = true;\n                    TableViewSelectionModel&lt;Assembly&gt; sm = assembliesTable.getSelectionModel();\n                    sm.clearSelection();\n                    for (Part p : c.getList()) {\n                        for (Assembly a : assemblies) {\n                            if (a.partsProperty().contains(p)) {\n                                sm.select(a);\n                            }\n                        }\n                    }\n                    selecting = false;\n                }\n            }\n        });\n        return new SplitPane(assembliesTable, partsTable);\n    }\n\n    private TableView setupAssembliesTableView() {\n        final TableView tableView = new TableView(assemblies);\n        tableView.getSelectionModel().setSelectionMode(SelectionMode.MULTIPLE);\n\n        final TableColumn&lt;Assembly, Integer&gt; idColumn = new TableColumn&lt;&gt;(&quot;id&quot;);\n        idColumn.setCellValueFactory(cell -&gt; cell.getValue().idProperty());\n\n        final TableColumn&lt;Assembly, String&gt; nameColumn = new TableColumn&lt;&gt;(&quot;name&quot;);\n        nameColumn.setCellValueFactory(cell -&gt; cell.getValue().nameProperty());\n\n        tableView.getColumns().addAll(idColumn, nameColumn);\n        return tableView;\n    }\n\n    private TableView setupPartsTableView() {\n        final TableView tableView = new TableView(parts);\n        tableView.getSelectionModel().setSelectionMode(SelectionMode.MULTIPLE);\n\n        final TableColumn&lt;Part, Integer&gt; idColumn = new TableColumn&lt;&gt;(&quot;id&quot;);\n        idColumn.setCellValueFactory(cell -&gt; cell.getValue().idProperty());\n\n        final TableColumn&lt;Part, String&gt; nameColumn = new TableColumn&lt;&gt;(&quot;name&quot;);\n        nameColumn.setCellValueFactory(cell -&gt; cell.getValue().nameProperty());\n\n        tableView.getColumns().addAll(idColumn, nameColumn);\n\n        return tableView;\n    }\n\n    public static class Part {\n\n        private ObjectProperty&lt;Integer&gt; id;\n        private StringProperty name;\n\n        public Part(int newId, String newName) {\n            this.id = new SimpleObjectProperty&lt;&gt;();\n            this.name = new SimpleStringProperty();\n            setId(newId);\n            setName(newName);\n        }\n\n        public final ObjectProperty&lt;Integer&gt; idProperty() {\n            return this.id;\n        }\n\n        public final void setId(int newValue) {\n            idProperty().set(newValue);\n        }\n\n        public final int getId() {\n            return idProperty().get();\n        }\n\n        public final StringProperty nameProperty() {\n            return this.name;\n        }\n\n        public final void setName(String newValue) {\n            nameProperty().set(newValue);\n        }\n\n        public final String getName() {\n            return nameProperty().get();\n        }\n    }\n\n    public static class Assembly {\n\n        private ObjectProperty&lt;Integer&gt; id;\n        private StringProperty name;\n        private ObservableList&lt;Part&gt; parts;\n\n        public Assembly(int newId, String newName, Part... newParts) {\n            id = new SimpleObjectProperty&lt;&gt;();\n            name = new SimpleStringProperty();\n            parts = FXCollections.observableArrayList();\n            setId(newId);\n            setName(newName);\n            parts.setAll(newParts);\n        }\n\n        public final ObjectProperty&lt;Integer&gt; idProperty() {\n            return id;\n        }\n\n        public final void setId(int newId) {\n            idProperty().set(newId);\n        }\n\n        public final int getId() {\n            return idProperty().get();\n        }\n\n        public final StringProperty nameProperty() {\n            return name;\n        }\n\n        public final void setName(String newValue) {\n            nameProperty().set(newValue);\n        }\n\n        public final String getName() {\n            return nameProperty().get();\n        }\n\n        public final ObservableList&lt;Part&gt; partsProperty() {\n            return parts;\n        }\n    }\n\n}\n</code></pre>\n<p>Basically <code>selecting</code> puts up an &quot;in selection mode&quot; mutex; without it, the two listeners eat up the stack.</p>\n<p>What's a better way to do this that (a) scales out to many <code>TableView</code>s and/or (b) is more idiomatic of JavaFX or (c) is just plain better? (Note: currently working with Java 8/JavaFX 8 but will take solutions in higher versions.) Also, will take any feedback on different ways to represent the data that better fits the JavaFX idiom.</p>\n"
    }
  ],
  "has_more": true,
  "quota_max": 300,
  "quota_remaining": 186
}