{"items":[{"tags":["java","hibernate","spring-data-jpa"],"comments":[{"owner":{"user_id":12907709,"display_name":"BANTYC"},"edited":false,"comment_id":133484456,"body":"UPD: changing bulk save to <code>factions.forEach(factionRepository::save);</code> made saving longer but there are at least all entries present. However I still have no idea why bulk save works this way"},{"owner":{"user_id":12907709,"display_name":"BANTYC"},"edited":false,"comment_id":133515367,"body":"This way stopped working today. Now storing 49208/77832"},{"owner":{"user_id":256196,"display_name":"Bohemian"},"edited":false,"comment_id":133527133,"body":"Try changing <code>peek(faction -&gt;{XXX})</code> to  <code>map(faction -&gt; {XXX; return faction;})</code>"},{"owner":{"user_id":12907709,"display_name":"BANTYC"},"edited":false,"comment_id":133528092,"body":"@Bohemian, already changed to that way and no result"},{"owner":{"user_id":7036419,"display_name":"Maurice Perry"},"edited":false,"comment_id":133576044,"body":"I see that the list is converted into a set. Could it be that by removing duplicates, the set gets shorter that the list?"}],"answers":[{"owner":{"user_id":8041003,"display_name":"John Williams"},"up_vote_count":2,"is_accepted":false,"creation_date":1678392263,"answer_id":75689524,"body":"<p>The faction.name values contain duplicates. The name column is unique so only the unique names remain. Test it by doing the following immediately before the save.</p>\n<pre><code>var uniqueFactionByName = factions.stream()\n                                     .map(faction -&gt; faction.name)\n                                     .collect(Collectors.toSet())\nSystem.out.println(uniqueFactionByName.size());\n</code></pre>\n"},{"owner":{"user_id":12473843,"display_name":"Sergey Tsypanov"},"up_vote_count":1,"is_accepted":true,"creation_date":1678691579,"answer_id":75718918,"body":"<blockquote>\n<p>changing bulk save to <code>factions.forEach(factionRepository::save);</code> made saving longer but there are at least all entries present. However I still have no idea why bulk save works this way</p>\n</blockquote>\n<p>This works because your business method is not annotated with <code>@Transactional</code> and thus you now save each <code>Faction</code> object in a separate transaction. See the code of <code>SimpleJpaRepository</code> encapsulating the basic functionality for Spring Data's <code>JpaRepository</code>:</p>\n<pre class=\"lang-java prettyprint-override\"><code>//one transaction for all items\n@Transactional\npublic &lt;S extends T&gt; List&lt;S&gt; saveAll(Iterable&lt;S&gt; entities) {\n    Assert.notNull(entities, &quot;Entities must not be null!&quot;);\n    List&lt;S&gt; result = new ArrayList();\n    Iterator var3 = entities.iterator();\n\n    while(var3.hasNext()) {\n        S entity = var3.next();\n        result.add(this.save(entity));\n    }\n\n    return result;\n}\n\n//a separate transaction for each item\n@Transactional\npublic &lt;S extends T&gt; S save(S entity) {\n    Assert.notNull(entity, &quot;Entity must not be null.&quot;);\n    if (this.entityInformation.isNew(entity)) {\n        this.em.persist(entity);\n        return entity;\n    } else {\n        return this.em.merge(entity);\n    }\n}\n</code></pre>\n<p>As you see <code>JpaRepository.saveAll()</code> just calls <code>JpaRepository.save()</code> in a loop, so the logic is the same but the only difference is about having 1 transaction instead of n.</p>\n<p>Now, why some of the items are lost. The cause is <code>@GeneratedValue(strategy = GenerationType.IDENTITY)</code> which is not supported by PostgreSQL, see <a href=\"https://vladmihalcea.com/hibernate-identity-sequence-and-table-sequence-generator/\" rel=\"nofollow noreferrer\">https://vladmihalcea.com/hibernate-identity-sequence-and-table-sequence-generator/</a>.</p>\n<p>With <code>GenerationType.IDENTITY</code> you insert a row into your table without ID and your DBMS assigns it automatically, so you have no control over it. If DBMS for some reason detects two rows as duplicated within one and the same transaction it might squash them into one and I suspect this is what happens in this case.</p>\n<p>I suggest you to use sequence for primary key generation, this would solve your problem. If sequence cannot be applied in your case then try to split entire collection of saved <code>Faction</code> objects into smaller chunks, e.g. of size 500, something like:</p>\n<pre class=\"lang-java prettyprint-override\"><code>Lists.partition(factions, 500)\n  .stream()\n  .map(factionRepository::saveAll)\n  .flatMap(List::stream)\n  .map(factionMapper::toDto)\n  .toList();\n</code></pre>\n<p>You'll still have <code>n/500</code> transactions instead of 1, but this could help. The correct solution, however, is to use sequence.</p>\n"},{"owner":{"user_id":412446,"display_name":"Christian Beikov"},"up_vote_count":2,"is_accepted":false,"creation_date":1678696362,"answer_id":75719520,"body":"<p>I guess you didn't implement <code>FactionRepository.saveAll</code> yourself but rely on the Spring Data default? Spring Data doesn't know if <code>save</code> should map to <code>persist</code> or <code>merge</code>, so it tries to understand what to do by looking at the entity e.g. if the entity has a PK set, it will assume <code>merge</code>. I don't know if the version you are using has some other strategies to determine this, but I think that could be the source of your problem.</p>\n<p>Are you certain that the objects do not contain a value for the id attribute i.e. <code>factions.stream().noneMatch(f -&gt; f.getId() != null)</code>?</p>\n<p>With all that DTO transformation code though, it's hard to see what's going on. I also guess that you just posted an excerpt and not the actual code? So there are further possibly mismatches which makes it hard for us to help you, as the bug could lie somewhere in the code you are not showing.</p>\n<p>Either way, I think this is a perfect use case for <a href=\"https://github.com/Blazebit/blaze-persistence#entity-view-usage\" rel=\"nofollow noreferrer\">Blaze-Persistence Entity Views</a>.</p>\n<p>I created the library to allow easy mapping between JPA models and custom interface or abstract class defined models, something like Spring Data Projections on steroids. The idea is that you define your target structure(domain model) the way you like and map attributes(getters) via JPQL expressions to the entity model.</p>\n<p>A DTO model for your use case could look like the following with Blaze-Persistence Entity-Views:</p>\n<pre><code>@EntityView(Faction.class)\n@CreatableEntityView\npublic interface FactionDto {\n    @IdMapping\n    Long getId();\n    String getName();\n    void setName(String name);\n    Boolean getIsPlayerFaction();\n    void setIsPlayerFaction(Boolean isPlayerFaction);\n    GovernmentDto getGovernment();\n    void setGovernment(GovernmentDto government);\n    AllegianceDto getAllegiance();\n    void setAllegiance(AllegianceDto allegiance);\n\n    @EntityView(Allegiance.class)\n    @CreatableEntityView\n    interface AllegianceDto {\n        @IdMapping\n        Long getId();\n        String getName();\n        void setName(String name);\n    }\n\n    @EntityView(Government.class)\n    @CreatableEntityView\n    interface GovernmentDto {\n        @IdMapping\n        Long getId();\n        String getName();\n        void setName(String name);\n    }\n}\n</code></pre>\n<p>Querying is a matter of applying the entity view to a query, the simplest being just a query by id.</p>\n<p><code>FactionDto a = entityViewManager.find(entityManager, FactionDto.class, id);</code></p>\n<p>The Spring Data integration allows you to use it almost like Spring Data Projections: <a href=\"https://persistence.blazebit.com/documentation/entity-view/manual/en_US/index.html#spring-data-features\" rel=\"nofollow noreferrer\">https://persistence.blazebit.com/documentation/entity-view/manual/en_US/index.html#spring-data-features</a></p>\n<pre><code>Page&lt;FactionDto&gt; findAll(Pageable pageable);\n</code></pre>\n<p>The best part is, it will only fetch the state that is actually necessary!</p>\n<p>Saving is also supported and as simple as defining and using this method in a repository:</p>\n<pre><code>void saveAll(List&lt;FactionDto&gt; dtos);\n</code></pre>\n"}],"owner":{"user_id":12907709,"display_name":"BANTYC"},"view_count":189,"up_vote_count":2,"accepted_answer_id":75718918,"answer_count":3,"score":2,"creation_date":1678199501,"question_id":75663296,"body":"<p>when I'm trying to save big list of entities (77832 elements) in PostgreSQL. But after performing &quot;saveAll&quot; method there are only 49207 entries in table (table was empty before adding items). According to debugger list size doesn't change. During saving data there are no errors in application and database log.</p>\n<p>Here is entity classes:</p>\n<pre><code>@Getter\n@Setter\n@Entity\n@Table(name = &quot;faction&quot;)\n@NoArgsConstructor\n@AllArgsConstructor\npublic class Faction {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n\n    @Column(name = &quot;name&quot;, unique = true, nullable = false)\n    private String name;\n\n    @ManyToOne(cascade = CascadeType.MERGE, optional = false)\n    @JoinColumn(name = &quot;allegiance_id&quot;, nullable = false)\n    private Allegiance allegiance;\n\n    @ManyToOne(cascade = CascadeType.MERGE, optional = false)\n    @JoinColumn(name = &quot;government_id&quot;, nullable = false)\n    private Government government;\n\n    @Column(name = &quot;is_player_faction&quot;, nullable = false)\n    private Boolean isPlayerFaction;\n}\n</code></pre>\n<pre><code>@Entity\n@Table(name = &quot;allegiance&quot;)\n@Getter\n@Setter\n@ToString\n@NoArgsConstructor\n@AllArgsConstructor\npublic class Allegiance {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n\n    @Column(name = &quot;name&quot;, unique = true, nullable = false)\n    private String name;\n}\n</code></pre>\n<p>And method which implements saving data logic:</p>\n<pre><code>public List&lt;FactionDto&gt; saveFactions(List&lt;FactionDto&gt; factionDtos) {\n        var factions = factionDtos.stream()\n                                  .map(factionMapper::toEntity)\n                                  .toList();\n\n        var governments = factionDtos.stream()\n                                     .map(FactionDto::getGovernment)\n                                     .collect(Collectors.toSet())\n                                     .stream()\n                                     .map(item -&gt; new Government(null, item.getName()))\n                                     .collect(Collectors.toSet());\n        Map&lt;String, Government&gt; governmentMap = governmentRepository\n                .saveAll(governments)\n                .stream()\n                .collect(Collectors.toMap(Government::getName, item -&gt; item));\n\n        var allegiances = factionDtos.stream()\n                                     .map(FactionDto::getAllegiance)\n                                     .collect(Collectors.toSet())\n                                     .stream()\n                                     .map(item -&gt; new Allegiance(null, item.getName()))\n                                     .collect(Collectors.toSet());\n        Map&lt;String, Allegiance&gt; allegianceMap = allegianceRepository\n                .saveAll(allegiances)\n                .stream()\n                .collect(Collectors.toMap(Allegiance::getName, allegiance -&gt; allegiance));\n\n        factions = factions.stream()\n                           .peek(faction -&gt; {\n                               var allegiance = allegianceMap.get(faction.getAllegiance().getName());\n                               faction.setAllegiance(allegiance);\n                               var government = governmentMap.get(faction.getGovernment().getName());\n                               faction.setGovernment(government);\n                           })\n                           .collect(Collectors.toList());\n\n\n        return factionRepository.saveAll(factions).stream()\n                                .map(factionMapper::toDto)\n                                .toList();\n    }\n</code></pre>\n<p>Debugger shows there are exactly 77832 elements in collection passed for saving. There are no duplicates</p>\n<p><a href=\"https://i.stack.imgur.com/cE6Em.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cE6Em.png\" alt=\"enter image description here\" /></a></p>\n<p>In my opinion there are should be same number of entries created or at least error message if there are conflicts</p>\n"},{"tags":["java","javacc"],"answers":[{"owner":{"user_id":7036419,"display_name":"Maurice Perry"},"up_vote_count":2,"is_accepted":false,"creation_date":1678191584,"answer_id":75661897,"body":"<p>Let's say you have the following <code>parser.jj</code> file:</p>\n<pre><code>options {\n    STATIC = false;\n    IGNORE_CASE = false;\n}\n\nPARSER_BEGIN(Parser)\npackage test14;\npublic class Parser {\n}\nPARSER_END(Parser)\n\nTOKEN:\n{\n  &lt;EVEN: ([&quot;0&quot;-&quot;9&quot;])* (&quot;0&quot;|&quot;2&quot;|&quot;4&quot;|&quot;6&quot;|&quot;8&quot;) &gt;\n}\n\nvoid llamarNumeroPar (): \n{}\n{\n  &lt; EVEN &gt; {System.out.println (&quot;soy un numeroPar&quot;);}\n}\n</code></pre>\n<p>You can now write a main class:</p>\n<pre><code>package test14;\n\nimport java.io.StringReader;\n\npublic class Test14 {\n    public static void main(String[] args) {\n        Parser parser = new Parser(new StringReader(&quot;1234567&quot;));\n        Token token = parser.getNextToken();\n        if (token.kind == Parser.EVEN) {\n            System.out.println(&quot;Even&quot;);\n        } else {\n            System.out.println(&quot;Something else&quot;);\n        }\n    }\n}\n</code></pre>\n<p>And... surprise: the output is &quot;Even&quot;. This is because it has read &quot;123456&quot; which is indeed an even number.</p>\n<p>Now add a second token <code>ODD</code>:</p>\n<pre><code>TOKEN:\n{\n  &lt;EVEN: ([&quot;0&quot;-&quot;9&quot;])* (&quot;0&quot;|&quot;2&quot;|&quot;4&quot;|&quot;6&quot;|&quot;8&quot;) &gt;\n|  &lt;ODD: ([&quot;0&quot;-&quot;9&quot;])* (&quot;1&quot;|&quot;3&quot;|&quot;5&quot;|&quot;7&quot;|&quot;9&quot;) &gt;\n}\n</code></pre>\n<p>And modify the main class as follows:</p>\n<pre><code>    if (token.kind == Parser.EVEN) {\n        System.out.println(&quot;Even: &quot; + token.image);\n    } else if (token.kind == Parser.ODD) {\n        System.out.println(&quot;Odd: &quot; + token.image);\n    } else {\n        System.out.println(&quot;Something else: &quot; + token.image);\n    }\n</code></pre>\n<p>This time, the output is as expected:</p>\n<pre><code>Odd: 1234567\n</code></pre>\n<p>Consider defining a token <code>NUMBER</code> and dealing with its parity in the Java code.</p>\n"},{"owner":{"user_id":667690,"display_name":"Theodore Norvell"},"up_vote_count":2,"is_accepted":false,"creation_date":1678207737,"answer_id":75664916,"body":"<p>Maurice's answer is excellent.  I'm going to come at it from a slightly different angle by answering a slightly broader question.</p>\n<p>I don't think it makes a lot of sense to test one token definition at a time. This is because the tricky part of writing token managers is usually not the individual regular expressions, but rather the interactions between them, especially when there are multiple states.  So the broader question is how to test a token manager as a whole.</p>\n<p>I think something like the following could be quite useful.</p>\n<pre><code>import your.favourite.test.framework ;\n\nclass TokenTests implements XYZConstants {\n\n    private final int TME = -99 ; // -99 because this should not be already in use as a token kind.\n\n    private void doOneTokenTest( String input, int[] expectation ) {\n        XYZ parser = new XYZ(new StringReader(input));\n        for( int k = 0 ; k &lt; expectation.length; ++k ) {\n            int state = parser.token_source.curLexState ;\n            try {\n                Token token = parser.getNextToken();\n                checkThat( expectation[k] != TME,\n                       &quot;Expected a TokenMgrErr, but got a&quot; +\n                       tokenImage[ token.kind ] + &quot; at token &quot; +\n                       k + &quot; of input &lt;&lt;&quot; + input + &quot;&gt;&gt;&quot; +\n                       &quot; state is &quot; + state ) ;\n                checkThat( token.kind == expectation[k],\n                       &quot;Expected a &quot; +\n                       tokenImage[ expectation[k] ] +\n                       &quot; but got a &quot; +\n                       tokenImage[ token.kind ] + &quot; at token &quot; +\n                       k + &quot; of input &lt;&lt;&quot; + input + &quot;&gt;&gt;&quot; +\n                       &quot; state is &quot; + state ) ;\n            } catch( TokenMgrErr e ) {\n                checkThat( expectation[k] == TME,\n                       &quot;Expected a &quot; +\n                       tokenImage[ expectation[k] ] +\n                       &quot; but got a TokenMgrErr at token &quot; +\n                       k + &quot; of input &lt;&lt;&quot; + input + &quot;&gt;&gt;&quot; +\n                       &quot; state is &quot; + state ) ; } } }\n</code></pre>\n<p>So now you can create and run a bunch of tests</p>\n<pre><code>    @Test\n    public void testTokenMatching() {\n        record Pair( String input, int[] expectation ) ;\n        Pair[] tests = {\n            new Pair( &quot;1234&quot;, int[]{ EVEN, EOF } ),\n            new Pair( &quot;1233&quot;, int[]{ ODD, EOF } ),\n            new Pair( &quot;&quot;. int[] { EOF },\n            new Pair( &quot;123.3&quot;, int[]{ ODD, TME } } ;\n        for( Pair t : tests ) {\n            doOneTokenTest( t.input(), t.expectation() ) ; } }\n</code></pre>\n"}],"owner":{"user_id":9249569,"display_name":"Avalon"},"view_count":94,"up_vote_count":2,"answer_count":2,"score":2,"creation_date":1678167309,"question_id":75658361,"body":"<p>I want to create a token that accepts only even numbers, and I need to test it in javacc, I'm just starting to use it and I can't think of any way to test this token, can anyone help me, thanks!</p>\n<pre><code>TOKEN: //I want this token to only accept even numbers\n{\n  &lt;TOKENPARANUMEROSPARES: ([&quot;0&quot;-&quot;9&quot;])* (&quot;0&quot;|&quot;2&quot;|&quot;4&quot;|&quot;6&quot;|&quot;8&quot;) &gt; {System.out.println(&quot;Soy un numero par&quot;);}\n}\n\nvoid llamarNumeroPar (): \n{}\n{\n//I want my program to be able to launch a message from my main with the message shown below\n  &lt; TOKENPARANUMEROSPARES &gt; {System.out.println (&quot;soy un numeroPar&quot;);}\n}\n</code></pre>\n<p>To print something, what do you recommend? Do I do it from the main or what could I correct in this part of my code?</p>\n"},{"tags":["java","spring","spring-boot","rest","spring-mvc"],"comments":[{"owner":{"user_id":836018,"display_name":"Jack"},"edited":false,"comment_id":133371855,"body":"I would if I get the confirmation about the last points that I have been trying to ask for hours."}],"answers":[{"owner":{"user_id":639520,"display_name":"E-Riz"},"up_vote_count":2,"is_accepted":false,"creation_date":1677595876,"answer_id":75593636,"body":"<p>A 204 (No Content) response should not include a body; &quot;No Content&quot; means <em>no content</em>. 204 is pretty standard for a DELETE response (when it succeeds of course), but I also see 200 OK.</p>\n<p>For PUT requests that succeed, it's typical to return a 200 response status with the updated resource (entity, etc) as the body. That saves clients from making another round-trip GET to the server to get the updated resource.</p>\n<p>By the way, Spring provides an annotation to specify the response status code so you don't have to be so verbose in the code. For example:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@DeleteMapping(&quot;/categories/{id}&quot;)\n@ResponseStatus(value = HttpStatus.NO_CONTENT)\npublic void deleteById(@PathVariable long id) {\n    categoryService.deleteById(id);\n}\n</code></pre>\n"},{"owner":{"user_id":8264132,"display_name":"Tayyab Munir"},"up_vote_count":2,"is_accepted":false,"creation_date":1677596219,"answer_id":75593693,"body":"<p>For PUT</p>\n<ul>\n<li>HTTP status 201 if the entry does not exist and is created</li>\n<li>HTTP status 200 or HTTP status 204 if entry exists and is updated</li>\n</ul>\n<p>For DELETE</p>\n<ul>\n<li>HTTP status 200</li>\n</ul>\n<p>visit   <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/PUT\" rel=\"nofollow noreferrer\">Mozilla docs</a> for further details</p>\n"},{"owner":{"user_id":7237884,"display_name":"Panagiotis Bougioukos"},"up_vote_count":1,"is_accepted":true,"creation_date":1677596733,"answer_id":75593791,"body":"<p>As described in <a href=\"https://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.6\" rel=\"nofollow noreferrer\">Http Protocol RFC 2616</a></p>\n<blockquote>\n<p><strong>9.6 PUT</strong></p>\n<p>If an existing resource is modified, either the 200 (OK) or 204 (No\nContent) response codes SHOULD be sent to indicate successful\ncompletion of the request.</p>\n</blockquote>\n<p>Also</p>\n<blockquote>\n<p><strong>9.7 DELETE</strong></p>\n<p>A successful response SHOULD be 200 (OK) if the response includes an entity describing the status, 202 (Accepted) if the action\nhas not yet been enacted, or 204 (No Content) if the action has been\nenacted but the response does not include an entity.</p>\n</blockquote>\n<p><strong>Edit</strong>: To clarify. The part in delete operation that describes the status 200 (OK) expects an entity not of the actual business deleted or not in database, but another object entity which is able to describe the status of the delete action (DONE, PENDING, FAILED...).</p>\n"}],"owner":{"user_id":836018,"display_name":"Jack"},"view_count":435,"up_vote_count":3,"accepted_answer_id":75593791,"answer_count":3,"score":2,"creation_date":1677595386,"question_id":75593543,"body":"<p>I was using <code>HttpStatus.OK</code> for all of my requests in Spring Bot Controller. But I realized that it is good to return a proper Http status and started to use the followings:</p>\n<pre><code>GET --&gt; Ok\nPOST -&gt; Created\nPUT --&gt; Ok ???\nDELETE --&gt; NoContent ???\n</code></pre>\n<p>But I am not sure regarding to PUT and DELETE, some people suggest using NoContent for DELETE and Ok for PUT. But I am confused and no idea which one is suitable.</p>\n<p>So, which Status codes should I use for PUT and DELETE ? Here is an example usage for my DELETE, but I am not sure if we can return body when Status code is NoContent (is it meaningful?)</p>\n<pre><code>@DeleteMapping(&quot;/categories/{id}&quot;)\npublic ResponseEntity&lt;ApiResponse&lt;CommandResponse&gt;&gt; deleteById(@PathVariable long id) {\n    final CommandResponse response = categoryService.deleteById(id);\n    return ResponseEntity\n            .status(HttpStatus.NO_CONTENT)\n            .body(new ApiResponse&lt;&gt;(Instant.now(clock).toEpochMilli(), SUCCESS, response));\n}\n</code></pre>\n<p><strong>Update:</strong> Based on the situatin, I think the following implementations are ok:</p>\n<p><em><strong>#1:</strong></em></p>\n<pre><code>@DeleteMapping(&quot;/categories/{id}&quot;)\npublic ResponseEntity&lt;ApiResponse&lt;Void&gt;&gt; deleteById(@PathVariable long id) {\n    categoryService.deleteById(id);\n    return ResponseEntity.ok(new ApiResponse&lt;&gt;(Instant.now(clock).toEpochMilli(), SUCCESS));\n}\n</code></pre>\n<br/>\n<p><em><strong>#2:</strong></em></p>\n<pre><code>@DeleteMapping(&quot;/categories/{id}&quot;)\npublic ResponseEntity&lt;ApiResponse&lt;Void&gt;&gt; deleteById(@PathVariable long id) {\n    categoryService.deleteById(id);\n    return ResponseEntity\n            .status(HttpStatus.NO_CONTENT)\n            .build();\n}\n</code></pre>\n"},{"tags":["java","push-notification","safari","web-push","safari-push-notifications"],"answers":[{"owner":{"user_id":1842599,"display_name":"Andrej Istomin"},"up_vote_count":4,"is_accepted":true,"creation_date":1677231912,"answer_id":75554966,"body":"<p>For me the problem was missing or incorrectly formatted <code>sub</code> parameter. It is NOT mandatory according to the protocol documentation, but Apple (and actually Mozilla as well) decided that it's required. Apple states, that one of the reasons of 403 <code>BadJwtToken</code> is this: &quot;The JWT subject claim isn’t a URL or mailto:.&quot; (See <a href=\"https://developer.apple.com/documentation/usernotifications/sending_web_push_notifications_in_safari_and_other_browsers\" rel=\"nofollow noreferrer\">the documentation</a>) When I started providing the <code>sub</code> parameter as <code>mailto:%my_email_address%</code>, everything works fine for me. You may look at the discussion <a href=\"https://github.com/web-push-libs/webpush-java/issues/201#issuecomment-1443258546\" rel=\"nofollow noreferrer\">here</a>\nI hope it will help.</p>\n"}],"owner":{"user_id":13278272,"display_name":"Ken Casey"},"view_count":302,"up_vote_count":2,"accepted_answer_id":75554966,"answer_count":1,"score":2,"creation_date":1677170894,"question_id":75547851,"body":"<p>I am trying to get the Web Push API to work with my app and Safari on iOS. I can register fine in Safari ... But, when trying to send my request to the endpoint I receive a 403 with reason: BadJwtToken.\nI've verified the token being sent in the Authentication header is valid. Also, the code I am using to send the Push request works perfectly on Chrome &amp; Edge.\nHas anyone else experienced this behaviour? Excerpt from the log below showing outgoing request and response. Any suggestions would be greatly appreciated.</p>\n<pre><code>2023-02-23 16:32:05.882 DEBUG 17412 --- [/O dispatcher 1] org.apache.http.wire                     : http-outgoing-0 &gt;&gt; &quot;POST /QKmekz9T3h2DpblQXdmVpVJPWtR145PdK-WYRMt4zldrXBOGsnqLluGtB9PFehMfoTXASt2-8pTmnRzUB0P0XMMDgX-tWdgIvL1YptpQdI_pVB3EEsnbR0LUStq97BUMIrMG_yVI6eUYJVigQtVgq0Fcl0D8k7tt9U8WEBbLmFc HTTP/1.1[\\r][\\n]&quot;\n2023-02-23 16:32:05.882 DEBUG 17412 --- [/O dispatcher 1] org.apache.http.wire                     : http-outgoing-0 &gt;&gt; &quot;Authorization: WebPush eyJ0eXAiOiJKV1QiLCJhbGciOiJFUzI1NiJ9.eyJhdWQiOiJodHRwczovL3dlYi5wdXNoLmFwcGxlLmNvbSIsImV4cCI6MTY3NzIxMzEyNSwic3ViIjoibWFpbHRvOiA8aW5mb0BtZHNnbG9iYWwuY29tPiJ9.7P42kj123WHHWk0AaRiFiIb1nTx1GaeaY3xmDWJbD3tlNQn_Rxw-jZPZOzxb1YeN7y2qWO9qoSIAg22_SwZuOQ[\\r][\\n]&quot;\n2023-02-23 16:32:05.882 DEBUG 17412 --- [/O dispatcher 1] org.apache.http.wire                     : http-outgoing-0 &gt;&gt; &quot;Content-Encoding: aesgcm[\\r][\\n]&quot;\n2023-02-23 16:32:05.882 DEBUG 17412 --- [/O dispatcher 1] org.apache.http.wire                     : http-outgoing-0 &gt;&gt; &quot;Encryption: salt=ski4AOi0Xc5HCo2zvuzDfg[\\r][\\n]&quot;\n2023-02-23 16:32:05.882 DEBUG 17412 --- [/O dispatcher 1] org.apache.http.wire                     : http-outgoing-0 &gt;&gt; &quot;TTL: 2419200[\\r][\\n]&quot;\n2023-02-23 16:32:05.882 DEBUG 17412 --- [/O dispatcher 1] org.apache.http.wire                     : http-outgoing-0 &gt;&gt; &quot;Crypto-Key: dh=BGLGnvvc-_jNZuHicms4eBijG7flOSUXHAte5GF2GtEQ1viZoL_NlzakYJBGMJrHHEbuxr76mPh8mAF0fZ2KFCo=;p256ecdsa=BKjlmDj7I5JkC3I2clsddfl7rklur8OIIx8_EKvDfpdrebwKRebZChSCIqKp64nkkyq4IWpUlVoDQ2CKK4axUjo[\\r][\\n]&quot;\n2023-02-23 16:32:05.882 DEBUG 17412 --- [/O dispatcher 1] org.apache.http.wire                     : http-outgoing-0 &gt;&gt; &quot;Content-Type: application/octet-stream[\\r][\\n]&quot;\n2023-02-23 16:32:05.882 DEBUG 17412 --- [/O dispatcher 1] org.apache.http.wire                     : http-outgoing-0 &gt;&gt; &quot;Content-Length: 202[\\r][\\n]&quot;\n2023-02-23 16:32:05.882 DEBUG 17412 --- [/O dispatcher 1] org.apache.http.wire                     : http-outgoing-0 &gt;&gt; &quot;Host: web.push.apple.com[\\r][\\n]&quot;\n2023-02-23 16:32:05.882 DEBUG 17412 --- [/O dispatcher 1] org.apache.http.wire                     : http-outgoing-0 &gt;&gt; &quot;Connection: Keep-Alive[\\r][\\n]&quot;\n2023-02-23 16:32:05.882 DEBUG 17412 --- [/O dispatcher 1] org.apache.http.wire                     : http-outgoing-0 &gt;&gt; &quot;User-Agent: Apache-HttpAsyncClient/4.1.4 (Java/1.8.0_362)[\\r][\\n]&quot;\n2023-02-23 16:32:05.882 DEBUG 17412 --- [/O dispatcher 1] org.apache.http.wire                     : http-outgoing-0 &gt;&gt; &quot;[\\r][\\n]&quot;\n2023-02-23 16:32:05.882 DEBUG 17412 --- [/O dispatcher 1] org.apache.http.wire                     : http-outgoing-0 &gt;&gt; &quot;[0xffffffc6][0x8]1_[0xfffffff1][0xffffffaa][0x8]1m[0xfffffff3][0xffffffd9]0:[0xffffffd8][0x1d]2Y[0xffffff9c][0xffffffae][0x8][0xfffffffe]gVs[0xffffffec][0xffffffcd]~[0x15][0xffffff8e][0xc][0xfffffff7][0xffffff83][0x12]B[0xffffffcc]y[0xffffffd8][0xffffff8d]}C{mCL[0xffffffee]0Z[0xffffffc3][0xffffff9a])20[0xffffffc8]G[0xffffffdb]&lt;t[0x6]a[0xffffff84]q[0x0][0xffffffc8][0xffffffa0][0xffffffe3][0xffffff95][0xffffff82][0xffffffdf]3'[0xffffffeb][0xffffffbf][0xffffffa7]H$\\1[0xffffffaf]E[0xffffffb4]0[0xffffffbe][0xb]3[0xffffffdf]W[0x5],[0xffffffed][0xffffffeb]dR[0xffffffd6][0xffffffc5]Mk[0xffffffc7][0xffffffbe][0x18]%[0xffffffd5]A[0xffffffec]~f[0xffffffd5][0xfffffff3](u[0xffffffc4]J{kKG[0xffffff8f]7NaZ&lt;1:F@[0xf][0xffffff97][0xffffffca].K[0xffffffea][0xffffffb1][0xfffffffd][0xfffffff6][0xffffff9d][0xffffffc9][0x7][0xffffff86]r[0xffffff95]S[0xfffffff4][0xffffffba]3[0xffffffe7][0xfffffff8][0xffffffd0];[0xffffffce][0xffffffd1][0xffffffce][0xffffffe7][0xffffffd1][0xffffffa2][0xffffffa0][0xffffffba]Z[0xffffff80][0xffffffa6][0x2]X[0xffffff9c][0xffffff91][0xffffffda][0xffffff98][0x12][0xffffffda]z[0xffffffe0]q7[0xffffffa9]F[0x0][0xffffffe7]3R[0xffffff9d]M\\v:xU[0xffffffa4][0xffffffa6][0xffffffdf];na[0x1c][0xffffffe1]&gt;[0xffffff82](2[0xffffffcf]-![0xffffff83][0xffffffd7][0xffffffc9]&quot;\n2023-02-23 16:32:05.883 DEBUG 17412 --- [/O dispatcher 1] o.a.h.i.nio.client.InternalIODispatch    : http-outgoing-0 [ACTIVE] Request ready\n2023-02-23 16:32:05.883 DEBUG 17412 --- [/O dispatcher 1] h.i.n.c.ManagedNHttpClientConnectionImpl : http-outgoing-0 10.154.0.20:56270&lt;-&gt;17.188.172.94:443[ACTIVE][r:w][ACTIVE][r][NOT_HANDSHAKING][0][0][0]: Event cleared [w]\n2023-02-23 16:32:05.975 DEBUG 17412 --- [/O dispatcher 1] h.i.n.c.ManagedNHttpClientConnectionImpl : http-outgoing-0 10.154.0.20:56270&lt;-&gt;17.188.172.94:443[ACTIVE][r:r][ACTIVE][r][NOT_HANDSHAKING][0][0][0]: 158 bytes read\n2023-02-23 16:32:05.975 DEBUG 17412 --- [/O dispatcher 1] org.apache.http.wire                     : http-outgoing-0 &lt;&lt; &quot;HTTP/1.1 403 Forbidden[\\r][\\n]&quot;\n2023-02-23 16:32:05.975 DEBUG 17412 --- [/O dispatcher 1] org.apache.http.wire                     : http-outgoing-0 &lt;&lt; &quot;content-type: text/plain; charset=UTF-8[\\r][\\n]&quot;\n2023-02-23 16:32:05.975 DEBUG 17412 --- [/O dispatcher 1] org.apache.http.wire                     : http-outgoing-0 &lt;&lt; &quot;content-length: 24[\\r][\\n]&quot;\n2023-02-23 16:32:05.975 DEBUG 17412 --- [/O dispatcher 1] org.apache.http.wire                     : http-outgoing-0 &lt;&lt; &quot;apns-id: 3253F680-762D-BC6F-9218-CB0F250A9142[\\r][\\n]&quot;\n2023-02-23 16:32:05.975 DEBUG 17412 --- [/O dispatcher 1] org.apache.http.wire                     : http-outgoing-0 &lt;&lt; &quot;[\\r][\\n]&quot;\n2023-02-23 16:32:05.975 DEBUG 17412 --- [/O dispatcher 1] org.apache.http.wire                     : http-outgoing-0 &lt;&lt; &quot;{&quot;reason&quot;:&quot;BadJwtToken&quot;}&quot;\n2023-02-23 16:32:05.978 DEBUG 17412 --- [/O dispatcher 1] org.apache.http.headers                  : http-outgoing-0 &lt;&lt; HTTP/1.1 403 Forbidden\n2023-02-23 16:32:05.978 DEBUG 17412 --- [/O dispatcher 1] org.apache.http.headers                  : http-outgoing-0 &lt;&lt; content-type: text/plain; charset=UTF-8\n2023-02-23 16:32:05.978 DEBUG 17412 --- [/O dispatcher 1] org.apache.http.headers                  : http-outgoing-0 &lt;&lt; content-length: 24\n2023-02-23 16:32:05.978 DEBUG 17412 --- [/O dispatcher 1] org.apache.http.headers                  : http-outgoing-0 &lt;&lt; apns-id: 3253F680-762D-BC6F-9218-CB0F250A9142\n2023-02-23 16:32:05.978 DEBUG 17412 --- [/O dispatcher 1] o.a.h.i.nio.client.InternalIODispatch    : http-outgoing-0 [ACTIVE(24)] Response received\n</code></pre>\n<p>I've tried pretty much everything I can think of at this stage</p>\n"},{"tags":["java","string"],"comments":[{"owner":{"user_id":3832970,"display_name":"Wiktor Stribiżew"},"edited":false,"comment_id":133178671,"body":"What about <a href=\"https://ideone.com/P1m10a\" rel=\"nofollow noreferrer\">ideone.com/P1m10a</a>? What is your targeted Java version?"}],"answers":[{"owner":{"user_id":12651435,"display_name":"Rasmus Kirvesm&#228;ki"},"up_vote_count":4,"is_accepted":true,"creation_date":1676625418,"answer_id":75482292,"body":"<p>It seems like Java's Matcher checks your string size when it initializes, and doesn't go past that. You are inserting to the string, which makes it longer. The matcher doesn't check that far.</p>\n<p>A quick, though slow, fix is to re-initialize the matcher every time.</p>\n<pre><code>StringBuilder text = new StringBuilder(&quot;Hel2o peo7ple it is ou6r wo3rld gu4ys&quot;);\nPattern pattern = Pattern.compile(&quot;[a-z]\\\\d&quot;);\nMatcher matcher = pattern.matcher(text);\n        \nwhile (matcher.find()) {\n    int startWord = matcher.start();\n    int numLetters = Integer.parseInt(text.substring(startWord + 1, startWord + 2));\n    text.deleteCharAt(startWord + 1);\n    for (int i = 0; i &lt; numLetters - 1; ++i) {\n        text.insert(startWord + 1, text.charAt(startWord));\n    }\n            \n    matcher = pattern.matcher(text);\n}\nSystem.out.println(text);\n</code></pre>\n<p>A faster approach would find the numbers, calculate the string length and then manually construct the string using the found numbers.</p>\n"},{"owner":{"user_id":18780356,"display_name":"SCASTELLANO6044"},"up_vote_count":0,"is_accepted":false,"creation_date":1676626443,"answer_id":75482450,"body":"<p>The issue is probably that the matcher is only finding the pattern [a-z]\\d, which matches a single letter followed by a digit, but it is not finding the last word &quot;gu4ys&quot; because it doesn't match that pattern.</p>\n<p>To fix this, you can modify the regular expression to include an optional group that matches any remaining letters at the end of the text.</p>\n<p>Try this regex and please let me know if it worked :)\n&quot;[a-z]\\d|[a-z]+&quot;</p>\n"}],"owner":{"user_id":21232548,"display_name":"Timur"},"view_count":65,"up_vote_count":2,"accepted_answer_id":75482292,"answer_count":2,"score":2,"creation_date":1676623936,"question_id":75482059,"body":"<p>I have a regular expression [a-z]\\d to unpack the text witch is compressed by simple rule\nhellowoooorld  -&gt; hel2owo4rld\nSo now i have to unpack my text and it doesn't work correctly. It can't find last word in my String\nit always like skip gu4ys</p>\n<pre><code>StringBuilder text = new StringBuilder(&quot;Hel2o peo7ple it is ou6r wo3rld gu4ys&quot;);\n        Pattern pattern = Pattern.compile(&quot;[a-z]\\\\d&quot;);\n        Matcher matcher = pattern.matcher(text);\n        while (matcher.find()) {\n            System.out.println(matcher.group());\n            int startWord = matcher.start();\n            int numLetters = Integer.parseInt(text.substring(startWord + 1, startWord + 2));\n            text.deleteCharAt(startWord + 1);\n            for (int i = 0; i &lt; numLetters - 1; ++i) {\n                text.insert(startWord + 1, text.charAt(startWord));\n            }\n        }\n        System.out.println(text);\n</code></pre>\n<p>Result is : Hello peooooooople it is ouuuuuur wooorld gu4ys\nI expect this : Hello peooooooople it is ouuuuuur wooorld guuuuys\nI can't understand why it doesn't work all is simple</p>\n"},{"tags":["java","types","binary-string"],"comments":[{"owner":{"user_id":16320675,"display_name":"user16320675"},"edited":false,"comment_id":133069454,"body":"since you are <i>not</i> providing the negative sign, try <code>Long.parseUnsignedLong(&quot;111100000000011100000000000100000000&zwnj;&#8203;00100100000000000000&zwnj;&#8203;00000000&quot;,2)</code> (it will return a negative <code>long</code> for above strings)"}],"answers":[{"owner":{"user_id":13290159,"display_name":"0x150"},"up_vote_count":2,"is_accepted":false,"creation_date":1676061746,"answer_id":75415937,"body":"<p>You're passing in a size 64 binary string, which is bigger than the signed byte size of a long. Since <code>parseLong</code> doesn't accept unsigned binary representations and instead wants a - or (an optional) + in front of the number to denote the sign, it throws an error. The max byte length you can pass into parseLong is 63.</p>\n<p>An equivalent <code>parseLong</code> call to your first example would be <code>Long.parseLong(&quot;-111111111000111111111110111111111101110000000000000000000000&quot;, 2)</code>, using the - sign and the two's complement of the number.</p>\n"},{"owner":{"user_id":1762224,"display_name":"Mr. Polywhirl"},"up_vote_count":0,"is_accepted":false,"creation_date":1676062827,"answer_id":75416070,"body":"<p>You are trying to parse a 64-bit unsigned (long) integer as a 64-bit signed (long) integer.</p>\n<p>Java's <code>long</code> is not unsigned. You will only be able to store a positive number up to 63 bits. The max value for a <code>long</code> is <code>9,223,372,036,854,775,807</code> or <code>2^(63)</code>.</p>\n<p>The most-significant bit (left-most) is the signed bit.</p>\n<ul>\n<li>If it's a 64-bit string that begins with a 1, it's negative.</li>\n<li>If it's less than 64 bits, it's positive and the leading 0 will not be displayed.</li>\n</ul>\n<p>Note: Any leading zeroes will not be displayed.</p>\n<pre class=\"lang-java prettyprint-override\"><code>import java.math.BigInteger;\n\npublic class NumberUtils {\n\n  static final String MIN_SIGNED_LONG_BINARY = Long.toBinaryString(Long.MIN_VALUE);\n  static final String MAX_SIGNED_LONG_BINARY =\n      padStart(Long.toBinaryString(Long.MAX_VALUE), 64, &quot;0&quot;);\n\n  public static void main(String[] args) {\n    parseBinary(&quot;1111000000000111000000000001000000000010010000000000000000000000&quot;);\n    parseBinary(&quot;1100000001000000010000000100000000001110000000010000010000000000&quot;);\n  }\n\n  private static void parseBinary(String str) {\n    BigInteger bigInt = new BigInteger(str, 2);\n    System.out.println(bigInt.longValue());\n    try {\n      Long.parseLong(str, 2);\n    } catch (NumberFormatException e) {\n      System.out.printf(\n          &quot;Error:%n* Min: %s (%d bits)%n* Val: %s (%d bits)%n* Max: %s (%d bits)%n&quot;,\n          MIN_SIGNED_LONG_BINARY,\n          MIN_SIGNED_LONG_BINARY.length(),\n          str,\n          str.length(),\n          MAX_SIGNED_LONG_BINARY,\n          MAX_SIGNED_LONG_BINARY.length());\n    }\n  }\n\n  public static String padStart(String inputString, int targetLength, String padString) {\n    if (inputString.length() &gt;= targetLength) return inputString;\n    StringBuilder sb = new StringBuilder();\n    while (sb.length() &lt; targetLength - inputString.length()) {\n      sb.append(padString);\n    }\n    return sb.append(inputString).toString();\n  }\n}\n\n</code></pre>\n<h2>Output</h2>\n<pre><code>-1150951111012646912\nError:\n* Min: 1000000000000000000000000000000000000000000000000000000000000000 (64 bits)\n* Val: 1111000000000111000000000001000000000010010000000000000000000000 (64 bits)\n* Max: 0111111111111111111111111111111111111111111111111111111111111111 (64 bits)\n-4593600976060873728\nError:\n* Min: 1000000000000000000000000000000000000000000000000000000000000000 (64 bits)\n* Val: 1100000001000000010000000100000000001110000000010000010000000000 (64 bits)\n* Max: 0111111111111111111111111111111111111111111111111111111111111111 (64 bits)\n</code></pre>\n"},{"owner":{"user_id":1552534,"display_name":"WJS"},"up_vote_count":3,"is_accepted":false,"creation_date":1676064349,"answer_id":75416248,"body":"<p>The short answer is that neither <code>Integer.parseInt</code> nor <code>Long.parseLong</code> can parse twos complement negative numbers without replacing the sign bit with an explicit <code>'+'</code> or <code>'-'</code> sign.</p>\n<p>This is probably in keeping with parsing a decimal number such as the following:</p>\n<pre><code>String max = &quot;9223372036854775807&quot;;  // Long.MAX_VALUE         \nString maxPlus1 = &quot;9223372036854775808&quot;; // Long.MAX_VALUE+1 \nlong m = Long.parseLong(max,10); //OK\nlong m1 =Long.parseLong(maxPlus1,10)); // throws exception\n</code></pre>\n<p>To parse your two's complement value of long or any other value you can use\n<a href=\"https://docs.oracle.com/en/java/javase/18/docs/api/java.base/java/lang/Long.html#parseUnsignedLong(java.lang.String,int)\" rel=\"nofollow noreferrer\">Long.parseUnsignedLong</a>.  All the following three method calls correctly parse the values, printing out <code>Long.MIN_VALUE</code>, the fourth one being your specific value in your question.</p>\n<pre><code>System.out.println(Long.parseUnsignedLong(&quot;1000000000000000000000000000000000000000000000000000000000000000&quot;,2));\nSystem.out.println(Long.parseUnsignedLong(&quot;8000000000000000&quot;,16));\nSystem.out.println(Long.parseUnsignedLong(&quot;9223372036854775808&quot;,10));\nSystem.out.println(Long.parseUnsignedLong(&quot;1111000000000111000000000001000000000010010000000000000000000000&quot;,2));\n</code></pre>\n<p>prints</p>\n<pre><code>-9223372036854775808\n-9223372036854775808\n-9223372036854775808\n-1150951111012646912\n</code></pre>\n"}],"owner":{"user_id":21189776,"display_name":" za1ra1za1 "},"view_count":139,"up_vote_count":2,"answer_count":3,"score":2,"creation_date":1676061400,"question_id":75415896,"body":"<p>we have byte <code>string s = &quot;1111000000000111000000000001000000000010010000000000000000000000&quot;</code>(this value equal -1150951111012646912), if we use <code>Long.parseLong(s, 2)</code>, we got &quot;</p>\n<blockquote>\n<p>java.lang.NumberFormatException: For input string:\n&quot;1100000001000000010000000100000000001110000000010000010000000000&quot;\nunder radix 2&quot;.</p>\n</blockquote>\n<p>i fixed this problem with this way to convert</p>\n<pre><code> new BigInteger(s, 2).longValue();\n</code></pre>\n<p>Explain please i can't understand what happend?</p>\n<p>Same situation with this value:\n<code>s = 1100000001000000010000000100000000001110000000010000010000000000</code> (equal -4593600976060873728)</p>\n<pre><code>new BigInteger(s, 2).longValue();\n</code></pre>\n"},{"tags":["java","spring-boot","spring-security","jwt"],"comments":[{"owner":{"user_id":8142290,"display_name":"Vee Dee"},"edited":false,"comment_id":132996490,"body":"The answer depends upon how are you using PreAuthorize. Are you using hasRole/hasAnyRole to check the roles or hasAuthority/hasAnyAuthority? The hasRole method appends ROLE_ as prefix to whatever is passed into it as value. Moreover it also depends upon how have you implemented your getAuthorities method for User Model implementing UserDetails from Spring Security. I think you should add those implementations as well so that a clear picture can be generated on the issue."},{"owner":{"user_id":21163933,"display_name":"User69"},"edited":false,"comment_id":132996673,"body":"I added the userDetailsImpl as you asked. I use the hasAnyRole annotation. I checked my getAuthorities method with a lot of console prints at the time and it seems to be doing is job correct."},{"owner":{"user_id":8142290,"display_name":"Vee Dee"},"edited":false,"comment_id":132998551,"body":"I have updated my answer and you can use the solution you desire to fix the problem. In my opinion you should go for second approach with Custom Converter since it gives you more flexibility in terms of using scopes. During console print try using the authentication object instead of user object(if not already using this approach).  authentication.getAuthorities() prefixes SCOPE_ to all the role name values by default."}],"answers":[{"owner":{"user_id":8142290,"display_name":"Vee Dee"},"up_vote_count":4,"is_accepted":true,"creation_date":1675776516,"answer_id":75374056,"body":"<p>Okay so here's the thing, since you're implementing resource server, the class:</p>\n<pre><code>org.springframework.security.oauth2.server.resource.authentication.JwtGrantedAuthoritiesConverter \n</code></pre>\n<p>is the one responsible for converting your scopes inside JWT token to granted authorities.\nNow, this class prepends all the authorities with <strong><code>SCOPE_</code></strong> prefix.</p>\n<p>Since you're using</p>\n<pre class=\"lang-java prettyprint-override\"><code>hasAnyRole('ADMIN', 'USER',...)\n</code></pre>\n<p>this method internally invokes,</p>\n<pre class=\"lang-java prettyprint-override\"><code>hasAnyAuthorityName(defaultRolePrefix, roleName) \n</code></pre>\n<p>method with the <code>defaultRolePrefix</code> as <code>ROLE_</code> and the <code>roleName</code> as your passed in value(s).</p>\n<p>Internal implementation:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Override\npublic final boolean hasAnyRole(String... roles) {\n    return hasAnyAuthorityName(this.defaultRolePrefix, roles);\n}\n\n@Override\npublic final boolean hasAnyAuthority(String... authorities) {\n    return hasAnyAuthorityName(null, authorities);\n}\n</code></pre>\n<p>On the other hand, the <strong><code>hasAnyAuthority</code></strong> method makes a call to the same method but with <strong><code>null</code> passed in to the <code>defaultRolePrefix</code></strong>.</p>\n<p>Now since you're using:</p>\n<pre class=\"lang-java prettyprint-override\"><code>.oauth2ResourceServer(OAuth2ResourceServerConfigurer::jwt)\n</code></pre>\n<p>in security config, it is using the default <code>AuthenticationConverter</code> for your JWT token which is</p>\n<pre><code>org.springframework.security.oauth2.server.resource.authentication.JwtAuthenticationConverter\n</code></pre>\n<p>which further invokes</p>\n<pre><code>org.springframework.security.oauth2.server.resource.authentication.JwtGrantedAuthoritiesConverter\n</code></pre>\n<p>As per the implementation in <code>JwtGrantedAuthoritiesConverter</code>, all the scopes in your JWT token are prefixed by <strong><code>SCOPE_</code></strong> as I mentioned earlier.</p>\n<p>Now assuming your granted authorities return <strong><code>ADMIN</code></strong> as one of the roles. Once you add it to your <em><strong><code>scope</code></strong></em> in JWT, the default converter will return <strong><code>SCOPE_ADMIN</code></strong> as an authority and similarly if you return <strong><code>ROLE_ADMIN</code></strong> in the scope, it will be converted to <strong><code>SCOPE_ROLE_ADMIN</code></strong> by default.</p>\n<p>The <code>JwtAuthenticationConverter</code> class returns an instance of</p>\n<pre><code>org.springframework.security.oauth2.server.resource.authentication.JwtAuthenticationToken\n</code></pre>\n<p>So, it can be fixed in following ways:</p>\n<p>Either, use <code>hasAnyAuthority</code> to check the authorities by appending <code>SCOPE_</code> to the role names you have set in scope.\nIf your role name is <strong><code>ADMIN</code></strong> or <strong><code>ROLE_ADMIN</code></strong> you should use</p>\n<pre class=\"lang-java prettyprint-override\"><code>@PreAuthorize(&quot;hasAnyAuthority('SCOPE_ADMIN')&quot;)\n@PreAuthorize(&quot;hasAnyAuthority('SCOPE_ROLE_ADMIN')&quot;) \n</code></pre>\n<p>and so on.\nIf you want to use <code>hasAnyRole</code> check then you must use</p>\n<pre class=\"lang-java prettyprint-override\"><code>@PreAuthorize(&quot;hasAnyAuthority('ROLE_SCOPE_ADMIN')&quot;)\n@PreAuthorize(&quot;hasAnyAuthority('ROLE_SCOPE_ROLE_ADMIN')&quot;) \n</code></pre>\n<p>for <strong><code>ADMIN</code></strong> and <strong><code>ROLE_ADMIN</code></strong> values respectively.</p>\n<p>Or, implement a custom authority converter and pass it to the <code>oauth2ResourceServer</code> in security config as follows,</p>\n<p><strong>Example Custom Converter</strong></p>\n<pre class=\"lang-java prettyprint-override\"><code>import org.springframework.core.convert.converter.Converter;\nimport org.springframework.security.oauth2.jwt.Jwt;\nimport org.springframework.stereotype.Component;\n\nimport java.util.Collections;\n\n@Component\npublic class JwtCustomAuthoritiesConverter implements Converter&lt;Jwt, Collection&lt;GrantedAuthority&gt;&gt; {\n    @Override\n    public Collection&lt;GrantedAuthority&gt; convert(Jwt jwt) {\n        Collection&lt;GrantedAuthority&gt; grantedAuthorities = new ArrayList&lt;&gt;();\n        Collection&lt;String&gt; splitScopes = Arrays.asList(jwt.getClaim(&quot;scope&quot;).split(&quot; &quot;));\n        for (String authority : splitScopes) {\n            grantedAuthorities.add(new SimpleGrantedAuthority(authority));\n        }\n        return grantedAuthorities;\n    }\n}\n</code></pre>\n<p>Then update your Spring Security config as:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Bean \nJwtCustomAuthoritiesConverter jwtCustomAuthoritiesConverter;\n\n@Bean\nJwtAuthenticationConverter jwtAuthenticationConverter(){\n    JwtAuthenticationConverter jwtAuthenticationConverter = new JwtAuthenticationConverter();\n    jwtAuthenticationConverter.setJwtGrantedAuthoritiesConverter(jwtCustomAuthoritiesConverter);\n    return jwtAuthenticationConverter;\n}\n\n...\n\nhttp.oauth2ResourceServer((oauth2) -&gt;\n                        oauth2.jwt((jwt) -&gt; jwt.jwtAuthenticationConverter(jwtAuthenticationConverter()))\n...\n</code></pre>\n<p>With the second option you can use your role names the way you want to in JWT token and the</p>\n<pre class=\"lang-java prettyprint-override\"><code>hasAnyRole('ADMIN') \n</code></pre>\n<p>check should get <code>ROLE_ADMIN</code> for <code>ADMIN</code> scope instead of <code>ROLE_SCOPE_ADMIN</code> which is the case now.</p>\n"}],"owner":{"user_id":21163933,"display_name":"User69"},"view_count":1203,"up_vote_count":2,"accepted_answer_id":75374056,"answer_count":1,"score":2,"creation_date":1675771260,"question_id":75373063,"body":"<p>I'm trying to integrate the updated Spring Security in my project, instead of using the deprecated <code>extending WebSecurityConfigurerAdapter</code>. I've set up a good system in which the user gets authenticated (<code>User</code> implements <code>UserDetails</code> - I am using Hibernate) and a token gets generated. I get a 200 on this login and receive a token. This authetication part works fine.</p>\n<p>Now the problem is that my users have roles (like <code>ADMIN</code>, <code>USER</code>, ...) These roles are added to the generated token. My controllers get the <code>@PreAuthorize</code> annotation. The request cannot pass these annotation and get a forbidden. When I don't use the <code>@PreAuthorize</code>, the requests get validated with the token.</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Configuration\n@EnableWebSecurity\n@EnableMethodSecurity\npublic class SecurityConfig {\n    private RSAKey rsaKey;\n    private final DefaultUserDetailsService defaultUserDetailsService;\n    \n    public SecurityConfig(DefaultUserDetailsService defaultUserDetailsService) {\n        this.defaultUserDetailsService = defaultUserDetailsService;\n    }\n    \n    @Bean\n    public AuthenticationManager authenticationManager(AuthenticationConfiguration authenticationConfiguration) throws Exception {\n        return authenticationConfiguration.getAuthenticationManager();\n    }\n\n    @Bean\n    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {\n        \n    return http \n               .cors(Customizer.withDefaults())\n               .csrf(AbstractHttpConfigurer::disable)\n               .authorizeHttpRequests(auth -&gt; auth\n                   .requestMatchers(&quot;/auth/**&quot;).permitAll()\n                   .anyRequest().authenticated()\n               )            \n               .userDetailsService(defaultUserDetailsService)\n               .sessionManagement(session -&gt;  session.sessionCreationPolicy(SessionCreationPolicy.STATELESS))\n               .oauth2ResourceServer(OAuth2ResourceServerConfigurer::jwt)\n               .headers(headers -&gt; headers\n                   .frameOptions().sameOrigin()\n               )\n               .httpBasic(withDefaults())\n               .build();\n    }\n    \n    @Bean\n    public JWKSource&lt;SecurityContext&gt; jwkSource() {\n        rsaKey = Jwks.generateRsa();\n        JWKSet jwkSet = new JWKSet(rsaKey);\n        return (jwkSelector, securityContext) -&gt; jwkSelector.select(jwkSet);\n    }\n    \n    @Bean\n    JwtDecoder jwtDecoder() throws JOSEException {\n        return NimbusJwtDecoder.withPublicKey(rsaKey.toRSAPublicKey()).build();\n   }\n    \n    @Bean\n    JwtEncoder jwtEncoder(JWKSource&lt;SecurityContext&gt; jwks) {\n        return new NimbusJwtEncoder(jwks);\n    }\n    \n    @Bean\n    public PasswordEncoder getPasswordEncoder() {\n        return new BCryptPasswordEncoder();\n    }\n        \n    @Bean\n    CorsConfigurationSource corsConfigurationSource() {\n        CorsConfiguration configuration = new CorsConfiguration();\n        configuration.setAllowedOrigins(List.of(&quot;http://localhost:4200&quot;));\n        configuration.setAllowedMethods(List.of(&quot;GET&quot;,&quot;POST&quot;,&quot;DELETE&quot;));\n        configuration.setAllowedHeaders(List.of(&quot;Authorization&quot;,&quot;Content-Type&quot;));\n        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\n        source.registerCorsConfiguration(&quot;/**&quot;,configuration);\n        return source;\n    }\n\n}\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>@Component\npublic class KeyGeneratorUtils {\n\n    private KeyGeneratorUtils() {}\n\n    static KeyPair generateRsaKey() {\n        KeyPair keyPair;\n        try {\n            KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(&quot;RSA&quot;);\n            keyPairGenerator.initialize(2048);\n            keyPair = keyPairGenerator.generateKeyPair();\n        } catch (Exception ex) {\n            throw new IllegalStateException(ex);\n        }\n        return keyPair;\n    }\n}\n\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>public class Jwks {\n       private Jwks() {}\n\n        public static RSAKey generateRsa() {\n            KeyPair keyPair = KeyGeneratorUtils.generateRsaKey();\n            RSAPublicKey publicKey = (RSAPublicKey) keyPair.getPublic();\n            RSAPrivateKey privateKey = (RSAPrivateKey) keyPair.getPrivate();\n            return new RSAKey.Builder(publicKey)\n                    .privateKey(privateKey)\n                    .keyID(UUID.randomUUID().toString())\n                    .build();\n        }\n}\n\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>@Service\npublic class DefaultTokenService implements TokenService {\n    private final JwtEncoder encoder;\n\n    public DefaultTokenService(JwtEncoder encoder) {\n        this.encoder = encoder;\n    }\n    \n    @Override\n    public String generateToken(Authentication authentication) {\n        Instant now = Instant.now();\n        String scope = authentication.getAuthorities().stream()\n                .map(GrantedAuthority::getAuthority)\n                .collect(Collectors.joining(&quot; &quot;));\n        \n        System.out.println(&quot;scope: &quot; + scope);\n        \n        JwtClaimsSet claims = JwtClaimsSet.builder()\n                .issuer(&quot;self&quot;)\n                .issuedAt(now)\n                .expiresAt(now.plus(1, ChronoUnit.HOURS))\n                .subject(authentication.getName())\n                .claim(&quot;scope&quot;, scope)\n                .build();\n        return this.encoder.encode(JwtEncoderParameters.from(claims)).getTokenValue();\n    }\n}\n\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>public class UserDetailsImpl implements UserDetails{\n      private static final long serialVersionUID = 1L;\n      private final Long id;\n      private final String username;\n      private final String riziv;\n      private final boolean verified;\n      @JsonIgnore\n      private final String password;\n      private final Collection&lt;? extends GrantedAuthority&gt; authorities;\n    \n        public UserDetailsImpl(Long id, String username, String riziv, String password,\n                Collection&lt;? extends GrantedAuthority&gt; authorities, boolean verified) {\n                this.id = id;\n                this.username = username;\n                this.riziv = riziv;\n                this.password = password;\n                this.authorities = authorities;\n                this.verified = verified;\n            }\n\n        public static UserDetailsImpl build(AuthUser authUser) {\n            List&lt;GrantedAuthority&gt; authorities = new ArrayList&lt;&gt;();\n            authorities.add(new SimpleGrantedAuthority(authUser.getRol().toString()));\n          \n            \n            return new UserDetailsImpl(\n                    authUser.getId(),\n                    authUser.getUsername(),\n                    authUser.getRiziv(),\n                    authUser.getPassword(),\n                    authorities, authUser.isVerified());\n        }\n        @Override\n        public Collection&lt;? extends GrantedAuthority&gt; getAuthorities() {\n            return authorities;\n        }\n        public Long getId() {\n            return id;\n        }\n        public boolean isVerified() {\n            return verified;\n        }\n        public String getRiziv() {\n            return riziv;\n        }\n        @Override\n        public String getUsername() {\n            return username;\n        }\n        @Override\n        public String getPassword() {\n            return password;\n        }\n        @Override\n        public boolean isAccountNonExpired() {\n            return true;\n        }\n        @Override\n        public boolean isAccountNonLocked() {\n            return true;\n        }\n        @Override\n        public boolean isCredentialsNonExpired() {\n            return true;\n        }\n        @Override\n        public boolean isEnabled() {\n            return true;\n        }\n        @Override\n        public boolean equals(Object o) {\n            if (this == o)\n                return true;\n            if (o == null || getClass() != o.getClass())\n                return false;\n            UserDetailsImpl klant = (UserDetailsImpl) o;\n            return Objects.equals(id, klant.id);\n        }\n\n}\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>@Service\npublic class DefaultUserDetailsService implements UserDetailsService {\n    private final AuthUserService authUserService;\n    \n    public DefaultUserDetailsService(AuthUserService authUserService) {\n        this.authUserService = authUserService;\n    }\n\n\n    @Override\n    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {\n        AuthUser authUser = authUserService.findByUsername(username)\n                .orElseThrow(() -&gt; new UsernameNotFoundException(&quot;User Not Found with username: &quot; + username));\n\n        return UserDetailsImpl.build(authUser);\n    }\n\n}\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>    @PreAuthorize(&quot;hasAnyRole('USER', 'ADMIN')&quot;)\n</code></pre>\n<p>I am making a configuration mistake somewhere, but I cannot seem to find it. Spring docs are very very hard to figure out, but I have been reading them relentlessly. There is also not a lot of clear information on these topics yet. I can find youtube videos tutorials and some related topics, but they only explain small parts, never a full setup.</p>\n<p>I have added below my <code>securityConfig</code>, <code>KeyGenerator</code>, <code>Jwks</code> and <code>tokengenerate</code> service. I also just added the <code>Userdetailsimpl</code> and service. I build my <code>userdetailsImpl</code> out of a user with a static build method. It might seem a strange construction but it works, it is because I did the security last and didn't think of it before. Also I added an example of my <code>@Preauthorize</code>.</p>\n<p>I am very close and this could be a good example for other users trying to implement this, because I seem not te able to find an example somewhere.Does anyone have experience with setting the Spring Boot 3 security up and can they tell me how I am misconfiguring? Why is my role not getting 'read' by the <code>@PreAuthorize</code>?</p>\n"},{"tags":["java","memory-leaks","try-with-resources"],"comments":[{"owner":{"user_id":2711488,"display_name":"Holger"},"edited":false,"comment_id":132996104,"body":"If the only method existing for closing a resource fails, what <i>can</i> you do? Nothing, obviously. You already did the best you can. Besides, I don’t understand why you call “try-with-resources” “optimistic”; it’s as defensive as Java code can be."},{"owner":{"user_id":40342,"display_name":"Joachim Sauer"},"edited":false,"comment_id":132996129,"body":"Assume you had some mechanism to re-try the close if the auto-close fails. What would you do if that fails? How many layers do you want to add? What would happen if the close fails but doesn&#39;t report it as an exception and just silently leaks resources? Some kinds of problems you simply can&#39;t code around ..."},{"owner":{"user_id":684296,"display_name":"Newerth"},"edited":false,"comment_id":132996131,"body":"Also you can never say &quot;yes&quot; to this unless you state that the answer covers your own code only."},{"owner":{"user_id":40342,"display_name":"Joachim Sauer"},"edited":false,"comment_id":132996148,"body":"Generally: try-with-resource is not automagically worse or better than manual code, but it sure as hell is better than at least 95% of all hand-written closing code I&#39;ve seen in the wild."},{"owner":{"user_id":637853,"display_name":"Thomas"},"edited":false,"comment_id":132996151,"body":"&quot;Is it correct to say that this code is prone to a resource/memory leak?&quot; - try-with-resources was actually introduced to reduce the risk of a memory leak as developers might forget to close the resource in a traditional try-finally. And as Holger said, what would you do if closing fails?"},{"owner":{"user_id":19239577,"display_name":"greenButMellow"},"edited":false,"comment_id":132996165,"body":"Thanks for the answers! I think I understand the spirit of the answer. Should I delete the question though?"},{"owner":{"user_id":19239577,"display_name":"greenButMellow"},"edited":false,"comment_id":132996178,"body":"@JoachimSauer, can you elaborate on that?"},{"owner":{"user_id":1531124,"display_name":"GhostCat"},"edited":false,"comment_id":132996215,"body":"What he means is: try-with-resources was introduced because people implemented all sorts of things using try/catch/finally ... and got that wrong. try-with-resources eliminates many things you can get wrong when implementing such logic manually."},{"owner":{"user_id":40342,"display_name":"Joachim Sauer"},"edited":false,"comment_id":132996222,"body":"@greenButMellow: try-with-resources can be re-implemented using the traditional try-catch-finally code, but it&#39;ll look quite wordy, due to the many possible cases it handles (including exceptions during the close). Most &quot;manual&quot; code that does the quivalent won&#39;t handle things like that. For example, if an exception happens <i>inside</i> the <code>try</code> and <i>another one</i> happens in the <code>close</code>. try-with-resources will report both of those (one as supressed)."},{"owner":{"user_id":19239577,"display_name":"greenButMellow"},"edited":false,"comment_id":132996308,"body":"@JoachimSauer, thanks! Can you refer me to the source code of try-with-resources?"},{"owner":{"user_id":40342,"display_name":"Joachim Sauer"},"edited":false,"comment_id":132996350,"body":"@greenButMellow: <a href=\"https://docs.oracle.com/javase/specs/jls/se17/html/jls-14.html#jls-14.20.3.1\" rel=\"nofollow noreferrer\">the JLS gives the equivalent code</a>. <a href=\"https://stackoverflow.com/questions/23611940/\">This SO question</a> might be more readable, though."}],"answers":[{"owner":{"user_id":10566045,"display_name":"TopchetoEU"},"up_vote_count":3,"is_accepted":false,"creation_date":1675771126,"answer_id":75373036,"body":"<p>You are correct in your assumption that if an exception is thrown upon the freeing of <code>transport</code>, some memory leak will occur, if the library you're using is bad. In normal circumstances, the <code>AutoCloseable</code> guarantees that all unmanaged resources will be freed, as the <a href=\"https://docs.oracle.com/javase/8/docs/api/java/lang/AutoCloseable.html\" rel=\"nofollow noreferrer\">Java documentation</a> states:</p>\n<blockquote>\n<p>While this interface method is declared to throw Exception, implementers are\nstrongly encouraged to declare concrete implementations of the close\nmethod to throw more specific exceptions, or to throw no exception at\nall if the close operation cannot fail.</p>\n<p>Cases where the close operation may fail require careful attention by\nimplementers. It is strongly advised to relinquish the underlying\nresources and to internally mark the resource as closed, prior to\nthrowing the exception. The close method is unlikely to be invoked\nmore than once and so this ensures that the resources are released in\na timely manner. Furthermore it reduces problems that could arise when\nthe resource wraps, or is wrapped, by another resource.</p>\n<p>Implementers of this interface are also strongly advised to not have\nthe close method throw InterruptedException. This exception interacts\nwith a thread's interrupted status, and runtime misbehavior is likely\nto occur if an InterruptedException is suppressed. More generally, if\nit would cause problems for an exception to be suppressed, the\nAutoCloseable.close method should not throw it.</p>\n</blockquote>\n"},{"owner":{"user_id":768644,"display_name":"rzwitserloot"},"up_vote_count":4,"is_accepted":true,"creation_date":1675771295,"answer_id":75373070,"body":"<p>The answer is 'theoretically, yes, pragmatically, no'. In the sense that:</p>\n<blockquote>\n<p>So is it correct to say that this code is prone to a resource/memory leak?</p>\n</blockquote>\n<p>If this is 'yes', then</p>\n<blockquote>\n<p>If the answer's yes, then what should a program do in such case?</p>\n</blockquote>\n<p>There is <strong>absolutely nothing</strong> you can do in this hypothetical, silly case.</p>\n<p>Hence why it's pragmatically speaking no.</p>\n<h2>So how can it fail?</h2>\n<p>The code you wrote is syntax sugar. It's the same as this:</p>\n<pre><code>try {\n  Transport transport = session.getTransport(&quot;smtp&quot;);\n  try {\n    transport.connect();\n  } finally {\n    try {\n     transport.close();\n    } catch (Throwable t) {\n      if (we got here because the try block threw) {\n        theExceptionThatGotUsHere.addSuppressed(t);\n        throw theExceptionThatGotUsHere;\n      } else {\n        throw t;\n      }\n    }\n  }\n} catch (MessagingException ignored) {}\n</code></pre>\n<p>You see why java has syntax sugar for that mess. In essence, <strong>it just does the same thing we used to do</strong>, with the one upside that if <code>close()</code> throws an exception, java takes some pains to ensure this does not end up confuscating the exception thrown by the main body. Generally if the flow goes:</p>\n<ul>\n<li>Write to some resource a bunch</li>\n<li>Eventually due to, say, someone yanking a disk right out, an IOException occurs explaining that someone yanked a disk out.</li>\n<li>We get to the 'resource safety' part of the code which calls <code>close()</code> on an <code>OutputStream</code> that is already tainted and that has already thrown. This, itself, <em>also</em> throws.</li>\n<li>The first exception is more useful than the second; they are both IOExceptions and will cause the same code flow, just, the first one has a 'better' stack trace and a 'better' message ('better' in the sense that they will more easily lead to fixing the bug).</li>\n</ul>\n<p>Hence, perhaps, it's essentially as simple as:</p>\n<pre><code>try {\n  Transport transport = session.getTransport(&quot;smtp&quot;);\n  try {\n    transport.connect();\n  } finally {\n    transport.close();\n  }\n} catch (MessagingException ignored) {}\n</code></pre>\n<p>So, how can this fail? Simple: If <code>close()</code> itself can no longer close the resource.</p>\n<p>However:</p>\n<ul>\n<li>That means there is <strong>nothing you can do from within java</strong>. The 'go to' answer is the very last snippet: Really really try, in a <code>finally</code> block, but that's with try-with-resources already does.</li>\n<li>This <strong>just is not relevant</strong>. All java APIs with a close method <strong>will close the resource</strong>. They just do. &quot;Yeah but what if they don't&quot;. Okay. What if the moon is made of cheese?</li>\n</ul>\n<p>Specifically, the close() may fail, but what they won't do, is cause a resource/memory leak even if they fail. What DOES happen is the following:</p>\n<ul>\n<li>Due to circumstances (Such as yanking a disk out, a network router going belly up, etc), a resource becomes 'invalid' and any attempt to interact with it throws exceptions.</li>\n<li>Notably, so does <code>close()</code>, this is important in particular for <em>output</em> streams, where <code>close()</code> throwing cannot safely be ignored, it means not all data is guaranteed to have arrived where you sent it, you should handle an exception in an output stream's close() call no different than in a write call().</li>\n<li>The underlying resources that the stream is taking up <strong>were already released when it became invalid</strong>. For memory leak/resources purposes, you already no longer had to invoke <code>close()</code> on this.</li>\n<li>Alternatively, the <code>close()</code> call cleans up resources (releases OS-level file handles, that sort of thing), and <strong>then</strong> throws the exception, to ensure you know that the write did not necessarily succeed.</li>\n</ul>\n"}],"owner":{"user_id":19239577,"display_name":"greenButMellow"},"view_count":139,"up_vote_count":4,"accepted_answer_id":75373070,"answer_count":2,"score":2,"creation_date":1675770234,"question_id":75372888,"body":"<p>Consider the following code:</p>\n<pre><code>try (Transport transport = session.getTransport(&quot;smtp&quot;)) {\n    transport.connect();\n} catch (MessagingException ignored) {}\n</code></pre>\n<p>What if, for some reason the auto-close fails? That might leave internally some file handler open (maybe not with SMTP but in general)</p>\n<p>So is it correct to say that this code is prone to a resource/memory leak?</p>\n<p>If the answer's yes, then what should a program do in such case?</p>\n"},{"tags":["java","spring-boot","jms","spring-jms","tibco-ems"],"comments":[{"owner":{"user_id":18157,"display_name":"Jim Garrison"},"edited":false,"comment_id":132745840,"body":"This is tough because the Tibco docs don&#39;t show the entire inheritance hierarchy.  If <code>TibjmsConnectionFactory</code> doesn&#39;t implement <code>javax.jms.ConnectionFactory</code> they you may be out of luck."},{"owner":{"user_id":1240763,"display_name":"Gary Russell"},"edited":false,"comment_id":132745867,"body":"Boot 3/Spring 6 moved from the javax to the jakarta namespace for JEE support - you either need to find a Tibco jar for JEE 9 or drop back to Boot 2.7/Spring 5.3."}],"answers":[{"owner":{"user_id":1240763,"display_name":"Gary Russell"},"up_vote_count":3,"is_accepted":true,"creation_date":1674591337,"answer_id":75226831,"body":"<p>Boot 3/Spring 6 moved from the <code>javax</code> to the <code>jakarta</code> namespace for JEE support - you either need to find a Tibco jar for JEE 9 or drop back to Boot 2.7/Spring 5.3.</p>\n"},{"owner":{"user_id":10138996,"display_name":"pascalre"},"up_vote_count":0,"is_accepted":false,"creation_date":1677579585,"answer_id":75590658,"body":"<p>Spring Boot 3 moved to the jakarta namespace. To be compatible with it, you need to use the (jakarta) client libraries from TIBCO EMS 10, those are backwards compatible.</p>\n"},{"owner":{"user_id":2171537,"display_name":"VinayBS"},"up_vote_count":1,"is_accepted":false,"creation_date":1682571809,"answer_id":76116903,"body":"<p>Encountered same issue. tibjms has jakarta compatible library that comes with Tibco EMS 10.2. Unfortunately, this library is not published in public maven repo.\nTo be able to use this, download the latest Tibco EMS community edition, install in the system and you will be able to see the lib under tibco/ems/10.2/lib folder with name jakarta.jms-tibjms.jar\nUpload it to your private nexus repo and thats it. You need corresponding   jakarta.jms-api dependency. This library is available in public maven repo.</p>\n"}],"owner":{"user_id":18106551,"display_name":"Sricharan Anand"},"view_count":367,"up_vote_count":2,"accepted_answer_id":75226831,"answer_count":3,"score":2,"creation_date":1674590597,"question_id":75226702,"body":"<p>I am trying to work on a tibco JMS CDC product. I have issues setting up the configuration and could not find a solution to my problem.</p>\n<pre><code>import com.tibco.tibjms.TibjmsConnectionFactory;\n\nimport javax.jms.JMSException;\n</code></pre>\n<pre><code>@Configuration\n@EnableJms\npublic class TibcoBusConfiguration {\n    @Value(&quot;${ems.password}&quot;)\n    private String password;\n\n    @Value(&quot;${ems.port}&quot;)\n    private String port;\n\n    @Value(&quot;${ems.topic}&quot;)\n    private String queue;\n\n    @Value(&quot;${ems.server}&quot;)\n    private String server;\n\n    @Value(&quot;${ems.user}&quot;)\n    private String user;\n\n    @Bean(name = &quot;tibjmsConnectionFactory&quot;)\n    public TibjmsConnectionFactory jmsConnectionFactory() throws javax.jms.JMSException {\n        final TibjmsConnectionFactory factory = new TibjmsConnectionFactory();\n\n        factory.setServerUrl(serverURL());\n        factory.setUserName(user);\n        factory.setUserPassword(password);\n\n        return factory;\n    }\n\n    @Bean\n    public JmsTemplate jmsTemplate(\n        @Autowired TibjmsConnectionFactory tibjmsConnectionFactory) throws JMSException {\n        final JmsTemplate jmsTemplate = new JmsTemplate();\n\n        jmsTemplate.setConnectionFactory(jmsConnectionFactory());\n        jmsTemplate.setDefaultDestinationName(queue);\n        jmsTemplate.setExplicitQosEnabled(true);\n        jmsTemplate.setDeliveryMode(DeliveryMode.PERSISTENT);\n        jmsTemplate.setSessionAcknowledgeMode(Session.CLIENT_ACKNOWLEDGE);\n        jmsTemplate.setSessionTransacted(false);\n\n        return jmsTemplate;\n    }\n\n    private String serverURL() {\n        return &quot;tcp://&quot; + server + &quot;:&quot; + port;\n    }\n\n\n\n}\n</code></pre>\n<p>Unfortunately JmsTemplate only allows jakarta.jms.ConnectionFactory, how do I pass in the TibcoConnectionFactory, because casting is not allowed since the classes do not match. Is my understanding of this incorrect?</p>\n<p>I have the following JAR's in my maven setup: tibjms.jar jakarta.jms-api-3.0 javax.jms-api-2.0</p>\n<p>Thanks in Advance</p>\n"},{"tags":["java","android-studio","jvm-crash"],"answers":[{"owner":{"user_id":14487489,"display_name":"Derrick"},"up_vote_count":2,"is_accepted":false,"creation_date":1674336720,"answer_id":75196706,"body":"<p>I just had this exact problem happen to me today after the same update.  I went through this thread to find me solution:</p>\n<p><a href=\"https://stackoverflow.com/questions/17759671/android-studio-failed-to-load-jvm-dll\">Android Studio Failed to Load JVM DLL</a></p>\n<p>Sounds like there are different fixes out out there.  I had to try several before getting it to work.</p>\n<p>Good luck!</p>\n"},{"owner":{"user_id":1404820,"display_name":"Niamul Hasan"},"up_vote_count":2,"is_accepted":false,"creation_date":1674773831,"answer_id":75252496,"body":"<p>I faced the same problem after installing android studio release electric eel on a fresh windows device. It turns out I was missing JDK.\nSo what  I did was</p>\n<ol>\n<li>Installed the JDK</li>\n<li>Set the jdk's bin location to path</li>\n<li>Set JAVA_HOME variable</li>\n</ol>\n"},{"owner":{"user_id":17534901,"display_name":"HSaunders603"},"up_vote_count":0,"is_accepted":true,"creation_date":1674920611,"answer_id":75268844,"body":"<p>Thanks for all the help guys! I ended up installing Microsoft Visual C++ X64, and then restarting Android Studio.</p>\n"}],"owner":{"user_id":17534901,"display_name":"HSaunders603"},"view_count":1418,"up_vote_count":2,"accepted_answer_id":75268844,"answer_count":3,"score":2,"creation_date":1674326822,"question_id":75195753,"body":"<p><a href=\"https://i.stack.imgur.com/kCpf4.png\" rel=\"nofollow noreferrer\">Error Message</a></p>\n<p>The error message I'm receiving reads:</p>\n<pre><code>Failed to load JVM DLL C:\\Program Files\\Android\\Android Studio\\jbr\\\\bin\\server\\jvm.dll\nIf you already have a JDK installed, define a JAVA_HOME variable in Computer &gt; System Properties &gt; System Settings &gt; Environment Variables.\n</code></pre>\n<p>I am running a 2022 Framework laptop with Windows 11, attempting to install 64-bit Electric Eel Android Studio. I believe this problem originated when I was attempting to uninstall Android Studio after running (breaking) an emulator.</p>\n<p>It appears in a small window instead of Android Studio. I already tried uninstalling every Java-related thing, reinstalling Java from the Oracle website, hard resetting my whole computer and deleting all files, and reinstalling Android Studio. Is there any way that I can easily reconfigure it?</p>\n"},{"tags":["java","jackson","timezone-offset","json-serialization","zoneid"],"comments":[{"owner":{"user_id":5772882,"display_name":"Ole V.V."},"edited":false,"comment_id":132817022,"body":"The format with the colon is the <a href=\"https://en.wikipedia.org/wiki/ISO_8601\" rel=\"nofollow noreferrer\">ISO 8601 standard</a>. You can’t persuade the consumer of your JSON to accept that?"},{"owner":{"user_id":5772882,"display_name":"Ole V.V."},"edited":false,"comment_id":132817078,"body":"<code>ZoneId</code> is harder. It represents an ID of a time zone that in virtually all cases has had and will have different UTC offset through history and future. I don’t see any reasoable way to serialize that to a numeric string, and under no circumstances will the receiver be able to reconstruct the <code>ZoneId</code> object at the other end."},{"owner":{"user_id":5772882,"display_name":"Ole V.V."},"edited":false,"comment_id":132817116,"body":"And no, I believe there is no support for <code>+03.00</code> with a point/dot neither in Jackson nor in java.time. If we can’t get rid of that requirement, I would use a custom serializer and inside that something like <code>ZoneOffset.ofHours(3).toString().replace(&#39;:&#39;, &#39;.&#39;)</code> (this gives <code>+03.00</code>)."},{"owner":{"user_id":18295167,"display_name":"trom"},"edited":false,"comment_id":132831993,"body":"Thank you, I resolved this task by custom serializer with replacing &#39;:&#39; by &#39;.&#39;"}],"answers":[{"owner":{"user_id":10819573,"display_name":"Arvind Kumar Avinash"},"up_vote_count":2,"is_accepted":false,"creation_date":1674911307,"answer_id":75267884,"body":"<p>The zone offset, <code>+03:00</code> is already in the <a href=\"https://en.wikipedia.org/wiki/ISO_8601\" rel=\"nofollow noreferrer\">ISO 8601</a> standard format. Therefore, you should educate the publisher/consumer to stick to it. However, if you want to change it in the desired format for any reason, here is how you can do it:</p>\n<pre><code>import java.time.ZoneOffset;\n\nclass Main {\n    public static void main(String[] args) {\n        ZoneOffset offset = ZoneOffset.of(&quot;+03:00&quot;);\n        String formatted = offset.toString().replace(':', '.');\n        System.out.println(formatted);\n    }\n}\n</code></pre>\n<p><strong>Output</strong>:</p>\n<pre><code>+03.00\n</code></pre>\n<p>Learn more about the modern Date-Time API from <strong><a href=\"https://docs.oracle.com/javase/tutorial/datetime/index.html\" rel=\"nofollow noreferrer\">Trail: Date Time</a></strong>.</p>\n"},{"owner":{"user_id":18295167,"display_name":"trom"},"up_vote_count":2,"is_accepted":false,"creation_date":1675011562,"answer_id":75276697,"body":"<p>To resolve this tak I made custom serializer:</p>\n<pre><code>object ZoneOffsetSerializer : JsonSerializer&lt;ZoneOffset&gt;() {\n    override fun serialize(value: ZoneOffset, jsonGenerator: JsonGenerator, serializers: SerializerProvider) {\n        val result = &quot;0&quot;.takeIf { value.totalSeconds == 0 } ?: value.toString().replace(':', '.')\n\n        jsonGenerator.writeString(result)\n    }\n}\n</code></pre>\n<p>and used annotation <code>@JsonSerialize(using = ZoneOffsetSerializer::class)</code> for necessary fields</p>\n"}],"owner":{"user_id":18295167,"display_name":"trom"},"view_count":92,"up_vote_count":2,"answer_count":2,"score":2,"creation_date":1674260926,"question_id":75190469,"body":"<p>What is the best way to serialize ZoneId or ZoneOffset from format +03:00 to format +03.00 using Jackson? Or may be there is another way how to change : to .</p>\n"},{"tags":["java","console","system"],"comments":[{"owner":{"user_id":3890632,"display_name":"khelwood"},"edited":false,"comment_id":132604028,"body":"It looks like it wants to make sure that the correct <code>c</code> is returned, even if <code>cons</code> is reassigned in another thread before the return statement is reached."},{"owner":{"user_id":6477761,"display_name":"Milchshakee"},"edited":false,"comment_id":132604322,"body":"@khelwood But couldn&#39;t you just wrap the entire method in a synchronized block?"},{"owner":{"user_id":3890632,"display_name":"khelwood"},"edited":false,"comment_id":132604374,"body":"Yeah if you want the entire method to be synchronized."}],"answers":[{"owner":{"user_id":1968,"display_name":"Konrad Rudolph"},"up_vote_count":4,"is_accepted":true,"creation_date":1673945963,"answer_id":75143998,"body":"<p><strong>tl;dr:</strong> It’s a common optimisation technique.</p>\n<p>This pattern is called <a href=\"https://en.wikipedia.org/wiki/Double-checked_locking\" rel=\"nofollow noreferrer\">double-checked locking</a>.</p>\n<p>The implementation could also just look much simpler, as follows:</p>\n<pre><code>public static synchronized Console console() {\n    if (cons == null) {\n        cons = SharedSecrets.getJavaIOAccess().console();\n    }\n    return cons;\n}\n</code></pre>\n<p>However, that way we would <em>always</em> lock the entire <code>System</code> class for every single call of the <code>console</code> method, which would lead to a substantial slowdown in typical applications.</p>\n<p>Instead, the actual implementation defensively locks the object <em>only</em> if it can’t acquire a valid <code>cons</code> instance. And it assigns the result to a local variable <code>c</code> so that this instance remains valid even if another thread overrides <code>cons</code> after the (unlocked) check happens. It also helps reduce reading the <code>cons</code> reference, which is declared as <code>volatile</code>, and reading it is thus slower than reading a non-volatile reference.</p>\n"}],"owner":{"user_id":6477761,"display_name":"Milchshakee"},"view_count":63,"up_vote_count":2,"accepted_answer_id":75143998,"answer_count":1,"score":2,"creation_date":1673944061,"question_id":75143633,"body":"<p>I stumbled upon the source code of System.console() and I'm unsure why exactly it is implemented like this:</p>\n<pre><code>/**\n * Returns the unique {@link java.io.Console Console} object associated\n * with the current Java virtual machine, if any.\n *\n * @return  The system console, if any, otherwise {@code null}.\n *\n * @since   1.6\n */\n public static Console console() {\n     Console c;\n     if ((c = cons) == null) {\n         synchronized (System.class) {\n             if ((c = cons) == null) {\n                 cons = c = SharedSecrets.getJavaIOAccess().console();\n             }\n         }\n     }\n     return c;\n }\n</code></pre>\n<p>More specifically, what is the point of the assignments to <code>c</code>? The variable <code>cons</code> is already static and holds the console object.</p>\n"},{"tags":["java","android","qr-code","onactivityresult"],"comments":[{"owner":{"user_id":12899294,"display_name":"Rui Alves"},"edited":false,"comment_id":132592489,"body":"Read documentation.(<a href=\"https://developer.android.com/training/basics/intents/result\" rel=\"nofollow noreferrer\">developer.android.com/training/basics/intents&zwnj;&#8203;/result</a>) This is also a duplicated, which means that you didn&#39;t even look for a solution."}],"answers":[{"owner":{"user_id":20109632,"display_name":"Chintan Bhanderi"},"up_vote_count":4,"is_accepted":false,"creation_date":1673887495,"answer_id":75137223,"body":"<p>A basic training is available at <a href=\"https://developer.android.com/training/basics/intents/result\" rel=\"nofollow noreferrer\">https://developer.android.com/training/basics/intents/result</a></p>\n<p>Here is an example on how to convert the existing code with the new one:</p>\n<p><strong>The old way:</strong></p>\n<pre><code>public void openSomeActivityForResult() {\n    Intent intent = new Intent(this, SomeActivity.class);\n    startActivityForResult(intent, 123);\n}\n\n@Override\nprotected void onActivityResult (int requestCode, int resultCode, Intent data) {\n    if (resultCode == Activity.RESULT_OK &amp;&amp; requestCode == 123) {\n        doSomeOperations();\n    }\n}\n</code></pre>\n<p><strong>The new way (Java):</strong></p>\n<pre><code>public void openSomeActivityForResult() {\n    Intent intent = new Intent(this, SomeActivity.class);\n    someActivityResultLauncher.launch(intent);\n}\n\n// You can do the assignment inside onAttach or onCreate, i.e, before the activity is displayed\nActivityResultLauncher&lt;Intent&gt; someActivityResultLauncher = registerForActivityResult(\n        new ActivityResultContracts.StartActivityForResult(),\n        new ActivityResultCallback&lt;ActivityResult&gt;() {\n            @Override\n            public void onActivityResult(ActivityResult result) {\n                if (result.getResultCode() == Activity.RESULT_OK) {\n                    // There are no request codes\n                    Intent data = result.getData();\n                    doSomeOperations();\n                }\n            }\n        });\n</code></pre>\n<p>This is Your Code</p>\n<pre><code>public class MainActivity extends AppCompatActivity {\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.qr_scanner_layout);\n\n\n        //Button click event to open QR scanner\n        findViewById(R.id.camera_button).setOnClickListener(v -&gt; {\n            Intent intent = new Intent(MainActivity.this, QRCodeScanner.class);\n            intent.putExtra(&quot;SCAN_FORMATS&quot;, &quot;QR_CODE&quot;);\n             someActivityResultLauncher.launch(intent);\n        });\n    }\n\n// You can do the assignment inside onAttach or onCreate, i.e, before the activity is displayed\nActivityResultLauncher&lt;Intent&gt; someActivityResultLauncher = registerForActivityResult(\n        new ActivityResultContracts.StartActivityForResult(),\n        new ActivityResultCallback&lt;ActivityResult&gt;() {\n            @Override\n            public void onActivityResult(ActivityResult result) {\n                if (result.getResultCode() == Activity.RESULT_OK) {\n                    // There are no request codes\n                    Intent data = result.getData();\n                    if (data != null) {\n                String scannedText = data.getStringExtra(&quot;com.journeyapps.barcodescanner.CaptureActivity.SCAN_RESULT&quot;);\n                TextView scannedTextView = findViewById(R.id.scanned_text);\n                scannedTextView.setText(scannedText);\n            }\n                }\n            }\n        });\n}\n</code></pre>\n"},{"owner":{"user_id":13598222,"display_name":"cactustictacs"},"up_vote_count":0,"is_accepted":false,"creation_date":1673889145,"answer_id":75137509,"body":"<p>If a function is deprecated, <a href=\"https://developer.android.com/reference/kotlin/androidx/activity/ComponentActivity?hl=en#startActivityForResult(android.content.Intent,int)\" rel=\"nofollow noreferrer\">the documentation usually tells you <em>why</em> and what you should use instead</a>:</p>\n<blockquote>\n<p><strong>This function is deprecated.</strong></p>\n<p>This method has been deprecated in favor of using the Activity Result API which brings increased type safety via an <code>ActivityResultContract</code> and the prebuilt contracts for common intents available in <code>androidx.activity.result.contract.ActivityResultContracts</code>, provides hooks for testing, and allow receiving results in separate, testable classes independent from your activity. Use <code>registerForActivityResult</code> passing in a <code>StartActivityForResult</code> object for the <code>ActivityResultContract</code>.</p>\n</blockquote>\n<p>The other answer shows you the developer guide for using this stuff and has an example, but it's important to always look at the documentation when you run into deprecated stuff - it's rare a function is removed with no information, and sometimes you won't need to worry about the deprecation anyway (e.g. if it only happened with the newest version of Android, meaning they've just decided it will be removed <em>sometime in the future</em> as the older APIs fall out of use)</p>\n"}],"owner":{"user_id":21021052,"display_name":"Netbull"},"view_count":923,"up_vote_count":2,"answer_count":2,"score":2,"creation_date":1673886842,"question_id":75137115,"body":"<p>'startActivityForResult(android.content.Intent, int)' is deprecated, what can I do? This is the code for my QR code scanner Android app (Java):</p>\n<pre><code>package com.example.wfr;\n\nimport android.content.Intent;\nimport android.os.Bundle;\nimport android.widget.TextView;\n\nimport androidx.annotation.Nullable;\nimport androidx.appcompat.app.AppCompatActivity;\n\npublic class MainActivity extends AppCompatActivity {\n    private static final int REQUEST_CODE = 0;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.qr_scanner_layout);\n\n\n        //Button click event to open QR scanner\n        findViewById(R.id.camera_button).setOnClickListener(v -&gt; {\n            Intent intent = new Intent(MainActivity.this, QRCodeScanner.class);\n            intent.putExtra(&quot;SCAN_FORMATS&quot;, &quot;QR_CODE&quot;);\n            startActivityForResult(intent, REQUEST_CODE);\n        });\n    }\n\n    @Override\n    protected void onActivityResult(int requestCode, int resultCode, @Nullable Intent data) {\n        super.onActivityResult(requestCode, resultCode, data);\n        if (requestCode == REQUEST_CODE &amp;&amp; resultCode == RESULT_OK) {\n            if (data != null) {\n                String scannedText = data.getStringExtra(&quot;com.journeyapps.barcodescanner.CaptureActivity.SCAN_RESULT&quot;);\n                TextView scannedTextView = findViewById(R.id.scanned_text);\n                scannedTextView.setText(scannedText);\n            }\n        }\n    }\n}\n</code></pre>\n"},{"tags":["java","spring","spring-boot","qualifiers"],"comments":[{"owner":{"user_id":2636929,"display_name":"Stultuske"},"edited":false,"comment_id":132544292,"body":"<a href=\"https://www.baeldung.com/spring-qualifier-annotation\" rel=\"nofollow noreferrer\">baeldung.com/spring-qualifier-annotation</a>"},{"owner":{"user_id":10461625,"display_name":"PatPanda"},"edited":false,"comment_id":132545603,"body":"The link you provided @Stultuske is pretty much my question. As you can see in the example of the tutorial <code>@Qualifier(&quot;fooFormatter&quot;)</code> the value is hard coded, not configurable. How to make it configurable please?"},{"owner":{"user_id":2636929,"display_name":"Stultuske"},"edited":false,"comment_id":132545939,"body":"not. you don&#39;t. You provide two autowired beans, and based on (if value equals english -&gt; use englishqualifiedBean else useOtherbean. basically: a factory pattern"},{"owner":{"user_id":10461625,"display_name":"PatPanda"},"edited":false,"comment_id":132546202,"body":"This is again the point of my question, many thanks. I have some 100+ concrete language beans. And Autowiring hundreds of concrete beans, + a giant if statement on the bean name is not optimal. Is there a way to simply configure which bean to use at application start time with a configurable @Qualifier?"},{"owner":{"user_id":2636929,"display_name":"Stultuske"},"edited":false,"comment_id":132546270,"body":"This might be against the &quot;point&quot; of your question, but at least it would work. You can&#39;t dynamically build a value you pass to an annotation. You might put them all in a Map, and have a specific (for instance that &quot;english&quot; and &quot;french&quot;) mapped to them, and you can get them that way."}],"answers":[{"owner":{"user_id":2636929,"display_name":"Stultuske"},"up_vote_count":1,"is_accepted":false,"creation_date":1673619650,"answer_id":75110432,"body":"<p>You can't make this dynamic, you'll need to use a workaround.\nA factory pattern would do well, here. Instead of one bean, you would have two, and based on the value of that property, you would let your factory choose which one to use.</p>\n<pre><code>@Component\npublic class LanguageFactory {\n\n  @Autowired\n  @Qualifier(&quot;english&quot;)\n  private LanguageService englishLanguage;\n\n  @Autowired\n  @Qualifier(&quot;french&quot;)\n  private LanguageService frenchLanguage;\n\n  @Value(&quot;${configuration}&quot;)\n  private String chosenLanguage;\n\n  public LanguageService getLanguageService() {\n    switch(chosenLanguage) {\n      case &quot;english&quot;: return englishLanguage;\n      case &quot;french&quot;: return frenchLanguage;\n      // add any other language you need\n      default: throw new Exception(&quot;Invalid language: &quot; + chosenLanguage);\n    }\n   }\n}\n</code></pre>\n<p>So, in your LanguageController, you would get something like this:</p>\n<pre><code>  @Autowired\n  private LanguageFactory languageFactory;\n\n  @GetMapping(&quot;/test&quot;)\n  public String test(@RequestParam String name) {\n      return languageFactory.getLangaugeService().process(name);\n  }\n</code></pre>\n<p>EDIT:</p>\n<p>Another option would be to use a Map. You would avoid all the if-elses, but you would still have to add them to a Map.</p>\n<pre><code>@Component\npublic class LanguageFactory {\n\n  private Map&lt;String, LanguageService&gt; languages = new HashMap&lt;&gt;();\n\n  @Value(&quot;${configuration}&quot;)\n  private String chosenLanguage;\n\n  @Autowired\n  public LanguageFactory(@Qualifier(&quot;english&quot;) LanguageService englishLanguage, @Qualifer(&quot;french&quot;) LanguageService frenchService) {\n    this.languages.put(&quot;english&quot;, englishLanguage);\n    this.languages.put(&quot;french&quot;, frenchLanguage);\n  }\n\n  public LanguageService getLanguageService() {\n    LanguageService ls = this.languages.get(chosenLanguage);\n    if ( ls == null ) {\n      // handle the issue as you see fit\n    }\n    return ls;\n  }\n}\n</code></pre>\n"},{"owner":{"user_id":639520,"display_name":"E-Riz"},"up_vote_count":2,"is_accepted":true,"creation_date":1673622020,"answer_id":75110883,"body":"<p>If you only need 1 of the <code>LanguageService</code> beans active at a time, then you can use <code>@ConditionalOnProperty</code> on each of them, each using a unique <code>havingValue</code>. Like this (warning, untested code written from memory):</p>\n<pre class=\"lang-java prettyprint-override\"><code>interface ConfigKeys {\n    public static final String LANGUAGE = &quot;my.app.prefix.language&quot;;\n}\n\n\n@Service\n@ConditionalOnProperty(name = ConfigKeys.LANGUAGE, havingValue = &quot;english&quot;)\npublic class EnglishLanguageServiceImpl implements LanguageService {\n\n    @Override\n    public String process(String name) {\n        return &quot;Welcome &quot; + name;\n    }\n\n}\n\n@Service\n@ConditionalOnProperty(name = ConfigKeys.LANGUAGE, havingValue = &quot;french&quot;)\npublic class FrenchLanguageServiceImpl implements LanguageService {\n\n    @Override\n    public String process(String name) {\n        return &quot;Bonjour &quot; + name;\n    }\n\n}\n</code></pre>\n<p>With that, you don't need any qualifiers, just set the <code>my.app.prefix.language</code> property in your config (application.properties or application.yaml) to the value you want, and there will just one <code>LanguageService</code> bean in the context. You can inject that bean wherever you need it without needing a qualifier.</p>\n"},{"owner":{"user_id":839733,"display_name":"Abhijit Sarkar"},"up_vote_count":1,"is_accepted":false,"creation_date":1673624441,"answer_id":75111358,"body":"<p>A much simpler option would be to group the related beans in <code>@Configuration</code> classes, and then use <code>@Conditional</code> to enable (or not) the configuration, and in turn, a set of beans. That way, you’re not dealing with individual beans, as you say you’ve many.</p>\n"}],"owner":{"user_id":10461625,"display_name":"PatPanda"},"view_count":163,"up_vote_count":2,"accepted_answer_id":75110883,"answer_count":3,"score":2,"creation_date":1673613807,"question_id":75109389,"body":"<p>Small question for SpringBoot, and how to configure the bean using <code>@Qualifier</code> please.</p>\n<p>I have a very straightforward piece of code:</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;\n         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n\n    &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;3.0.1&lt;/version&gt;\n        &lt;relativePath/&gt;\n    &lt;/parent&gt;\n\n    &lt;groupId&gt;com.question&lt;/groupId&gt;\n    &lt;artifactId&gt;language&lt;/artifactId&gt;\n    &lt;version&gt;1.1&lt;/version&gt;\n\n    &lt;name&gt;language&lt;/name&gt;\n    &lt;description&gt;Spring Boot&lt;/description&gt;\n\n    &lt;properties&gt;\n        &lt;java.version&gt;17&lt;/java.version&gt;\n        &lt;maven.compiler.source&gt;17&lt;/maven.compiler.source&gt;\n        &lt;maven.compiler.target&gt;17&lt;/maven.compiler.target&gt;\n        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\n    &lt;/properties&gt;\n\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n\n&lt;/project&gt;\n\n</code></pre>\n<pre><code>package com.question;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\n\n@SpringBootApplication\npublic class LanguageApplication {\n\n    public static void main(String[] args) {\n        SpringApplication.run(LanguageApplication.class, args);\n    }\n\n}\n</code></pre>\n<pre><code>package com.question.service;\n\npublic interface LanguageService {\n\n    String process(String name);\n\n}\n\n</code></pre>\n<pre><code>package com.question.service;\n\nimport org.springframework.stereotype.Service;\n\n@Service(&quot;french&quot;)\npublic class FrenchLanguageServiceImpl implements LanguageService {\n\n    @Override\n    public String process(String name) {\n        return &quot;Bonjour &quot; + name;\n    }\n\n}\n\n</code></pre>\n<pre><code>package com.question.service;\n\nimport org.springframework.stereotype.Service;\n\n@Service(&quot;english&quot;)\npublic class EnglishLanguageServiceImpl implements LanguageService {\n\n    @Override\n    public String process(String name) {\n        return &quot;Welcome &quot; + name;\n    }\n\n}\n\n</code></pre>\n<pre><code>package com.question.controller;\n\nimport com.question.service.LanguageService;\nimport org.springframework.beans.factory.annotation.Qualifier;\nimport org.springframework.beans.factory.annotation.Value;\nimport org.springframework.web.bind.annotation.*;\n\n@RestController\npublic class LanguageController {\n\n    private final LanguageService languageService;\n\n    @Value(&quot;${configuration}&quot;)\n    public String configuration;\n\n    public LanguageController(@Qualifier(configuration) LanguageService languageService) {\n        this.languageService = languageService;\n    }\n\n    @GetMapping(&quot;/test&quot;)\n    public String test(@RequestParam String name) {\n        return languageService.process(name);\n    }\n\n}\n\n</code></pre>\n<p>Expected:</p>\n<p>What I hope to achieve is equally straightforward. I would like to pass some sort of configuration to <code>application.properties</code>, something like <code>configuration=french</code> or <code>configuration=english</code>.</p>\n<p>At the controller layer, to use <code>(@Qualifier(configuration) LanguageService languageService)</code> And the correct concrete service will be used.</p>\n<p>Actual:</p>\n<p>Unfortunately,</p>\n<p><code>@Qualifier(configuration) + @Value(&quot;${configuration}&quot;) public String configuration;</code></p>\n<p>will yield <code>Attribute Value must be constant</code>.</p>\n<p>Is there a way we can configure the concrete Bean via a configurable <code>@Qualifier</code> please?</p>\n<p>I understand there is a way to workaround this by using ApplicationContext getBean.</p>\n<p>But having this construct: @Qualifier(configuration) makes the code clean and easily understandable. How to achieve this please?</p>\n<p>Thank you</p>\n"},{"tags":["java","operators","calculator","operands"],"answers":[{"owner":{"user_id":773113,"display_name":"Mike Nakis"},"up_vote_count":4,"is_accepted":false,"creation_date":1673428982,"answer_id":75080752,"body":"<p>What you are looking for is a proper <em><strong>parser</strong></em>, that would convert your string into what is known as a <em><strong>parse-tree</strong></em>, so that you can then perform the operations described by the parse tree.</p>\n<p>So, a parser for numeric expressions would convert the string &quot;20/((10+5)*2)&quot; into the following parse-tree:</p>\n<pre><code>               [/]\n              /   \\\n             20   [*]\n                 /   \\\n               [+]    2\n              /   \\\n             10    5\n</code></pre>\n<p>Then you would perform your calculations on the parse-tree, recursively, as follows:</p>\n<ul>\n<li>to compute the value of the current node:\n<ul>\n<li>if the node is a leaf node, (a numeral,) then:\n<ul>\n<li>use the value of the numeral as the value of the node.</li>\n</ul>\n</li>\n<li>if the node is a non-leaf node, (an operand with child nodes,) then:\n<ul>\n<li>compute the value of the left child node (recursion)</li>\n<li>compute the value of the right child node (recursion)</li>\n<li>perform the calculation indicated by the operand on the two computed values.</li>\n<li>use the result of the calculation as the value of the node.</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>Parsers are an entire sub-topic of Information Science, (otherwise known as &quot;Computer Science&quot;,) so they cannot really be explained in a stackoverflow answer, but at least you have a name now, that you can use to search for more information if you want to.</p>\n"}],"owner":{"user_id":20664407,"display_name":"Daleo dorito"},"view_count":124,"up_vote_count":2,"answer_count":1,"score":2,"creation_date":1673428601,"question_id":75080666,"body":"<p>How do you tell Java the order of operands?</p>\n<p>Well, I am pretty new to coding and a friend of mine in a higher course got asked to make a calculator and I got interested in how would it would work.</p>\n<p>I searched for it and the solutions I found are pretty much just a superbasic calculator, is code I could do my self (and I appreciate that cause there is a lot I do not understand yet); but I am looking for something more complex.</p>\n<p>The proposals were something like:</p>\n<pre><code>Double result = 0;\n\nSystem.out.println (&quot;First opperand:&quot;);\nNum1 = scan.next double();\n\nSystem.out.println (&quot;Choose operation (+,-,*,/):&quot;);\nOpe = scan.next();\n\nSystem.out.println (&quot;Second opperand:&quot;);\nNum2 = scan.next double();\n\nSwitch (ope) {\n Case '+':\n  Result = num1 + num2;\n  break;\n\n Case '-':\n  Result = num1 - num2;\n  break;\n\n//and so on for each different operand that you want to add\n}\n\nSystem.out.println (result);\n</code></pre>\n<p>The thing is, I guess the idea of a calculator is the user to input a operation as a string and then the calculator interprets the operands and opperator. I guess you can do this somewhat easy with the string class, telling it to search the full string for successions of numbers as new opperands variables to create and anything else as a operator and check if they are valid (don't really know how to properly program that yet since I am still very new to this as I told before).</p>\n<p>But the actual question is, how could I tell the program the order of operations of something like &quot;20/((10+5)*2)&quot;?</p>\n<p>I think I could kinda deal with the basic opperators but how do I deal with parentheses?</p>\n<p>I don't know if this is way more advanced and I won't even understand the answer or it is actually kinda simple and I just need some perspective but I am like really intriged by this and that's why I am asking</p>\n"},{"tags":["java","spring","spring-boot","junit","mockito"],"comments":[{"owner":{"user_id":2696260,"display_name":"M. Deinum"},"edited":false,"comment_id":132469104,"body":"You are using Spring Boot 2.7 which is build with Spring 5.3. Spring 6 is for Spring Boot 3 (and is totally different). As you are using Spring Boot, use <code>spring-boot-starter-test</code> and remove the other test dependencies (junit, spring-test and mockito) those will be included in the proper compatible versions."},{"owner":{"user_id":9947525,"display_name":"Fazal Haroon"},"edited":false,"comment_id":132469419,"body":"thanks, M. Deiunm yes, spring framework 6 and spring boot 3 are totally different."}],"answers":[{"owner":{"user_id":9947525,"display_name":"Fazal Haroon"},"up_vote_count":3,"is_accepted":true,"creation_date":1673295669,"answer_id":75062533,"body":"<p>Nothing wrong with the code. I just change my <strong>pom.xml</strong>, remove the version from <em>org.springframework</em> then run, it worked perfectly</p>\n<pre><code>      &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-test&lt;/artifactId&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;junit&lt;/groupId&gt;\n            &lt;artifactId&gt;junit&lt;/artifactId&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.mockito&lt;/groupId&gt;\n            &lt;artifactId&gt;mockito-core&lt;/artifactId&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n</code></pre>\n<p>Removing unwanted dependencies from the maven build resolved the issue.</p>\n<p><strong>Yahoo!! Great</strong></p>\n<p><strong>Note:</strong> SNAPSHOT, M1, M2, M3, and M4 releases typically WORK IN PROGRESS. The Spring team is still working on them, Recommend NOT using them.</p>\n"},{"owner":{"user_id":295339,"display_name":"Lars Andren"},"up_vote_count":1,"is_accepted":false,"creation_date":1675665235,"answer_id":75358041,"body":"<p>I got this error when using <code>spring-test 6.0.4</code>. However, when I changed to using version <code>5.3.24</code> it started working.</p>\n"}],"owner":{"user_id":9947525,"display_name":"Fazal Haroon"},"view_count":732,"up_vote_count":2,"accepted_answer_id":75062533,"answer_count":2,"score":2,"creation_date":1673295489,"question_id":75062502,"body":"<p><strong>Unit Testing with Spring framework - Java</strong></p>\n<p>I got the below error when I run the spring unit test with a java context</p>\n<pre><code>java.lang.IllegalStateException: Could not load CacheAwareContextLoaderDelegate [org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate]\n</code></pre>\n<p>My <strong>pom.xml</strong> have these dependencies but still faced this issue when i run my test case</p>\n<pre><code>        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-test&lt;/artifactId&gt;\n            &lt;version&gt;6.0.3&lt;/version&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;junit&lt;/groupId&gt;\n            &lt;artifactId&gt;junit&lt;/artifactId&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.mockito&lt;/groupId&gt;\n            &lt;artifactId&gt;mockito-core&lt;/artifactId&gt;\n            &lt;version&gt;4.5.1&lt;/version&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n</code></pre>\n<p>My current version of spring and java</p>\n<pre><code>    &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;2.7.7&lt;/version&gt;\n        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;\n    &lt;/parent&gt;\n    &lt;groupId&gt;com.example&lt;/groupId&gt;\n    &lt;artifactId&gt;demo&lt;/artifactId&gt;\n    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n    &lt;name&gt;demo&lt;/name&gt;\n    &lt;description&gt;Demo project for Spring Boot&lt;/description&gt;\n    &lt;properties&gt;\n        &lt;java.version&gt;11&lt;/java.version&gt;\n    &lt;/properties&gt;\n</code></pre>\n<p>I just change my <strong>pom.xml</strong>, remove the version then run, it worked perfectly</p>\n<pre><code>      &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-test&lt;/artifactId&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt; \n</code></pre>\n"},{"tags":["java","jdbc","try-with-resources"],"comments":[{"owner":{"user_id":11002,"display_name":"tgdavies"},"edited":false,"comment_id":132421470,"body":"Yes, your DB resources will all be closed correctly. In the second case there is no <code>ResultSet</code> to close."}],"answers":[{"owner":{"user_id":642706,"display_name":"Basil Bourque"},"up_vote_count":4,"is_accepted":true,"creation_date":1673085466,"answer_id":75039435,"body":"<h1>Yes, correct</h1>\n<p>Yes, you have correctly used try-with-resources syntax to close your JDBC resources appropriately.</p>\n<p>You said:</p>\n<blockquote>\n<p>connection and reslutset both need to be closed</p>\n</blockquote>\n<p>Yes.</p>\n<ul>\n<li>Both <code>Connection</code> and <code>ResultSet</code> classes are documented as having a <code>close</code> method that releases resources. So you should close them as early as is practical.</li>\n<li>Both classes are documented as implementing <a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/AutoCloseable.html\" rel=\"nofollow noreferrer\"><code>AutoCloseable</code></a>. So you can use them with try-with-resources syntax.</li>\n</ul>\n<p>Ditto for <code>java.sql.Statement</code>.</p>\n<p>In contrast, look at the <a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/java.sql/java/sql/ResultSetMetaData.html\" rel=\"nofollow noreferrer\"><code>ResultSetMetaData</code></a> class. That class has no <code>close</code> method, and does not implement <code>AutoCloseable</code>. So that class, unlike a regular <code>ResultSet</code>, does not need to be closed, and cannot be used in try-with-resources syntax.</p>\n<h1><code>AutoCloseable</code></h1>\n<p>You said:</p>\n<blockquote>\n<p>But in the second case executeUpdate cannot be put in ().</p>\n</blockquote>\n<p>The <code>executeUpdate</code> method does not return an <code>AutoCloseable</code> object. So that method cannot be called with try-with-resources syntax.</p>\n<p>That method <code>executeUpdate</code> returns a primitive <code>int</code> rather than a reference to an object. So there is no <code>close</code> method to call.</p>\n"}],"owner":{"user_id":17766026,"display_name":"Nemo "},"view_count":97,"up_vote_count":3,"accepted_answer_id":75039435,"answer_count":1,"score":2,"creation_date":1673083057,"question_id":75039229,"body":"<p>I have this small project and I need to connect my Java application to the database. I have succeeded. I have few questions though. I'm not sure how to handle resources. As of now, I defaulted to packing as much as I can into try-with-resources because, it is reliable option for closing them automatically. But I'm not 100% sure if I'm doing it right.</p>\n<p>There are 2 cases:</p>\n<ol>\n<li>I use function <code>ResultSet executeQuery(String sql)</code></li>\n</ol>\n<pre class=\"lang-java prettyprint-override\"><code>try \n(\n    Connection connection = DriverManager.getConnection(url, user, password);\n    Statement statement = connection.createStatement();\n    ResultSet resultSet = statement.executeQuery(query)\n) \n{\n    ResultSetMetaData rsmd = resultSet.getMetaData();\n    int columnsNumber = rsmd.getColumnCount();\n    String number = new String();\n\n    while (resultSet.next()) {\n        for (int i = 1; i &lt;= columnsNumber; i++) {\n            number = resultSet.getString(i);\n        }\n    }\n    retValue = Integer.parseInt(number);\n    …\n}\n</code></pre>\n<ol start=\"2\">\n<li>I use function <code> int executeUpdate(String sql)</code></li>\n</ol>\n<pre class=\"lang-java prettyprint-override\"><code>try \n(\n    Connection connection = DriverManager.getConnection(url, user, password);\n    Statement statement = connection.createStatement()\n) \n{\n    statement.executeUpdate(query);\n    …\n}\n</code></pre>\n<p>From what I understand, Connection and ResultSet both need to be closed. In first case I am using result set later, so that's why I'm creating a variable in () of try. But in the second case executeUpdate cannot be put in (). I know that it returns int, but I am still unsure. Is this sufficient? Are connection and result set closed properly?</p>\n"},{"tags":["java","spring","postgresql","jpa","spring-data-jpa"],"comments":[{"owner":{"user_id":7871511,"display_name":"Rohit Agarwal"},"edited":false,"comment_id":132308570,"body":"Can you please share application.properties file"},{"owner":{"user_id":3426309,"display_name":"Andrey B. Panfilov"},"edited":false,"comment_id":132308604,"body":"<code>user</code> is a <a href=\"https://www.postgresql.org/docs/current/sql-keywords-appendix.html\" rel=\"nofollow noreferrer\">reserved word in PostgreSQL</a>, you need to chose another table name for your entity."},{"owner":{"user_id":15445661,"display_name":"Raul Penate"},"edited":false,"comment_id":132308605,"body":"@RohitAgarwal Sure, I updated the question with the file."},{"owner":{"user_id":15445661,"display_name":"Raul Penate"},"edited":false,"comment_id":132308629,"body":"@AndreyB.Panfilov Holy moly, yeah I rename it to <code>users</code> and it worked, thanks!!! feel free to post your answer so it helps more people, happy new year guys 🫂"}],"answers":[{"owner":{"user_id":14912402,"display_name":"WiatroBosy"},"up_vote_count":2,"is_accepted":true,"creation_date":1672583901,"answer_id":74975220,"body":"<pre><code>create table public.user ( id serial not null, \n               email varchar(255), \n               name varchar(255), \n               priority integer, \n               primary key (id))\n</code></pre>\n<p>add the schema name before the table name</p>\n<p><a href=\"https://i.stack.imgur.com/z7x85.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/z7x85.png\" alt=\"enter image description here\" /></a></p>\n"},{"owner":{"user_id":10839630,"display_name":"Altan Mehmet T&#252;rkmen"},"up_vote_count":1,"is_accepted":false,"creation_date":1672757279,"answer_id":74994926,"body":"<p>You need to specify the schema name in table and id fields like this:</p>\n<pre><code>@Table(name = &quot;anomaly&quot;, schema = &quot;schema_name&quot;)\npublic class Anomaly {\n\n@Id\n@SequenceGenerator(name = &quot;id&quot;,  allocationSize = 1, schema = &quot;schema_name&quot;)\n@GeneratedValue(strategy = GenerationType.IDENTITY)\n@Column(name = &quot;id&quot;)\nprivate Long anomalyId;\n</code></pre>\n"},{"owner":{"user_id":19519118,"display_name":"surendra ingle"},"up_vote_count":1,"is_accepted":false,"creation_date":1673428817,"answer_id":75080719,"body":"<p>user is a reserved word in Postgresql thats why it show an error\nuse a different word like &quot;users&quot; &quot;usersId&quot;.</p>\n"}],"owner":{"user_id":15445661,"display_name":"Raul Penate"},"view_count":242,"up_vote_count":2,"accepted_answer_id":74975220,"answer_count":3,"score":2,"creation_date":1672583351,"question_id":74975173,"body":"<p>I'm using Spring boot, and I Run this model.</p>\n<pre><code>package com.example.demo.Models;\n\nimport jakarta.persistence.*;\n\n@Entity\n@Table(name = &quot;user&quot;)\npublic class UserModel {\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    @Column(unique = true, nullable = true)\n    private Long id;\n    private String name;\n    private String email;\n    private Integer priority;\n   \n    /* Here are all the setters and getters*/\n}\n</code></pre>\n<p>application.properties:</p>\n<pre><code>spring.datasource.url=jdbc:postgresql://localhost:5432/dbdemo\nspring.datasource.username=postgres\nspring.datasource.password=password\nspring.jpa.hibernate.ddl-auto=update\n</code></pre>\n<p>Everything fine with Java.</p>\n<pre><code>Process finished with exit code 0\n</code></pre>\n<p>But in the console of my docker image of Postgres I get the following error:</p>\n<pre><code>ERROR:  syntax error at or near &quot;user&quot; at character 14\nSTATEMENT: create table user(id bigserial not null, email varchar(255), name varchar(255), priority integer, primary key (id))\n</code></pre>\n<p>I'm not sure how to solve it, I'd appreciate any help.</p>\n"},{"tags":["java","spring-boot","docker","spring-data","buildpack"],"answers":[{"owner":{"user_id":1585136,"display_name":"Daniel Mikusa"},"up_vote_count":4,"is_accepted":true,"creation_date":1672626133,"answer_id":74978584,"body":"<p>Trying to pick out and answer your questions, if I missed anything let me know.</p>\n<ol>\n<li><p>You shouldn't generally need to set an entry point. Buildpacks will detect and set the correct one for you automatically. That should work for 99% of Spring Boot apps. It is also significantly more flexible than what you'd get with a standard Docker <code>ENTRYPOINT</code>, see <a href=\"https://buildpacks.io/docs/app-developer-guide/run-an-app/\" rel=\"nofollow noreferrer\">the docs on starting your container</a>. If you still feel like you need to set an entrypoint, you'd have to provide more information about why and what you are trying to do (probably good for a new question).</p>\n</li>\n<li><p>There is no equivalent to <code>EXPOSE</code> in buildpacks, but it matters less than you might think. <code>EXPOSE</code> <a href=\"https://docs.docker.com/engine/reference/builder/#expose\" rel=\"nofollow noreferrer\">is just setting metadata</a>.</p>\n<blockquote>\n<p>The EXPOSE instruction does not actually publish the port. It functions as a type of documentation between the person who builds the image and the person who runs the container, about which ports are intended to be published.</p>\n</blockquote>\n<p>Without <code>EXPOSE</code>, you can't run <code>docker run -P</code>, but you can still run <code>docker run -p port:port</code> and it works just the same.</p>\n<p>If you need to document the port information, which is basically what <code>EXPOSE</code> does, you could add a label with the port information. <a href=\"https://paketo.io/docs/howto/configuration/#applying-custom-labels\" rel=\"nofollow noreferrer\">Buildpacks support setting arbitrary labels on the generated images</a>.</p>\n</li>\n<li><p>In answer to:</p>\n<blockquote>\n<p>Is this new way of building images everyone is talking about good only for very basic Dockerfile?</p>\n</blockquote>\n<p>No. Dockerfiles are a generic way to build images, which work for many, many different situations. Buildpacks do not attempt to replace Dockerfiles for every use case. The target area for buildpacks is packaging your applications into container images. If you deploy with Docker or Kubernetes or some other container orchestrator then Buildpacks should work very well for you.</p>\n</li>\n<li><p>In answer to:</p>\n<blockquote>\n<p>How may I change the base image</p>\n</blockquote>\n<p>With buildpacks you have a base build image and a base run image. The base build image is the base container image that is used when buildpacks run and your application compiles. The base run image is what is used by your application when it executes. The build is often larger than the base as you have more dev tools and libraries there.</p>\n<p>You can change both. To change the build image, you must change the builder. That is the <code>&lt;builder&gt;</code> tag in your Spring Boot build tools configuration or the <code>-B</code> flag for <code>pack build</code>. The builder contains the base build image plus all of the buildpacks. It also has metadata to indicate the run image that pairs with the build image. If you make a custom builder image, you can control all of those things in as much detail as you want, you just need to ensure that the buildpacks you're using are compatible with the build and run image you create. <a href=\"https://buildpacks.io/docs/operator-guide/create-a-builder/\" rel=\"nofollow noreferrer\">Instructions for creating a builder can be found here</a>.</p>\n<p>If you only need to change the run image, that can be done a little easier. You can <a href=\"https://docs.spring.io/spring-boot/docs/3.0.1/maven-plugin/reference/htmlsingle/#build-image.customization\" rel=\"nofollow noreferrer\">set the <code>&lt;runImage&gt;</code> config setting</a> in your Spring Boot build tools and it'll override the run image suggested by the builder.</p>\n<p>You need to be careful when doing this because you need to ensure that the application built with the build image will run on the run image you specify. The two are usually paired so that any libraries necessary to run the application are present at runtime. For Java apps, this is generally easy since there are not a lot of system dependencies. However, you could not set the run image to <code>scratch</code> because the JVM does have a couple of system dependencies.</p>\n<p>You might be thinking, &quot;how would I create these images?&quot; and the answer is a Dockerfile. As mentioned before, Buildpacks are not attempting to completely replace Dockerfiles, just make certain use cases easier. This is a use case, making base images, where Dockerfiles work fine, so you can <code>docker build</code> your own base builder and run images. See <a href=\"https://buildpacks.io/docs/operator-guide/create-a-stack/\" rel=\"nofollow noreferrer\">here for more detailed instructions</a>.</p>\n<p>The process to create your own build/run images is not technically difficult or time consuming, but it does require automation because you <em>must</em> keep those images up-to-date so you are getting relevant security fixes.</p>\n<p>Having said all that, <strong>you may not need to create custom images</strong>. I don't know what you're specific needs are here, so I would encourage you to take a look at <a href=\"https://stackoverflow.com/questions/69447497/is-it-possible-to-customize-docker-image-generated-with-spring-native-with-buil/69466535#69466535\">this SO post, which has some possible ways to customize the container images generated by Spring Boot</a>.</p>\n<p>I would also suggest that you try to take a step back and rethink the problem you have to solve. It is often the case that converting a Dockerfile to Buildpacks can be more complicated and produce awkward results because you're trying to reimplement your Dockerfile solution to the problem. If you instead think about how you could solve the actual problem using Buildpacks, you might come out with a more elegant solution.</p>\n</li>\n</ol>\n"}],"owner":{"user_id":10461625,"display_name":"PatPanda"},"view_count":358,"up_vote_count":2,"accepted_answer_id":74978584,"answer_count":1,"score":2,"creation_date":1672568501,"question_id":74974087,"body":"<p>Small question regarding migrating building Docker images from Dockerfile to BuildPacks for a SpringBoot project.</p>\n<p>I have a very straightforward SpringBoot application I need to containerize. In order to do so, I have a very straightforward Dockerfile:</p>\n<pre><code>FROM my-custom-java-base-image\n\nRUN install -d -o some-user -g some-user /var/log/supervisor\nRUN chmod -R 755 /usr/local/some-user/\n\nEXPOSE 9999\n</code></pre>\n<p>Please note, in this Dockerfile, there is a custom java base image, the need to run some RUN commands (as well as running some other commands), and exposing a custom port, not the usual 8080.</p>\n<p>This image builds fine, and everything works with it, very happy.</p>\n<p>Now, since SpringBoot 2.3, there is this new feature with Buildpacks integration, where one can just simply run <code>./mvnw spring-boot:build-image</code> and have a very nice layered Docker image built.</p>\n<p>This Layered Docker image is indeed very cool. Many talks at popular conferences shows the benefits of this new way of building images:</p>\n<p>references:</p>\n<p><a href=\"https://www.youtube.com/watch?v=44n_MtsggnI\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=44n_MtsggnI</a></p>\n<p><a href=\"https://www.youtube.com/watch?v=EVHHyiypiY0\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=EVHHyiypiY0</a></p>\n<p>However, during all the demo I could find online, the initial Dockerfile is very rudimentary, no custom port, no custom commands, as if it can only work for the basic</p>\n<pre><code>FROM alpine\nWORKDIR /tmp\nCOPY target/myapp.jar myapp.jar\nENTRYPOINT [java -jar blablabla]\n</code></pre>\n<p>What I tried so far is to find in the plugin configuration a way to configure the things I need from my Dockerfile</p>\n<pre><code>&lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n                &lt;!-- Configuration to push the image to our own Dockerhub repository--&gt;\n                &lt;configuration&gt;\n                    &lt;image&gt;\n                        &lt;name&gt;docker.io/2013techsmarts/${project.artifactId}:latest&lt;/name&gt;\n                    &lt;/image&gt;\nsome configuration for the port, some commands to run, etc\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n</code></pre>\n<p>But no luck.</p>\n<p>Is this new way of building images everyone is talking about good only for very basic Dockerfile?</p>\n<p>How may I change the port, the base image, add my own commands etc while using Buildpacks please?</p>\n<p>Thank you</p>\n"},{"tags":["java","algorithm","oop","data-structures","time-complexity"],"comments":[{"owner":{"user_id":869736,"display_name":"Louis Wasserman"},"edited":false,"comment_id":132303856,"body":"Sure.  Maintain a Map from genre to TreeMaps from dates to lists of movies, so your query is just <code>get(genre).subMap(fromDate, toDate).values()</code> to get a Collection of Lists of the movies you want in O(log n)."},{"owner":{"user_id":5772882,"display_name":"Ole V.V."},"edited":false,"comment_id":132305410,"body":"I strongly recommend that you don’t use <code>Date</code>. That class was poorly designed and is long outdated. For a release date use <code>LocalDate</code> from <a href=\"https://docs.oracle.com/javase/tutorial/datetime/index.html\" rel=\"nofollow noreferrer\">java.time, the modern Java date and time API</a>."},{"owner":{"user_id":719263,"display_name":"Jean-Baptiste Yun&#232;s"},"edited":false,"comment_id":132305991,"body":"Precompute data structures...by genre, by date... and extract information from these."}],"answers":[{"owner":{"user_id":869736,"display_name":"Louis Wasserman"},"up_vote_count":4,"is_accepted":true,"creation_date":1672531993,"answer_id":74972614,"body":"<p>Sure.  Maintain a Map from genre to TreeMaps from dates to lists of movies, so your query is just <code>get(genre).subMap(fromDate, toDate).values()</code> to get a Collection of Lists of the movies you want in O(log n).</p>\n<p>Stop using Date, by the way.  It's not the worst time API ever invented, but it's certainly not worth using anymore.  So the data structure would presumably be</p>\n<pre><code>Map&lt;String, NavigableMap&lt;LocalDate, List&lt;Movie&gt;&gt;&gt;\n</code></pre>\n"}],"owner":{"user_id":11052519,"display_name":"dark lion"},"view_count":76,"up_vote_count":2,"accepted_answer_id":74972614,"answer_count":1,"score":2,"creation_date":1672531673,"question_id":74972603,"body":"<p>I have the following Movie class -</p>\n<pre><code>class Movie{\n\n    private String genre;\n    private String title;\n    private Date releaseDate;\n\n    Movie(String genre, String title, Date releaseDate){\n        this.genre = genre;\n        this.title = title;\n        this.releaseDate = releaseDate;\n    }\n\n    void setGenre(String genre){\n        this.genre = genre;\n    }\n    void setTitle(String title){\n        this.title = title;\n    }\n    void setReleaseDate(Date releaseDate){\n        this.releaseDate = releaseDate;\n    }\n    String getGenre(){\n        retuen genre;\n    }\n    String getTitle(){\n        return title;\n    }\n    Date getReleaseDate(){\n        return releaseDate;\n    }\n}\n</code></pre>\n<p>I have the following requirements -</p>\n<ol>\n<li>Create a catalog to store all &quot;Movie&quot; objects (can be of any time complexity)</li>\n<li>Create a method to return all movies of a certain genre, and time period from the catalog (This method may be called thousands of times, and should be optimized as much as possible)</li>\n</ol>\n<p>Here is my implementation so far.</p>\n<p>Method 1</p>\n<pre><code>void populateCatalog(List&lt;Movie&gt; catalog, String genre, String title, Date date){\n        catalog.add(new Movie(genre, title, date));\n    }\n</code></pre>\n<p>Method 2</p>\n<pre><code>boolean isWithinRange(Date date, Date beforeDate, Date afterDate){\n        return !date.before(beforeDate) &amp;&amp; !date.after(afterDate);\n    }\n    \n    //timePeriod = &quot;11/1/2020-11/2/2022&quot;\n    List&lt;Movie&gt; findGenreTimePeriod(List&lt;Movie&gt; catalog, String genre, String timePeriod){\n        List&lt;Movie&gt; result = new ArrayList&lt;&gt;();\n\n        int catalogSize = catalog.size();\n        String dates[] = timePeriod.split(&quot;-&quot;);\n        Date beforeDate = new Date(dates[0]);\n        Date afterDate = new Date(dates[1]);\n\n        for(int i=0; i&lt;catalogSize; i++){\n            Movie movie = catalog.get(i);\n            String movieGenre = movie.getGenre();\n            Date date = movie.getDate();\n            if(movieGenre.equals(genre) &amp;&amp; isWithinRange(date, beforeDate, afterDate));\n                result.add(movie);\n        }\n        \n        return result;\n    }\n</code></pre>\n<p>My implementation iterates through all items in the catalog and is O(N). Is there an approach that gives better time complexity, perhaps by modifying method 1? Additionally, is there a way to return an iterator class, that returns the information as needed?</p>\n"},{"tags":["java","maven","terminal","java-home"],"answers":[{"owner":{"user_id":2422776,"display_name":"Mureinik"},"up_vote_count":3,"is_accepted":true,"creation_date":1684061499,"answer_id":76247071,"body":"<p>It looks like you set <code>JAVA_HOME</code> to point to the <code>java</code> executable, not the directory containing the Java installation, as it should be</p>\n<pre class=\"lang-bash prettyprint-override\"><code>export JAVA_HOME=/usr/lib/jvm/default-runtime\n</code></pre>\n"}],"owner":{"user_id":21896173,"display_name":"sorryladies"},"view_count":38,"up_vote_count":2,"accepted_answer_id":76247071,"answer_count":1,"score":2,"creation_date":1684061300,"question_id":76247056,"body":"<p>Here is the message I get when I try to use maven in the terminal:</p>\n<pre><code>The JAVA_HOME environment variable is not defined correctly,\nthis environment variable is needed to run this program.\n</code></pre>\n<p>This is the definition of the JAVA_HOME environment variable:</p>\n<pre><code>echo $JAVA_HOME                                                                                1 ✘ \n/usr/lib/jvm/default-runtime/bin/java\n\njava --version                                                                                   ✔ \nopenjdk 19.0.2 2023-01-17\nOpenJDK Runtime Environment (build 19.0.2+7)\nOpenJDK 64-Bit Server VM (build 19.0.2+7, mixed mode)\n</code></pre>\n"},{"tags":["java","database","spring-boot","hibernate","jpa"],"answers":[{"owner":{"user_id":8908834,"display_name":"Mauricio Buffon"},"up_vote_count":0,"is_accepted":false,"creation_date":1683660244,"answer_id":76212790,"body":"<blockquote>\n<p>I know there were some changes to jakarta but i dont know if this is a problem to me.</p>\n</blockquote>\n<p>It probably is. The Jakarta Persistence API 3.1 now supports the <code>java.util.UUID</code> type (<a href=\"https://newsroom.eclipse.org/eclipse-newsletter/2022/march/what%E2%80%99s-new-jakarta-persistence-31\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://jakarta.ee/specifications/persistence/3.1/jakarta-persistence-spec-3.1.html#jakarta-persistence-3-1\" rel=\"nofollow noreferrer\">here</a>).</p>\n<p>Plotting the dependency tree in Maven (<code>mvn dependency:tree</code>) for the latest current version of Spring-Boot (<code>3.0.6</code>), you can see it uses <code>org.hibernate.orm:hibernate-core:jar:6.1.7.Final</code> - which is <a href=\"https://jakarta.ee/specifications/persistence/3.1/\" rel=\"nofollow noreferrer\">compatible</a> with JPA 3.1.</p>\n<p>Try removing <code>@Column(columnDefinition = &quot;VARCHAR(255)&quot;)</code> and <code>@Type(type = &quot;org.hibernate.type.UUIDCharType&quot;)</code> annotations from your <code>WerkstattEntity</code> entity.</p>\n<p>Be cautious, though: on an Apache Derby database, the <code>java.util.UUID</code> type is translated to <code>char(16) for bit data</code>.</p>\n"},{"owner":{"user_id":2889760,"display_name":"Gavin King"},"up_vote_count":3,"is_accepted":true,"creation_date":1683661033,"answer_id":76212860,"body":"<p>As you'll find if you read in the migration guide for Hibernate 6, we no longer use stringly-typed names to identify types. Which is much better.</p>\n<p>But even better still, you no longer need a custom <code>@Type</code> annotation to persist <code>UUID</code>s. So:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Id\nprivate UUID id;\n</code></pre>\n<p>would in principle work fine.</p>\n<p>You can even use:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Id @GeneratedValue\nprivate UUID id;\n</code></pre>\n<p>if you want the <code>UUID</code> to be generated.</p>\n<p>However, note that, by default, this maps to a column of type <code>UUID</code> if the database has such a type. If you really need to map to a <code>VARCHAR</code> columns, use:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Id @GeneratedValue\n@JdbcTypeCode(Types.VARCHAR)\nprivate UUID id;\n</code></pre>\n<p>or:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Id @GeneratedValue\n@JdbcType(VarcharJdbcType.class)\nprivate UUID id;\n</code></pre>\n<p>depending on taste.</p>\n"}],"owner":{"user_id":8236968,"display_name":"gensheimer"},"view_count":59,"up_vote_count":2,"accepted_answer_id":76212860,"answer_count":2,"score":2,"creation_date":1683657680,"question_id":76212506,"body":"<p>normally I store my UUID´s to the database as String. In Spring Boot 2.x I used to decoreate the UUID with <code>@Type(type = &quot;org.hibernate.type.UUIDCharType&quot;)</code>. Somehow in Spring Boot 3.x it doesnt work anymore. It tells me <code>Cannot resolve method 'type'</code>.</p>\n<p>I know there were some changes to jakarta but i dont know if this is a problem to me.</p>\n<p>My Entity:</p>\n<pre><code>import jakarta.persistence.*;\nimport lombok.AllArgsConstructor;\nimport lombok.Builder;\nimport lombok.Data;\nimport lombok.NoArgsConstructor;\nimport org.hibernate.annotations.Type;\n\nimport java.util.Set;\nimport java.util.UUID;\n\n@Data\n@Entity\n@Table(name = &quot;werkstatt&quot;)\n@AllArgsConstructor\n@NoArgsConstructor\n@Builder\npublic class WerkstattEntity {\n\n    @Id\n    @Column(columnDefinition = &quot;VARCHAR(255)&quot;)\n    @Type(type = &quot;org.hibernate.type.UUIDCharType&quot;)\n    private UUID id;\n}\n</code></pre>\n<p>My gradle dep:</p>\n<pre><code>dependencies {\n    implementation 'org.springframework.boot:spring-boot-starter-actuator'\n    implementation 'org.springframework.boot:spring-boot-starter-data-jpa'\n    implementation 'org.springframework.boot:spring-boot-starter-security'\n    implementation 'org.springframework.boot:spring-boot-starter-web'\n    implementation 'org.springframework.boot:spring-boot-starter-webflux'\n    compileOnly 'org.projectlombok:lombok'\n    developmentOnly 'org.springframework.boot:spring-boot-devtools'\n    runtimeOnly 'org.mariadb.jdbc:mariadb-java-client'\n    annotationProcessor 'org.projectlombok:lombok'\n    testImplementation 'org.springframework.boot:spring-boot-starter-test'\n    testImplementation 'io.projectreactor:reactor-test'\n    testImplementation 'org.springframework.security:spring-security-test'\n    \n\n    // https://mvnrepository.com/artifact/io.jsonwebtoken/jjwt-api\n    implementation 'io.jsonwebtoken:jjwt-api:0.11.5'\n\n    // https://mvnrepository.com/artifact/io.jsonwebtoken/jjwt-impl\n    runtimeOnly 'io.jsonwebtoken:jjwt-impl:0.11.5'\n\n    // https://mvnrepository.com/artifact/io.jsonwebtoken/jjwt-jackson\n    runtimeOnly 'io.jsonwebtoken:jjwt-jackson:0.11.5'\n\n    implementation 'org.mapstruct:mapstruct:1.5.5.Final'\n\n    annotationProcessor 'org.mapstruct:mapstruct-processor:1.5.5.Final'\n\n}\n</code></pre>\n"},{"tags":["java","string","encoding","character-encoding","windows-1251"],"comments":[{"owner":{"user_id":5646962,"display_name":"Thomas Kl&#228;ger"},"edited":false,"comment_id":134382809,"body":"Very strange: on my machine this works without problem and yields the expected output. Also running it in an online IDE like <a href=\"https://www.jdoodle.com/online-java-compiler/\" rel=\"nofollow noreferrer\">jdoodle.com/online-java-compiler</a> also gives the expected output."},{"owner":{"user_id":4712734,"display_name":"DuncG"},"edited":false,"comment_id":134382886,"body":"Note that <code>HexFormat.of().withDelimiter(&quot;, &quot;).formatHex(&quot;Привет&quot;.getBytes(&quot;UTF-8&quot;))</code> is <code>d0, 9f, d1, 80, d0, b8, d0, b2, d0, b5, d1, 82</code>, perhaps you have compiled with source file of different encoding to windows-1251"},{"owner":{"user_id":16376827,"display_name":"g00se"},"edited":false,"comment_id":134382896,"body":"For some reason it looks like your vm cannot decode Windows-1251. It&#39;s essentially ignored and you get UTF-8. btw if you import <code>HexFormat</code> why do you do so much work? ;)"},{"owner":{"user_id":2711488,"display_name":"Holger"},"edited":false,"comment_id":134382958,"body":"<a href=\"https://tio.run/##fVDLasMwELznKxaBQSaOSAK9NO2lpcf2kmPIQbFlR7EjGWudxJRA6Y/0HwqFfobzRa78CDGlqS6LdndmZ2bDd3y0CeKq8hNuDDxzqeB1APal@SqRPhjkaMtOywC2dkrnmEkVLZbAs8i4gOtM7w08HXyRotRndP3mhUGxZTpHlloMJopu7D2mpGb@mmdGIHvsaiBCnifYfanLAmnShBcvfCuo684upM15MHAPpPw4vZXf5Wf5dXons//uklWBwoCvc4VgLe6lCqzs0WR6M7kFAkMwLBL4UG9R0p8SlyVCRbjuaWhY293rMA9@NVr8cXAt3R5rrbZJOOOFd7asbBRuL95QZ0AtBGKbxXhmy12L6ATbznDYB/yVTUiJYxZOsKw5Ds54enAU8ZpbHsReS7iIlz33x87Hsap@AA\" rel=\"nofollow noreferrer\">Can not reproduce</a>. You should ensure that you source file has the right encoding (and the compiler options matched). Try to verify with <code>System.out.println(s);</code>"}],"answers":[{"owner":{"user_id":4712734,"display_name":"DuncG"},"up_vote_count":3,"is_accepted":true,"creation_date":1683566608,"answer_id":76202887,"body":"<p>It looks like perhaps you have UTF-8 encoded source file when you compiled?</p>\n<pre><code>HexFormat.of().withPrefix(&quot;, &quot;).formatHex(&quot;Привет&quot;.getBytes(&quot;UTF-8&quot;))\n==&gt; &quot;d09fd180d0b8d0b2d0b5d182&quot;\n</code></pre>\n<p>If I save your code in my UTF-8 editor and compile+run:</p>\n<pre><code>java -Dfile.encoding=UTF-8 Foo.java\nUTF-8\nbytes count in windows-1251: 6\nwindows-1251[0] = 0xcf\nwindows-1251[1] = 0xf0\nwindows-1251[2] = 0xe8\nwindows-1251[3] = 0xe2\nwindows-1251[4] = 0xe5\nwindows-1251[5] = 0xf2\n</code></pre>\n<p>Whereas this matches your output if compile+run that UTF8 file with your default encoding:</p>\n<pre><code>java -Dfile.encoding=windows-1251 Foo.java\nwindows-1251\nbytes count in windows-1251: 12\nwindows-1251[0] = 0xd0\nwindows-1251[1] = 0x9f\nwindows-1251[2] = 0xd1\nwindows-1251[3] = 0x80\nwindows-1251[4] = 0xd0\nwindows-1251[5] = 0xb8\nwindows-1251[6] = 0xd0\nwindows-1251[7] = 0xb2\nwindows-1251[8] = 0xd0\nwindows-1251[9] = 0xb5\nwindows-1251[10] = 0xd1\nwindows-1251[11] = 0x82\n</code></pre>\n<p>If I change my editor charset to windows-1251 then the output is as expected:</p>\n<pre><code>java -Dfile.encoding=windows-1251 Foo.java\nwindows-1251\nbytes count in windows-1251: 6\nwindows-1251[0] = 0xcf\nwindows-1251[1] = 0xf0\nwindows-1251[2] = 0xe8\nwindows-1251[3] = 0xe2\nwindows-1251[4] = 0xe5\nwindows-1251[5] = 0xf2\n</code></pre>\n<p><strong>EDIT</strong></p>\n<p>For simplicity above I've used <code>java Foo.java</code> &quot;compile and launch&quot; mode but for normal separate use the important steps are to match up <code>javac</code> with character encoding of the source code, and <code>java</code> with any encoding you want the app to use:</p>\n<pre><code>javac -Dfile.encoding=TheJavaFilesCharSet {JavaFiles}\njava  -Dfile.encoding=AnyOrDefaultCharSet {ClassWithMain}\n</code></pre>\n<p>As mentioned in the comments its worth using <code>HexFormat</code>, it is immutable and therefore safe to assign to a static field directly or via a user-friendly debugging output method:</p>\n<pre><code>private static final HexFormat HEX = HexFormat.ofDelimiter(&quot;, &quot;).withPrefix(&quot;0x&quot;).withUpperCase();\npublic static String formatHex(byte[] arr) {\n    return &quot;new byte[/*&quot;+arr.length+&quot;*/] {&quot;+HEX.formatHex(arr)+&quot;}&quot;;\n}\n\nHEX.formatHex(new byte[]{1,2,3});\n==&gt; &quot;0x01, 0x02, 0x03&quot;\n\nformatHex(new byte[]{1,2,3});\n==&gt; &quot;new byte[/*3*/] {0x01, 0x02, 0x03}&quot;\n</code></pre>\n<p>The latter is helpful if you want to cut/paste definitions back into testcases.</p>\n"}],"owner":{"user_id":4899476,"display_name":"Ilyas"},"view_count":68,"up_vote_count":2,"accepted_answer_id":76202887,"answer_count":1,"score":2,"creation_date":1683564940,"question_id":76202691,"body":"<p>I'm trying to understand character encoding for Strings in Java. I'm working on Windows 10 and the default character encoding is <code>windows-1251</code>. it is 8-bit encoding character. So it must be 1 byte for 1 symbol. So when I call <code>getBytes()</code> for a String with 6 symbols, I expect an array of 6 bytes. But the following code snippet returns 12, instead of 6.</p>\n<pre><code>&quot;Привет&quot;.getBytes(&quot;windows-1251&quot;).length // returns 12\n</code></pre>\n<p>At first, I thought that the first byte of the character must be zero. But both bytes related to the character have non-zero values. Could anyone explain, what I'm missing here, please?</p>\n<p>Here is an example of how I tested it</p>\n<pre><code>import java.nio.charset.Charset;\nimport java.io.*;\nimport java.util.HexFormat;\n\npublic class Foo\n{\n    public static void main(String[] args) throws Exception\n    {\n        System.out.println(Charset.defaultCharset().displayName());\n        String s = &quot;Привет&quot;;\n        System.out.println(&quot;bytes count in windows-1251: &quot; + s.getBytes(&quot;windows-1251&quot;).length);\n        printBytes(s.getBytes(&quot;windows-1251&quot;), &quot;windows-1251&quot;);\n    }\n    \n    public static void printBytes(byte[] array, String name) {\n        for (int k = 0; k &lt; array.length; k++) {\n            System.out.println(name + &quot;[&quot; + k + &quot;] = &quot; + &quot;0x&quot; +\n                byteToHex(array[k]));\n        }\n    }\n\nstatic public String byteToHex(byte b) {\n      // Returns hex String representation of byte b\n      char hexDigit[] = {\n         '0', '1', '2', '3', '4', '5', '6', '7',\n         '8', '9', 'a', 'b', 'c', 'd', 'e', 'f'\n      };\n      char[] array = { hexDigit[(b &gt;&gt; 4) &amp; 0x0f], hexDigit[b &amp; 0x0f] };\n      return new String(array);\n   }\n}\n</code></pre>\n<p>the result is:</p>\n<pre><code>windows-1251\nbytes count in windows-1251: 12\nwindows-1251[0] = 0xd0\nwindows-1251[1] = 0x9f\nwindows-1251[2] = 0xd1\nwindows-1251[3] = 0x80\nwindows-1251[4] = 0xd0\nwindows-1251[5] = 0xb8\nwindows-1251[6] = 0xd0\nwindows-1251[7] = 0xb2\nwindows-1251[8] = 0xd0\nwindows-1251[9] = 0xb5\nwindows-1251[10] = 0xd1\nwindows-1251[11] = 0x82\n</code></pre>\n<p>but what I expect is:</p>\n<pre><code>windows-1251\nbytes count in windows-1251: 6\nwindows-1251[0] = 0xcf\nwindows-1251[1] = 0xf0\nwindows-1251[2] = 0xe8\nwindows-1251[3] = 0xe2\nwindows-1251[4] = 0xe5\nwindows-1251[5] = 0xf2\n</code></pre>\n"},{"tags":["java","mysql","mariadb","sql-update","sql-insert"],"answers":[{"owner":{"user_id":10676716,"display_name":"GMB"},"up_vote_count":3,"is_accepted":true,"creation_date":1682627467,"answer_id":76124415,"body":"<p>As your query stands, (some of) the parameters need to be passed twice (once for insert and another for update). MySQL offers <a href=\"https://dev.mysql.com/doc/refman/8.0/en/miscellaneous-functions.html#function_values\" rel=\"nofollow noreferrer\">the <code>VALUES(...)</code> function</a> to access the insert values by column name in the update clause - which is exactly there to save you that hassle.</p>\n<p>Also: the <code>UPDATE</code> clause would be better expressed if it addressed only non-primary key columns, not all columns.</p>\n<p>Assuming that your table has columns <code>owner_id, object_id, item_id, cnt, enchant_level</code> where the first three columns are the primary key:</p>\n<pre><code>insert into items (owner_id, object_id, item_id, cnt, enchant_level)\nvalues (?, ?, ?, ?, ?)\non duplicate key update \nset cnt = values(cnt), \n    enchant_level = values(enchant_level)\n</code></pre>\n<p>Or, if you are running MySQL 8.0.19 or higher you can use the new alias-based syntax (<code>values()</code> was an unfortunate name choice in MySQL, as it somehow conflicts with the homonym SQL standard row constructor):</p>\n<pre class=\"lang-sql prettyprint-override\"><code>insert into items (owner_id, object_id, item_id, cnt, enchant_level)\nvalues (?, ?, ?, ?, ?) v\non duplicate key update \nset cnt = v.cnt,\n    enchant_level = v.enchant_level\n</code></pre>\n"}],"owner":{"user_id":1368428,"display_name":"Vetalll"},"view_count":53,"up_vote_count":2,"accepted_answer_id":76124415,"answer_count":1,"score":2,"creation_date":1682625815,"question_id":76124229,"body":"<p>I Have a next SQL Query:</p>\n<pre><code>const val INSERT_OR_UPDATE_ITEM_SQL = &quot;&quot; +\n            &quot;INSERT INTO `items` (owner_id, object_id, item_id, count, enchant_level, item_location, item_location_data, custom_type1, custom_type2, duration_left, create_time)&quot; +\n            &quot;VALUES (?,?,?,?,?,?,?,?,?,?,?) &quot; +\n            &quot;ON DUPLICATE KEY UPDATE owner_id=?,object_id=?,item_id=?,count=?,enchant_level=?,item_location=?,item_location_data=?,custom_type1=?,custom_type2=?,duration_left=?,create_time=?&quot;\n</code></pre>\n<p>And this is preparation of PreparedStatement:</p>\n<pre><code>statement.setString(1, item.ownerId)\nstatement.setInt(2, item.objectId)\nstatement.setInt(3, item.template.id)\nstatement.setInt(4, item.count)\nstatement.setInt(5, item.enchantLevel)\nstatement.setString(6, item.itemLocation.name)\nstatement.setInt(7, item.itemLocationData)\nstatement.setInt(8, item.customType1)\nstatement.setInt(9, item.customType2)\nstatement.setInt(10, item.durationLeft)\nstatement.setLong(11, item.createTime)\n</code></pre>\n<p>The issue here is when i try to execute query :</p>\n<pre><code>Exception in thread &quot;main&quot; java.sql.SQLTransientConnectionException: (conn=352) Parameter at position 12 is not set\n</code></pre>\n<p>This is because I have 22 Questions mark instead of 11 (because of ON CONFLICT UPDATE)</p>\n<p>My Simple task is to make <strong>INSERT or UPDATE</strong></p>\n"},{"tags":["java","reactive-programming","quarkus","quarkus-panache","quarkus-reactive"],"answers":[{"owner":{"user_id":4935751,"display_name":"Luka Juršnik"},"up_vote_count":1,"is_accepted":false,"creation_date":1682426916,"answer_id":76101341,"body":"<p>I found solution on Quarkus issues page (<a href=\"https://github.com/quarkusio/quarkus/issues/28808\" rel=\"nofollow noreferrer\">https://github.com/quarkusio/quarkus/issues/28808</a>) and commit solution to existing project(<a href=\"https://github.com/Lukec1/quarkus-3.0.0.CR2-sample/commit/98a4791571334a898716d7780a87d993d443f5c6\" rel=\"nofollow noreferrer\">https://github.com/Lukec1/quarkus-3.0.0.CR2-sample/commit/98a4791571334a898716d7780a87d993d443f5c6</a>).</p>\n<p><strong>Edited:</strong> recognized problem is when using Panache Hibernate Reactive and <code>Uni.combine</code>. Because of that i now use chain approach which does not work in parallel as we would like with the <code>Uni.combine</code>.</p>\n<p>ZooService</p>\n<pre class=\"lang-java prettyprint-override\"><code>  public Uni&lt;List&lt;Dog&gt;&gt; getDogs(String owner) {\n    return zooRepository.getDogs(owner);\n  }\n\n  public Uni&lt;List&lt;Cat&gt;&gt; getCats(String owner) {\n    return zooRepository.getCats(owner);\n  }\n\n  public Uni&lt;List&lt;Rat&gt;&gt; getRats(String owner) {\n    return zooRepository.getRats(owner);\n  }\n\n  public Uni&lt;List&lt;Dolphin&gt;&gt; getDoplphins(String owner) {\n    return zooRepository.getDoplphins(owner);\n  }\n</code></pre>\n<p>ZooRepository</p>\n<pre class=\"lang-java prettyprint-override\"><code>private Uni&lt;List&lt;AnimalEntity&gt;&gt; getAnimals(String ownerId, AnimalType animalType) {\n    return list(&quot;ownerId = ?1 AND animalType = ?2&quot;, ownerId, animalType).log()\n        .onItem()\n        .invoke(\n            result -&gt;\n                log.debug(\n                    &quot;Found {} entities for parameters '{}' - '{}'&quot;,\n                    result.size(),\n                    ownerId,\n                    animalType))\n        .onFailure()\n        .invoke(\n            throwable -&gt;\n                log.error(\n                    &quot;Error while getting accounts for parameters '{}' - '{}'&quot;,\n                    ownerId,\n                    animalType,\n                    throwable));\n  }\n\n  @WithSession\n  public Uni&lt;List&lt;Dog&gt;&gt; getDogs(String ownerId) {\n    return getAnimals(ownerId, AnimalType.DOG).map(animalEntityMapper::mapToDogs);\n  }\n\n  @WithSession\n  public Uni&lt;List&lt;Cat&gt;&gt; getCats(String ownerId) {\n    return getAnimals(ownerId, AnimalType.CAT).map(animalEntityMapper::mapToCats);\n  }\n\n  @WithSession\n  public Uni&lt;List&lt;Rat&gt;&gt; getRats(String ownerId) {\n    return getAnimals(ownerId, AnimalType.RAT).map(animalEntityMapper::mapToRats);\n  }\n\n  @WithSession\n  public Uni&lt;List&lt;Dolphin&gt;&gt; getDoplphins(String ownerId) {\n    return getAnimals(ownerId, AnimalType.DOLPHIN).map(animalEntityMapper::mapToDolphins);\n  }\n</code></pre>\n<p>Code which need to work, but not:</p>\n<pre class=\"lang-java prettyprint-override\"><code>    Uni&lt;List&lt;Dog&gt;&gt; dogs = zooService.getDogs(owner);\n    Uni&lt;List&lt;Cat&gt;&gt; cats = zooService.getCats(owner);\n    Uni&lt;List&lt;Rat&gt;&gt; rats = zooService.getRats(owner);\n    Uni&lt;List&lt;Dolphin&gt;&gt; dolphins = zooService.getDoplphins(owner);\n    \n    final AnimalsDto summary = new AnimalsDto();\n    \n    return Uni.combine().all().unis(dogs, cats, rats, \n    dolphins).asTuple().map(animal -&gt; {\n         summary.setDogs(animal.getItem1());\n         summary.setCats(animal.getItem2());\n         summary.setRats(animal.getItem3());\n         summary.setDolphins(animal.getItem4());\n         return summary;\n    });\n</code></pre>\n<p>and implemented working solution founded from Quarkus github issues:</p>\n<pre class=\"lang-java prettyprint-override\"><code>     return dogs.invoke(summary::setDogs)\n        .chain(() -&gt; cats.invoke(summary::setCats))\n        .chain(() -&gt; rats.invoke(summary::setRats))\n        .chain(() -&gt; dolphins.invoke(summary::setDolphins))\n        .replaceWith(summary);\n</code></pre>\n"},{"owner":{"user_id":175554,"display_name":"ozkanpakdil"},"up_vote_count":2,"is_accepted":false,"creation_date":1683129696,"answer_id":76165969,"body":"<p>By design <strong>hibernate reactive</strong> can not share a session on parallel threads which is blocking using it with Uni or Mutiny.</p>\n<blockquote>\n<p>The problem is that Hibernate Reactive needs operations on the database to happen in a predictable order to avoid errors when managing entities. So, you cannot share the same session among different threads or uni streams.</p>\n</blockquote>\n<blockquote>\n<p>We don't have a solution for this at the moment, and chaining the uni is the only way to be sure that everything will work as expected.</p>\n</blockquote>\n<p>Here is the <a href=\"https://github.com/hibernate/hibernate-reactive/issues/1615\" rel=\"nofollow noreferrer\">real source</a></p>\n"}],"owner":{"user_id":4935751,"display_name":"Luka Juršnik"},"view_count":131,"up_vote_count":2,"answer_count":2,"score":2,"creation_date":1682076283,"question_id":76072695,"body":"<p>I am working on a project using Quarkus 3.0.0.CR2 and Hibernate Reactive Panache as the ORM for a reactive application. The application retrieves animals from owners using an API <a href=\"https://github.com/Lukec1/quarkus-3.0.0.CR2-sample/blob/main/src/main/java/org/acme/ZooResource.java\" rel=\"nofollow noreferrer\">resource</a> that makes 5 reactive calls to a <a href=\"https://github.com/Lukec1/quarkus-3.0.0.CR2-sample/blob/main/src/main/java/org/acme/ZooService.java\" rel=\"nofollow noreferrer\">service</a>, which is forwards to the <a href=\"https://github.com/Lukec1/quarkus-3.0.0.CR2-sample/blob/main/src/main/java/org/acme/ZooRepository.java\" rel=\"nofollow noreferrer\">database repository implementation</a>.</p>\n<p>However, when reapeatably running the <a href=\"https://github.com/Lukec1/quarkus-3.0.0.CR2-sample/blob/main/src/test/java/org/acme/ZooResourceTest.java\" rel=\"nofollow noreferrer\">unit test</a> or making curl calls to &quot;http://localhost:8080/zoo/animals/Melani&quot;, I am randomly encountering two different errors:</p>\n<ul>\n<li><code>org.hibernate.HibernateException: java.util.concurrent.CompletionException: java.lang.IllegalStateException: Session/EntityManager is closed</code></li>\n<li><code>org.hibernate.HibernateException: java.util.concurrent.CompletionException: java.util.NoSuchElementException</code></li>\n</ul>\n<p>Could someone please help me understand why I am encountering these errors and suggest a solution?</p>\n<p>Here is a link to a sample project on Github that demonstrates the error: <a href=\"https://github.com/Lukec1/quarkus-3.0.0.CR2-sample\" rel=\"nofollow noreferrer\">https://github.com/Lukec1/quarkus-3.0.0.CR2-sample</a></p>\n<p>Thank you in advance for your help.</p>\n"},{"tags":["java","date","datetime"],"comments":[{"owner":{"user_id":721855,"display_name":"aled"},"edited":false,"comment_id":134103556,"body":"What&#39;s the year?"},{"owner":{"user_id":56952,"display_name":"erotsppa"},"edited":false,"comment_id":134103863,"body":"@aled oops! Can I set it to a default year?"},{"owner":{"user_id":642706,"display_name":"Basil Bourque"},"edited":false,"comment_id":134109314,"body":"Edit the Question&#39;s title and body to make clear that you are asking for how to set a default year in the formatter."}],"answers":[{"owner":{"user_id":507738,"display_name":"MC Emperor"},"up_vote_count":3,"is_accepted":true,"creation_date":1681752035,"answer_id":76037699,"body":"<p>The issue is that the construction of a <code>LocalDateTime</code> requires a <em>year</em> to be present, but your time string does not.</p>\n<p>You can instruct the <code>DateTimeFormatterBuilder</code> to default to some value if some element is absent, using <code>parseDefaulting</code>.</p>\n<pre class=\"lang-java prettyprint-override\"><code>DateTimeFormatter formatter2 = new DateTimeFormatterBuilder()\n    .parseDefaulting(ChronoField.YEAR, 2023)\n    .appendPattern(&quot;h:mm a z - d MMMM&quot;)\n    .toFormatter()\n    .withLocale(Locale.US);\n</code></pre>\n"}],"owner":{"user_id":56952,"display_name":"erotsppa"},"view_count":66,"up_vote_count":2,"accepted_answer_id":76037699,"answer_count":1,"score":2,"creation_date":1681749021,"question_id":76037322,"body":"<pre><code>DateTimeFormatter formatter2 = new DateTimeFormatterBuilder()\n                    .appendPattern(&quot;h:mm a z - d MMMM&quot;)\n                    .toFormatter()\n                    .withLocale(Locale.US);\n\n            String test = &quot;7:00 PM EST - 14 April&quot;;\nLocalDateTime date2 = LocalDateTime.parse(test, formatter2);\n</code></pre>\n<p>It throws this exception</p>\n<blockquote>\n<p>java.time.format.DateTimeParseException: Text '7:00 PM EST - 14 April'\ncould not be parsed: Unable to obtain LocalDateTime from\nTemporalAccessor: {DayOfMonth=14, MonthOfYear=4},ISO,America/New_York\nresolved to 19:00 of type java.time.format.Parsed</p>\n</blockquote>\n<p>But you can see that it correctly parsed out all the components. What's the issue?</p>\n"},{"tags":["java","timezone","date-format","timezone-offset","datetimeformatter"],"comments":[{"owner":{"user_id":668951,"display_name":"Atul"},"edited":false,"comment_id":134028635,"body":"Of course I could manually hard code and append +00:00"},{"owner":{"user_id":16034206,"display_name":"experiment unit 1998X"},"edited":false,"comment_id":134028892,"body":"using the offset O says this in the java doc, <code>Four letters outputs the full form, which is localized offset text, such as &#39;GMT, with 2-digit hour and minute field, optional second field if non-zero, and colon, for example &#39;GMT+08:00&#39;</code> so since its zero, the +00:00 is not going to be output, since its optional. This should also apply to using O once only"},{"owner":{"user_id":642706,"display_name":"Basil Bourque"},"edited":false,"comment_id":134030291,"body":"Do you understand that having <code>GMT</code> <i>and</i> <code>+00:00</code> is redundant?"},{"owner":{"user_id":5772882,"display_name":"Ole V.V."},"edited":false,"comment_id":134030324,"body":"If I use <code>DateTimeFormatter.ofPattern(&quot;E MMM d u H:m:s &#39;GMT&#39;xxx&quot;, Locale.ENGLISH)</code> in conjunction with <code>OffsetDateTime.ofInstant(date.toInstant(), ZoneOffset.UTC)</code>, I get <code>Fri Feb 24 2023 13:57:11 GMT+00:00</code>."},{"owner":{"user_id":668951,"display_name":"Atul"},"edited":false,"comment_id":134030710,"body":"@BasilBourque yes, but downstream needs it this way :)"},{"owner":{"user_id":5772882,"display_name":"Ole V.V."},"edited":false,"comment_id":134031028,"body":"@experimentunit1998X Thanks for referring to <a href=\"https://docs.oracle.com/en/java/javase/18/docs/api/java.base/java/time/format/DateTimeFormatter.html\" rel=\"nofollow noreferrer\">the docs</a>. I believe the relevant sentence from that paragraph is: <i>If the offset is zero, only localized text is output.</i>"},{"owner":{"user_id":10819573,"display_name":"Arvind Kumar Avinash"},"edited":false,"comment_id":134034428,"body":"I agree with @BasilBourque and I also <a href=\"https://stackoverflow.com/questions/75992230/print-gmt0000-in-datetimeformatter/75993831#comment134032792_75993831\">commented the same</a> but I missed to see his comment earlier. <code>GMT+00:00</code> is not a standard way and to accommodate this requirement, we can customise the pattern (by adding <code>xxx</code> or <code>XXX</code>) as I have done in my answer."},{"owner":{"user_id":642706,"display_name":"Basil Bourque"},"edited":false,"comment_id":134034470,"body":"I suggest you educate those “downstream” folks about <a href=\"https://en.wikipedia.org/wiki/ISO_8601\" rel=\"nofollow noreferrer\">ISO 8601</a>."}],"answers":[{"owner":{"user_id":10819573,"display_name":"Arvind Kumar Avinash"},"up_vote_count":2,"is_accepted":false,"creation_date":1681291213,"answer_id":75993831,"body":"<h2>Avoid hardcoding localized zone-offset</h2>\n<p>Avoid hardcoding localized zone-offset (e.g. 'GMT'). The <a href=\"https://docs.oracle.com/javase/8/docs/api/java/time/format/DateTimeFormatter.html\" rel=\"nofollow noreferrer\"><code>DateTimeFormatter</code></a> already provides you with pattern <code>O</code> to deal with localized zone-offset.</p>\n<p><strong>Demo:</strong></p>\n<pre><code>class Main {\n    public static void main(String[] args) {\n        Calendar calendar = Calendar.getInstance();\n        calendar.set(2023, 1, 24, 13, 57, 11);\n        Date date = calendar.getTime();\n\n        DateTimeFormatter dtf = DateTimeFormatter.ofPattern(&quot;E MMM d u H:m:s Oxxx&quot;, Locale.ENGLISH);\n        ZonedDateTime zdt = ZonedDateTime.ofInstant(date.toInstant(), ZoneOffset.UTC);\n        String strDate = zdt.format(dtf);\n        System.out.println(strDate);\n    }\n}\n</code></pre>\n<p><strong>Output</strong>:</p>\n<pre><code>Fri Feb 24 2023 13:57:11 GMT+00:00\n</code></pre>\n<p><a href=\"https://ideone.com/wQPGv1\" rel=\"nofollow noreferrer\"><kbd>ONLINE DEMO</kbd></a></p>\n<p>Learn more about the modern Date-Time API from <strong><a href=\"https://docs.oracle.com/javase/tutorial/datetime/index.html\" rel=\"nofollow noreferrer\">Trail: Date Time</a></strong>.</p>\n"},{"owner":{"user_id":6028807,"display_name":"Miss Chanandler Bong"},"up_vote_count":1,"is_accepted":false,"creation_date":1681292663,"answer_id":75994032,"body":"<p>According to the <a href=\"https://docs.oracle.com/javase/8/docs/api/java/time/format/DateTimeFormatter.html\" rel=\"nofollow noreferrer\">documentation</a>, <code>O</code> is <code>localized zone-offset</code>. If you take a look into the <code>DateTimeFormatterBuilder</code>, you can find that the <code>O</code> option is mapped to a parser called <code>LocalizedOffsetIdPrinterParser</code>. Here is the part of the code that makes <code>GMT</code> printed without a zone offset:</p>\n<pre><code>if (totalSecs != 0) {\n    ...\n}\nreturn true;\n</code></pre>\n<p>Since <code>+00:00</code> has a <code>0</code> total different seconds, this code block is not executed.</p>\n<p>Here is an example of how you can use <a href=\"https://docs.oracle.com/javase/8/docs/api/java/time/format/DateTimeFormatterBuilder.html#appendOffset-java.lang.String-java.lang.String-\" rel=\"nofollow noreferrer\"><code>DateTimeFormatterBuilder#appendOffset(pattern, noOffsetText)</code></a> to force printing the zone offset even if it's <code>00:00</code>:</p>\n<pre><code>DateTimeFormatterBuilder dateTimeFormatterBuilder = new DateTimeFormatterBuilder()\n                .parseCaseInsensitive()\n                .append(DateTimeFormatter.ofPattern(&quot;E MMM d u H:m:s 'GMT'&quot;))\n                .appendOffset(&quot;+HH:MM&quot;, &quot;+00:00&quot;);  // +HH:MM - hour and minute, ignoring second, with colon\nDateTimeFormatter formatter = dateTimeFormatterBuilder.toFormatter(Locale.ENGLISH);\nSystem.out.println(odt.format(formatter));\n</code></pre>\n"}],"owner":{"user_id":668951,"display_name":"Atul"},"view_count":107,"up_vote_count":2,"answer_count":2,"score":2,"creation_date":1681278078,"question_id":75992230,"body":"<p>I need to print the date something like <code>&quot;Fri Feb 24 2023 13:57:11 GMT+00:00&quot;</code>\nwith</p>\n<pre><code>DateTimeFormatter dtf = DateTimeFormatter.ofPattern(&quot;E MMM d u H:m:s O&quot;, Locale.ENGLISH);\nOffsetDateTime odt = OffsetDateTime.ofInstant(date.toInstant(), ZoneOffset.of(&quot;+05:30&quot;));\nString strDate = odt.format(dtf);\n</code></pre>\n<p>I can print it like <code>&quot;Fri Feb 24 2023 19:27:11 GMT+5:30&quot;.</code></p>\n<p>But if I use</p>\n<pre><code>OffsetDateTime odt = OffsetDateTime.ofInstant(date.toInstant(), ZoneOffset.of(&quot;+00:00&quot;));\n</code></pre>\n<p>it prints as <code>&quot;Fri Feb 24 2023 13:57:11 GMT&quot;</code> without the <code>+00:00</code>\nHow could I add that in java?</p>\n"},{"tags":["java","android","android-gradle-plugin"],"answers":[{"owner":{"user_id":12763954,"display_name":"Olivier"},"up_vote_count":0,"is_accepted":false,"creation_date":1681632337,"answer_id":76026573,"body":"<p>As explained <a href=\"https://stackoverflow.com/a/59244378/12763954\">here</a>, the dependency should be added to the app gradle script, not the project script.</p>\n"},{"owner":{"user_id":589329,"display_name":"Vampire"},"up_vote_count":3,"is_accepted":true,"creation_date":1681679084,"answer_id":76030326,"body":"<p>The <code>implementation</code> you use within <code>dependencies { ... }</code> actually is a configuration.\nThis configuration needs to be added by some plugin you apply, as by default no configurations are present in a Gradle build.\nLanguage plugins like <code>java</code>, or <code>kotlin(&quot;jvm&quot;)</code>, <code>com.android.application</code>, (or plugins they apply transitively), add such configurations to which you can then add dependencies.</p>\n<p>In the root project build script you showed, you do not apply any plugin, so there is also no configuration present to which you could add dependencies and thus you get a complaint by gradle, that <code>implementation</code> does not exist.</p>\n<p>You probably wanted to add this line to your application-level build script instead.</p>\n"}],"owner":{"user_id":3818984,"display_name":"Baalback"},"view_count":139,"up_vote_count":2,"accepted_answer_id":76030326,"answer_count":2,"score":2,"creation_date":1681236692,"question_id":75988906,"body":"<p>I made some search before posting here.\nI created a new project and I have the below:</p>\n<p>From:(build gradle project)</p>\n<pre><code>// Top-level build file where you can add configuration options common to all sub-projects/modules.\nplugins {\n    id 'com.android.application' version '7.4.2' apply false\n    id 'com.android.library' version '7.4.2' apply false\n}\n</code></pre>\n<p>To:</p>\n<pre><code>// Top-level build file where you can add configuration options common to all sub-projects/modules.\nplugins {\n    id 'com.android.application' version '7.4.2' apply false\n    id 'com.android.library' version '7.4.2' apply false\n}\ndependencies {\n    // Import the Firebase BoM\n    implementation platform('com.google.firebase:firebase-bom:31.3.0')\n\n\n    // TODO: Add the dependencies for Firebase products you want to use\n    // When using the BoM, don't specify versions in Firebase dependencies\n    // https://firebase.google.com/docs/android/setup#available-libraries\n}\n</code></pre>\n<p>So I got this error:</p>\n<blockquote>\n<p>Could not find method implementation() for arguments [DefaultExternalModuleDependency{group='com.google.firebase', name='firebase-bom', version='31.3.0', configuration='default'}] on object of type org.gradle.api.internal.artifacts.dsl.dependencies.DefaultDependencyHandler.</p>\n</blockquote>\n<p>this is gradle app</p>\n<pre><code>plugins {\n    id 'com.android.application'\n}\n\nandroid {\n    namespace 'com.example.delivery1'\n    compileSdk 33\n\n    defaultConfig {\n        applicationId &quot;com.example.delivery1&quot;\n        minSdk 25\n        targetSdk 33\n        versionCode 1\n        versionName &quot;1.0&quot;\n\n        testInstrumentationRunner &quot;androidx.test.runner.AndroidJUnitRunner&quot;\n    }\n\n    buildTypes {\n        release {\n            minifyEnabled false\n            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'\n        }\n    }\n    compileOptions {\n        sourceCompatibility JavaVersion.VERSION_1_8\n        targetCompatibility JavaVersion.VERSION_1_8\n    }\n    buildFeatures {\n        viewBinding true\n    }\n}\n\ndependencies {\n\n    implementation 'androidx.appcompat:appcompat:1.6.1'\n    implementation 'com.google.android.material:material:1.8.0'\n    implementation 'androidx.constraintlayout:constraintlayout:2.1.4'\n    implementation 'androidx.lifecycle:lifecycle-livedata-ktx:2.6.1'\n    implementation 'androidx.lifecycle:lifecycle-viewmodel-ktx:2.6.1'\n    implementation 'androidx.navigation:navigation-fragment:2.5.3'\n    implementation 'androidx.navigation:navigation-ui:2.5.3'\n    testImplementation 'junit:junit:4.13.2'\n    androidTestImplementation 'androidx.test.ext:junit:1.1.5'\n    androidTestImplementation 'androidx.test.espresso:espresso-core:3.5.1'\n    implementation(platform(&quot;org.jetbrains.kotlin:kotlin-bom:1.8.0&quot;))\n    classpath 'com.google.gms:google-services:4.3.15'\n}\n</code></pre>\n"},{"tags":["java","scala","apache-spark","github-actions","cicd"],"comments":[{"owner":{"user_id":1736407,"display_name":"Cam"},"edited":false,"comment_id":133938955,"body":"Thanks @DmytroMitin did you want to make that an answer and I will mark it as the accepted one?"},{"owner":{"user_id":5249621,"display_name":"Dmytro Mitin"},"edited":false,"comment_id":133939106,"body":"done :) good that this helped"}],"answers":[{"owner":{"user_id":5249621,"display_name":"Dmytro Mitin"},"up_vote_count":3,"is_accepted":true,"creation_date":1680688194,"answer_id":75937985,"body":"<p>Or vice versa this can mean that you need to downgrade to Java less than 11 because one of dependencies doesn't work with Java 11</p>\n<hr />\n<p><a href=\"https://stackoverflow.com/questions/53583199/spark-error-unsupported-class-file-major-version\">Spark Error - Unsupported class file major version</a></p>\n<p><a href=\"https://stackoverflow.com/questions/62021734/illegalargumentexception-unsupported-class-file-major-version-55\">IllegalArgumentException: &#39;Unsupported class file major version 55&#39;</a></p>\n<p><a href=\"https://stackoverflow.com/questions/55019548/spark-illegalargumentexception-unsupported-class-file-major-version-55\">Spark: IllegalArgumentException: &#39;Unsupported class file major version 55&#39;</a></p>\n<p><a href=\"https://stackoverflow.com/questions/67079327/how-can-i-fix-unsupported-class-file-major-version-60-in-intellij-idea\">How can I fix &quot;unsupported class file major version 60&quot; in IntelliJ IDEA?</a></p>\n<p><a href=\"https://stackoverflow.com/questions/55923943/how-to-fix-unsupported-class-file-major-version-55-while-executing-org-apache\">How to fix &#39;Unsupported class file major version 55&#39; while executing &#39;org.apache.spark.sql.DataSet.collectAsList()&#39;</a></p>\n"}],"owner":{"user_id":1736407,"display_name":"Cam"},"view_count":41,"up_vote_count":2,"accepted_answer_id":75937985,"answer_count":1,"score":2,"creation_date":1680683869,"question_id":75937329,"body":"<p>I've inherited a codebase that hasn't been touched for around 3 years. I've noticed that a large number of unit tests in our GitHub action for the repo are failing with the error:</p>\n<pre><code>java.lang.IllegalArgumentException: Unsupported class file major version 55\n</code></pre>\n<p>A quick google suggested that I needed to update to Java 11, so I added the following step to our <code>main.yml</code>:</p>\n<pre><code>- name: Set up Java\n  uses: actions/setup-java@v3\n  with:\n    distribution: 'zulu'\n    java-version: '11'\n</code></pre>\n<p>But the tests are still failing with the same error.</p>\n<p>Can anyone lend a hand with this?</p>\n"},{"tags":["java","spring-boot","thymeleaf"],"comments":[{"owner":{"user_id":1744230,"display_name":"QBrute"},"edited":false,"comment_id":133856693,"body":"Where&#39;s your class <code>SurveyStat</code>?"},{"owner":{"user_id":8616360,"display_name":"shashaank srivastava"},"edited":false,"comment_id":133856705,"body":"@QBrute SurveyStat is automatically provided by thymeleaf to give iteration stats <a href=\"https://www.baeldung.com/thymeleaf-iteration#status-variable\" rel=\"nofollow noreferrer\">baeldung.com/thymeleaf-iteration#status-variable</a>"},{"owner":{"user_id":1744230,"display_name":"QBrute"},"edited":false,"comment_id":133856864,"body":"Thanks for clarifying, but judging from the example at Baeldung, shouldn&#39;t it be <code>th:each=&quot;survey, surveyStat: ${surveys}&quot;</code>?"},{"owner":{"user_id":8616360,"display_name":"shashaank srivastava"},"edited":false,"comment_id":133856906,"body":"@QBrute In case we omit the explicit creation of status variable (presented as iStat in our example), we could invoke our status variable by simply using the studentStat, which is the aggregation of the variable student with the suffix Stat."}],"answers":[{"owner":{"user_id":2633917,"display_name":"tobifasc"},"up_vote_count":3,"is_accepted":true,"creation_date":1680182216,"answer_id":75888765,"body":"<pre><code>surveyRepository.findAll(PageRequest.of(0,10))\n</code></pre>\n<p>returns a <code>Page&lt;T&gt;</code> (provided your <code>surveyRepository</code> is a default <a href=\"https://docs.spring.io/spring-data/data-commons/docs/current/api/org/springframework/data/repository/PagingAndSortingRepository.html\" rel=\"nofollow noreferrer\">PagingAndSortingRepository</a>)</p>\n<p>This <code>Page</code> neither implements <code>Collection</code> nor <code>Map</code> and it isn't an array. But it implements <code>Iterable</code> so thymeleaf will compute the size as <code>null</code>. You can check the relevant code <a href=\"https://github.com/thymeleaf/thymeleaf/blob/e5434ee1dc5145c8a2a5ff50a40bffa16c63a412/lib/thymeleaf/src/main/java/org/thymeleaf/engine/IteratedGatheringModelProcessable.java#L410\" rel=\"nofollow noreferrer\">here</a>.</p>\n<p>What you could do is instead of passing the <code>Page</code> to the model pass a <code>Collection</code> instead:</p>\n<pre><code>@GetMapping(path = &quot;/&quot;)\npublic String homePage(Model model) {\n    List&lt;Survey&gt; surveys = surveyRepository.findAll(PageRequest.of(0,10)).getContent();\n    model.addAttribute(&quot;surveys&quot;, surveys);\n    return &quot;index&quot;;\n}\n</code></pre>\n"}],"owner":{"user_id":8616360,"display_name":"shashaank srivastava"},"view_count":59,"up_vote_count":2,"accepted_answer_id":75888765,"answer_count":1,"score":2,"creation_date":1680180747,"question_id":75888529,"body":"<p>This is my data class survey nothing unusual here I even have eager loading to prevent issues</p>\n<pre><code>package com.based.basedsurvey.data;\n\nimport jakarta.persistence.*;\nimport lombok.*;\n\nimport java.util.ArrayList;\nimport java.util.List;\n\n@Entity\n@Data\n@NoArgsConstructor\npublic class Survey {\n    @Id\n    @GeneratedValue(strategy = GenerationType.AUTO)\n    private long id;\n    @NonNull\n    private String name;\n    private boolean open;\n\n    @ToString.Exclude\n    @EqualsAndHashCode.Exclude\n    @OneToMany(cascade = CascadeType.ALL, orphanRemoval = true, fetch = FetchType.EAGER)\n    private List&lt;Question&gt; questions = new ArrayList&lt;&gt;();\n\n    public Survey(String name){\n        this.name = name;\n        open = false;\n    }\n}\n</code></pre>\n<p>in the controller this is also very standard just returning all of the items</p>\n<pre><code>    @GetMapping(path = &quot;/&quot;)\n    public String homePage(Model model) {\n        model.addAttribute(&quot;surveys&quot;, surveyRepository.findAll(PageRequest.of(0,10)));\n        return &quot;index&quot;;\n    }\n</code></pre>\n<p>repository class</p>\n<pre><code>package com.based.basedsurvey.repo;\n\nimport com.based.basedsurvey.data.Survey;\nimport org.springframework.data.jpa.repository.JpaRepository;\nimport org.springframework.data.repository.CrudRepository;\n\npublic interface SurveyRepository extends JpaRepository&lt;Survey, Long&gt; {\n    Survey findSurveyById(long id);\n\n}\n</code></pre>\n<p>html, this is a small snippet, the important part is surveyStat.odd and surveyStat.last</p>\n<pre><code> &lt;tbody&gt;\n    &lt;tr th:each=&quot;survey: ${surveys}&quot; th:class=&quot;${surveyStat.odd}? 'odd'&quot;&gt;\n        &lt;td&gt;\n          &lt;div th:attr=&quot;hx-reveal=${surveyStat.last ? 'revealed' : null}&quot;&gt;&lt;/div&gt;\n          &lt;p th:text=&quot;${survey.isOpen()?'OPEN':'CLOSED'}&quot;/&gt;\n        &lt;/td&gt;\n    &lt;/tr&gt;\n&lt;/tbody&gt;\n</code></pre>\n<p><code>EL1021E: A problem occurred whilst attempting to access the property 'last': 'Unable to access property 'last' through getter method'</code></p>\n<p><code>Unable to access property 'last' through getter method</code></p>\n<p><code>Cannot invoke &quot;java.lang.Integer.intValue()&quot; because &quot;this.size&quot; is null</code></p>\n<p>I'm not sure why when i use surveyStat.odd there is no issue but when I use surveyStat.last I'm given an error and the index page is no longer able to load</p>\n<p>There is no issue on compilation but rather when the view index is attempting to load the error EL1021E shown below is thrown.</p>\n"},{"tags":["java","sorting","recursion","stack-overflow","quicksort"],"comments":[{"owner":{"user_id":21508463,"display_name":"Yves Daoust"},"edited":false,"comment_id":133837699,"body":"The error trace is incomplete."},{"owner":{"user_id":21508463,"display_name":"Yves Daoust"},"edited":false,"comment_id":133837709,"body":"Note that QuickSort must be performed in-place. Which your code does not do."},{"owner":{"user_id":19209356,"display_name":"ege.exe"},"edited":false,"comment_id":133837739,"body":"@Yves Daoust I&#39;m confused on what error trace means in this context, do you mean I didn&#39;t provide the full error message or is it something else? Also what does the error trace have anything to do with my algorithm?"},{"owner":{"user_id":21508463,"display_name":"Yves Daoust"},"edited":false,"comment_id":133838095,"body":"&quot;what does the error trace have anything to do with my algorithm&quot;: you mean there is no error to worry about ??"},{"owner":{"user_id":5772882,"display_name":"Ole V.V."},"edited":false,"comment_id":133838434,"body":"When you are partitioning your elements, you will at a point encounter the pivot element, and since it is not greater than itself, you will put it in the <code>left_arr</code>. After the recursive calls you are adding both all the elements from <code>left_arr</code> including the pivot element and the pivot element itself to the result. So the pivot element gets duplicated. Also if the pivot happens to be the max element, all the elements go into <code>left_arr</code>, which will cause recursion with a list equal to the original one. Whether any of this can cause your stack overflow, I don’t know."},{"owner":{"user_id":5772882,"display_name":"Ole V.V."},"edited":false,"comment_id":133838505,"body":"Did you try a debugger?"},{"owner":{"user_id":5772882,"display_name":"Ole V.V."},"edited":false,"comment_id":133842657,"body":"I cannot reproduce exactly. In one run your code sorted your input into <code>[6, 6, 15, 15, 32, 32, 32, 232, 232, 643, 643, 6543, 6543, 534232, 534232]</code>. Note the repeated elements. However when I enter input 1, 2, 1, -1, I get a stack overflow error that looks like yours. Can it be that you observed it when by mistake you entered the same element twice?"},{"owner":{"user_id":5772882,"display_name":"Ole V.V."},"edited":false,"comment_id":133844398,"body":"@user16320675 True. I believe that that’s why we observe the stack overflow if there are equal elements in the list. If there are not, the random component will save us sooner or later and in the vast majority of cases before the stack overflow hits us."},{"owner":{"user_id":16320675,"display_name":"user16320675"},"edited":false,"comment_id":133844494,"body":"@Ole agreed - just tested and also could not reproduce the problem with posted input, but for sure if replacing last element by <code>6</code> (a duplicate)"}],"answers":[{"owner":{"user_id":2910751,"display_name":"Martin Frank"},"up_vote_count":3,"is_accepted":true,"creation_date":1680094460,"answer_id":75877520,"body":"<h2>code runs fine</h2>\n<p>well <strong>almost</strong> fine, there is a bug in your code</p>\n<pre><code>left_arr = quick_sort(left_arr);\nright_arr = quick_sort(right_arr);\nArrayList&lt;Integer&gt; result = new ArrayList&lt;Integer&gt;();\nresult.addAll(left_arr);\nresult.add(pivot); //BUG HERE\nresult.addAll(right_arr);\n</code></pre>\n<p>when you split left/right you already add your <code>pivot</code> into the <code>left_arr</code> - so no need to add it twice, since</p>\n<pre><code>if (element &gt; pivot) {\n    right_arr.add(element);\n} else {\n    left_arr.add(element); //pivot itself is NOT bigger than pivot and will be added here\n}\n</code></pre>\n<p>alternatively you can <code>remove</code> the pivot from the list: <code>int pivot = arr.remove(pivot_index);</code></p>\n<h2>about java.lang.StackOverflowError</h2>\n<p>well - your code is working fine, on my machine so i guess you have to setup your computer properly - see <a href=\"https://stackoverflow.com/questions/3700459/how-to-increase-the-java-stack-size\">this answer</a> for further details (sorry for that link-only answer)</p>\n"}],"owner":{"user_id":19209356,"display_name":"ege.exe"},"view_count":59,"up_vote_count":2,"accepted_answer_id":75877520,"answer_count":1,"score":2,"creation_date":1680091783,"question_id":75877008,"body":"<p>For the following quicksort algorithm:</p>\n<pre><code>import java.util.Scanner;\nimport java.util.ArrayList;\npublic class quick_sort_demo {\n    public static void main(String[] args) {\n        Scanner sc = new Scanner(System.in);\n        ArrayList&lt;Integer&gt; my_arr = new ArrayList&lt;Integer&gt;();\n        while (true) {\n            System.out.println(&quot;Enter input value. '-1' to exit the adding process. &quot;);\n            int val = sc.nextInt();\n            sc.nextLine();\n            if (val == -1) {\n                break;\n            } else {\n                my_arr.add(val);\n            }\n        }\n        quick_sort(my_arr);\n    }\n    public static ArrayList&lt;Integer&gt; quick_sort(ArrayList&lt;Integer&gt; arr) {\n        if (arr.size() &lt;= 1) {\n            return arr;\n        }\n        int pivot_index = (int) (Math.random() * arr.size());\n        int pivot = arr.get(pivot_index);\n        ArrayList&lt;Integer&gt; left_arr = new ArrayList&lt;Integer&gt;();\n        ArrayList&lt;Integer&gt; right_arr = new ArrayList&lt;Integer&gt;();\n        for (int i = 0; i &lt; arr.size(); i++) {\n            int element = arr.get(i);\n            if (element &gt; pivot) {\n                right_arr.add(element);\n            } else {\n                left_arr.add(element);\n            }\n        }\n        left_arr = quick_sort(left_arr);\n        right_arr = quick_sort(right_arr);\n        ArrayList&lt;Integer&gt; result = new ArrayList&lt;Integer&gt;();\n        result.addAll(left_arr);\n        result.add(pivot);\n        result.addAll(right_arr);\n        return result;\n    }\n}\n</code></pre>\n<p>I am getting this error repeatedly:</p>\n<pre><code>Exception in thread &quot;main&quot; java.lang.StackOverflowError\n        at java.base/java.util.Random.next(Random.java:209)\n        at java.base/java.util.Random.nextDouble(Random.java:463)\n        at java.base/java.lang.Math.random(Math.java:865)\n        at quick_sort_demo.quick_sort(quick_sort_demo.java:23)\n        at quick_sort_demo.quick_sort(quick_sort_demo.java:35)\n</code></pre>\n<p>My exact inputs for the program were as follows: {6,15,32,643,6543,534232,232,-1}</p>\n<p>I tried asking CHATGPT but I couldn't get a helpful answer for the specific error I encountered. I don't understand why I'm getting a stackoverflow error as the recursive method should be calling itself without issue until the 'arr.size()' returns something &lt;= 1. Can someone explain what I'm doing wrong? Is my algorithm wrong and why am I getting a recursion error?</p>\n"},{"tags":["java","unit-testing","junit","mocking","junit5"],"comments":[{"owner":{"user_id":466862,"display_name":"Mark Rotteveel"},"edited":false,"comment_id":133834436,"body":"Why would you want to skip those methods? A lot of extremely brittle tests are written because people take the term unit testing too literal or too extreme."},{"owner":{"user_id":20629378,"display_name":"Pavan G"},"edited":false,"comment_id":133850665,"body":"@MarkRotteveel those methods are void , so  I don&#39;t want to execute them, I just want to check whether the method is called or not"},{"owner":{"user_id":466862,"display_name":"Mark Rotteveel"},"edited":false,"comment_id":133852771,"body":"I think that is a nonsensical argument. Mocking them because they are void sounds like an excuse."}],"answers":[{"owner":{"user_id":16775102,"display_name":"Feel free"},"up_vote_count":1,"is_accepted":true,"creation_date":1680074831,"answer_id":75874320,"body":"<p>Beware that the void method on mocks does nothing by default!</p>\n<p>you can use any of the doThrow(),doAnswer(),doNothing(),doReturn() family of methods from Mockito framework to mock void methods.</p>\n<p>For example,</p>\n<pre><code>Mockito.doThrow(new Exception()).when(instance).methodName();\n</code></pre>\n<p>or if you want to combine it with follow-up behavior,</p>\n<pre><code>Mockito.doThrow(new Exception()).doNothing().when(instance).methodName();\n</code></pre>\n<p>or do nothing:</p>\n<pre><code>Mockito.doNothing().when(spy).methodToMock();\n</code></pre>\n<p>or you can call real method</p>\n<pre><code>Mockito.doCallRealMethod().when(&lt;objectInstance&gt;).&lt;method&gt;();\n&lt;objectInstance&gt;.&lt;method&gt;();\n</code></pre>\n<p>Or, you could call the real method for all methods of that class, doing this:</p>\n<pre><code>&lt;Object&gt; &lt;objectInstance&gt; = mock(&lt;Object&gt;.class, Mockito.CALLS_REAL_METHODS);\n</code></pre>\n"},{"owner":{"user_id":9223726,"display_name":"Lavanya Nagarajan"},"up_vote_count":2,"is_accepted":false,"creation_date":1680074848,"answer_id":75874324,"body":"<p>Try something like this,</p>\n<pre><code>@Test\npublic void testProcessMethod() throws Exception {\n   try (MockedStatic&lt;Demo&gt; demoMocked = Mockito.mockStatic(Demo.class)) {\n        demoMocked.when((str1, str2) -&gt; Demo.processMethod1(str1, str2)).thenAnswer((Answer&lt;Void&gt;) invocation -&gt; null);\n        demoMocked.verify(Mockito.times(1), () -&gt; Demo.processMethod1(Mockito.anyString(), Mockito.anyString()));\n\n        demoMocked.when((str1, str2) -&gt; Demo.processMethod2(str1, str2)).thenAnswer((Answer&lt;Void&gt;) invocation -&gt; null);\n        demoMocked.verify(Mockito.times(1), () -&gt; Demo.processMethod2(Mockito.anyString(), Mockito.anyString()));\n   }\n}\n</code></pre>\n"}],"owner":{"user_id":20629378,"display_name":"Pavan G"},"view_count":89,"up_vote_count":2,"accepted_answer_id":75874320,"answer_count":2,"score":2,"creation_date":1680069988,"question_id":75873664,"body":"<pre class=\"lang-java prettyprint-override\"><code>public class Demo{\n    public static CustomObject processMethod(String str1, String str2){\n        //do something\n        Demo1.processMethod1(str1,str2);\n        Demo2.processMethod2(str1,str2);\n        return custom Object;\n    }\n}\n\npublic class Demo1{\n    public static void processMethod1(String str1, String str2){}\n}\n\npublic class Demo2{\n    public static void processMethod2(String str1, String str2){}\n}\n</code></pre>\n<p>I am new to unit testing. While creating a test for class Demo processMethod, how to skip the execution of processMethod1 and processMethod2?</p>\n"},{"tags":["java","java-stream"],"answers":[{"owner":{"user_id":5133585,"display_name":"Sweeper"},"up_vote_count":3,"is_accepted":false,"creation_date":1679555101,"answer_id":75820048,"body":"<p>You can <code>flatMap</code> twice. The intermediate <code>flatMap</code> flattens the stream to <code>Stream&lt;List&lt;Integer&gt;&gt;</code> - the scores of all students but grouped by subject.</p>\n<pre><code>Stream&lt;Integer&gt; integerStream = Arrays.stream(students)\n    .flatMap(s -&gt; s.getMarks().values().stream()) // Stream&lt;List&lt;Integer&gt;&gt;\n    .flatMap(Collection::stream); // now flatten it again\n</code></pre>\n"}],"owner":{"user_id":21462180,"display_name":"Kto Tam"},"view_count":44,"up_vote_count":3,"answer_count":1,"score":2,"creation_date":1679554627,"question_id":75819990,"body":"<p>How convert an array of students to Stream all marks of all students?</p>\n<pre><code>Map&lt;String, List&lt;Integer&gt;&gt; markAnn = new HashMap&lt;&gt;();\nmarkAnn.put(&quot;Physics&quot;, List.of(4,4,5));\nmarkAnn.put(&quot;Mathematics&quot;, List.of(2,3,4));\n\nMap&lt;String, List&lt;Integer&gt;&gt; markKate = new HashMap&lt;&gt;();\nmarkKate.put(&quot;Physics&quot;, List.of(1,2,3));\nmarkKate.put(&quot;Mathematics&quot;, List.of(5,5,3));\n\nStudenT[] students = {new StudenT(&quot;Ann&quot;, markAnn),new StudenT(&quot;Kate&quot;, markKate)};\n</code></pre>\n<pre><code>class Lesson6 {\n    public static void main(String[] args) {\n\n        Map&lt;String, List&lt;Integer&gt;&gt; markAnn = new HashMap&lt;&gt;();\n        markAnn.put(&quot;Physics&quot;, List.of(4,4,5));\n        markAnn.put(&quot;Mathematics&quot;, List.of(2,3,4));\n\n        Map&lt;String, List&lt;Integer&gt;&gt; markKate = new HashMap&lt;&gt;();\n        markKate.put(&quot;Physics&quot;, List.of(1,2,3));\n        markKate.put(&quot;Mathematics&quot;, List.of(5,5,3));\n\n        StudenT[] students = {new StudenT(&quot;Ann&quot;, markAnn),new StudenT(&quot;Kate&quot;, markKate)};\n        Stream&lt;Integer&gt; integerStream = Stream.of(students).map(StudenT::getMarks).flatMap()               \n\n    }\n}\n\nclass StudenT {\n\n    private String name;\n    private Map&lt;String, List&lt;Integer&gt;&gt; marks;\n\n     public StudenT(String name, Map&lt;String, List&lt;Integer&gt;&gt; marks) {\n         this.name = name;\n         this.marks = marks;\n     }\n\n     public String getName() {\n        return name;\n    }\n\n    public Map&lt;String, List&lt;Integer&gt;&gt; getMarks() {\n        return marks;\n    }\n}\n</code></pre>\n"},{"tags":["java","ssl"],"answers":[{"owner":{"user_id":3281336,"display_name":"PatS"},"up_vote_count":1,"is_accepted":false,"creation_date":1679515016,"answer_id":75816757,"body":"<p>The SO question <a href=\"https://stackoverflow.com/questions/56286934/which-cipher-suites-algorithm-are-supported-in-jdk11-and-which-one-is-best-to-us\">Which Cipher Suites Algorithm Are Supported in Jdk11 and Which One is Best to Use with TLSv1.2</a> has the answer buried in details of answering a related question.</p>\n<p>The link is:\n<a href=\"https://docs.oracle.com/en/java/javase/11/docs/specs/security/standard-names.html#jsse-cipher-suite-names\" rel=\"nofollow noreferrer\">https://docs.oracle.com/en/java/javase/11/docs/specs/security/standard-names.html#jsse-cipher-suite-names</a></p>\n<p>The table is very large so it is not reproduced below.</p>\n"},{"owner":{"user_id":4295123,"display_name":"Ardit Meti"},"up_vote_count":2,"is_accepted":false,"creation_date":1679516256,"answer_id":75816913,"body":"<pre><code>SSLSocketFactory f = (SSLSocketFactory) SSLSocketFactory.getDefault();\nSSLSocket secureSocket = (SSLSocket) f.createSocket();\nstream(secureSocket.getSupportedCipherSuites()).forEach(System.out::println);\n</code></pre>\n<p>p.s.\nAlso there is this cool link from mozilla that recommend based on the webserver: <a href=\"https://ssl-config.mozilla.org/#server=tomcat&amp;version=9.0.30&amp;config=intermediate&amp;guideline=5.6\" rel=\"nofollow noreferrer\">https://ssl-config.mozilla.org/#server=tomcat&amp;version=9.0.30&amp;config=intermediate&amp;guideline=5.6</a></p>\n"}],"owner":{"user_id":3281336,"display_name":"PatS"},"view_count":97,"up_vote_count":3,"answer_count":2,"score":2,"creation_date":1679514730,"question_id":75816713,"body":"<p>I'm debugging an SSL problem and trying find how Java knows what cipher suites are supported.</p>\n<p><strong>How can I get a list of the cipher suites that are supported by TLSv1.2 in Java 11?</strong></p>\n<p><strong>Is there Java code I could write to list the cipher suites available?</strong></p>\n<h2>Searching for answers:</h2>\n<p>I found that <code>openssl</code> can list several.</p>\n<pre><code>openssl ciphers -V | head\n          0xC0,0x30 - ECDHE-RSA-AES256-GCM-SHA384 TLSv1.2 Kx=ECDH     Au=RSA  Enc=AESGCM(256) Mac=AEAD\n          0xC0,0x2C - ECDHE-ECDSA-AES256-GCM-SHA384 TLSv1.2 Kx=ECDH     Au=ECDSA Enc=AESGCM(256) Mac=AEAD\n          0xC0,0x28 - ECDHE-RSA-AES256-SHA384 TLSv1.2 Kx=ECDH     Au=RSA  Enc=AES(256)  Mac=SHA384\n          0xC0,0x24 - ECDHE-ECDSA-AES256-SHA384 TLSv1.2 Kx=ECDH     Au=ECDSA Enc=AES(256)  Mac=SHA384\n          0xC0,0x14 - ECDHE-RSA-AES256-SHA    SSLv3 Kx=ECDH     Au=RSA  Enc=AES(256)  Mac=SHA1\n          0xC0,0x0A - ECDHE-ECDSA-AES256-SHA  SSLv3 Kx=ECDH     Au=ECDSA Enc=AES(256)  Mac=SHA1\n          0x00,0xA5 - DH-DSS-AES256-GCM-SHA384 TLSv1.2 Kx=DH/DSS   Au=DH   Enc=AESGCM(256) Mac=AEAD\n          0x00,0xA3 - DHE-DSS-AES256-GCM-SHA384 TLSv1.2 Kx=DH       Au=DSS  Enc=AESGCM(256) Mac=AEAD\n          0x00,0xA1 - DH-RSA-AES256-GCM-SHA384 TLSv1.2 Kx=DH/RSA   Au=DH   Enc=AESGCM(256) Mac=AEAD\n          0x00,0x9F - DHE-RSA-AES256-GCM-SHA384 TLSv1.2 Kx=DH       Au=RSA  Enc=AESGCM(256) Mac=AEAD\n</code></pre>\n"},{"tags":["java","generics","wildcard"],"comments":[{"owner":{"user_id":11002,"display_name":"tgdavies"},"edited":false,"comment_id":133631687,"body":"I don&#39;t think there&#39;s any reason for the <code>Object &amp;</code> part."},{"owner":{"user_id":5772882,"display_name":"Ole V.V."},"edited":false,"comment_id":133632309,"body":"In this context <code>super</code> and <code>extends</code> are opposites. <code>T extends Object</code> means that <code>T</code> is a <i>subtype</i>  of <code>Object</code> (or is <code>Object</code>). <code>? super T</code> means that <code>?</code> is a <i>supertype</i> of <code>T</code> or (typically) is <code>T</code>. Or put the other way around <code>T</code> is a subtype of <code>?</code>. If you had <code>Comparable&lt;? extends T&gt;</code> you had not guaranteed that every <code>T</code> can be compared to every other <code>T</code>, which you need for the method to do its work."}],"answers":[{"owner":{"user_id":11002,"display_name":"tgdavies"},"up_vote_count":2,"is_accepted":false,"creation_date":1678943150,"answer_id":75752347,"body":"<p>You can certainly write the method signature as</p>\n<pre><code>public static &lt;T extends Comparable&lt;T&gt;&gt; T max(List&lt;? extends T&gt; list, int begin, int end)\n</code></pre>\n<p>And that works perfectly well with most types.</p>\n<p>But it is more strict than we need.</p>\n<p>Consider:</p>\n<pre><code>class Aa implements Comparable&lt;Aa&gt; {\n    @Override\n    public int compareTo(Aa o) {\n        return 0;\n    }\n}\n\nclass Bb extends Aa {}\n</code></pre>\n<p>Every instance of <code>Bb</code> knows how to compare itself with another instance of <code>Bb</code> (because a <code>Bb</code> IS-A <code>Aa</code>), but it does <em>not</em> <code>extend Comparable&lt;Bb&gt;</code>.</p>\n<p>All we need is that we can compare two instances of the type, which is satisfied by checking that it or one of its parent classes implements <code>Comparable</code>.</p>\n<p><code>T extends Comparable&lt;? super T&gt;</code> requires that <code>T</code> implements <code>Comparable&lt;X&gt;</code> (either directly or via a superclass) where <code>X</code> is a superclass of <code>T</code>.</p>\n<p>In our example above <code>class Aa implements Comparable&lt;Object&gt;</code> would also be fine.</p>\n<p>Using <code>T extends Comparable&lt;?&gt;</code> doesn't work, because when we call <code>compareTo</code> all we know is that <code>T</code> can be compared to some unknown class, we don't know that it can be compared to <code>T</code>.</p>\n"},{"owner":{"user_id":3553434,"display_name":"时间只会一直走"},"up_vote_count":1,"is_accepted":false,"creation_date":1678955422,"answer_id":75753678,"body":"<p>The simple answer is the following two things：</p>\n<p>In <code>List&lt;? extends T&gt; list</code> any element is <code>T</code> or a subclass of <code>T</code>, <code>&lt;T extends Comparable&lt;? super T&gt;&gt;</code> ensure that any elements in the List implement the same parent type compar interface(If use <code>&lt;T extends Comparable&lt;? extends T&gt;&gt;</code>, there is no guarantee of this, imagine if T is Number, then <code>&lt;T extends Number&gt;</code> could be <code>Float</code>, <code>List&lt;? extends T&gt;</code> mayber <code>Integer</code>, <code>Float</code> and <code>Integer</code> have no inheritance relationship and cannot be compared directly)</p>\n<p><code>T extends Object</code>, Let me tell you a scene, you need to write like this, About 10 years ago, we would compile the web packaged into a war package. If there were 100 files in it, we might only modify one of the files. At this time, we would decompress the war package and compile the modified class to get it\nThe class file is copied separately to tomcat in the production environment.</p>\n<p>If this is the code before modification:</p>\n<pre><code>public static &lt;T&gt; int method(T obj) {\n    //...\n}\n</code></pre>\n<p>Due to generic erasure, after compilation, it will become like this (note that it is only schematic, because it is bytecode after compilation, you can understand it as this):</p>\n<pre><code>public static int method(Object obj) {\n    //...\n}\n</code></pre>\n<p>Therefore, to call this method, the referenced method signature is <code>int method(Object)</code></p>\n<p>If you modify this method, make it bound by the interface, like this:</p>\n<pre><code>public static &lt;T extends CharSequence&gt; int method(T obj) {\n    //...\n}\n</code></pre>\n<p>At this time, after compilation, the method signature will become <code>int method(CharSequence)</code></p>\n<p>If you directly move the compiled class of this class to tomcat, then the location where it is called will report an error.</p>\n<p>The solution is to use <code>&lt;T extends Object &amp; CharSequence&gt;</code>:</p>\n<pre><code>public static &lt;T extends Object &amp; CharSequence&gt; int method(T obj) {\n    //...\n}\n</code></pre>\n<p>When the generic type is erased, the type before the first &amp; symbol will be retained, at this time, his method signature is still <code>int method(Object)</code></p>\n"}],"owner":{"user_id":2668926,"display_name":"davidandcode"},"view_count":74,"up_vote_count":2,"answer_count":2,"score":2,"creation_date":1678940780,"question_id":75752175,"body":"<p>My question is in the following code, why <code>Comparable&lt;? super T&gt;</code> instead of <code>Comparable&lt;? extends T&gt;</code> or <code>Comparable&lt;T&gt;</code>?</p>\n<p>The comparable can compare <code>T</code>'s ancestors but in the list we only have <code>T</code>'s subtypes?</p>\n<p>Also, why <code>T extends Object</code>, isn't this by default?</p>\n<p>Write a generic method to find the maximal element in the range [begin, end) of a list.</p>\n<p>Answer:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public static &lt;T extends Object &amp; Comparable&lt;? super T&gt;&gt; T max(List&lt;? extends T&gt; list, int begin, int end) {\n\n    T maxElem = list.get(begin);\n\n    for (++begin; begin &lt; end; ++begin)\n        if (maxElem.compareTo(list.get(begin)) &lt; 0)\n            maxElem = list.get(begin);\n    return maxElem;\n}\n</code></pre>\n<p>this is from the six edition of the Java tutorial: a short course on the basics by ray gallardo et al.</p>\n"},{"tags":["java","future","completable-future"],"answers":[{"owner":{"user_id":402428,"display_name":"michid"},"up_vote_count":3,"is_accepted":true,"creation_date":1678743211,"answer_id":75727087,"body":"<p>Add a completion handler to each future in your list to complete an auxiliary future:</p>\n<pre><code>List&lt;CompletableFuture&lt;String&gt;&gt; futures = ...\n    \nvar firstNonNull = new CompletableFuture&lt;String&gt;();\nfutures.forEach(future -&gt; future.whenComplete( (value, failure) -&gt; {\n    if (value != null) {\n        firstNonNull.complete(value);\n    }\n}));\n\nfirstNonNull.whenComplete(...)\n</code></pre>\n<p>Now <code>firstNonNull</code> completes once the first future in <code>futures</code> completes with a non <code>null</code> value.</p>\n"}],"owner":{"user_id":1255801,"display_name":"homar"},"view_count":59,"up_vote_count":2,"accepted_answer_id":75727087,"answer_count":1,"score":2,"creation_date":1678739512,"question_id":75726651,"body":"<p>In java I have a list of futures that can return a result or null.\nHow to wait for whichever completes first and if it returns a result then ignore the rest but if it returns null wait for another one to finish?</p>\n"},{"tags":["java","consumer","functional-interface"],"comments":[{"owner":{"user_id":1554195,"display_name":"tquadrat"},"edited":false,"comment_id":133558075,"body":"Although off topic in regard to your question, you should revisit the lessons about inheritance and how to build a class hierarchy."}],"answers":[{"owner":{"user_id":2422776,"display_name":"Mureinik"},"up_vote_count":2,"is_accepted":true,"creation_date":1678551046,"answer_id":75706222,"body":"<p>This may be missing the point of the question, but you could use <a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/Collection.html#removeIf-java.util.function.Predicate-\" rel=\"nofollow noreferrer\"><code>removeIf</code></a> and pass a <code>Predicate</code> that's based on the <code>isDanger</code> property:</p>\n<pre class=\"lang-java prettyprint-override\"><code>animals.removeIf(Animal::isDanger)\n</code></pre>\n"},{"owner":{"user_id":9513184,"display_name":"Unmitigated"},"up_vote_count":1,"is_accepted":false,"creation_date":1678551406,"answer_id":75706265,"body":"<p>There are two main issues with your code:</p>\n<ul>\n<li>When you pass an <code>Integer</code> to <code>List#remove</code>, it's using the overload that removes an element by value (see <a href=\"https://docs.oracle.com/en/java/javase/19/docs/api/java.base/java/util/List.html#remove(java.lang.Object)\" rel=\"nofollow noreferrer\"><code>List#remove(Object)</code></a>). You would need to pass an <code>int</code> instead to remove by <strong>index</strong>.</li>\n<li>In order to delete elements while iterating, to avoid skipping elements, you should either loop backwards or use an <code>Iterator</code>.</li>\n</ul>\n<pre class=\"lang-java prettyprint-override\"><code>BiConsumer&lt;Boolean, Integer&gt; removeDangerous = (isDangerous, index) -&gt; {\n    if(isDangerous){\n        System.out.println(&quot;Dangerous animal: &quot; + listOfAnimals.get(index).getName());\n        listOfAnimals.remove((int)index);\n    }\n};\nfor (int i = listOfAnimals.size() - 1; i &gt;= 0; i--) {\n    removeDangerous.accept(listOfAnimals.get(i).isDanger(), i);\n}\n</code></pre>\n"}],"owner":{"user_id":17703613,"display_name":"OrlandoVSilva"},"view_count":52,"up_vote_count":2,"accepted_answer_id":75706222,"answer_count":2,"score":2,"creation_date":1678550767,"question_id":75706195,"body":"<p>I have the following problem:</p>\n<p>Goal: Remove from list the animal with &quot;danger&quot; == true;</p>\n<p>Restraints: One of the functional interfaces (<code>Consumer</code>, <code>Predicate</code>, <code>Function</code> or <code>Supplier</code>) must be used (I chose <code>BiConsumer</code> because of the index);</p>\n<p>Issue: <code>BiConsumer</code> is not updating the passed list (No error is displayed);</p>\n<p>Attempts: I have also tried having a list inside <code>removeDangerousAnimal</code>, so that I could then do something like:</p>\n<pre class=\"lang-java prettyprint-override\"><code>static List&lt;Animal&gt; removeDangerousAnimal(List&lt;Animal&gt; listOfAnimals) {\n        List&lt;Animal&gt; newList = new Arraylist&lt;&gt;();\n \n        BiConsumer&lt;Boolean, Integer&gt; removeDangerous = (isDangerous, index) -&gt; {\n            if(isDangerous == true){\n                System.out.println(&quot;Dangerous animal: &quot; + listOfAnimals.get(index).getName());\n                listOfAnimals.remove(index);\n                newList = listOfAnimals;\n            }\n        };\n</code></pre>\n<p>But I have learned that with lambdas local variables are immutable (Error: &quot;Variable used in lambda expression should be final or effectively final&quot;).</p>\n<p>Question: I do not understand why <code>BiConsumer</code> is not updating my list.</p>\n<p>Main:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class Main {\n    public static void main(String[] args) {\n        List&lt;Animal&gt; animals = new ArrayList&lt;&gt;();\n\n        Dog dog = new Dog(&quot;Tom&quot;, &quot;He's a good boy&quot;, &quot;Chihuahua&quot;, 10, 0.30, false, &quot;Dry food&quot;, 0.20);\n        Cat cat = new Cat(&quot;Misty&quot;, &quot;She has a temper!&quot;, &quot;Tigress&quot;, 6, 0.40, true, &quot;Soggy food&quot;, 0.5);\n        Bird bird = new Bird(&quot;Twitty&quot;, &quot;He's very cute!&quot;, &quot;Parrot&quot;, 1.5, 0.15, false, &quot;Dry food&quot;, 0.10);\n\n        animals.add(dog);\n        animals.add(cat);\n        animals.add(bird);\n\n        animals = removeDangerousAnimal(animals);\n\n        for (Animal a: animals) {\n            System.out.println(&quot;Animal name: &quot; + a.getName());\n        }\n    }\n\n    static List&lt;Animal&gt; removeDangerousAnimal(List&lt;Animal&gt; listOfAnimals){\n\n        BiConsumer&lt;Boolean, Integer&gt; removeDangerous = (isDangerous, index) -&gt; {\n            if(isDangerous == true){\n                System.out.println(&quot;Dangerous animal: &quot; + listOfAnimals.get(index).getName());\n                listOfAnimals.remove(index);\n            }\n        };\n\n        for (int i = 0; i &lt; listOfAnimals.size(); i++) {\n            //System.out.println(&quot;Animal name: &quot; + a.getName() + &quot; &quot; + a.isDanger());\n            removeDangerous.accept(listOfAnimals.get(i).isDanger(), i);\n        }\n\n        return listOfAnimals;\n    }\n}\n</code></pre>\n<p>Animal:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class Animal {\n\n    private String name;\n    private String description;\n    private String race;\n    private double weight;\n    private double height;\n    private boolean danger;\n    private String food;\n    private double foodQuantity;\n\n    //---------------------------\n\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public String getDescription() {\n        return description;\n    }\n\n    public void setDescription(String description) {\n        this.description = description;\n    }\n\n    public String getRace() {\n        return race;\n    }\n\n    public void setRace(String race) {\n        this.race = race;\n    }\n\n    public double getWeight() {\n        return weight;\n    }\n\n    public void setWeight(double weight) {\n        this.weight = weight;\n    }\n\n    public double getHeight() {\n        return height;\n    }\n\n    public void setHeight(double height) {\n        this.height = height;\n    }\n\n    public boolean isDanger() {\n        return danger;\n    }\n\n    public void setDanger(boolean danger) {\n        this.danger = danger;\n    }\n\n    public String getFood() {\n        return food;\n    }\n\n    public void setFood(String food) {\n        this.food = food;\n    }\n\n    public double getFoodQuantity() {\n        return foodQuantity;\n    }\n\n    public void setFoodQuantity(double foodQuantity) {\n        this.foodQuantity = foodQuantity;\n    }\n}\n</code></pre>\n<p>Dog:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class Dog extends Animal {\n    private String name;\n    private String description;\n    private String race;\n    private double weight;\n    private double height;\n    private boolean danger;\n    private String food;\n    private double foodQuantity;\n\n    //---------------------------\n\n    public Dog(String name, String description, String race, double weight, double height, boolean danger, String food, double foodQuantity) {\n        this.name = name;\n        this.description = description;\n        this.race = race;\n        this.weight = weight;\n        this.height = height;\n        this.danger = danger;\n        this.food = food;\n        this.foodQuantity = foodQuantity;\n    }\n\n    public Dog() {\n\n    }\n    //---------------------------\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public String getDescription() {\n        return description;\n    }\n\n    public void setDescription(String description) {\n        this.description = description;\n    }\n\n    public String getRace() {\n        return race;\n    }\n\n    public void setRace(String race) {\n        this.race = race;\n    }\n\n    public double getWeight() {\n        return weight;\n    }\n\n    public void setWeight(double weight) {\n        this.weight = weight;\n    }\n\n    public double getHeight() {\n        return height;\n    }\n\n    public void setHeight(double height) {\n        this.height = height;\n    }\n\n    public boolean isDanger() {\n        return danger;\n    }\n\n    public void setDanger(boolean danger) {\n        this.danger = danger;\n    }\n\n    public String getFood() {\n        return food;\n    }\n\n    public void setFood(String food) {\n        this.food = food;\n    }\n\n    public double getFoodQuantity() {\n        return foodQuantity;\n    }\n\n    public void setFoodQuantity(double foodQuantity) {\n        this.foodQuantity = foodQuantity;\n    }\n}\n</code></pre>\n<p>Cat:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class Cat extends Animal {\n\n    private String name;\n    private String description;\n    private String race;\n    private double weight;\n    private double height;\n    private boolean danger;\n    private String food;\n    private double foodQuantity;\n\n    //---------------------------\n\n    public Cat(String name, String description, String race, double weight, double height, boolean danger, String food, double foodQuantity) {\n        this.name = name;\n        this.description = description;\n        this.race = race;\n        this.weight = weight;\n        this.height = height;\n        this.danger = danger;\n        this.food = food;\n        this.foodQuantity = foodQuantity;\n    }\n\n    public Cat() {\n\n    }\n\n    //---------------------------\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public String getDescription() {\n        return description;\n    }\n\n    public void setDescription(String description) {\n        this.description = description;\n    }\n\n    public String getRace() {\n        return race;\n    }\n\n    public void setRace(String race) {\n        this.race = race;\n    }\n\n    public double getWeight() {\n        return weight;\n    }\n\n    public void setWeight(double weight) {\n        this.weight = weight;\n    }\n\n    public double getHeight() {\n        return height;\n    }\n\n    public void setHeight(double height) {\n        this.height = height;\n    }\n\n    public boolean isDanger() {\n        return danger;\n    }\n\n    public void setDanger(boolean danger) {\n        this.danger = danger;\n    }\n\n    public String getFood() {\n        return food;\n    }\n\n    public void setFood(String food) {\n        this.food = food;\n    }\n\n    public double getFoodQuantity() {\n        return foodQuantity;\n    }\n\n    public void setFoodQuantity(double foodQuantity) {\n        this.foodQuantity = foodQuantity;\n    }\n}\n</code></pre>\n<p>Bird:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class Bird extends Animal {\n\n    private String name;\n    private String description;\n    private String race;\n    private double weight;\n    private double height;\n    private boolean danger;\n    private String food;\n    private double foodQuantity;\n\n    //---------------------------\n\n    public Bird(String name, String description, String race, double weight, double height, boolean danger, String food, double foodQuantity) {\n        this.name = name;\n        this.description = description;\n        this.race = race;\n        this.weight = weight;\n        this.height = height;\n        this.danger = danger;\n        this.food = food;\n        this.foodQuantity = foodQuantity;\n    }\n\n    public Bird() {\n\n    }\n\n    //---------------------------\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public String getDescription() {\n        return description;\n    }\n\n    public void setDescription(String description) {\n        this.description = description;\n    }\n\n    public String getRace() {\n        return race;\n    }\n\n    public void setRace(String race) {\n        this.race = race;\n    }\n\n    public double getWeight() {\n        return weight;\n    }\n\n    public void setWeight(double weight) {\n        this.weight = weight;\n    }\n\n    public double getHeight() {\n        return height;\n    }\n\n    public void setHeight(double height) {\n        this.height = height;\n    }\n\n    public boolean isDanger() {\n        return danger;\n    }\n\n    public void setDanger(boolean danger) {\n        this.danger = danger;\n    }\n\n    public String getFood() {\n        return food;\n    }\n\n    public void setFood(String food) {\n        this.food = food;\n    }\n\n    public double getFoodQuantity() {\n        return foodQuantity;\n    }\n\n    public void setFoodQuantity(double foodQuantity) {\n        this.foodQuantity = foodQuantity;\n    }\n}\n</code></pre>\n"},{"tags":["java","gradle","cxf","java-11"],"answers":[{"owner":{"user_id":20142156,"display_name":"Dhaval Gajjar"},"up_vote_count":3,"is_accepted":true,"creation_date":1678548260,"answer_id":75705929,"body":"<p>The issue is that while generating java from wsdl you are adding all libraries to classpath <code>classpath configurations.wsdl2java</code>. But while compiling those libraries are not in the classpath so you get those errors.</p>\n<p>You need to adjust <code>dependencies</code> section as follow.</p>\n<pre><code>dependencies {\n    implementation 'jakarta.xml.bind:jakarta.xml.bind-api:4.0.0'\n    implementation 'jakarta.xml.ws:jakarta.xml.ws-api:4.0.0'\n    wsdl2java 'com.sun.xml.bind:jaxb-ri:4.0.2'\n    wsdl2java 'com.sun.xml.bind:jaxb-xjc:4.0.2'\n    wsdl2java 'com.sun.xml.bind:jaxb-core:4.0.2'\n    wsdl2java 'com.sun.xml.bind:jaxb-impl:4.0.2'\n    wsdl2java 'org.apache.cxf:cxf-tools-wsdlto-core:4.0.0'\n    wsdl2java 'org.apache.cxf:cxf-tools-wsdlto-frontend-jaxws:4.0.0'\n    wsdl2java 'org.apache.cxf:cxf-tools-wsdlto-databinding-jaxb:4.0.0'\n}\n</code></pre>\n<p>As <code>jakarta.xml.bind-api</code> and <code>jakarta.xml.ws-api</code> libraries don't need while generating java classes. But those are required while compiling. So added those 2 as implementation dependencies which adds to Java compile and runtime classpaths.</p>\n"}],"owner":{"user_id":1424124,"display_name":"Mark"},"view_count":174,"up_vote_count":2,"accepted_answer_id":75705929,"answer_count":1,"score":2,"creation_date":1678530410,"question_id":75704260,"body":"<p>Jakarta packages are not found when the generated Java is compiled.\nJakarta dependencies are referenced in build.gradle for the module:</p>\n<pre><code>plugins {\n    id 'java-library'\n}\nconfigurations {\n    wsdl2java\n}\n\ndependencies {\n    wsdl2java 'jakarta.xml.bind:jakarta.xml.bind-api:4.0.0'\n    wsdl2java 'com.sun.xml.bind:jaxb-ri:4.0.2'\n    wsdl2java 'com.sun.xml.bind:jaxb-xjc:4.0.2'\n    wsdl2java 'com.sun.xml.bind:jaxb-core:4.0.2'\n    wsdl2java 'com.sun.xml.bind:jaxb-impl:4.0.2'\n    wsdl2java 'org.apache.cxf:cxf-tools-wsdlto-core:4.0.0'\n    wsdl2java 'org.apache.cxf:cxf-tools-wsdlto-frontend-jaxws:4.0.0'\n    wsdl2java 'org.apache.cxf:cxf-tools-wsdlto-databinding-jaxb:4.0.0'\n}\n</code></pre>\n<p>Gradle to generate the code includes</p>\n<pre><code>classpath configurations.wsdl2java\n</code></pre>\n<p>Resulting example code includes imports that do not resolve</p>\n<pre><code>import jakarta.xml.bind.annotation.XmlAccessType;\nimport jakarta.xml.bind.annotation.XmlAccessorType;\nimport jakarta.xml.bind.annotation.XmlElement;\nimport jakarta.xml.bind.annotation.XmlType;\n</code></pre>\n<p>When the task attempts to compile, error is:</p>\n<pre><code>error: package jakarta.xml.bind.annotation does not exist\nimport jakarta.xml.bind.annotation.XmlAccessType;\n</code></pre>\n<p>Yet, all these are supposed to be included in</p>\n<pre><code>jakarta.xml.bind:jakarta.xml.bind-api:4.0.0\n</code></pre>\n<p>Full build.gradle file is:</p>\n<pre><code>plugins {\n    id 'java-library'\n}\nconfigurations {\n    wsdl2java\n}\n\ndependencies {\n    wsdl2java 'jakarta.xml.bind:jakarta.xml.bind-api:4.0.0'\n    wsdl2java 'com.sun.xml.bind:jaxb-ri:4.0.2'\n    wsdl2java 'com.sun.xml.bind:jaxb-xjc:4.0.2'\n    wsdl2java 'com.sun.xml.bind:jaxb-core:4.0.2'\n    wsdl2java 'com.sun.xml.bind:jaxb-impl:4.0.2'\n    wsdl2java 'org.apache.cxf:cxf-tools-wsdlto-core:4.0.0'\n    wsdl2java 'org.apache.cxf:cxf-tools-wsdlto-frontend-jaxws:4.0.0'\n    wsdl2java 'org.apache.cxf:cxf-tools-wsdlto-databinding-jaxb:4.0.0'\n}\n\ndef allmyWsdl = task allmyWsdl {\n    String[] wsdls = [&quot;one&quot;, &quot;two&quot;, &quot;three&quot;];\n\n    wsdls.each {name-&gt;\n        def thing = task &quot;myWsdl${name}&quot; (type: JavaExec) {\n            // Defining these mean the task can run incrementally\n            inputs.files(&quot;${projectDir}/src/main/resources&quot;)\n            outputs.dir(&quot;${projectDir}/out/generated-sources/cxf-ws&quot;)\n\n            String wsdl = &quot;${projectDir}/src/main/resources/wsdls/${name}.wsdl&quot;\n            String genSrcDir = &quot;${projectDir}/out/generated-sources/cxf-ws&quot;\n\n            inputs.file wsdl\n            outputs.dir genSrcDir\n\n            classpath configurations.wsdl2java\n            main &quot;org.apache.cxf.tools.wsdlto.WSDLToJava&quot;\n\n            args '-client', '-impl', '-exsh', 'true', '-noAddressBinding', '-autoNameResolution', &quot;-wsdlLocation&quot;, &quot;classpath:wsdls/${name}.wsdl&quot;, '-p', &quot;com.my.webservices.${name}&quot;, '-encoding', 'UTF-8', '-d', genSrcDir, wsdl\n\n            final OutputStream baos = new ByteArrayOutputStream()\n            errorOutput = new OutputStream() {\n                void write(int b) {System.err.write(b); baos.write(b) }\n                void flush() { System.err.flush(); baos.flush() }\n                void close() { System.err.close(); baos.close() }\n            }\n\n            doLast {\n                def str = baos.toString()\n                if (str.contains('Usage : wsdl2java') || str.contains('WSDLToJava Error')) {\n                    throw new TaskExecutionException(tasks[name],\n                            new IOException('Apache CXF WSDLToJava has failed. Please see System.err output.'))\n                }\n            }\n        }\n    }\n}\n\nallmyWsdl.dependsOn(tasks.matching { task -&gt; task.name.startsWith( 'myWsdl' ) } )\ncompileJava.dependsOn += allmyWsdl\nsourceSets.main.java.srcDirs += 'out/generated-sources/cxf-ws'\n</code></pre>\n"},{"tags":["java","java-14"],"comments":[{"owner":{"user_id":139985,"display_name":"Stephen C"},"edited":false,"comment_id":133511999,"body":"Java 14 is end-of-life.  You shouldn&#39;t be using it to learn about new Java language constructs.  Use Java 17.  (Or later if you are trying to learn about post Java 17 features ...)   I don&#39;t know if it will make a difference here ... but this could be a Java compiler or JLS bug that has been fixed by Java 17."},{"owner":{"user_id":5684257,"display_name":"HTNW"},"edited":false,"comment_id":133512024,"body":"@StephenC This has not changed since Java 14."},{"owner":{"user_id":139985,"display_name":"Stephen C"},"edited":false,"comment_id":133512030,"body":"Even so, using an EOL&#39;d Java version to learn Java is ... asking for trouble."},{"owner":{"user_id":12348584,"display_name":"H3AR7B3A7"},"edited":false,"comment_id":133512060,"body":"Does this answer your question? <a href=\"https://stackoverflow.com/questions/7331686/why-and-not\">Why &#39;&amp;&amp;&#39; and not &#39;&amp;&#39;?</a>"},{"owner":{"user_id":2668926,"display_name":"davidandcode"},"edited":false,"comment_id":133512327,"body":"my bad what i meant was really java 17"}],"answers":[{"owner":{"user_id":768644,"display_name":"rzwitserloot"},"up_vote_count":3,"is_accepted":false,"creation_date":1678322108,"answer_id":75679436,"body":"<p>Indeed, 'right side will not necessarily be evaluated' is just completely wrong.</p>\n<p><code>&amp;&amp;</code> is legal because <strong>within the if statement</strong>, you have an absolute guarantee that <code>myObj instanceof Integer iObj</code> will have been evaluated, <em>and</em> evaluated to true (thus establishing <code>iObj</code> in the scope of the code inside the if block). Given <code>a &amp;&amp; b</code>, b is not neccessarily evaluated, but if code flows into that <code>if</code>, b definitely has been, which is why your first snippet compiles.</p>\n<p><code>&amp;</code> is presumably not legal here because the spec didn't bother. There is no explanation that involves a scenario where <code>myObj instanceof Integer iObj</code> either didn't get evaluated, or evaluated to <code>false</code> somehow. Inside the if block, it <em>will have been evaluated, and will have evaluated to <code>true</code></em>. But, the point is, the compiler has to figure out that based on static code analysis and <em>that part</em> is where the spec doesn't bother listing out explicitly that <code>boolean &amp; boolean</code> establishes definite evaluation (and definitely true evaluation).</p>\n"}],"owner":{"user_id":2668926,"display_name":"davidandcode"},"view_count":111,"up_vote_count":4,"answer_count":1,"score":2,"creation_date":1678319306,"question_id":75679239,"body":"<p>I am using the example from Java the complete reference by Herbert Schildt, 12th ed and Java is 14</p>\n<p>Where he gives the 2 following examples (if blocks), the first one is ok and the 2nd one is wrong therefore commented</p>\n<pre><code>public class PatternMatch {\n    public static void main(String[] args){\n        Number myOb = Integer.valueOf(9);\n        int count = 10;\n        if((count &lt; 100) &amp;&amp; myOb instanceof Integer iObj) { // is OK!!!\n            iObj = count;\n        }\n\n        /*\n        if((count &lt; 100) &amp; myOb instanceof Integer iObj) { // Error!!!\n            iObj = count;\n        }\n        */\n    }\n}\n</code></pre>\n<p>His explanation on why the 2nd if block (commented out) is &quot;In this case, the compiler cannot know whether or not iObj will be in scope in the if block because the right side of the &amp; will not necessarily be evaluated&quot;. This leads to my confusion: &amp; makes sure both its left and right sides are ALWAYS evaluated so why &quot;because the right side of the &amp; will not necessarily be evaluated&quot;?</p>\n<p>Thanks!</p>\n<p>if you put the java14 code in your IDE, you do see the 2nd if block produces the compilation error saying iObj not defined... but I just don't understand his explanation:</p>\n<p>His explanation on why the 2nd if block is &quot;In this case, the compiler cannot know whether or not iObj will be in scope in the if block because the right side of the &amp; will not necessarily be evaluated&quot;. This leads to my confusion: &amp; makes sure both its left and right sides are ALWAYS evaluated so why &quot;because the right side of the &amp; will not necessarily be evaluated&quot;?</p>\n<pre><code>public class PatternMatch {\n    public static void main(String[] args){\n        Number myOb = Integer.valueOf(9);\n        int count = 10;\n        if((count &lt; 100) &amp;&amp; myOb instanceof Integer iObj) { // is OK!!!\n            iObj = count;\n        }\n\n    \n        if((count &lt; 100) &amp; myOb instanceof Integer iObj) { // Error!!!\n            iObj = count;\n        }\n   \n    }\n}\n</code></pre>\n"},{"tags":["java","spring-webflux","project-reactor"],"answers":[{"owner":{"user_id":14183092,"display_name":"kerbermeister"},"up_vote_count":2,"is_accepted":false,"creation_date":1678220107,"answer_id":75666766,"body":"<p>I think you're confused because of the word &quot;parallel&quot; when you use <code>Scheduler.parallel()</code> or <code>Scheduler.newParallel()</code></p>\n<p><strong>&quot;parallel&quot; in this case does not mean it magically makes your processing parallel by default.</strong></p>\n<p>It means that scheduler has fixed thread pool that is meant to perform some CPU-bound operations and <strong>is suited for parallel work.</strong></p>\n<p>It is recommended to use this scheduler for performing CPU-bound operations.</p>\n<p>About <code>Flux.range()</code> : this method is meant to emit a sequence of count incrementing integers, starting from start. It is a sequential operation in your first case, it emits the numbers on a thread from which you subscribed to your flux. There is no any parallel work unless you use <code>parallel()</code> with <code>runOn()</code></p>\n"},{"owner":{"user_id":1840146,"display_name":"Toerktumlare"},"up_vote_count":1,"is_accepted":false,"creation_date":1678234068,"answer_id":75668337,"body":"<p>the behaviour you are seeing is pointed out in the <a href=\"https://projectreactor.io/docs/core/release/reference/#advanced-parallelizing-parralelflux\" rel=\"nofollow noreferrer\">reactor documentation</a> which states:</p>\n<blockquote>\n<p>To obtain a ParallelFlux, you can use the parallel() operator on any Flux. By itself, this method does not parallelize the work. Rather, it divides the workload into “rails” (by default, as many rails as there are CPU cores).</p>\n<p>In order to tell the resulting ParallelFlux where to run each rail (and, by extension, to run rails in parallel) you have to use runOn(Scheduler). Note that there is a recommended dedicated Scheduler for parallel work: Schedulers.parallel().</p>\n</blockquote>\n<p>So you need <code>rails</code> to be able to split up work. And to assign split up work on different cores you need a <code>parallel scheduler</code>.</p>\n<p>Which means your first example has threads on multiple cores because of the scheduler. But the <code>Flux</code> itself has not the ability to split up the work and assign it to different cores.</p>\n<p>So basically your first example is allocating threads on multiple cores that aren't used.</p>\n<p>Remember, I/O work as logging, making requests, reading/writing files, usually don't benefit from parallel work. You are basically putting out work on multiple cores that still have to wait for other things like file handles getting freed, other services responding etc. etc.</p>\n<p>So you are basically allocating a lot of resources for very little gain.</p>\n<p>I/O work is more orchestration than raw computing power, and parallel work mostly shines if you need to do heavy cpu bound calculations.</p>\n<p>So not logging.</p>\n"}],"owner":{"user_id":1970670,"display_name":"Piotr Cierpich"},"view_count":140,"up_vote_count":2,"answer_count":2,"score":2,"creation_date":1678211477,"question_id":75665561,"body":"<p>There are many questions on subscribeOn and in theory it is simple: it makes the subscriber process run with specific Scheduler. However when I run this:</p>\n<pre><code>    @Test\nvoid fluxWithSubscribeOnTest() {\n    final Scheduler s = Schedulers.newParallel(&quot;parallel&quot;, 10);\n    final Publisher&lt;Integer&gt; integerFlux =\n            Flux\n                    .range(1, 1000)\n                    .doOnNext(integer -&gt; log.info(&quot;executed&quot;))\n                    .subscribeOn(s);\n    StepVerifier.create(integerFlux)\n            .expectNextCount(1000)\n            .verifyComplete();\n}\n</code></pre>\n<p>I see all 1000 logs are written in the same parallel-1 thread</p>\n<pre><code>18:39:47.612 [parallel-1] INFO com.performance.TestClass - executed\n18:39:47.613 [parallel-1] INFO com.performance.TestClass - executed\n18:39:47.613 [parallel-1] INFO com.performance.TestClass - executed\n18:39:47.613 [parallel-1] INFO com.performance.TestClass - executed\n18:39:47.613 [parallel-1] INFO com.performance.TestClass - executed\n18:39:47.613 [parallel-1] INFO com.performance.TestClass - executed\n18:39:47.613 [parallel-1] INFO com.performance.TestClass - executed\n18:39:47.613 [parallel-1] INFO com.performance.TestClass - executed\n</code></pre>\n<p>I'd expect the above code to log (so perform onNext) in multiple threads from the pool provided with the subscribeOn. ParallelFlux work that way and, as expected, it logs in different threads:</p>\n<pre><code>    @Test\nvoid parallelFluxTest() {\n    final Scheduler s = Schedulers.newParallel(&quot;parallel&quot;, 10);\n    final Publisher&lt;Integer&gt; integerFlux =\n            Flux\n                    .range(1, 1000)\n                    .parallel(10)\n                    .runOn(s)\n                    .doOnNext(integer -&gt; log.info(&quot;executed&quot;));\n    StepVerifier.create(integerFlux)\n            .expectNextCount(1000)\n            .verifyComplete();\n}\n\n18:43:42.377 [parallel-1] INFO com.performance.TestClass - executed\n18:43:42.377 [parallel-2] INFO com.performance.TestClass - executed\n18:43:42.377 [parallel-3] INFO com.performance.TestClass - executed\n18:43:42.377 [parallel-4] INFO com.performance.TestClass - executed\n18:43:42.378 [parallel-5] INFO com.performance.TestClass - executed\n</code></pre>\n<p>Can someone explain why the subscribeOn example logs with only one thread while the pool size is 10?</p>\n"},{"tags":["java","opencv"],"answers":[{"owner":{"user_id":4926757,"display_name":"Rotem"},"up_vote_count":3,"is_accepted":true,"creation_date":1678140209,"answer_id":75656246,"body":"<p>The reason that the whole image is detected as one contour is that <code>findContours</code> finds white contours (not black contours), and the entire image after threshold is a large white contour.</p>\n<p>Use <code>Imgproc.THRESH_BINARY_INV</code> for inverting black and white:</p>\n<pre><code>Imgproc.threshold(grayImage, thresholdImage, 242, 255, Imgproc.THRESH_BINARY_INV);\n</code></pre>\n<hr />\n<p>Other issues:</p>\n<ul>\n<li><p>We may ignore small contours - considered to be noise:</p>\n<pre><code> double contour_area = Imgproc.contourArea(contour);\n if (contour_area &lt; min_contour_area) {\n     continue;\n }\n</code></pre>\n</li>\n<li><p>Add white padding before <code>warpAffine</code> - required because <code>warpAffine</code> may add black margins (think of 45 degrees rotation for example):</p>\n<pre><code> Mat rect = new Mat(image, boundingRect);\n rect = rect.clone(); //Create a clone of the cropped rectangle (required because copyMakeBorder refers to the large image).\n Mat rectWithBorder = new Mat();\n Core.copyMakeBorder(rect, rectWithBorder, emptySpace*2, emptySpace*2, emptySpace*2, emptySpace*2, Core.BORDER_CONSTANT, new Scalar(255, 255, 255));\n</code></pre>\n</li>\n<li><p>Rotate around the center of the cropped rectangle (not around <code>rotatedRect.center</code>):</p>\n<pre><code> Point rect_center = new Point((rectWithBorder.cols()-1.0)/2, (rectWithBorder.rows()-1.0)/2);\n Mat rotationMatrix = Imgproc.getRotationMatrix2D(rect_center, angle, 1.0);  \n Mat rotatedRectMat = new Mat();\n Imgproc.warpAffine(rectWithBorder, rotatedRectMat, rotationMatrix, rectWithBorder.size());\n</code></pre>\n</li>\n<li><p>Remove the extra margins after <code>warpAffine</code>:</p>\n<pre><code> Rect boundingRect2 = new Rect(emptySpace, emptySpace, rotatedRectMat.cols()-emptySpace*2, rotatedRectMat.rows()-emptySpace*2);\n Mat rectWithBorder2 = new Mat(rotatedRectMat, boundingRect2);\n</code></pre>\n</li>\n</ul>\n<hr />\n<p>Code sample:</p>\n<pre><code>package myproject;\n\nimport org.opencv.core.Core;\nimport org.opencv.core.Mat;\nimport org.opencv.core.Scalar;\nimport org.opencv.core.Rect;\nimport org.opencv.core.Point;\nimport org.opencv.core.MatOfPoint;\nimport org.opencv.core.MatOfPoint2f;\nimport org.opencv.core.RotatedRect;\nimport org.opencv.imgproc.Imgproc;\nimport org.opencv.imgcodecs.Imgcodecs;\nimport java.util.List;\nimport java.util.ArrayList;\n\nclass Sample {\n    \n\nstatic { System.loadLibrary(Core.NATIVE_LIBRARY_NAME); }\n\n\n  \npublic static void main(String[] args) {\n    // Load the image file\n    // temp\n    //File file = ResourceUtils.getFile(&quot;classpath:input_image.png&quot;);\n    final String image_file_name = &quot;input_image.png&quot;;\n    \n    // temp change to inputstream\n    Mat image = Imgcodecs.imread(image_file_name);\n\n    // Convert the image to grayscale\n    Mat grayImage = new Mat();\n    Imgproc.cvtColor(image, grayImage, Imgproc.COLOR_BGR2GRAY);\n\n    // Apply a threshold to convert the image to black and white\n    Mat thresholdImage = new Mat();\n    //Imgproc.threshold(grayImage, thresholdImage, 242, 255, Imgproc.THRESH_BINARY);\n    Imgproc.threshold(grayImage, thresholdImage, 242, 255, Imgproc.THRESH_BINARY_INV);\n    Imgcodecs.imwrite(&quot;thresh.png&quot;, thresholdImage);\n\n    // Find contours in the thresholded image\n    List&lt;MatOfPoint&gt; contours = new ArrayList&lt;&gt;();\n    Mat hierarchy = new Mat();\n    Imgproc.findContours(thresholdImage, contours, hierarchy, Imgproc.RETR_EXTERNAL, Imgproc.CHAIN_APPROX_SIMPLE);\n\n    // Set the amount of empty space to add around the cropped image\n    int emptySpace = 20;\n    \n    double min_contour_area = 10000.0;  //Area threshold - ignore small contours with area less than 10000 (assume noise)\n\n    // Loop over the contours\n    for (int i = 0; i &lt; contours.size(); i++) {\n        MatOfPoint contour = contours.get(i);\n        \n        double contour_area = Imgproc.contourArea(contour);\n        \n        if (contour_area &lt; min_contour_area) {\n            continue;   //Ignore small contours with area less than min_contour_area (assume noise)\n        }\n\n        // Find the bounding box of the contour\n        Rect boundingRect = Imgproc.boundingRect(contour);\n\n        // Crop the rectangle from the original image using the bounding box coordinates\n        Mat rect = new Mat(image, boundingRect);\n        rect = rect.clone(); //Create a clone of the cropped rectangle (required because copyMakeBorder refers to the large image). \n        \n        //Imgcodecs.imwrite(&quot;rect.png&quot;, rect); //Save rect for testing\n\n        // Straighten the rectangle\n        RotatedRect rotatedRect = Imgproc.minAreaRect(new MatOfPoint2f(contour.toArray()));\n        double angle = rotatedRect.angle;\n        if (rotatedRect.size.width &gt; rotatedRect.size.height) {\n            angle += 90;\n        }\n               \n        // Add empty space around the rect - add larger padding before rotation because warpAffine may add black margins\n        Mat rectWithBorder = new Mat();\n        Core.copyMakeBorder(rect, rectWithBorder, emptySpace*2, emptySpace*2, emptySpace*2, emptySpace*2, Core.BORDER_CONSTANT, new Scalar(255, 255, 255));\n        \n        //Imgcodecs.imwrite(&quot;rectWithBorder.png&quot;, rectWithBorder); //Save rectWithBorder for testing\n        \n        //Mat rotationMatrix = Imgproc.getRotationMatrix2D(rotatedRect.center, angle, 1.0);  \n        Point rect_center = new Point((rectWithBorder.cols()-1.0)/2, (rectWithBorder.rows()-1.0)/2);\n        Mat rotationMatrix = Imgproc.getRotationMatrix2D(rect_center, angle, 1.0);  //Rotate around the center of rect.\n        Mat rotatedRectMat = new Mat();\n        Imgproc.warpAffine(rectWithBorder, rotatedRectMat, rotationMatrix, rectWithBorder.size());\n        \n        //Imgcodecs.imwrite(&quot;rotatedRectMat.png&quot;, rotatedRectMat); //Save rotatedRectMat for testing\n        \n        //Crop the center of rotatedRectMat (remove the extra emptySpace padding from each side).\n        Rect boundingRect2 = new Rect(emptySpace, emptySpace, rotatedRectMat.cols()-emptySpace*2, rotatedRectMat.rows()-emptySpace*2);\n        Mat rectWithBorder2 = new Mat(rotatedRectMat, boundingRect2);\n\n\n        // Save the rectangle with border as a separate image file\n        Imgcodecs.imwrite(String.format(&quot;output_image_%d.png&quot;, i), rectWithBorder2);\n    }\n}\n\n}\n</code></pre>\n<hr />\n<p>Result:<br />\n<a href=\"https://i.stack.imgur.com/PYKul.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PYKul.png\" alt=\"enter image description here\" /></a>  <a href=\"https://i.stack.imgur.com/ha8AQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ha8AQ.png\" alt=\"enter image description here\" /></a>  <a href=\"https://i.stack.imgur.com/zrxFh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zrxFh.png\" alt=\"enter image description here\" /></a></p>\n<p><a href=\"https://i.stack.imgur.com/metmS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/metmS.png\" alt=\"enter image description here\" /></a>  <a href=\"https://i.stack.imgur.com/rpb4u.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rpb4u.png\" alt=\"enter image description here\" /></a>  <a href=\"https://i.stack.imgur.com/db4Ug.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/db4Ug.png\" alt=\"enter image description here\" /></a></p>\n<p><a href=\"https://i.stack.imgur.com/xDKhJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xDKhJ.png\" alt=\"enter image description here\" /></a>  <a href=\"https://i.stack.imgur.com/LmC4x.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LmC4x.png\" alt=\"enter image description here\" /></a>  <a href=\"https://i.stack.imgur.com/boXzQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/boXzQ.png\" alt=\"enter image description here\" /></a></p>\n"}],"owner":{"user_id":10803013,"display_name":"andresmonc"},"view_count":44,"up_vote_count":2,"accepted_answer_id":75656246,"answer_count":1,"score":2,"creation_date":1678117100,"question_id":75652836,"body":"<p>I'm trying to use opencv to detect contours of cards scanned against a white background. However, I'm running into an issue where it seems to just be detecting the whole image as 1 contour. I'm completely stumped on what I can tweak at this point. I've tried ImgProc.RETR_LIST but that returns 42k contours.</p>\n<p><strong>Code:</strong></p>\n<pre><code>    public void convert() throws FileNotFoundException {\n        // Load the image file\n        // temp\n        File file = ResourceUtils.getFile(&quot;classpath:input_image.png&quot;);\n        // temp change to inputstream\n        Mat image = Imgcodecs.imread(file.getAbsolutePath());\n\n        // Convert the image to grayscale\n        Mat grayImage = new Mat();\n        Imgproc.cvtColor(image, grayImage, Imgproc.COLOR_BGR2GRAY);\n\n        // Apply a threshold to convert the image to black and white\n        Mat thresholdImage = new Mat();\n        Imgproc.threshold(grayImage, thresholdImage, 242, 255, Imgproc.THRESH_BINARY);\n        Imgcodecs.imwrite(&quot;thresh.png&quot;, thresholdImage);\n\n        // Find contours in the thresholded image\n        List&lt;MatOfPoint&gt; contours = new ArrayList&lt;&gt;();\n        Mat hierarchy = new Mat();\n        Imgproc.findContours(thresholdImage, contours, hierarchy, Imgproc.RETR_EXTERNAL, Imgproc.CHAIN_APPROX_SIMPLE);\n\n        // Set the amount of empty space to add around the cropped image\n        int emptySpace = 20;\n\n        // Loop over the contours\n        for (int i = 0; i &lt; contours.size(); i++) {\n            MatOfPoint contour = contours.get(i);\n\n            // Find the bounding box of the contour\n            Rect boundingRect = Imgproc.boundingRect(contour);\n\n            // Crop the rectangle from the original image using the bounding box coordinates\n            Mat rect = new Mat(image, boundingRect);\n\n            // Straighten the rectangle\n            RotatedRect rotatedRect = Imgproc.minAreaRect(new MatOfPoint2f(contour.toArray()));\n            double angle = rotatedRect.angle;\n            if (rotatedRect.size.width &gt; rotatedRect.size.height) {\n                angle += 90;\n            }\n            Mat rotationMatrix = Imgproc.getRotationMatrix2D(rotatedRect.center, angle, 1.0);\n            Mat rotatedRectMat = new Mat();\n            Imgproc.warpAffine(rect, rotatedRectMat, rotationMatrix, rect.size());\n\n            // Add empty space around the cropped image\n            Mat rectWithBorder = new Mat();\n            Core.copyMakeBorder(rotatedRectMat, rectWithBorder, emptySpace, emptySpace, emptySpace, emptySpace, Core.BORDER_CONSTANT, new Scalar(255, 255, 255));\n\n            // Save the rectangle with border as a separate image file\n            Imgcodecs.imwrite(String.format(&quot;output_image_%d.png&quot;, i), rectWithBorder);\n\n        }\n    }\n</code></pre>\n<p><strong>Input Image</strong>:</p>\n<p><a href=\"https://i.stack.imgur.com/ysWlH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ysWlH.png\" alt=\"enter image description here\" /></a></p>\n<p><strong>Generated Threshold:</strong></p>\n<p><a href=\"https://i.stack.imgur.com/JNciq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JNciq.png\" alt=\"enter image description here\" /></a></p>\n<p><strong>Output Image:</strong></p>\n<p><a href=\"https://i.stack.imgur.com/FQZXN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FQZXN.png\" alt=\"enter image description here\" /></a></p>\n"},{"tags":["java","spring","multithreading","spring-boot"],"comments":[{"owner":{"user_id":2696260,"display_name":"M. Deinum"},"edited":false,"comment_id":133463174,"body":"Each thread created will get a new number, it doesn&#39;t reuse threadnames. So it start with 2 threads, will grow, then shrink, create new threads but the counter will keep increasing. So the fact that you see <code>My-Thread-300</code> doesn&#39;t mean there are 300 threads. It means that there have been 300 threads created but there should not be more than 30 active. YOu should be able to see statistics. Also if you are using Spring Boot there is already a predefined taskexecutor for you so you don&#39;t need to create it."}],"answers":[{"owner":{"user_id":14183092,"display_name":"kerbermeister"},"up_vote_count":3,"is_accepted":false,"creation_date":1678107419,"answer_id":75651146,"body":"<p>Every time a thread is created it gets the incremeted number postfix.</p>\n<p>From docs of <code>allowCoreThreadTimeOut()</code> method:</p>\n<blockquote>\n<p>If false (default), core threads stay alive even when idle. If true,\ncore threads use keepAliveTime to time out waiting for work.</p>\n</blockquote>\n<p>The default timeout is configured with option <code>keepAliveSeconds</code> which is set in <code>ThreadPoolTaskExecutor</code> to 60 seconds by default.</p>\n<p>So, if you have <code>allowCoreThreadTimeOut()</code> enabled, then the threads will be terminated after timeout if they have no work within the thread keep alive time.</p>\n<p>After this if you submit a task to your executor, the new thread will be created with the increased thread number postfix.</p>\n<p>So, it does not mean at all that you have, for example, 300 threads within your executor if you can see the thread with <code>-300</code> postfix.</p>\n"}],"owner":{"user_id":3714465,"display_name":"Gnana"},"view_count":183,"up_vote_count":2,"answer_count":1,"score":2,"creation_date":1678104961,"question_id":75650729,"body":"<p>I am using spring-boot ThreadPoolTaskExecutor for thread management. I am calling my Welcome service class from WelcomeController class.Each request is creating new thread. like My Thread-1,My Thread-2,My Thread-3.......My Thread-300.\nAs per documentation , queue depth is Intger.MAX and CorePoolSize=2, all the request has to go to queue and only 2 thread should work. But I am seeing more threads.</p>\n<p>Why thread count is &gt; CorePoolSize ??</p>\n<p>How to fix this issue ? What mistake I am doing ??</p>\n<p><strong>spring-boot-starter-parent =  2.1.7.RELEASE</strong></p>\n<pre><code>@Bean(name = &quot;My Thread Pool&quot;)\n  public Executor myTaskExecutor() {\n    ThreadPoolTaskExecutor pool = new ThreadPoolTaskExecutor();\n    pool.setCorePoolSize(2);\n    pool.setMaxPoolSize(3);\n    pool.setKeepAliveSeconds(30);\n    pool.setAllowCoreThreadTimeOut(true);\n    pool.setWaitForTasksToCompleteOnShutdown(true);\n    pool.setThreadNamePrefix(&quot;My Thread-&quot;);\n    return pool;\n  }\n\n@Service\nclass Welcome {\n\n    @Async(&quot;My Thread Pool&quot;)\n    public void sayHello() {\n     System.out.println(&quot; Thread Name&quot;+Thread.currentThread().getName());\n\n    }\n\n}\n</code></pre>\n"},{"tags":["java","mysql","sql","jooq"],"answers":[{"owner":{"user_id":521799,"display_name":"Lukas Eder"},"up_vote_count":3,"is_accepted":true,"creation_date":1678089539,"answer_id":75648331,"body":"<h2>Why this works as &quot;expected&quot;:</h2>\n<p>That's a very interesting case, and looking only at the API usage, it at first seems like a bug where the rows from the second <code>UNION ALL</code> subquery should be mapped to <code>B</code>, but are instead mapped to <code>A</code>.</p>\n<p>But jOOQ cannot possibly discriminate between rows produced from the first subquery and the second one. Only the database server might know about the origin of each row. Think of how jOOQ works behind the scenes:</p>\n<ul>\n<li>The query is being generated the way you wrote it (<a href=\"https://www.jooq.org/doc/latest/manual/sql-execution/fetching/ad-hoc-converter/\" rel=\"nofollow noreferrer\">ad-hoc converters</a> don't play a role in this, being completely client side mapping implementations)</li>\n<li>The JDBC driver returns rows via <code>ResultSet</code></li>\n<li>jOOQ maps those rows to your custom data type <code>A</code>, which is the type of the query for all <code>UNION ALL</code> subqueries (just like the names of the columns are derived only from the first <code>UNION ALL</code> subquery)</li>\n</ul>\n<p>In your particular case, you tell the compiler to infer <code>List&lt;Something&gt;</code> as the result type via your explicit declaration. That's why you can still compile your <code>mapping(B::new)</code> from the second subquery, but what you're really getting is a <code>List&lt;A&gt;</code>, because jOOQ will only use the first <code>UNION ALL</code> subquery's row type for the actual results, given that it cannot discriminate between the two.</p>\n<p>Since this issue came up on the issue tracker a few times, there's now a section in the manual explaining this, as well as a blog post:</p>\n<ul>\n<li><a href=\"https://www.jooq.org/doc/latest/manual/sql-building/sql-statements/select-statement/set-operations/set-operation-rowtype/\" rel=\"nofollow noreferrer\">https://www.jooq.org/doc/latest/manual/sql-building/sql-statements/select-statement/set-operations/set-operation-rowtype/</a></li>\n<li><a href=\"https://blog.jooq.org/how-to-use-jooqs-converters-with-union-operations/\" rel=\"nofollow noreferrer\">https://blog.jooq.org/how-to-use-jooqs-converters-with-union-operations/</a></li>\n</ul>\n<p>Note, this isn't limited to <a href=\"https://www.jooq.org/doc/latest/manual/sql-execution/fetching/ad-hoc-converter/\" rel=\"nofollow noreferrer\">ad-hoc converters</a>. It works this way for any type of converter or binding.</p>\n<h2>A workaround using an explicit discriminator</h2>\n<p>You can always implement a discriminator aware converter yourself:</p>\n<pre class=\"lang-java prettyprint-override\"><code>Function3&lt;String, Integer, String, Something&gt; converter = \n    (discriminator, id, name) -&gt; {\n        switch (discriminator) {\n            case &quot;A&quot;: return new A(id, name);\n            case &quot;B&quot;: return new B(id, name);\n            default: throw new IllegalArgumentException();\n        }\n    };\n\nList&lt;Something&gt; records = db.select(\n  row(inline(&quot;A&quot;), TABLE_A.ID, TABLE_A.NAME).mapping(converter)\n)\n.from(TABLE_A)\n.unionAll(\n   select( \n       row(inline(&quot;B&quot;), TABLE_A.ID, TABLE_A.NAME).mapping(converter)\n   ).from(TABLE_B)\n).fetch(Record1::component1);\n</code></pre>\n<p>This is a bit more verbose, but now it does exactly what you're expecting. Note that the second <code>UNION ALL</code> subquery still needs a reference to the <code>converter</code> in order to compile.</p>\n<h2>Mapping only globally</h2>\n<p>Maybe even easier in this particular case, map things globally instead of per <code>UNION ALL</code> subquery (the actual query might be more complicated, of course):</p>\n<pre class=\"lang-java prettyprint-override\"><code>List&lt;Something&gt; records = db.select(inline(&quot;A&quot;), TABLE_A.ID, TABLE_A.NAME)\n.from(TABLE_A)\n.unionAll(\n   select(inline(&quot;B&quot;), TABLE_A.ID,TABLE_A.NAME)\n  .from(TABLE_B)\n).fetch((discriminator, id, name) -&gt; {\n    switch (discriminator) {\n        case &quot;A&quot;: return new A(id, name);\n        case &quot;B&quot;: return new B(id, name);\n        default: throw new IllegalArgumentException();\n    }\n});\n</code></pre>\n<p>Now, it is a bit less confusing, as you don't have to map the two subqueries twice anymore, only the global result, once.</p>\n"}],"owner":{"user_id":21325123,"display_name":"Matt Snider"},"view_count":31,"up_vote_count":2,"accepted_answer_id":75648331,"answer_count":1,"score":2,"creation_date":1677923662,"question_id":75634880,"body":"<p>It seems when running a union query with multiple converters, the second ad-hoc converter is ignored.</p>\n<p>For example:</p>\n<pre class=\"lang-java prettyprint-override\"><code>record A(UInteger id, String name) implements Something { };\nrecord B(UInteger id, String name) implements Something { };\n\n// ... \nList&lt;Something&gt; record = db.select(\n  row(TABLE_A.ID,TABLE_A.NAME).mapping(A::new)\n)\n.from(TABLE_A)\n.unionAll(\n   select(\n       row(TABLE_A.ID,TABLE_A.NAME).mapping(B::new)\n   ).from(TABLE_B)\n).fetch(Record1::component1);\n</code></pre>\n<p>All results end up as <code>A</code> and the second ad-hoc converter gets ignored.</p>\n"},{"tags":["java","bash","maven","apache-spark","java-17"],"answers":[{"owner":{"user_id":6395627,"display_name":"Slaw"},"up_vote_count":3,"is_accepted":true,"creation_date":1677911947,"answer_id":75634087,"body":"<p><a href=\"https://openjdk.org/jeps/261\" rel=\"nofollow noreferrer\">JEP 261: Module System</a> has this to say:</p>\n<blockquote>\n<p>Two new <strong>JDK-specific</strong> <em>[emphasis added]</em> JAR-file manifest attributes are defined to correspond to the <code>--add-exports</code> and <code>--add-opens</code> command-line options:</p>\n<ul>\n<li><code>Add-Exports: &lt;module&gt;/&lt;package&gt;( &lt;module&gt;/&lt;package&gt;)*</code></li>\n<li><code>Add-Opens: &lt;module&gt;/&lt;package&gt;( &lt;module&gt;/&lt;package&gt;)*</code></li>\n</ul>\n<p>The value of each attribute is a space-separated list of slash-separated module-name/package-name pairs. A <code>&lt;module&gt;/&lt;package&gt;</code> pair in the value of an <code>Add-Exports</code> attribute has the same meaning as the command-line option <code>--add-exports &lt;module&gt;/&lt;package&gt;=ALL-UNNAMED</code>. A <code>&lt;module&gt;/&lt;package&gt;</code> pair in the value of an <code>Add-Opens</code> attribute has the same meaning as the command-line option <code>--add-opens &lt;module&gt;/&lt;package&gt;=ALL-UNNAMED</code>.</p>\n<p>Each attribute can occur at most once, in the main section of a <code>MANIFEST.MF</code> file. A particular pair can be listed more than once. If a specified module was not resolved, or if a specified package does not exist, then the corresponding pair is ignored. <strong>These attributes are interpreted only in the main executable JAR file of an application, i.e., in the JAR file specified to the <code>-jar</code> option of the Java run-time launcher; they are ignored in all other JAR files.</strong> <em>[emphasis added]</em></p>\n</blockquote>\n<p>As emphasized, these attributes are JDK-specific. They do not appear to be part of the <a href=\"https://docs.oracle.com/en/java/javase/19/docs/specs/jar/jar.html\" rel=\"nofollow noreferrer\">JAR file specification</a>. And they only work with the JAR file specified with the <code>-jar</code> option.</p>\n"}],"owner":{"user_id":2827181,"display_name":"Marc Le Bihan"},"view_count":181,"up_vote_count":2,"accepted_answer_id":75634087,"answer_count":1,"score":2,"creation_date":1677906296,"question_id":75633758,"body":"<p>I encounter a problem that the whole <em>Spark</em> community has:<br />\nwhen I switch from <em>Java</em> 11 to 17, <em>Spark</em> (for me the <code>3.3.2</code> version) fails with:</p>\n<p><code>java.lang.IllegalAccessError: class org.apache.spark.storage.StorageUtils$ (in unnamed module @0xe25b2fe) cannot access class sun.nio.ch.DirectBuffer (in module java.base) because module java.base does not export sun.nio.ch to unnamed module @0xe25b2fe</code></p>\n<p>The solution is to :</p>\n<ul>\n<li>Change your <em>Maven</em> launch of unit tests,</li>\n<li>Change your Dockerfiles,</li>\n<li>Change your <em>java</em> command lines in any script involving directly or indirectly your classes or <em>Spark</em>,</li>\n<li>And ask all your customers to do the same</li>\n</ul>\n<p>to go from:</p>\n<pre class=\"lang-bash prettyprint-override\"><code>java -jar target/myProgram.jar\n</code></pre>\n<p>to :</p>\n<pre class=\"lang-bash prettyprint-override\"><code>java --add-exports java.base/sun.nio.ch=ALL-UNNAMED \\\n   --add-opens java.base/java.util=ALL-UNNAMED \\\n   --add-opens java.base/java.nio=ALL-UNNAMED \\\n   --add-opens java.base/java.lang=ALL-UNNAMED \\\n   --add-opens java.base/java.lang.invoke=ALL-UNNAMED \\\n   -jar myProgram.jar\n</code></pre>\n<p>And you understand that the response is, at 100%:<br />\n&quot;<em>No, let's stay on Java 11.<br />\nSpark (or Scala) doesn't handle Java 17 correctly, making it unusable with it</em>&quot;</p>\n<p>Does an alternative solution exist, that would allow me to, like I would do savagely a:<br />\n<code>System.setProperty(&quot;my.property&quot;, &quot;myValue&quot;)</code><br />\nif I was really willing so,</p>\n<p>to setup at the earliest place of my build process,<br />\nsomething that would ensure that for/from any launch of the classes, jars I'm producing here - whenever they are intended for tests, runtime, containerization... -,</p>\n<p>the underlying <em>java</em> command launching them will assume the<br />\n<code>--add-exports java.base/sun.nio.ch=ALL-UNNAMED --add-opens java.base/java.util=ALL-UNNAMED    --add-opens java.base/java.nio=ALL-UNNAMED --add-opens java.base/java.lang=ALL-UNNAMED --add-opens java.base/java.lang.invoke=ALL-UNNAMED</code><br />\nto come along with it, avoiding for anyone the clumsy (and sometimes impossible task) of correcting all the java command lines everywhere?</p>\n<p>Because it's a definitive stumbling block for the migration from Java 11 to Java 17.</p>\n"},{"tags":["java","constants"],"comments":[{"owner":{"user_id":6073886,"display_name":"OH GOD SPIDERS"},"edited":false,"comment_id":133424642,"body":"put them in a List and use contains: <code>Arrays.asList(UserRole.ADMIN, UserRole.SELLER, UserRole.BIGGER).contains(input)</code> - Note however that I see huge problems with your plan on checking if <code>input.toLower()</code> (which i assume means the lowercase conversion of your input) equals a couple of Strings of which not a single one is all lower case."},{"owner":{"user_id":1076640,"display_name":"yshavit"},"edited":false,"comment_id":133424682,"body":"A <code>Set</code> would be a bit more efficient if there are many roles. With three roles, a <code>List</code> (as @OHGODSPIDERS suggested) is fine, and may even be more efficient (I&#39;m not sure)."},{"owner":{"user_id":214525,"display_name":"f1sh"},"edited":false,"comment_id":133424795,"body":"sounds like an ideal use case for an <code>enum</code> since you can iterate over the constants and compare their names."},{"owner":{"user_id":16320675,"display_name":"user16320675"},"edited":false,"comment_id":133424867,"body":"@pasta64 how would <code>eval()</code> work for this question?"},{"owner":{"user_id":16376827,"display_name":"g00se"},"edited":false,"comment_id":133425277,"body":"<code>enum</code> (<code>String</code>s are not type safe) then <code>UserRole.valueOf(u.toUpperCase());</code> An exception will be thrown if not valid."},{"owner":{"user_id":2711488,"display_name":"Holger"},"edited":false,"comment_id":133425702,"body":"<code>boolean matches = switch(input.toLower()) { case ADMIN, SELLER, BIDDER -&gt; true; default -&gt; false; };</code> but as @OHGODSPIDERS already said, there will never be a match as long as your constant strings contain uppercase characters."}],"answers":[{"owner":{"user_id":1151412,"display_name":"Hushen Savani"},"up_vote_count":1,"is_accepted":false,"creation_date":1677855774,"answer_id":75628691,"body":"<p>It is not a good idea to match the input against the constants fields. You could use map to match such data. However, still if you want to do it, here is the class.</p>\n<pre><code>import java.lang.reflect.Field;\n\npublic class ConstantCheckerUtil {\n    public static boolean checkConstant(String input) {\n        boolean hasAnyMatch = false;\n\n        try {\n            Class&lt;UserRole&gt; userRoleClass = UserRole.class;\n            Field[] userRoleClassDeclaredFields = userRoleClass.getDeclaredFields();\n            for (Field userRoleClassDeclaredField : userRoleClassDeclaredFields) {\n                if(userRoleClassDeclaredField.get(userRoleClassDeclaredField.toString()).toString().toLowerCase().equals(input)) {\n                    hasAnyMatch = true;\n                    break;\n                }\n            }\n        } catch (Exception e) {\n            e.printStackTrace(); //You can enhance the logging part\n        }\n\n        return hasAnyMatch;\n    }\n\n    public static void main(String[] args) { //Testing\n        System.out.println(ConstantCheckerUtil.checkConstant(&quot;Admin&quot;.toLowerCase()));\n    }\n}\n</code></pre>\n"},{"owner":{"user_id":642706,"display_name":"Basil Bourque"},"up_vote_count":2,"is_accepted":true,"creation_date":1677861907,"answer_id":75629759,"body":"<h1>Enum</h1>\n<blockquote>\n<p>I gonna use a lot of constants in my code and that w'd probably produce a more elegant code that easier to debug and read.</p>\n</blockquote>\n<p>For constants known at compile time, an <a href=\"https://docs.oracle.com/en/java/javase/19/docs/api/java.base/java/lang/Enum.html\" rel=\"nofollow noreferrer\">enum</a> is often the best approach. The enum facility in Java is more powerful and flexible than you may have seen in other languages.</p>\n<p>In Java, each enum object is named in all-uppercase, by convention.</p>\n<pre class=\"lang-java prettyprint-override\"><code>enum UserRole\n{\n    ADMIN ,\n    SELLER , \n    BIDDER ;\n }\n</code></pre>\n<p>Fetch by constant name.</p>\n<pre class=\"lang-java prettyprint-override\"><code>UserRole userRole = UserRole.valueOf( UserRole.class , &quot;seller&quot;.toUpperCase() ) ;\n</code></pre>\n<p>See that <a href=\"https://ideone.com/452Z2R\" rel=\"nofollow noreferrer\">code run at Ideone.com</a>.</p>\n<blockquote>\n<p>userRole.toString() = SELLER</p>\n</blockquote>\n<p>Or, you may want to add a display name for presentation to the users.</p>\n<p>Add a private member field to the enum class. Write a constructor that takes the text of each enum object’s display name. Add a getter method. And write a <code>static</code> method to look for the enum matching an expected display name.</p>\n<pre class=\"lang-java prettyprint-override\"><code>enum UserRole\n{\n    ADMIN ( &quot;Admin&quot; ) ,\n    SELLER ( &quot;Seller&quot; ) , \n    BIDDER ( &quot;Bidder&quot; ) ;\n\n    private final String displayName ;\n\n    // Constructor \n    UserRole ( String displayName ) \n    {\n        this.displayName = displayName ;\n    }\n\n    public String getDisplayName() \n    { \n        return this.displayName ; \n    }\n\n    public static UserRole forDisplayNameIgnoreCase ( final String desiredDisplayName ) \n    {\n        for ( UserRole userRole : UserRole.values() )\n        {\n            if ( userRole.getDisplayName().equalsIgnoreCase( desiredDisplayName ) )\n            {\n                return userRole ;\n            }\n        }\n        throw new IllegalArgumentException( &quot;Unknown display name&quot; ) ;  // Or return an `Optional&lt; UserRole &gt;`. The Optional would be my preference. \n    }\n\n}\n</code></pre>\n<p>Fetch by display name.</p>\n<pre><code>UserRole userRole = UserRole.forDisplayNameIgnoreCase ( &quot;seller&quot; ) ;\n</code></pre>\n<p>See this <a href=\"https://ideone.com/OGBpRo\" rel=\"nofollow noreferrer\">code run at Ideone.com</a>.</p>\n<blockquote>\n<p>userRole.toString() = SELLER</p>\n</blockquote>\n"}],"owner":{"user_id":20612285,"display_name":"danwgh"},"view_count":129,"up_vote_count":2,"accepted_answer_id":75629759,"answer_count":2,"score":2,"creation_date":1677853787,"question_id":75628336,"body":"<p>I have this class to hold my constants:</p>\n<pre><code>public class UserRole {\n    static final String ADMIN = &quot;Admin&quot;;\n    static final String SELLER = &quot;Seller&quot;;\n    static final String BIDDER = &quot;Bidder&quot;; \n}\n</code></pre>\n<p>When Im getting input from the user I want to check that <code>input.toLower()</code> equals to one of this constants.<br/> (I want the class to provide such a method)\nI can do it with multiple <code>if</code>s of course but i want it to be more elegant. I gonna use a lot of constants in my code and that w'd probably produce a more elegant code that easier to debug and read.\nIm coming from the C++ world where i can use x-macros or something similar and i'd like to know what is a good way to achieve this task in Java.</p>\n"},{"tags":["java","json","spring","spring-boot","jackson"],"answers":[{"owner":{"user_id":3636601,"display_name":"Jens"},"up_vote_count":3,"is_accepted":true,"creation_date":1677483805,"answer_id":75577859,"body":"<p>Change the configuration of the <code>ObjectMapper</code> and add</p>\n<pre><code>mapper.configure(JsonParser.Feature.ALLOW_BACKSLASH_ESCAPING_ANY_CHARACTER, true); \n</code></pre>\n<p>You can add something like</p>\n<pre><code>@Bean\npublic Jackson2ObjectMapperBuilderCustomizer jsonCustomizer() {\n    return builder -&gt; builder.json().featuresToEnable(JsonParser.Feature.ALLOW_BACKSLASH_ESCAPING_ANY_CHARACTER)\n}\n</code></pre>\n<p>to a <code>@Configuration</code> annotated class to reconfigure the mapper</p>\n"}],"owner":{"user_id":19324621,"display_name":"Kira Sign"},"view_count":116,"up_vote_count":2,"accepted_answer_id":75577859,"answer_count":1,"score":2,"creation_date":1677482926,"question_id":75577737,"body":"<p>I received the following when sending POST request</p>\n<blockquote>\n<p>Resolved [org.springframework.http.converter.HttpMessageNotReadableException: I/O error while reading input message; nested exception is java.io.IOException: Found strange data: ?Color]\nMy request body</p>\n</blockquote>\n<pre><code>{\n    &quot;name&quot;: &quot;\\bColor&quot;,\n    &quot;displayName&quot;: &quot;\\bColor&quot;,\n    &quot;position&quot;: 6\n}\n</code></pre>\n<p>Controller</p>\n<pre><code>    @PostMapping(&quot;/name&quot;)\n    public BaseResponseV2 saveNameField(@RequestBody NameField nameField) {\n        nameService.saveFilterOption(nameField);\n        return BaseResponseV2.makeResponse(&quot;DONE&quot;);\n    }\n</code></pre>\n<p>NameField:</p>\n<pre><code>    private String name;\n    private String displayName;\n    private int position;\n</code></pre>\n<p>So How do I pass the special/strange character to RequestBody</p>\n"},{"tags":["java","java-native-interface","jvm-arguments","java-17","native-code"],"answers":[{"owner":{"user_id":1554195,"display_name":"tquadrat"},"up_vote_count":1,"is_accepted":false,"creation_date":1677309708,"answer_id":75563896,"body":"<p>If I remember it correctly, those things &quot;with handle&quot; are not the libraries but the functions to be expected inside a library.</p>\n<p>You are interested mainly in those lines beginning with &quot;Loaded library&quot;.</p>\n"},{"owner":{"user_id":3699139,"display_name":"Jorn Vernee"},"up_vote_count":2,"is_accepted":true,"creation_date":1677339012,"answer_id":75566478,"body":"<p>As others have mentioned, the &quot;Found&quot; and &quot;Failed to find&quot; lines are about symbols/function being looked up in a library.</p>\n<hr />\n<p>Unified logging (<code>-Xlog</code>) also allows you to pipe output to a file:</p>\n<pre><code>-Xlog:library=info:file=libraries_log.txt\n</code></pre>\n<p>And then use <code>grep</code> (or <code>sls</code> on Windows) on the file to look for &quot;Loaded library&quot;:</p>\n<pre><code>$ grep &quot;Loaded library&quot; ./libraries_log.txt\n[0.021s][info][library] Loaded library libjsvml.so, handle 0x00007f9a7c0ca000\n[0.045s][info][library] Loaded library /usr/lib/jvm/java-17-openjdk-amd64/lib/libnio.so, handle 0x00007f9a7c0eccb0\n[0.053s][info][library] Loaded library /usr/lib/jvm/java-17-openjdk-amd64/lib/libzip.so, handle 0x00007f9a7c024da0\n[0.213s][info][library] Loaded library /usr/lib/jvm/java-17-openjdk-amd64/lib/libjimage.so, handle 0x00007f9a7c002790\n[0.532s][info][library] Loaded library /usr/lib/jvm/java-17-openjdk-amd64/lib/libnet.so, handle 0x00007f9a7c0ed2f0\n[0.544s][info][library] Loaded library /root/.gradle/native/e1d6ef7f7dcc3fd88c89a11ec53ec762bb8ba0a96d01ffa2cd45eb1d1d8dd5c5/linux-amd64/libnative-platform.so, handle 0x00007f9a7c6cad60\n[0.560s][info][library] Loaded library /root/.gradle/native/e1d6ef7f7dcc3fd88c89a11ec53ec762bb8ba0a96d01ffa2cd45eb1d1d8dd5c5/linux-amd64-ncurses6/libnative-platform-curses.so, handle 0x00007f9a7c6d0ef0\n[0.667s][info][library] Loaded library /usr/lib/jvm/java-17-openjdk-amd64/lib/libmanagement.so, handle 0x00007f9a7c763730\n[0.670s][info][library] Loaded library /usr/lib/jvm/java-17-openjdk-amd64/lib/libmanagement_ext.so, handle 0x00007f9a7c76e760\n[0.807s][info][library] Loaded library /usr/lib/jvm/java-17-openjdk-amd64/lib/libextnet.so, handle 0x00007f9a7c7e4fd0\n</code></pre>\n<p>All of these libraries are being loaded by the JVM. Note that the JDK also uses JNI itself to implement certain features, so that is why some libraries from the JDK directory are being loaded.</p>\n<p>I'm assuming the libraries you're interested in are the <code>/root/.gradle/native/*</code> libraries?</p>\n<hr />\n<p>You could then use the value of the handle, i.e. the hexadecimal value at the end of the line, to search for symbols that are being looked up in this particular library. For example, if I take the handle value of <code>/root/.gradle/native/*/linux-amd64/libnative-platform.so</code>, which is <code>0x00007f9a7c6cad60</code>. I can use <code>grep</code> again to find which symbols the JVM is trying to load from this library:</p>\n<pre><code>$ grep 0x00007f9a7c6cad60 ./libraries_log.txt\n[0.544s][info][library] Loaded library /root/.gradle/native/e1d6ef7f7dcc3fd88c89a11ec53ec762bb8ba0a96d01ffa2cd45eb1d1d8dd5c5/linux-amd64/libnative-platform.so, handle\n0x00007f9a7c6cad60\n[0.545s][info][library] Found JNI_OnLoad in library with handle 0x00007f9a7c6cad60\n[0.546s][info][library] Found Java_net_rubygrapefruit_platform_internal_jni_NativeLibraryFunctions_getVersion in library with handle 0x00007f9a7c6cad60\n[0.565s][info][library] Found Java_net_rubygrapefruit_platform_internal_jni_PosixTerminalFunctions_isatty in library with handle 0x00007f9a7c6cad60\n[0.703s][info][library] Found Java_net_rubygrapefruit_platform_internal_jni_PosixProcessFunctions_getPid in library with handle 0x00007f9a7c6cad60\n</code></pre>\n"}],"owner":{"user_id":21274485,"display_name":"Augustin Cayot "},"view_count":100,"up_vote_count":2,"accepted_answer_id":75566478,"answer_count":2,"score":2,"creation_date":1677309287,"question_id":75563871,"body":"<p>I started my app with the JVM option <code>-Xlog:library=trace</code> - <a href=\"https://stackoverflow.com/questions/75548200/how-to-find-native-libraries-in-a-jdk-17-application-that-are-used-via-jni\">based on advice in another question</a> - to see which native libraries are being loaded.</p>\n<p>But the output is pretty confusing - see below:</p>\n<pre><code>[0.021s][info][library] Loaded library libjsvml.so, handle 0x00007f9a7c0ca000\n[0.042s][info][library] Failed to find JNI_OnLoad_nio in library with handle 0x00007f9a83c232e0\n[0.045s][info][library] Loaded library /usr/lib/jvm/java-17-openjdk-amd64/lib/libnio.so, handle 0x00007f9a7c0eccb0\n[0.046s][info][library] Found JNI_OnLoad in library with handle 0x00007f9a7c0eccb0\n[0.046s][info][library] Found Java_sun_nio_fs_UnixNativeDispatcher_init in library with handle 0x00007f9a7c0eccb0\n[0.047s][info][library] Found Java_sun_nio_fs_UnixNativeDispatcher_getcwd in library with handle 0x00007f9a7c0eccb0\n[0.049s][info][library] Found Java_sun_nio_fs_UnixNativeDispatcher_stat0 in library with handle 0x00007f9a7c0eccb0\n[0.052s][info][library] Failed to find JNI_OnLoad_zip in library with handle 0x00007f9a83c232e0\n[0.053s][info][library] Loaded library /usr/lib/jvm/java-17-openjdk-amd64/lib/libzip.so, handle 0x00007f9a7c024da0\n[0.054s][info][library] Found JNI_OnLoad in library with handle 0x00007f9a7c024da0\n[0.054s][info][library] Failed to find Java_java_util_zip_Inflater_initIDs in library with handle 0x00007f9a7c0eccb0\n[0.055s][info][library] Found Java_java_util_zip_Inflater_initIDs in library with handle 0x00007f9a7c024da0\n[0.056s][info][library] Failed to find Java_java_util_zip_Inflater_init in library with handle 0x00007f9a7c0eccb0\n[0.057s][info][library] Found Java_java_util_zip_Inflater_init in library with handle 0x00007f9a7c024da0\n[0.063s][info][library] Failed to find Java_java_util_zip_Inflater_inflateBytesBytes in library with handle 0x00007f9a7c0eccb0\n[0.067s][info][library] Found Java_java_util_zip_Inflater_inflateBytesBytes in library with handle 0x00007f9a7c024da0\n[0.068s][info][library] Failed to find Java_java_util_zip_Inflater_reset in library with handle 0x00007f9a7c0eccb0\n[0.069s][info][library] Found Java_java_util_zip_Inflater_reset in library with handle 0x00007f9a7c024da0\n[0.074s][info][library] Failed to find JNI_OnLoad_zip in library with handle 0x00007f9a83c232e0\n[0.117s][info][library] Failed to find Java_java_util_zip_Inflater_end in library with handle 0x00007f9a7c0eccb0\n[0.117s][info][library] Found Java_java_util_zip_Inflater_end in library with handle 0x00007f9a7c024da0\n[0.211s][info][library] Failed to find JNI_OnLoad_jimage in library with handle 0x00007f9a83c232e0\n[0.213s][info][library] Loaded library /usr/lib/jvm/java-17-openjdk-amd64/lib/libjimage.so, handle 0x00007f9a7c002790\n[0.216s][info][library] Failed to find JNI_OnLoad in library with handle 0x00007f9a7c002790\n[0.220s][info][library] Failed to find Java_jdk_internal_jimage_NativeImageBuffer_getNativeMap in library with handle 0x00007f9a7c0eccb0\n[0.221s][info][library] Failed to find Java_jdk_internal_jimage_NativeImageBuffer_getNativeMap in library with handle 0x00007f9a7c024da0\n[0.222s][info][library] Found Java_jdk_internal_jimage_NativeImageBuffer_getNativeMap in library with handle 0x00007f9a7c002790\n[0.531s][info][library] Failed to find JNI_OnLoad_net in library with handle 0x00007f9a83c232e0\n[0.532s][info][library] Loaded library /usr/lib/jvm/java-17-openjdk-amd64/lib/libnet.so, handle 0x00007f9a7c0ed2f0\n[0.533s][info][library] Found JNI_OnLoad in library with handle 0x00007f9a7c0ed2f0\n[0.534s][info][library] Found inet_pton in library with handle 0x0000000000000000\n[0.534s][info][library] Failed to find JNI_OnLoad_nio in library with handle 0x00007f9a83c232e0\n[0.535s][info][library] Found Java_sun_nio_ch_IOUtil_initIDs in library with handle 0x00007f9a7c0eccb0\n[0.536s][info][library] Found Java_sun_nio_ch_IOUtil_iovMax in library with handle 0x00007f9a7c0eccb0\n[0.536s][info][library] Found Java_sun_nio_ch_FileChannelImpl_initIDs in library with handle 0x00007f9a7c0eccb0\n[0.537s][info][library] Found Java_sun_nio_ch_FileChannelImpl_maxDirectTransferSize0 in library with handle 0x00007f9a7c0eccb0\n[0.538s][info][library] Found Java_sun_nio_ch_FileDispatcherImpl_init in library with handle 0x00007f9a7c0eccb0\n[0.538s][info][library] Found Java_sun_nio_ch_NativeThread_init in library with handle 0x00007f9a7c0eccb0\n[0.539s][info][library] Found Java_sun_nio_ch_NativeThread_current in library with handle 0x00007f9a7c0eccb0\n[0.540s][info][library] Found Java_sun_nio_ch_FileKey_initIDs in library with handle 0x00007f9a7c0eccb0\n[0.541s][info][library] Found Java_sun_nio_ch_FileKey_init in library with handle 0x00007f9a7c0eccb0\n[0.542s][info][library] Found Java_sun_nio_ch_FileDispatcherImpl_lock0 in library with handle 0x00007f9a7c0eccb0\n[0.542s][info][library] Found Java_sun_nio_ch_FileDispatcherImpl_release0 in library with handle 0x00007f9a7c0eccb0\n[0.543s][info][library] Failed to find JNI_OnLoad_native-platform in library with handle 0x00007f9a83c232e0\n[0.544s][info][library] Loaded library /root/.gradle/native/e1d6ef7f7dcc3fd88c89a11ec53ec762bb8ba0a96d01ffa2cd45eb1d1d8dd5c5/linux-amd64/libnative-platform.so, handle 0x00007f9a7c6cad60\n[0.545s][info][library] Found JNI_OnLoad in library with handle 0x00007f9a7c6cad60\n[0.546s][info][library] Found Java_net_rubygrapefruit_platform_internal_jni_NativeLibraryFunctions_getVersion in library with handle 0x00007f9a7c6cad60\n[0.552s][info][library] Failed to find JNI_OnLoad_native-platform-curses in library with handle 0x00007f9a83c232e0\n[0.557s][info][library] Failed to find JNI_OnLoad_native-platform-curses in library with handle 0x00007f9a83c232e0\n[0.560s][info][library] Loaded library /root/.gradle/native/e1d6ef7f7dcc3fd88c89a11ec53ec762bb8ba0a96d01ffa2cd45eb1d1d8dd5c5/linux-amd64-ncurses6/libnative-platform-curses.so, handle 0x00007f9a7c6d0ef0\n[0.561s][info][library] Failed to find JNI_OnLoad in library with handle 0x00007f9a7c6d0ef0\n[0.562s][info][library] Found Java_net_rubygrapefruit_platform_internal_jni_TerminfoFunctions_getVersion in library with handle 0x00007f9a7c6d0ef0\n[0.565s][info][library] Failed to find Java_net_rubygrapefruit_platform_internal_jni_PosixTerminalFunctions_isatty in library with handle 0x00007f9a7c6d0ef0\n[0.565s][info][library] Found Java_net_rubygrapefruit_platform_internal_jni_PosixTerminalFunctions_isatty in library with handle 0x00007f9a7c6cad60\n[0.567s][info][library] Found Java_net_rubygrapefruit_platform_internal_jni_TerminfoFunctions_initTerminal in library with handle 0x00007f9a7c6d0ef0\n[0.568s][info][library] Found Java_net_rubygrapefruit_platform_internal_jni_TerminfoFunctions_hideCursor in library with handle 0x00007f9a7c6d0ef0\n[0.568s][info][library] Found Java_net_rubygrapefruit_platform_internal_jni_TerminfoFunctions_showCursor in library with handle 0x00007f9a7c6d0ef0\n[0.570s][info][library] Found Java_net_rubygrapefruit_platform_internal_jni_TerminfoFunctions_defaultForeground in library with handle 0x00007f9a7c6d0ef0\n[0.571s][info][library] Found Java_net_rubygrapefruit_platform_internal_jni_TerminfoFunctions_boldOn in library with handle 0x00007f9a7c6d0ef0\n[0.571s][info][library] Found Java_net_rubygrapefruit_platform_internal_jni_TerminfoFunctions_dimOn in library with handle 0x00007f9a7c6d0ef0\n[0.572s][info][library] Found Java_net_rubygrapefruit_platform_internal_jni_TerminfoFunctions_reset in library with handle 0x00007f9a7c6d0ef0\n[0.572s][info][library] Found Java_net_rubygrapefruit_platform_internal_jni_TerminfoFunctions_down in library with handle 0x00007f9a7c6d0ef0\n[0.573s][info][library] Found Java_net_rubygrapefruit_platform_internal_jni_TerminfoFunctions_up in library with handle 0x00007f9a7c6d0ef0\n[0.574s][info][library] Found Java_net_rubygrapefruit_platform_internal_jni_TerminfoFunctions_left in library with handle 0x00007f9a7c6d0ef0\n[0.574s][info][library] Found Java_net_rubygrapefruit_platform_internal_jni_TerminfoFunctions_right in library with handle 0x00007f9a7c6d0ef0\n[0.575s][info][library] Found Java_net_rubygrapefruit_platform_internal_jni_TerminfoFunctions_startLine in library with handle 0x00007f9a7c6d0ef0\n[0.575s][info][library] Found Java_net_rubygrapefruit_platform_internal_jni_TerminfoFunctions_clearToEndOfLine in library with handle 0x00007f9a7c6d0ef0\n[0.666s][info][library] Failed to find JNI_OnLoad_management in library with handle 0x00007f9a83c232e0\n[0.667s][info][library] Loaded library /usr/lib/jvm/java-17-openjdk-amd64/lib/libmanagement.so, handle 0x00007f9a7c763730\n[0.668s][info][library] Found JNI_OnLoad in library with handle 0x00007f9a7c763730\n[0.669s][info][library] Failed to find JNI_OnLoad_management_ext in library with handle 0x00007f9a83c232e0\n[0.670s][info][library] Loaded library /usr/lib/jvm/java-17-openjdk-amd64/lib/libmanagement_ext.so, handle 0x00007f9a7c76e760\n[0.671s][info][library] Found JNI_OnLoad in library with handle 0x00007f9a7c76e760\n[0.673s][info][library] Failed to find Java_sun_management_VMManagementImpl_getVersion0 in library with handle 0x00007f9a7c76e760\n[0.674s][info][library] Failed to find Java_sun_management_VMManagementImpl_getVersion0 in library with handle 0x00007f9a7c0eccb0\n[0.674s][info][library] Found Java_sun_management_VMManagementImpl_getVersion0 in library with handle 0x00007f9a7c763730\n[0.675s][info][library] Failed to find Java_sun_management_VMManagementImpl_initOptionalSupportFields in library with handle 0x00007f9a7c76e760\n[0.675s][info][library] Failed to find Java_sun_management_VMManagementImpl_initOptionalSupportFields in library with handle 0x00007f9a7c0eccb0\n[0.676s][info][library] Found Java_sun_management_VMManagementImpl_initOptionalSupportFields in library with handle 0x00007f9a7c763730\n[0.682s][info][library] Failed to find Java_sun_management_VMManagementImpl_getStartupTime in library with handle 0x00007f9a7c76e760\n[0.683s][info][library] Failed to find Java_sun_management_VMManagementImpl_getStartupTime in library with handle 0x00007f9a7c0eccb0\n[0.684s][info][library] Found Java_sun_management_VMManagementImpl_getStartupTime in library with handle 0x00007f9a7c763730\n[0.687s][info][library] Failed to find Java_sun_management_VMManagementImpl_getVmArguments0 in library with handle 0x00007f9a7c76e760\n[0.687s][info][library] Failed to find Java_sun_management_VMManagementImpl_getVmArguments0 in library with handle 0x00007f9a7c0eccb0\n[0.687s][info][library] Found Java_sun_management_VMManagementImpl_getVmArguments0 in library with handle 0x00007f9a7c763730\n[0.702s][info][library] Failed to find Java_net_rubygrapefruit_platform_internal_jni_PosixProcessFunctions_getPid in library with handle 0x00007f9a7c6d0ef0\n[0.703s][info][library] Found Java_net_rubygrapefruit_platform_internal_jni_PosixProcessFunctions_getPid in library with handle 0x00007f9a7c6cad60\n[0.782s][info][library] Failed to find JNI_OnLoad_net in library with handle 0x00007f9a83c232e0\n[0.782s][info][library] Failed to find Java_java_net_NetworkInterface_init in library with handle 0x00007f9a7c76e760\n[0.784s][info][library] Found Java_java_net_NetworkInterface_init in library with handle 0x00007f9a7c0eccb0\n[0.785s][info][library] Failed to find JNI_OnLoad_net in library with handle 0x00007f9a83c232e0\n[0.786s][info][library] Failed to find Java_java_net_InetAddress_init in library with handle 0x00007f9a7c76e760\n[0.787s][info][library] Found Java_java_net_InetAddress_init in library with handle 0x00007f9a7c0eccb0\n[0.789s][info][library] Failed to find Java_java_net_InetAddressImplFactory_isIPv6Supported in library with handle 0x00007f9a7c76e760\n[0.789s][info][library] Found Java_java_net_InetAddressImplFactory_isIPv6Supported in library with handle 0x00007f9a7c0eccb0\n[0.790s][info][library] Failed to find Java_java_net_Inet4Address_init in library with handle 0x00007f9a7c76e760\n[0.790s][info][library] Found Java_java_net_Inet4Address_init in library with handle 0x00007f9a7c0eccb0\n[0.791s][info][library] Failed to find Java_java_net_Inet6Address_init in library with handle 0x00007f9a7c76e760\n[0.791s][info][library] Found Java_java_net_Inet6Address_init in library with handle 0x00007f9a7c0eccb0\n[0.792s][info][library] Failed to find Java_java_net_NetworkInterface_getAll in library with handle 0x00007f9a7c76e760\n[0.793s][info][library] Found Java_java_net_NetworkInterface_getAll in library with handle 0x00007f9a7c0eccb0\n[0.798s][info][library] Failed to find Java_java_net_NetworkInterface_isLoopback0 in library with handle 0x00007f9a7c76e760\n[0.803s][info][library] Found Java_java_net_NetworkInterface_isLoopback0 in library with handle 0x00007f9a7c0eccb0\n[0.804s][info][library] Failed to find Java_java_net_NetworkInterface_boundInetAddress0 in library with handle 0x00007f9a7c76e760\n[0.804s][info][library] Found Java_java_net_NetworkInterface_boundInetAddress0 in library with handle 0x00007f9a7c0eccb0\n[0.806s][info][library] Failed to find JNI_OnLoad_extnet in library with handle 0x00007f9a83c232e0\n[0.807s][info][library] Loaded library /usr/lib/jvm/java-17-openjdk-amd64/lib/libextnet.so, handle 0x00007f9a7c7e4fd0\n[0.807s][info][library] Found JNI_OnLoad in library with handle 0x00007f9a7c7e4fd0\n[0.808s][info][library] Found Java_jdk_net_LinuxSocketOptions_quickAckSupported0 in library with handle 0x00007f9a7c7e4fd0\n[0.809s][info][library] Found Java_jdk_net_LinuxSocketOptions_keepAliveOptionsSupported0 in library with handle 0x00007f9a7c7e4fd0\n[0.809s][info][library] Found Java_jdk_net_LinuxSocketOptions_incomingNapiIdSupported0 in library with handle 0x00007f9a7c7e4fd0\n[0.810s][info][library] Failed to find Java_sun_nio_ch_Net_initIDs in library with handle 0x00007f9a7c7e4fd0\n[0.810s][info][library] Failed to find Java_sun_nio_ch_Net_initIDs in library with handle 0x00007f9a7c76e760\n[0.811s][info][library] Found Java_sun_nio_ch_Net_initIDs in library with handle 0x00007f9a7c0eccb0\n[0.811s][info][library] Failed to find Java_sun_nio_ch_Net_pollinValue in library with handle 0x00007f9a7c7e4fd0\n[0.812s][info][library] Failed to find Java_sun_nio_ch_Net_pollinValue in library with handle 0x00007f9a7c76e760\n[0.812s][info][library] Found Java_sun_nio_ch_Net_pollinValue in library with handle 0x00007f9a7c0eccb0\n[0.813s][info][library] Failed to find Java_sun_nio_ch_Net_polloutValue in library with handle 0x00007f9a7c7e4fd0\n[0.813s][info][library] Failed to find Java_sun_nio_ch_Net_polloutValue in library with handle 0x00007f9a7c76e760\n[0.814s][info][library] Found Java_sun_nio_ch_Net_polloutValue in library with handle 0x00007f9a7c0eccb0\n[0.814s][info][library] Failed to find Java_sun_nio_ch_Net_pollerrValue in library with handle 0x00007f9a7c7e4fd0\n[0.815s][info][library] Failed to find Java_sun_nio_ch_Net_pollerrValue in library with handle 0x00007f9a7c76e760\n[0.815s][info][library] Found Java_sun_nio_ch_Net_pollerrValue in library with handle 0x00007f9a7c0eccb0\n[0.816s][info][library] Failed to find Java_sun_nio_ch_Net_pollhupValue in library with handle 0x00007f9a7c7e4fd0\n[0.816s][info][library] Failed to find Java_sun_nio_ch_Net_pollhupValue in library with handle 0x00007f9a7c76e760\n[0.820s][info][library] Found Java_sun_nio_ch_Net_pollhupValue in library with handle 0x00007f9a7c0eccb0\n[0.820s][info][library] Failed to find Java_sun_nio_ch_Net_pollnvalValue in library with handle 0x00007f9a7c7e4fd0\n[0.823s][info][library] Failed to find Java_sun_nio_ch_Net_pollnvalValue in library with handle 0x00007f9a7c76e760\n[0.827s][info][library] Found Java_sun_nio_ch_Net_pollnvalValue in library with handle 0x00007f9a7c0eccb0\n[0.827s][info][library] Failed to find Java_sun_nio_ch_Net_pollconnValue in library with handle 0x00007f9a7c7e4fd0\n[0.828s][info][library] Failed to find Java_sun_nio_ch_Net_pollconnValue in library with handle 0x00007f9a7c76e760\n[0.829s][info][library] Found Java_sun_nio_ch_Net_pollconnValue in library with handle 0x00007f9a7c0eccb0\n[0.829s][info][library] Failed to find Java_sun_nio_ch_Net_isExclusiveBindAvailable in library with handle 0x00007f9a7c7e4fd0\n[0.830s][info][library] Failed to find Java_sun_nio_ch_Net_isExclusiveBindAvailable in library with handle 0x00007f9a7c76e760\n[0.831s][info][library] Found Java_sun_nio_ch_Net_isExclusiveBindAvailable in library with handle 0x00007f9a7c0eccb0\n[0.831s][info][library] Failed to find Java_sun_nio_ch_Net_isIPv6Available0 in library with handle 0x00007f9a7c7e4fd0\n[0.832s][info][library] Failed to find Java_sun_nio_ch_Net_isIPv6Available0 in library with handle 0x00007f9a7c76e760\n[0.832s][info][library] Found Java_sun_nio_ch_Net_isIPv6Available0 in library with handle 0x00007f9a7c0eccb0\n[0.833s][info][library] Failed to find Java_sun_nio_ch_Net_socket0 in library with handle 0x00007f9a7c7e4fd0\n[0.833s][info][library] Failed to find Java_sun_nio_ch_Net_socket0 in library with handle 0x00007f9a7c76e760\n[0.837s][info][library] Found Java_sun_nio_ch_Net_socket0 in library with handle 0x00007f9a7c0eccb0\n[0.843s][info][library] Failed to find Java_sun_nio_ch_IOUtil_setfdVal in library with handle 0x00007f9a7c7e4fd0\n[0.843s][info][library] Failed to find Java_sun_nio_ch_IOUtil_setfdVal in library with handle 0x00007f9a7c76e760\n[0.844s][info][library] Found Java_sun_nio_ch_IOUtil_setfdVal in library with handle 0x00007f9a7c0eccb0\n[0.844s][info][library] Failed to find Java_sun_nio_ch_IOUtil_fdVal in library with handle 0x00007f9a7c7e4fd0\n[0.845s][info][library] Failed to find Java_sun_nio_ch_IOUtil_fdVal in library with handle 0x00007f9a7c76e760\n[0.845s][info][library] Found Java_sun_nio_ch_IOUtil_fdVal in library with handle 0x00007f9a7c0eccb0\n[0.846s][info][library] Failed to find Java_sun_nio_ch_NativeSocketAddress_AFINET in library with handle 0x00007f9a7c7e4fd0\n[0.846s][info][library] Failed to find Java_sun_nio_ch_NativeSocketAddress_AFINET in library with handle 0x00007f9a7c76e760\n[0.847s][info][library] Found Java_sun_nio_ch_NativeSocketAddress_AFINET in library with handle 0x00007f9a7c0eccb0\n[0.847s][info][library] Failed to find Java_sun_nio_ch_NativeSocketAddress_AFINET6 in library with handle 0x00007f9a7c7e4fd0\n[0.848s][info][library] Failed to find Java_sun_nio_ch_NativeSocketAddress_AFINET6 in library with handle 0x00007f9a7c76e760\n[0.848s][info][library] Found Java_sun_nio_ch_NativeSocketAddress_AFINET6 in library with handle 0x00007f9a7c0eccb0\n[0.849s][info][library] Failed to find Java_sun_nio_ch_NativeSocketAddress_sizeofSockAddr4 in library with handle 0x00007f9a7c7e4fd0\n[0.850s][info][library] Failed to find Java_sun_nio_ch_NativeSocketAddress_sizeofSockAddr4 in library with handle 0x00007f9a7c76e760\n[0.850s][info][library] Found Java_sun_nio_ch_NativeSocketAddress_sizeofSockAddr4 in library with handle 0x00007f9a7c0eccb0\n[0.855s][info][library] Failed to find Java_sun_nio_ch_NativeSocketAddress_sizeofSockAddr6 in library with handle 0x00007f9a7c7e4fd0\n[0.859s][info][library] Failed to find Java_sun_nio_ch_NativeSocketAddress_sizeofSockAddr6 in library with handle 0x00007f9a7c76e760\n[0.859s][info][library] Found Java_sun_nio_ch_NativeSocketAddress_sizeofSockAddr6 in library with handle 0x00007f9a7c0eccb0\n[0.860s][info][library] Failed to find Java_sun_nio_ch_NativeSocketAddress_sizeofFamily in library with handle 0x00007f9a7c7e4fd0\n[0.860s][info][library] Failed to find Java_sun_nio_ch_NativeSocketAddress_sizeofFamily in library with handle 0x00007f9a7c76e760\n[0.861s][info][library] Found Java_sun_nio_ch_NativeSocketAddress_sizeofFamily in library with handle 0x00007f9a7c0eccb0\n[0.861s][info][library] Failed to find Java_sun_nio_ch_NativeSocketAddress_offsetFamily in library with handle 0x00007f9a7c7e4fd0\n[0.862s][info][library] Failed to find Java_sun_nio_ch_NativeSocketAddress_offsetFamily in library with handle 0x00007f9a7c76e760\n[0.862s][info][library] Found Java_sun_nio_ch_NativeSocketAddress_offsetFamily in library with handle 0x00007f9a7c0eccb0\n[0.863s][info][library] Failed to find Java_sun_nio_ch_NativeSocketAddress_offsetSin4Port in library with handle 0x00007f9a7c7e4fd0\n[0.863s][info][library] Failed to find Java_sun_nio_ch_NativeSocketAddress_offsetSin4Port in library with handle 0x00007f9a7c76e760\n[0.864s][info][library] Found Java_sun_nio_ch_NativeSocketAddress_offsetSin4Port in library with handle 0x00007f9a7c0eccb0\n[0.864s][info][library] Failed to find Java_sun_nio_ch_NativeSocketAddress_offsetSin4Addr in library with handle 0x00007f9a7c7e4fd0\n[0.865s][info][library] Failed to find Java_sun_nio_ch_NativeSocketAddress_offsetSin4Addr in library with handle 0x00007f9a7c76e760\n[0.866s][info][library] Found Java_sun_nio_ch_NativeSocketAddress_offsetSin4Addr in library with handle 0x00007f9a7c0eccb0\n[0.866s][info][library] Failed to find Java_sun_nio_ch_NativeSocketAddress_offsetSin6Port in library with handle 0x00007f9a7c7e4fd0\n[0.867s][info][library] Failed to find Java_sun_nio_ch_NativeSocketAddress_offsetSin6Port in library with handle 0x00007f9a7c76e760\n[0.870s][info][library] Found Java_sun_nio_ch_NativeSocketAddress_offsetSin6Port in library with handle 0x00007f9a7c0eccb0\n[0.871s][info][library] Failed to find Java_sun_nio_ch_NativeSocketAddress_offsetSin6Addr in library with handle 0x00007f9a7c7e4fd0\n[0.871s][info][library] Failed to find Java_sun_nio_ch_NativeSocketAddress_offsetSin6Addr in library with handle 0x00007f9a7c76e760\n[0.872s][info][library] Found Java_sun_nio_ch_NativeSocketAddress_offsetSin6Addr in library with handle 0x00007f9a7c0eccb0\n[0.872s][info][library] Failed to find Java_sun_nio_ch_NativeSocketAddress_offsetSin6ScopeId in library with handle 0x00007f9a7c7e4fd0\n[0.873s][info][library] Failed to find Java_sun_nio_ch_NativeSocketAddress_offsetSin6ScopeId in library with handle 0x00007f9a7c76e760\n[0.874s][info][library] Found Java_sun_nio_ch_NativeSocketAddress_offsetSin6ScopeId in library with handle 0x00007f9a7c0eccb0\n[0.874s][info][library] Failed to find Java_sun_nio_ch_NativeSocketAddress_offsetSin6FlowInfo in library with handle 0x00007f9a7c7e4fd0\n[0.875s][info][library] Failed to find Java_sun_nio_ch_NativeSocketAddress_offsetSin6FlowInfo in library with handle 0x00007f9a7c76e760\n[0.875s][info][library] Found Java_sun_nio_ch_NativeSocketAddress_offsetSin6FlowInfo in library with handle 0x00007f9a7c0eccb0\n[0.877s][info][library] Failed to find Java_sun_nio_ch_Net_bind0 in library with handle 0x00007f9a7c7e4fd0\n[0.880s][info][library] Failed to find Java_sun_nio_ch_Net_bind0 in library with handle 0x00007f9a7c76e760\n[0.884s][info][library] Found Java_sun_nio_ch_Net_bind0 in library with handle 0x00007f9a7c0eccb0\n[0.895s][info][library] Failed to find Java_sun_nio_ch_Net_localInetAddress in library with handle 0x00007f9a7c7e4fd0\n[0.895s][info][library] Failed to find Java_sun_nio_ch_Net_localInetAddress in library with handle 0x00007f9a7c76e760\n[0.896s][info][library] Found Java_sun_nio_ch_Net_localInetAddress in library with handle 0x00007f9a7c0eccb0\n[0.896s][info][library] Failed to find Java_sun_nio_ch_Net_localPort in library with handle 0x00007f9a7c7e4fd0\n[0.897s][info][library] Failed to find Java_sun_nio_ch_Net_localPort in library with handle 0x00007f9a7c76e760\n[0.897s][info][library] Found Java_sun_nio_ch_Net_localPort in library with handle 0x00007f9a7c0eccb0\n[0.898s][info][library] Failed to find Java_sun_nio_ch_Net_isReusePortAvailable0 in library with handle 0x00007f9a7c7e4fd0\n[0.898s][info][library] Failed to find Java_sun_nio_ch_Net_isReusePortAvailable0 in library with handle 0x00007f9a7c76e760\n[0.898s][info][library] Found Java_sun_nio_ch_Net_isReusePortAvailable0 in library with handle 0x00007f9a7c0eccb0\n[0.900s][info][library] Failed to find Java_sun_nio_ch_Net_setIntOption0 in library with handle 0x00007f9a7c7e4fd0\n[0.900s][info][library] Failed to find Java_sun_nio_ch_Net_setIntOption0 in library with handle 0x00007f9a7c76e760\n[0.900s][info][library] Found Java_sun_nio_ch_Net_setIntOption0 in library with handle 0x00007f9a7c0eccb0\n[0.914s][info][library] Failed to find Java_sun_nio_ch_IOUtil_configureBlocking in library with handle 0x00007f9a7c7e4fd0\n[0.914s][info][library] Failed to find Java_sun_nio_ch_IOUtil_configureBlocking in library with handle 0x00007f9a7c76e760\n[0.914s][info][library] Found Java_sun_nio_ch_IOUtil_configureBlocking in library with handle 0x00007f9a7c0eccb0\n[0.915s][info][library] Failed to find Java_sun_nio_ch_Net_connect0 in library with handle 0x00007f9a7c7e4fd0\n[0.915s][info][library] Failed to find Java_sun_nio_ch_Net_connect0 in library with handle 0x00007f9a7c76e760\n[0.916s][info][library] Found Java_sun_nio_ch_Net_connect0 in library with handle 0x00007f9a7c0eccb0\n[0.917s][info][library] Failed to find Java_sun_nio_ch_Net_pollConnect in library with handle 0x00007f9a7c7e4fd0\n[0.920s][info][library] Failed to find Java_sun_nio_ch_Net_pollConnect in library with handle 0x00007f9a7c76e760\n[0.920s][info][library] Found Java_sun_nio_ch_Net_pollConnect in library with handle 0x00007f9a7c0eccb0\n[0.924s][info][library] Failed to find Java_sun_nio_ch_IOUtil_fdLimit in library with handle 0x00007f9a7c7e4fd0\n[0.926s][info][library] Failed to find Java_sun_nio_ch_IOUtil_fdLimit in library with handle 0x00007f9a7c76e760\n[0.926s][info][library] Found Java_sun_nio_ch_IOUtil_fdLimit in library with handle 0x00007f9a7c0eccb0\n[0.927s][info][library] Failed to find Java_sun_nio_ch_EPoll_eventSize in library with handle 0x00007f9a7c7e4fd0\n[0.928s][info][library] Failed to find Java_sun_nio_ch_EPoll_eventSize in library with handle 0x00007f9a7c76e760\n[0.928s][info][library] Found Java_sun_nio_ch_EPoll_eventSize in library with handle 0x00007f9a7c0eccb0\n[0.929s][info][library] Failed to find Java_sun_nio_ch_EPoll_eventsOffset in library with handle 0x00007f9a7c7e4fd0\n[0.929s][info][library] Failed to find Java_sun_nio_ch_EPoll_eventsOffset in library with handle 0x00007f9a7c76e760\n[0.929s][info][library] Found Java_sun_nio_ch_EPoll_eventsOffset in library with handle 0x00007f9a7c0eccb0\n[0.930s][info][library] Failed to find Java_sun_nio_ch_EPoll_dataOffset in library with handle 0x00007f9a7c7e4fd0\n[0.930s][info][library] Failed to find Java_sun_nio_ch_EPoll_dataOffset in library with handle 0x00007f9a7c76e760\n[0.931s][info][library] Found Java_sun_nio_ch_EPoll_dataOffset in library with handle 0x00007f9a7c0eccb0\n[0.931s][info][library] Failed to find Java_sun_nio_ch_EPoll_create in library with handle 0x00007f9a7c7e4fd0\n[0.932s][info][library] Failed to find Java_sun_nio_ch_EPoll_create in library with handle 0x00007f9a7c76e760\n[0.932s][info][library] Found Java_sun_nio_ch_EPoll_create in library with handle 0x00007f9a7c0eccb0\n[0.933s][info][library] Failed to find Java_sun_nio_ch_EventFD_eventfd0 in library with handle 0x00007f9a7c7e4fd0\n[0.933s][info][library] Failed to find Java_sun_nio_ch_EventFD_eventfd0 in library with handle 0x00007f9a7c76e760\n[0.939s][info][library] Found Java_sun_nio_ch_EventFD_eventfd0 in library with handle 0x00007f9a7c0eccb0\n[0.956s][info][library] Failed to find Java_sun_nio_ch_EPoll_ctl in library with handle 0x00007f9a7c7e4fd0\n[0.966s][info][library] Failed to find Java_sun_nio_ch_EPoll_ctl in library with handle 0x00007f9a7c76e760\n[0.971s][info][library] Found Java_sun_nio_ch_EPoll_ctl in library with handle 0x00007f9a7c0eccb0\n[0.976s][info][library] Failed to find Java_sun_nio_ch_FileDispatcherImpl_write0 in library with handle 0x00007f9a7c7e4fd0\n[0.977s][info][library] Failed to find Java_sun_nio_ch_FileDispatcherImpl_write0 in library with handle 0x00007f9a7c76e760\n[0.977s][info][library] Found Java_sun_nio_ch_FileDispatcherImpl_write0 in library with handle 0x00007f9a7c0eccb0\n[0.983s][info][library] Failed to find Java_sun_nio_ch_EPoll_wait in library with handle 0x00007f9a7c7e4fd0\n[0.983s][info][library] Failed to find Java_sun_nio_ch_EPoll_wait in library with handle 0x00007f9a7c76e760\n[0.984s][info][library] Found Java_sun_nio_ch_EPoll_wait in library with handle 0x00007f9a7c0eccb0\n[0.988s][info][library] Failed to find Java_sun_nio_ch_SocketDispatcher_read0 in library with handle 0x00007f9a7c7e4fd0\n[0.988s][info][library] Failed to find Java_sun_nio_ch_SocketDispatcher_read0 in library with handle 0x00007f9a7c76e760\n[0.989s][info][library] Found Java_sun_nio_ch_SocketDispatcher_read0 in library with handle 0x00007f9a7c0eccb0\n</code></pre>\n<p>Most of the output is talking about &quot;failed to find&quot; a library. But then I see other lines where it does find the library.</p>\n<p>Is there some other argument I should be using to exclude all of the &quot;failed to find&quot; stuff and just see what's actually loaded?</p>\n<p>Just to be clear, I only want to see loaded native libraries that are being invoked by Java Native Interface (JNI) because I have evidence that there is a memory leak in the Java application when it calls some native code via JNI.</p>\n<p>But this output doesn't shed as much light on the matter as I was hoping.</p>\n<p>Or maybe I'm just not reading it right?</p>\n"},{"tags":["java","open-telemetry"],"answers":[{"owner":{"user_id":3975633,"display_name":"samad montazeri"},"up_vote_count":3,"is_accepted":true,"creation_date":1677232823,"answer_id":75555118,"body":"<p>To write unit tests you can access the exported spans with <code>AgentTestingExporterAccess</code>. You need to import these packages:</p>\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;io.opentelemetry.javaagent&lt;/groupId&gt;\n    &lt;artifactId&gt;opentelemetry-testing-common&lt;/artifactId&gt;\n    &lt;version&gt;1.23.0-alpha&lt;/version&gt;\n    &lt;scope&gt;test&lt;/scope&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;io.opentelemetry.javaagent&lt;/groupId&gt;\n    &lt;artifactId&gt;opentelemetry-agent-for-testing&lt;/artifactId&gt;\n    &lt;version&gt;1.23.0-alpha&lt;/version&gt;\n    &lt;scope&gt;test&lt;/scope&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>A simple unit test can look like this:</p>\n<pre><code>import io.opentelemetry.api.trace.SpanKind;\nimport io.opentelemetry.javaagent.testing.common.AgentTestingExporterAccess;\n\n\nimport static io.opentelemetry.api.common.AttributeKey.stringKey;\n\n\nimport io.opentelemetry.sdk.trace.data.StatusData;\n\n\npublic class MainTest {\n    @Test\n    public void testHello() {\n        AgentTestingExporterAccess.reset();\n        Main.hello(); // This a function that creates a span\n        var spans = AgentTestingExporterAccess.getExportedSpans();\n        assertEquals(spans.get(0).getName(), &quot;hello&quot;);\n        assertEquals(spans.get(0).getKind(), SpanKind.INTERNAL);\n        assertEquals(spans.get(0).getStatus(), StatusData.unset());\n        assertEquals(spans.get(0).getAttributes().get(stringKey(&quot;service.name&quot;)), &quot;search&quot;);\n    }\n}\n</code></pre>\n<p>Please note that to be able to use <code>AgentTestingExporterAccess</code>, you need to run your tests with the javaagent too. If the java agent is not attached when running the tests, you will get an exception from <code>AgentTestingExporterAccess</code> like this:</p>\n<pre><code>java.lang.AssertionError: Error accessing fields with reflection.\n...\nCaused by: java.lang.NullPointerException\n...\n</code></pre>\n<p>Another way of doing this is to write a mock server and capture the spans. Opentelemetry has an example <a href=\"https://github.com/open-telemetry/opentelemetry-java-docs/blob/cef845752aa39ead1eb23223420c3b58d1874907/telemetry-testing/src/test/java/io/opentelemetry/example/telemetry/ApplicationTest.java\" rel=\"nofollow noreferrer\">here</a></p>\n"}],"owner":{"user_id":3975633,"display_name":"samad montazeri"},"view_count":135,"up_vote_count":2,"accepted_answer_id":75555118,"answer_count":1,"score":2,"creation_date":1677183102,"question_id":75549857,"body":"<p>I have added opentelemetry <strong>javaagent</strong> to a project and used it to instrument the project. Is there a way to test the instrumentation(for example created spans) in the unit tests?</p>\n<p>Lets say this is my whole project code:</p>\n<pre><code>public class Main {\n    public static void main(String[] args) {\n        System.out.println(hello());\n    }\n\n    @WithSpan(&quot;hello&quot;)\n    private static String hello() {\n        return &quot;Hello world!&quot;;\n    }\n}\n</code></pre>\n<p>How can I test that calling the <code>hello()</code> function creates a <code>hello</code> span?</p>\n"},{"tags":["java","file","sha256"],"comments":[{"owner":{"user_id":466862,"display_name":"Mark Rotteveel"},"edited":false,"comment_id":133288391,"body":"This has nothing to do with Java using signed bytes instead of unsigned bytes... That said, please specify what this <code>DigestUtils</code> class is. The problems is that a digest returns bytes, while your test.sha256 contains hex encoded bytes. You either need to encode the output of <code>digest</code> as hex or decode the contents of test.sha256 from hex to bytes (e.g. using Java 17 and higher <code>HexFormat</code>)"},{"owner":{"user_id":13553379,"display_name":"ojacomarket"},"edited":false,"comment_id":133288435,"body":"@MarkRotteveel thanks for the quick response, that class <code>import org.apache.commons.codec.digest.DigestUtils</code>"},{"owner":{"user_id":466862,"display_name":"Mark Rotteveel"},"edited":false,"comment_id":133288516,"body":"Or use <code>DigestUtils.sha256Hex(...)</code>."},{"owner":{"user_id":466862,"display_name":"Mark Rotteveel"},"edited":false,"comment_id":133288569,"body":"That said, a text file that only has content <code>hello</code> (no whitespace or unprintable characters), does not have a SHA-256 of &quot;5891b5b522d5df086d0ff0b110fbd9d21bb4fc7163af34d08286a2e846f&zwnj;&#8203;6be03&quot;, the correct hash would be &quot;2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938&zwnj;&#8203;b9824&quot;"},{"owner":{"user_id":13553379,"display_name":"ojacomarket"},"edited":false,"comment_id":133288683,"body":"@MarkRotteveel that&#39;s  not correct, use <code>sha256sum data.txt</code> on Linux and will get the same I did"},{"owner":{"user_id":466862,"display_name":"Mark Rotteveel"},"edited":false,"comment_id":133288711,"body":"Never mind, the hash you have occurs when the file contains <code>hello\\n</code> (where \\n represent a linefeed)."}],"answers":[{"owner":{"user_id":466862,"display_name":"Mark Rotteveel"},"up_vote_count":3,"is_accepted":true,"creation_date":1677168620,"answer_id":75547402,"body":"<p>The problem you have is that the output of <code>DigestUtils.getDigest(&quot;SHA-256&quot;).digest(..)</code> is a byte array of the raw bytes of the digest, while your <code>test.sha256</code> file contains a hex encoded value.</p>\n<p>To address this problem, you'll need to encode the raw bytes to hex, for example using <code>HexFormat</code> (introduced in Java 17), or the <code>DigestUtil.sha256Hex(..)</code> method which will perform the digest and then produce a hex-encoded string.</p>\n<p>For example:</p>\n<pre><code>System.out.println(DigestUtils.sha256Hex(Files.readAllBytes(data)));\n</code></pre>\n<p>and</p>\n<pre><code>Objects.equals(\n        DigestUtils.sha256Hex(Files.readAllBytes(data)),\n        Files.readString(test.sha256));\n</code></pre>\n<p>Or, if you want to keep the hash parameterized and you cannot use <code>HexFormat</code> of Java 17:</p>\n<pre><code>Hex.encodeHexString(\n        DigestUtils.getDigest(&quot;SHA-256&quot;)\n                .digest(Files.readAllBytes(data)));\n</code></pre>\n<p>where <code>Hex</code> is <code>org.apache.commons.codec.binary.Hex</code>.</p>\n"}],"owner":{"user_id":13553379,"display_name":"ojacomarket"},"view_count":158,"up_vote_count":3,"accepted_answer_id":75547402,"answer_count":1,"score":2,"creation_date":1677166606,"question_id":75547015,"body":"<p>I have a file called <code>test.sha256</code>, which contains:</p>\n<pre><code>5891b5b522d5df086d0ff0b110fbd9d21bb4fc7163af34d08286a2e846f6be03\n</code></pre>\n<p>I have another file called <code>data.txt</code>, which contains:</p>\n<pre><code>hello\n</code></pre>\n<p>I know that when using <code>Files.readAllBytes(Path.of(data.txt));</code> the result is an array of <code>signed</code> bytes. However what if I should do following:</p>\n<ol>\n<li>Read <code>test.sha256</code>, which contains sha256 hash of <code>data.txt</code></li>\n<li>Read <code>data.txt</code> and create sha256 hash from that file</li>\n<li>Compare (1) and (2)</li>\n</ol>\n<p>Problem is that when I use:</p>\n<pre><code>DigestUtils.getDigest(&quot;SHA-256&quot;).digest(Files.readAllBytes(data.txt))\n</code></pre>\n<p>Result differs from the content of <code>test.sha256</code> file. And that is because Java cannot iterpret <code>unsigned</code> bytes using <code>Files.readAllBytes</code>, but can do that using <code>DigestUtils.getDigest().digest</code>.</p>\n<p>Note though, that &quot;SHA-256&quot; is configurable, i.e I don't hardcode it in real code (it is passed as an argument to the method).</p>\n<p>My question is how I can compare hash &quot;A&quot; that has been red from a file and the hash that is generated from a data of file &quot;B&quot; ? Where &quot;A&quot; is the actual hash of &quot;B&quot;.</p>\n<p>UPD: I confirm that they differ:</p>\n<pre><code>Arrays.equals(DigestUtils.sha256(Files.readAllBytes(data.txt)), Files.readAllBytes(test.sha256));\n</code></pre>\n<p>Java class being used: <code>import org.apache.commons.codec.digest.DigestUtils</code></p>\n"},{"tags":["java","apache-poi","docx4j","aspose.words"],"answers":[{"owner":{"user_id":3915431,"display_name":"Axel Richter"},"up_vote_count":2,"is_accepted":false,"creation_date":1677153838,"answer_id":75544587,"body":"<p>There is a reason that you did not find methods to get line numbers and/or division into pages of a Word document. The reason is that this is not possible without rendering the Word document.</p>\n<p>A Word document body consists of a stream of body elements, such as paragraphs, tables, pictures, diagrams, ... Technically there is no page concept in a Word document. Microsoft Word creates pages on the fly while rendering. The same is for text lines. Microsoft Word reformats line breaks on the fly while rendering.</p>\n<p>One body element follows the element before it. How much height a body element claims depends on multiple factors, such as font family, font size, margins, paddings, vertical indents, special height settings, ... . Therefore, without rendering one cannot know how much vertical space a body element needs and whether a page is full.</p>\n<p>The same is for text lines. How much width a body element claims depends on multiple factors, such as font family, font size, margins, paddings, horizontal indents, special width settings, ... . Therefore, without rendering one cannot know how much space a body element needs and whether the right page margin is reached to make a line break necessary.</p>\n<p>There may be explicit page breaks set and there may be explicit line breaks set. However, that is not necessary and so one cannot rely on those as there may be automatic line breaks and automatic page breaks too, dependent on the rendering.</p>\n<p>Microsoft Word normally marks page breaks when a document was rendered and saved then. However, this also is nothing what I would rely on for a <code>*.docx</code> as it could have been created using other word-processing applications, which don’t do so.</p>\n<p>Apache POI is not internally rendering Word documents. So no chance using this library.</p>\n<p>At least Aspose.Words should have an internally rendering engine and so be able to get at least pages. At least it claims so. However, I do not know much about Aspose code.</p>\n"},{"owner":{"user_id":8356224,"display_name":"Alexey Noskov"},"up_vote_count":1,"is_accepted":true,"creation_date":1677153949,"answer_id":75544609,"body":"<p>MS Word documents are flow documents and does not contain any information about document layout. The consumer applications like MS Word or Open Office build the document layout on the fly.\nAspose.Words has it’s own document layout engine. The facade classes <a href=\"https://reference.aspose.com/words/java/com.aspose.words/layoutcollector/\" rel=\"nofollow noreferrer\">LayoutCollector</a> and <a href=\"https://reference.aspose.com/words/java/com.aspose.words/layoutenumerator/\" rel=\"nofollow noreferrer\">LayoutEnumerator</a> allows to get layout information of document elements.\nFor example to determine page index where a particular node starts or ends you can use <code>LayoutCollector.getStartPageIndex</code> and <code>LayoutCollector.getEndPageIndex</code> correspondingly:</p>\n<pre class=\"lang-java prettyprint-override\"><code>Document doc = new Document(&quot;C:\\\\Temp\\\\in.docx&quot;);\nLayoutCollector collector = new LayoutCollector(doc);\n// Get some node, for example the first paragraph is in the document.\nParagraph para = doc.getFirstSection().getBody().getFirstParagraph();\nSystem.out.println(&quot;Paragraph starts on &quot; + collector.getStartPageIndex(para) + &quot; page.&quot;);\n</code></pre>\n<p>See <a href=\"https://github.com/aspose-words/Aspose.Words-for-Java/blob/68f7247689a95fdea86f766df2989c3657188aa7/Examples/ApiExamples/Java/src/main/java/Examples/ExLayout.java\" rel=\"nofollow noreferrer\">Aspose.Words for Java GitHub</a> for more code examples</p>\n"}],"owner":{"user_id":20622284,"display_name":"lemon chow"},"view_count":89,"up_vote_count":3,"accepted_answer_id":75544609,"answer_count":2,"score":2,"creation_date":1677145960,"question_id":75543134,"body":"<p>I am looking for a library in java that can read all data from a word document element by element including paragraph,tables, charts, images and comments etc. and having the track of current page number and line number where the element is starting using inbuit methods. i tried with apache-poi, aspose and docx4j.I didn't find any such methods to get line number. if there are any please let me know</p>\n"},{"tags":["java"],"comments":[{"owner":{"user_id":20896122,"display_name":"undefined symbol"},"edited":false,"comment_id":133204590,"body":"What prevents the loop from running? That determines a strategy for detecting that it&#39;s not.  You don&#39;t want to add a detection mehanism that&#39;s more likely to get stuck than the loop is..."},{"owner":{"user_id":2702249,"display_name":"Om Sao"},"edited":false,"comment_id":133204600,"body":"I already have several catch logics and handling as per the exceptions. Still once in couple of days, polling stops with new error. I want to know when polling stopped, so that I quickly read the logs for errors, otherwise the error reasons are lost in tonnes of cloud logs."},{"owner":{"user_id":2873875,"display_name":"Gokhan Dilek"},"edited":false,"comment_id":133204633,"body":"Are you able to provide the rest of the logic inside the for loop try/catch block?"},{"owner":{"user_id":29470,"display_name":"Tim Moore"},"edited":false,"comment_id":133204663,"body":"Why not alert on an unhandled exception?"}],"answers":[{"owner":{"user_id":183406,"display_name":"meriton"},"up_vote_count":3,"is_accepted":false,"creation_date":1676775532,"answer_id":75497732,"body":"<p>There are two different reasons why polling stops making progress, and each needs a different approach:</p>\n<p>If the logic throws a <code>Throwable</code> other than an <code>Exception</code>, for instance an <code>Error</code>, the catch does not match, and execution will leave the for-loop, and likely reach the thread's <code>UncaughtExceptionHandler</code>, the default implementation of which logs the exception to <code>System.err</code> and terminates the thread. To prevent this, you should catch <code>Throwable</code> rather than <code>Exception</code>.</p>\n<p>The second possibility is that some step in your logic doesn't terminate, for instance due to an infinite loop, a deadlock, waiting for I/O operations, or whatever. In this case, you'll want to take a thread dump to see where the thread is stuck. You can automate this as follows:</p>\n<pre><code>class Watchdog {\n    final Duration gracePeriod;\n    final Thread watchedThread;\n    volatile Instant lastProgress;\n\n    public Watchdog(Duration gracePeriod) {\n        this.gracePeriod = gracePeriod;\n        watchedThread = Thread.currentThread();\n        everythingIsFine();\n        \n        var t = new Thread(this::keepWatch);\n        t.setDaemon(true);\n        t.start();\n    }\n    \n    public void everythingIsFine() {\n        lastProgress = Instant.now();\n    }\n    \n    void keepWatch() {\n        while (true) {\n            var silence = Duration.between(lastProgress, Instant.now());\n            if (silence.compareTo(gracePeriod) &gt; 0) {\n                System.err.println(&quot;Watchdog hasn't seen any progress for &quot; + silence.toSeconds() + &quot; seconds. The watched thread is currently at:&quot;);\n                for (var element : watchedThread.getStackTrace()) {\n                    System.err.println(&quot;\\tat &quot; + element);\n                }\n            }\n            try {\n                Thread.sleep(gracePeriod);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }\n    }\n}\n</code></pre>\n<p>while you can use as follows:</p>\n<pre><code>public class Test {\n    void step() throws Exception {\n        System.in.read();\n    }\n    \n    void job() {\n        var snoopy = new Watchdog(Duration.ofSeconds(2));\n        for (;;) {\n            try {\n                step();\n                snoopy.everythingIsFine();\n                Thread.sleep(1000);\n            } catch (Throwable t) {\n                System.err.println(t);\n            }\n        }\n    }\n    \n    public static void main(String[] args) throws Exception {\n        new Test().job();\n    }\n}\n</code></pre>\n<p>once the grace period elapses, the WatchDog will print something like:</p>\n<pre>\nWatchdog hasn't seen any progress for 2 seconds. The watched thread is currently at:\n    at java.base/java.io.FileInputStream.readBytes(Native Method)\n    at java.base/java.io.FileInputStream.read(FileInputStream.java:293)\n    at java.base/java.io.BufferedInputStream.fill(BufferedInputStream.java:255)\n    at java.base/java.io.BufferedInputStream.implRead(BufferedInputStream.java:289)\n    at java.base/java.io.BufferedInputStream.read(BufferedInputStream.java:276)\n    at stackoverflow.Test.step(Test.java:48)\n    at stackoverflow.Test.job(Test.java:55)\n    at stackoverflow.Test.main(Test.java:65)\n</pre>\n"}],"owner":{"user_id":2702249,"display_name":"Om Sao"},"view_count":81,"up_vote_count":2,"answer_count":1,"score":2,"creation_date":1676771251,"question_id":75497509,"body":"<p>I have a message stream, where messages comes which I need to process and then store them in database. In Java, I've written polling code which polls stream and consumes messages every 20 seconds.</p>\n<p>This is done inside an infinite for-loop, like below:</p>\n<pre><code>for (;;) {\n    try{\n        //1. Logic for polling.\n        //2. Logic for processing the message.\n        //3. Logic for storing the message in database.\n        Thread.sleep(20000 - &lt;time taken for above 3 steps &gt;); \n    } catch(Exception E){\n        //4. Exception handling.\n    }\n}\n</code></pre>\n<p>This logic runs as expected and the stream is polled, but once in a while it hits an exception or something goes wrong and polling stops.</p>\n<p>I want to have a mechanism, that as soon as polling stopped, let's say this <code>for</code> loop is not running for 60 seconds, I should receive a mail or ping.</p>\n<p>How can I invoke a method if this for loop is not running for 60 seconds?</p>\n<p>I am thinking like, each for-loop execution will ping a heartbeat, and when that heartbeat pinging not received from for-loop then a mail sending is invoked.</p>\n"},{"tags":["java","spring","spring-boot","zipkin","micrometer-tracing"],"answers":[{"owner":{"user_id":2595499,"display_name":"lzafra"},"up_vote_count":2,"is_accepted":true,"creation_date":1677138810,"answer_id":75541942,"body":"<p>Maybe by setting <a href=\"https://docs.spring.io/spring-boot/docs/current/reference/html/application-properties.html#application-properties.actuator.management.tracing.sampling.probability\" rel=\"nofollow noreferrer\">this property</a> to 0.0?</p>\n<pre><code>management.tracing.sampling.probability: 0.0\n</code></pre>\n"},{"owner":{"user_id":3549589,"display_name":"vivek_vara"},"up_vote_count":1,"is_accepted":false,"creation_date":1679141620,"answer_id":75775822,"body":"<p>This seems to be removed in Spring Boot 3 with Micrometer. It was used to be available in spring-cloud-sleuth.</p>\n<p>Anyone see any other alternative?</p>\n"}],"owner":{"user_id":10674026,"display_name":"pero_hero"},"view_count":432,"up_vote_count":2,"accepted_answer_id":75541942,"answer_count":2,"score":2,"creation_date":1676561988,"question_id":75474597,"body":"<p>In spring boot 2 it was possible to disable distributed tracing during development as described <a href=\"https://stackoverflow.com/a/56529683/10674026\">here</a>. Locally, traces were still generated but not exported.</p>\n<p>In spring boot 3 it is possible it <strong>disable tracing at all</strong> with:</p>\n<pre><code>     management.tracing.enabled=false\n</code></pre>\n<p><strong>How can I disable the zipkin reporter or distributed tracing in spring boot 3 but keep local tracing on?</strong></p>\n"},{"tags":["java","javafx","linechart","javafx-css"],"comments":[{"owner":{"user_id":6395627,"display_name":"Slaw"},"edited":false,"comment_id":133113621,"body":"Set the color <a href=\"https://openjfx.io/javadoc/19/javafx.graphics/javafx/scene/doc-files/cssref.html#linechart\" rel=\"nofollow noreferrer\">via CSS</a>. To target a specific chart, give the chart an ID."},{"owner":{"user_id":9504633,"display_name":"DVN-Anakin"},"edited":false,"comment_id":133113631,"body":"Depends on the version of JavaFX, the preferable way is to use CSS"},{"owner":{"user_id":19056337,"display_name":"Wewius"},"edited":false,"comment_id":133113676,"body":"@Slaw Thank you. This looks promising and I already have a CSS file but I&#39;m not sure how to implement/use these style classes to get what I want. <code>chart-series-line series&lt;i&gt; default-color&lt;j&gt;</code> seems to only change what series gets what default color. This would lead to the first series of each Line Chart still getting the same color, would it not?"},{"owner":{"user_id":1155209,"display_name":"jewelsea"},"edited":false,"comment_id":133114086,"body":"Oracle have an <a href=\"https://docs.oracle.com/javafx/2/charts/css-styles.htm\" rel=\"nofollow noreferrer\">old tutorial for styling charts</a>.  It might be a bit out of date, but still mostly relevant."}],"answers":[{"owner":{"user_id":6395627,"display_name":"Slaw"},"up_vote_count":3,"is_accepted":true,"creation_date":1676343921,"answer_id":75443099,"body":"<p>The <a href=\"https://openjfx.io/javadoc/19/javafx.graphics/javafx/scene/doc-files/cssref.html#linechart\" rel=\"nofollow noreferrer\">JavaFX CSS Reference Guide</a> says the following for <code>LineChart</code>:</p>\n<blockquote>\n<div class=\"s-table-container\">\n<table class=\"s-table\">\n<thead>\n<tr>\n<th>Style class</th>\n<th>Comments</th>\n<th>Properties</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>&quot;chart-series-line series&lt;i&gt; default-color&lt;j&gt;&quot;</code></td>\n<td>Where <code>&lt;i&gt;</code> is the index of the series and <code>&lt;j&gt;</code> is the series’ color index</td>\n<td><code>Node</code></td>\n</tr>\n<tr>\n<td><code>&quot;chart-line-symbol series&lt;i&gt; data&lt;j&gt; default-color&lt;k&gt;&quot;</code></td>\n<td>Where <code>&lt;i&gt;</code> is the index of the series, <code>&lt;j&gt;</code> is the index of the data within the series, and <code>&lt;k&gt;</code> is the series’ color index</td>\n<td><code>Node</code></td>\n</tr>\n<tr>\n<td><code>&quot;chart-line-symbol series&lt;i&gt; default-color&lt;j&gt;&quot;</code></td>\n<td>Where <code>&lt;i&gt;</code> is the index of the series and <code>&lt;j&gt;</code> is the series’ color index</td>\n<td><code>LegendItem</code></td>\n</tr>\n</tbody>\n</table>\n</div></blockquote>\n<p><sup><em><strong>Note:</strong> Although the line is only documented as a <code>Node</code>, by default it is actually a <code>javafx.scene.shape.Path</code>.</em></sup></p>\n<p>If you want to target a specific series' line, use <code>.chart-series-line.series&lt;i&gt;</code>, where <code>&lt;i&gt;</code> is replaced with the index of the series in the chart's data. And if you want to give a series of a <em>specific chart</em> a certain color, then simply give the chart an ID and use that in the CSS selector.</p>\n<p>Here's an example. It uses so-called looked-up colors, which makes the CSS a little more scalable and organized. Also, they can have their values changed via the <code>setStyle</code> method in code, allowing you to dynamically change the color programmatically. Another approach for that is to use a &quot;data URL&quot;, showcased in <a href=\"https://stackoverflow.com/a/74074598/1155209\">this other Stack Overflow answer</a>.</p>\n<p><strong>style.css</strong>:</p>\n<pre class=\"lang-css prettyprint-override\"><code>/*\n * The '-fx-stroke' is used to set the color of the line. The line is\n * targeted by the '.chart-series-line.series&lt;i&gt;' selectors.\n *\n * The '-fx-background-color' is used to set the color of the legend\n * symbol so it matches the line. This would also color the symbols\n * on the line if they were shown. These symbol nodes are targeted\n * by the '.chart-line-symbol.series&lt;i&gt;' selectors.\n *\n * Both the '-fx-series0-color' and '-fx-series1-color' &quot;properties&quot;\n * are looked-up colors. You can change the value of a looked-up color\n * in code by calling 'setStyle(...)' on the appropriate node.\n */\n\n #firstChart {\n    -fx-series0-color: magenta;\n    -fx-series1-color: dodgerblue;\n }\n\n#secondChart {\n    -fx-series0-color: red;\n    -fx-series1-color: black;\n}\n\n#firstChart .chart-series-line.series0,\n#firstChart .chart-line-symbol.series0 {\n    -fx-stroke: -fx-series0-color;\n    -fx-background-color: -fx-series0-color;\n}\n\n#firstChart .chart-series-line.series1,\n#firstChart .chart-line-symbol.series1 {\n    -fx-stroke: -fx-series1-color;\n    -fx-background-color: -fx-series1-color;\n}\n\n#secondChart .chart-series-line.series0,\n#secondChart .chart-line-symbol.series0 {\n    -fx-stroke: -fx-series0-color;\n    -fx-background-color: -fx-series0-color;\n}\n\n#secondChart .chart-series-line.series1,\n#secondChart .chart-line-symbol.series1 {\n    -fx-stroke: -fx-series1-color;\n    -fx-background-color: -fx-series1-color;\n}\n</code></pre>\n<p><strong>Main.java</strong>:</p>\n<pre class=\"lang-java prettyprint-override\"><code>import java.util.function.UnaryOperator;\nimport javafx.application.Application;\nimport javafx.geometry.Insets;\nimport javafx.scene.Scene;\nimport javafx.scene.chart.LineChart;\nimport javafx.scene.chart.NumberAxis;\nimport javafx.scene.chart.XYChart;\nimport javafx.scene.layout.VBox;\nimport javafx.stage.Stage;\n\npublic class Main extends Application {\n\n    @Override\n    public void start(Stage primaryStage) {\n        var chart1 = createLineChart(&quot;Chart 1&quot;);\n        chart1.setId(&quot;firstChart&quot;);\n        chart1.getData().add(createSeries(&quot;f(x) = x&quot;, x -&gt; x));\n        chart1.getData().add(createSeries(&quot;f(x) = 2x&quot;, x -&gt; 2 * x));\n\n        /*\n         * Uncomment the line of code below to demonstrate dynamically changing\n         * the value of a looked-up color.\n         */\n        // chart1.setStyle(&quot;-fx-series0-color: goldenrod;&quot;);\n\n        var chart2 = createLineChart(&quot;Chart 2&quot;);\n        chart2.setId(&quot;secondChart&quot;);\n        chart2.getData().add(createSeries(&quot;f(x) = x^2&quot;, x -&gt; x * x));\n        chart2.getData().add(createSeries(&quot;f(x) = x^3&quot;, x -&gt; x * x * x));\n\n        var root = new VBox(10, chart1, chart2);\n        root.setPadding(new Insets(10));\n\n        primaryStage.setScene(new Scene(root, 1000, 720));\n        primaryStage.getScene()\n                .getStylesheets()\n                .add(Main.class.getResource(&quot;/style.css&quot;).toString());\n        primaryStage.show();\n    }\n\n    private LineChart&lt;Number, Number&gt; createLineChart(String title) {\n        var chart = new LineChart&lt;&gt;(new NumberAxis(), new NumberAxis());\n        chart.setTitle(title);\n        chart.getXAxis().setLabel(&quot;x&quot;);\n        chart.getYAxis().setLabel(&quot;f(x)&quot;);\n        chart.setCreateSymbols(false);\n        return chart;\n    }\n\n    private XYChart.Series&lt;Number, Number&gt; createSeries(\n            String name, \n            UnaryOperator&lt;Double&gt; func) {\n        var series = new XYChart.Series&lt;Number, Number&gt;();\n        series.setName(name);\n\n        for (int x = 0; x &lt; 20; x++) {\n            series.getData().add(new XYChart.Data&lt;&gt;(x, func.apply((double) x)));\n        }\n\n        return series;\n    }\n\n}\n</code></pre>\n"}],"owner":{"user_id":19056337,"display_name":"Wewius"},"view_count":84,"up_vote_count":2,"accepted_answer_id":75443099,"answer_count":1,"score":2,"creation_date":1676339453,"question_id":75442777,"body":"<p>I have an application that displays several Line Charts with several Series like this:</p>\n<p><a href=\"https://i.stack.imgur.com/LYe4Z.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LYe4Z.png\" alt=\"enter image description here\" /></a></p>\n<p>I'd like to change the color of each Series but haven't found a way to achieve this. The only thing I found is how to change the default colors but that doesn't solve my problem.</p>\n<p>Is there really now way to achieve individual colors for chart series?</p>\n"},{"tags":["java","sonarqube","jacoco","jacoco-maven-plugin","jacoco-plugin"],"comments":[{"owner":{"user_id":3143823,"display_name":"tm1701"},"edited":false,"comment_id":133005374,"body":"You asked me to check this one ... I don&#39;t know."},{"owner":{"user_id":1549977,"display_name":"Benjamin Marwell"},"edited":false,"comment_id":133027078,"body":"This q does not contain enough information why module1 does not contain coverage code. Please ask on the ASF Maven mailing lists. BTW, you can check if module1 has the correct parent."},{"owner":{"user_id":3548035,"display_name":"Lokesh Pandey"},"edited":false,"comment_id":133072717,"body":"@BenjaminMarwell I have double checked all the relative or absolute paths it&#39;s all correct. I am finding it all strange that for other modules it generating the coverage report but for only one module it&#39;s not generating."}],"answers":[{"owner":{"user_id":1563969,"display_name":"Sarang"},"up_vote_count":2,"is_accepted":true,"creation_date":1677071886,"answer_id":75533246,"body":"<p>Create one more module as ReportAggregator and move jacoco configuration from parent pom to ReportAggregator pom</p>\n"},{"owner":{"user_id":3548035,"display_name":"Lokesh Pandey"},"up_vote_count":1,"is_accepted":false,"creation_date":1677162552,"answer_id":75546189,"body":"<p>Thank you @Sarang for the response. It did resolve my problem, but after that I ran into one more issue and that is for one of my module it was not generating the jacoco.exec file. After some investigation it seems the problem was with <code>&lt;argLine&gt;</code> tag. In one of my module I was using this tag and somehow this was overridden.</p>\n<p>So what I did is I pre append the <code>argLine</code> before this and it resolve my issue</p>\n<pre><code>&lt;configuration&gt;\n    &lt;argLine&gt;${argLine} -XX:PermSize=256m -XX:MaxPermSize=1048m&lt;/argLine&gt;\n&lt;/configuration&gt;\n</code></pre>\n"},{"owner":{"user_id":7271622,"display_name":"Phạm Th&#224;nh Nam"},"up_vote_count":0,"is_accepted":false,"creation_date":1683863941,"answer_id":76233035,"body":"<p>You can try to merge unit test and instrument test from app module :</p>\n<pre><code>task jacocoUiTestReportAllModules(type: JacocoReport, dependsOn: ['testDebugUnitTest', 'createDebugCoverageReport']) {\n    group &quot;Reports&quot;\n    description &quot;Generate Jacoco Instrumented Tests coverage reports for all modules&quot;\n    reports {\n        xml.enabled = true\n        html.enabled = true\n        html.destination file(&quot;${rootProject.buildDir}/coverage-report&quot;)\n    }\n    def javaClasses = []\n    def kotlinClasses = []\n    def javaSrc = []\n    def kotlinSrc = []\n    def execution = []\n    def fileFilter = ['**/R.class', '**/R$*.class', '**/BuildConfig.*', '**/Manifest*.*', '**/*Test*.*', 'android/**/*.*']\n    rootProject.subprojects.each { proj -&gt;\n        javaClasses &lt;&lt; fileTree(dir: &quot;$proj.buildDir/intermediates/javac/debug&quot;, excludes: fileFilter)\n        kotlinClasses &lt;&lt; fileTree(dir: &quot;$proj.buildDir/tmp/kotlin-classes/debug&quot;, excludes: fileFilter)\n        javaSrc &lt;&lt; &quot;$proj.projectDir/src/main/java&quot;\n        kotlinSrc &lt;&lt; &quot;$proj.projectDir/src/main/kotlin&quot;\n        execution &lt;&lt; fileTree(dir: proj.buildDir, includes: [    'jacoco/testDebugUnitTest.exec',\n                'outputs/code_coverage/debugAndroidTest/connected/**/*.ec'])\n    }\n    getSourceDirectories().setFrom(files([javaSrc, kotlinSrc]))\n    getClassDirectories().setFrom(files([javaClasses, kotlinClasses]))\n    getExecutionData().setFrom(execution)\n\n    doLast() {\n        print &quot;file://${reports.html.destination}/index.html&quot;\n\n    }\n}\n</code></pre>\n"}],"owner":{"user_id":3548035,"display_name":"Lokesh Pandey"},"view_count":340,"up_vote_count":2,"accepted_answer_id":75533246,"answer_count":3,"score":2,"creation_date":1675781928,"question_id":75375132,"body":"<p>There is something strange going on with my jacoco configuration and I am not able to figure it out. I have visited multiple threads on stack overflow and other platforms and tried many thing, but didn't resolve this issue.</p>\n<p>I have setup the java code coverage for multiple modules. This is my project structure</p>\n<ul>\n<li><p>ABC</p>\n<ul>\n<li>module1</li>\n</ul>\n</li>\n<li><p>DEF</p>\n<ul>\n<li>module1</li>\n<li>module2</li>\n<li>module3</li>\n</ul>\n<p>pom.xml</p>\n</li>\n</ul>\n<p>I have configured the jacoco for my DEF maven project. I am only configuring my DEF project. And this is what pom.xml contains</p>\n<pre><code>    &lt;plugin&gt;\n        &lt;groupId&gt;org.jacoco&lt;/groupId&gt;\n        &lt;artifactId&gt;jacoco-maven-plugin&lt;/artifactId&gt;\n        &lt;version&gt;0.8.8&lt;/version&gt;\n        &lt;executions&gt;\n            &lt;execution&gt;\n                &lt;goals&gt;\n                    &lt;goal&gt;prepare-agent&lt;/goal&gt;\n                &lt;/goals&gt;\n            &lt;/execution&gt;\n            &lt;execution&gt;\n                &lt;id&gt;report&lt;/id&gt;\n                &lt;phase&gt;prepare-package&lt;/phase&gt;\n                &lt;goals&gt;\n                    &lt;goal&gt;report-aggregate&lt;/goal&gt;\n                &lt;/goals&gt;\n                &lt;configuration&gt;\n                 &lt;outputDirectory&gt;${project.basedir}/target/reports&lt;/outputDirectory&gt;\n                &lt;/configuration&gt;\n                &lt;/execution&gt;\n        &lt;/executions&gt;\n    &lt;/plugin&gt;\n</code></pre>\n<p><b>Issue:</b> The issue here is, it's generating the code coverage report in each module1, module2 and module3. But the report generated in module1, doesn't contains the code coverage for itself. Meaning, it shows the code coverage for module2 and module3, but it doesn't include module1 report in itself. I don't know what's wrong ?</p>\n<p><b>EDIT :</b> modules in DEF are maven modules and it didn't contains anything related to jacoco.</p>\n<p>Any idea or any suggestions ?</p>\n<p>Thanks</p>\n"},{"tags":["java","json","jackson"],"comments":[{"owner":{"user_id":10671013,"display_name":"Tan Yu Hau Sean"},"edited":false,"comment_id":132936744,"body":"what annotations did you try?"},{"owner":{"user_id":772883,"display_name":"No3x"},"edited":false,"comment_id":132936877,"body":"<code>@JsonFormat(shape=JsonFormat.Shape.ARRAY)</code>, <code>@JsonValue</code>, <code>@JsonProperty</code> without change"},{"owner":{"user_id":14183092,"display_name":"kerbermeister"},"edited":false,"comment_id":132937370,"body":"have you tried this? <a href=\"https://stackoverflow.com/questions/69846490/how-to-fix-error-start-array-token-when-deserializing-json-with-modelmapper\" title=\"how to fix error start array token when deserializing json with modelmapper\">stackoverflow.com/questions/69846490/&hellip;</a>"},{"owner":{"user_id":10671013,"display_name":"Tan Yu Hau Sean"},"edited":false,"comment_id":132937550,"body":"thanks for pointing us in the right direction kerbermeister, all the searches i was making either didnt have a solution or was using custom deserializer and was quite convoluted"},{"owner":{"user_id":772883,"display_name":"No3x"},"edited":false,"comment_id":132937610,"body":"@kerbermeister I also tried <code>@JsonCreator</code> but it did not work. Now I tried again on my non-corporate machine and it works! Maybe there is a difference in the versions. Please post it as answer."},{"owner":{"user_id":14183092,"display_name":"kerbermeister"},"edited":false,"comment_id":132937716,"body":"you&#39;re welcome, posted an answer, however, I agree it depends on the version of jackson you&#39;re using"},{"owner":{"user_id":772883,"display_name":"No3x"},"edited":false,"comment_id":132937746,"body":"@kerbermeister so i might not able to use this approach because I&#39;m tied to the platform versions in corporate field. Maybe someone knows an alternative to <code>@JsonCreator</code>?"},{"owner":{"user_id":14183092,"display_name":"kerbermeister"},"edited":false,"comment_id":132937832,"body":"I&#39;ll try to research this"},{"owner":{"user_id":772883,"display_name":"No3x"},"edited":false,"comment_id":132938559,"body":"Seems to work on both machines/versions. Tested 2.13.4, 2.14.1"}],"answers":[{"owner":{"user_id":14183092,"display_name":"kerbermeister"},"up_vote_count":3,"is_accepted":true,"creation_date":1675445090,"answer_id":75339110,"body":"<p>Actually it is quite simple to serialize your models to the target json, but might be tricky to deserialize.</p>\n<p>So, the solution for deserialization in this case could be using <code>@JsonCreator</code> annotation from <code>com.fasterxml.jackson.annotation</code> package above constructor:</p>\n<pre><code>@Data\npublic class GetPersonsReponseDto {\n\n    public List&lt;Person&gt; persons;\n\n    @JsonCreator // use this annotation for deserialization on constructor\n    public GetPersonsReponseDto(List&lt;Person&gt; persons) {\n        this.persons = persons;\n    }\n\n    public GetPersonsReponseDto() {\n    }\n}\n</code></pre>\n<p>However, it might not work with some versions of jackson.</p>\n"}],"owner":{"user_id":772883,"display_name":"No3x"},"view_count":797,"up_vote_count":2,"accepted_answer_id":75339110,"answer_count":1,"score":2,"creation_date":1675440618,"question_id":75338290,"body":"<p>I have a Json response that looks like this:</p>\n<pre><code>[\n    { &quot;name&quot;:&quot;A&quot; },\n    { &quot;name&quot;:&quot;B&quot; }\n]\n</code></pre>\n<p>I have Java classes representing a single <code>ResponseDto</code> and contains a List of <code>Person</code>:</p>\n<pre><code>public class GetPersonsResponseDto {\n    public List&lt;Person&gt; persons;\n}\n\npublic class Person {\n    public String name;\n}\n</code></pre>\n<p>I would like to deserialize the by JSON using <code>ObjectMapper</code> but without use of a custom Deserializer and without collection type (no <code>Persons[].class</code> or <code>TypeReference&lt;List&lt;Person&gt;&gt;(){}</code>). What I really want is</p>\n<pre><code>ObjectMapper mapper = new ObjectMapper();\nmapper.readValue(in, GetPersonsResponseDto.class);\n</code></pre>\n<p>But I get:</p>\n<pre><code>jackson.map.JsonMappingException: \nCan not deserialize instance of com.project.my.GetPersonsResponseDto out of START_ARRAY token\n</code></pre>\n<p>I tried several Annotations but without success.</p>\n"},{"tags":["java","regex","split"],"comments":[{"owner":{"user_id":2636929,"display_name":"Stultuske"},"edited":false,"comment_id":132908033,"body":"can you provide a minimal reproducable example? The way the question is now, it is pretty hard to figure out what exactly problem you are having"}],"answers":[{"owner":{"user_id":548225,"display_name":"anubhava"},"up_vote_count":3,"is_accepted":true,"creation_date":1675334678,"answer_id":75321981,"body":"<p>In Java you can use this regex for splitting:</p>\n<pre class=\"lang-bash prettyprint-override\"><code>(?&lt;=\\s{1,99}[aA][sS]\\s{1,99}\\w{1,99})\\s*,\\s*\n</code></pre>\n<p>We are using finite range quantifiers <code>{1,99}</code> instead of just <code>+</code> here because Java regex engine doesn't allow dynamic length look behind assertions.</p>\n<p><a href=\"https://regex101.com/r/WpFIF3/2\" rel=\"nofollow noreferrer\">RegEx Demo</a></p>\n<p><strong>Java Code:</strong></p>\n<pre class=\"lang-bash prettyprint-override\"><code>String[] queryArray = internalQuery.split(\n   &quot;(?&lt;=\\\\s{1,99}[aA][aS]\\\\s{1,99}\\\\w{1,99})\\\\s*,\\\\s*&quot;);\n</code></pre>\n<p><strong>RegEx Breakdown:</strong></p>\n<ul>\n<li><code>(?&lt;=\\s{1,99}[aA][sS]\\s{1,99}\\w{1,99})</code>: Lookbehind assertion that makes sure that we have word <code>AS</code> (ignore case) surrounded with 1 to 99 whitespaces on either side followed by a 1+ (upto 99) word characters as alias name</li>\n<li><code>\\s*,\\s*</code>: Match a comma surrounded with 0 or more whitespaces on either side</li>\n</ul>\n"}],"owner":{"user_id":9639932,"display_name":"Animesh Panigrahi"},"view_count":94,"up_vote_count":2,"accepted_answer_id":75321981,"answer_count":1,"score":2,"creation_date":1675334001,"question_id":75321834,"body":"<p>I want to split a query by comma only if it is preceded by <code>AS</code>.</p>\n<p>A small part of My Query:</p>\n<pre><code>DATE_TRUNC('month', timestamp) AS month_begin_dt\n        ,   FIRST_VALUE(monitorsessionid) OVER(PARTITION BY openpsid,DATE_TRUNC('month', timestamp) ORDER BY timestamp DESC) AS monitorsessionid\n        ,   FIRST_VALUE(vrr) OVER(PARTITION BY openpsid,DATE_TRUNC('month', timestamp) ORDER BY timestamp DESC) AS vrr\n</code></pre>\n<p>I tried to split the query in java using the split() method with the following regular expression.</p>\n<pre><code>String[] queryArray = internalQuery.split(&quot;,(?![^\\\\(]*\\\\))&quot;);\n</code></pre>\n<p>I want my split array to have elements as:</p>\n<pre><code>[0] = DATE_TRUNC('month', timestamp) AS month_begin_dt\n\n[1] = FIRST_VALUE(monitorsessionid) OVER(PARTITION BY openpsid,DATE_TRUNC('month', timestamp) ORDER BY timestamp DESC) AS monitorsessionid\n\n[2] = FIRST_VALUE(vrr) OVER(PARTITION BY openpsid,DATE_TRUNC('month', timestamp) ORDER BY timestamp DESC) AS vrr\n</code></pre>\n<p><strong>The output I am getting in the queryArray is:</strong></p>\n<pre><code>[0] = DATE_TRUNC('month', timestamp) AS month_begin_dt\n\n[1] = FIRST_VALUE(monitorsessionid) OVER(PARTITION BY openpsid\n\n[2] = DATE_TRUNC('month', timestamp) ORDER BY timestamp DESC) AS monitorsessionid\n\n[3] = FIRST_VALUE(vrr) OVER(PARTITION BY openpsid\n\n[4] = DATE_TRUNC('month', timestamp) ORDER BY timestamp DESC) AS vrr\n</code></pre>\n<p><strong>The Desired Output in the queryArray</strong></p>\n<pre><code>[0] = DATE_TRUNC('month', timestamp) AS month_begin_dt\n\n[1] = FIRST_VALUE(monitorsessionid) OVER(PARTITION BY\nopenpsid,DATE_TRUNC('month', timestamp) ORDER BY timestamp DESC) AS monitorsessionid\n\n[2] = FIRST_VALUE(vrr) OVER(PARTITION BY openpsid,DATE_TRUNC('month', timestamp) ORDER BY timestamp DESC) AS vrr\n</code></pre>\n"},{"tags":["java","spring-boot","p-lang"],"comments":[{"owner":{"user_id":19839660,"display_name":"Iv&#225;n Larios"},"edited":false,"comment_id":132896817,"body":"Can you add an example of your controller class? I don&#39;t understand exactly what you refer to."},{"owner":{"user_id":5102878,"display_name":"Victoriia"},"edited":false,"comment_id":132897102,"body":"@Iv&#225;nLarios Added an example. Hope it clarifies the question"}],"answers":[{"owner":{"user_id":11713777,"display_name":"dariosicily"},"up_vote_count":2,"is_accepted":false,"creation_date":1675290649,"answer_id":75316883,"body":"<p>You can create a new <a href=\"https://fasterxml.github.io/jackson-databind/javadoc/2.14/com/fasterxml/jackson/databind/ObjectMapper.html\" rel=\"nofollow noreferrer\"><code>ObjectMapper</code></a> instance in your controller explicitly configuring  its <a href=\"https://fasterxml.github.io/jackson-databind/javadoc/2.14/com/fasterxml/jackson/databind/DeserializationFeature.html#FAIL_ON_IGNORED_PROPERTIES\" rel=\"nofollow noreferrer\"><code>DeserializationFeature#FAIL_ON_UNKNOWN_PROPERTIES</code></a> to the value <code>true</code> that will force the fail in the case of unknown properties inside the json in the post request body like below:</p>\n<pre><code>@PostMapping(value = &quot;/updateproduct&quot;)\npublic Product updateProduct(@RequestBody String productString) throws JsonProcessingException {\n    ObjectMapper objectMapper = new ObjectMapper();\n    objectMapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, true);\n    //it will fail in case of unknown properties inside the json string\n    Product product = objectMapper.readValue(productString, Product.class);\n    return product;\n}\n</code></pre>\n<p>Choosing to convert the request body json to <code>String</code> you can configure manually your <code>ObjectMapper</code> local instance while you have to decide how to proceed when there is a json processing exception (in my case I simply decided to directly throw the exception but a different behaviour can be adopted) or the <code>UnrecognizedPropertyException</code> exception like the case you presented.</p>\n<p><strong>EDIT:</strong>\nanswer the OP comment below</p>\n<blockquote>\n<p>But instead of receiving String and explicitly creating a\nobjectMapper, I would like to find a way to keep it Product and to\nsomehow tell Spring &quot;use this ObjectMapper bean for this specific\ncontroller&quot;.</p>\n</blockquote>\n<p>I am not aware if it is possible to do exactly what you want, but you can achieve something pretty similar: you can define a custom <code>ObjectMapper</code> bean in your configuration class so having a default primary bean and your custom bean:</p>\n<pre><code>@Configuration\npublic class ApplicationConfiguration {\n\n    @Bean\n    @Primary\n    public ObjectMapper objectMapper() {\n        return Jackson2ObjectMapperBuilder\n                .json()\n                .build();\n    }\n\n    @Bean(&quot;customObjectMapper&quot;)\n    public ObjectMapper getCustomObjectMapper() {\n        return Jackson2ObjectMapperBuilder\n                .json()\n                .build()\n                .configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, true);\n    }\n}\n</code></pre>\n<p>Then in the same controller you can refer both the two beans, so one method will end with success because it works with the default primary bean and the other one will fail:</p>\n<pre><code>@RestController\n@RequestMapping(&quot;/&quot;)\npublic class ExampleController {\n\n    //fine, it is using the default primary bean so it ignores\n    //unknown properties in the json \n    @PostMapping(value = &quot;/updateproduct&quot;)\n    public Product updateProduct(@RequestBody Product product) {\n        return product;\n    }\n\n    @Autowired\n    @Qualifier(&quot;customObjectMapper&quot;)\n    private ObjectMapper objectMapper;\n\n    //it is using the custom bean so it will fail \n    //with unknown properties in the json\n    @PostMapping(value = &quot;/updateproductfail&quot;)\n    public Product updateProductFail(@RequestBody String productString) throws JsonProcessingException {\n        Product product = objectMapper.readValue(productString, Product.class);\n        return product;\n    }\n}\n</code></pre>\n"},{"owner":{"user_id":19839660,"display_name":"Iv&#225;n Larios"},"up_vote_count":0,"is_accepted":false,"creation_date":1675326827,"answer_id":75320448,"body":"<p>To change this on project level, you can add on your application.properties the following content:</p>\n<pre><code>spring.jackson.deserialization.fail-on-unknown-properties=true\n</code></pre>\n<p>Or if you are using an application.yaml:</p>\n<pre><code>spring:\n  jackson:\n    deserialization:\n      fail-on-unknown-properties: true\n</code></pre>\n<p>This configuration will affect on project level, so you can keep using the correct DTO on the @RequestBody object received. This way, you don't have to do any change on your controller, but may be advisable to control the exception in your @ControllerAdvice.</p>\n"},{"owner":{"user_id":18195920,"display_name":"Yaron Holland"},"up_vote_count":1,"is_accepted":false,"creation_date":1676989662,"answer_id":75521858,"body":"<p>Add to the Product:</p>\n<pre><code>@JsonAnySetter\npublic Map&lt;String,Object&gt; unknownAttributes = new HashMap&lt;&gt;();\n</code></pre>\n<p>Then in the controller use:</p>\n<pre><code>if (!product.unknownAttributes.isEmpty()) {\n\n}\n</code></pre>\n"}],"owner":{"user_id":5102878,"display_name":"Victoriia"},"view_count":492,"up_vote_count":2,"answer_count":3,"score":2,"creation_date":1675278352,"question_id":75315022,"body":"<p>I have SpringBoot application X that has customer facing APIs. Those APIs receive request body as JSON.</p>\n<p>Application X issues API calls to application Y and receives responses with JSON body.</p>\n<p>I want to prevent application X from receiving unknown fields in the request body on customer-facing controllers.</p>\n<p>I was thinking about <code>spring.jackson.deserialization.fail-on-unknown-properties=true</code> but if I understand correctly such configuration will cause a failure also if a call from application X to application Y will return response body with unknown field. Therefore this configuration will make the API between application X and application Y more coupled and less robust.</p>\n<p><strong>I am looking for a way to enforce &quot;fail-on-unknown-fields&quot; only for deserialization of request body at customer facing controllers of an application while allowing deserialization at other parts of the application to ignore unknown fields</strong></p>\n<p>Example:\nI have the following customer facing API.</p>\n<pre><code>@PostMapping\npublic Response updateProduct(@RequestBody Product product) {\n.....\n}\n</code></pre>\n<p>Where</p>\n<pre><code>class Product {\n    private int id;\n    private String name;\n    private int price;\n}\n</code></pre>\n<p>I want to prevent customer from passing the following body to request, because colour is not a know field.</p>\n<pre><code>{\n  &quot;id&quot;: 777,\n  &quot;name&quot;: &quot;apple&quot;,\n  &quot;price&quot;: 2,\n  &quot;colour&quot;: &quot;red&quot;\n}\n</code></pre>\n<p>But -\nI want it the &quot;fail-unknown-fields&quot; to be enforced on this controller only and not at other places where Jackson is used to deserialized responses received from other applications.</p>\n"},{"tags":["java","windows","javafx","jpackage","java-19"],"comments":[{"owner":{"user_id":1155209,"display_name":"jewelsea"},"edited":false,"comment_id":132836589,"body":"Does it work without the argument<code>--vm=client</code>?"},{"owner":{"user_id":720236,"display_name":"Andrea Vacondio"},"edited":false,"comment_id":132843672,"body":"Yes it works. The generated runtime has a <code>server</code> directory and the application starts"},{"owner":{"user_id":4712734,"display_name":"DuncG"},"edited":false,"comment_id":132851955,"body":"Which jdk-19 are you using? That setting just gives an error message for me: <code>jlink --vm=client --add-modules java.base --output myruntime</code>."},{"owner":{"user_id":720236,"display_name":"Andrea Vacondio"},"edited":false,"comment_id":132863020,"body":"I&#39;m using Liberica and you are right, using Oracle jdk the <code>--vm=client</code> gives an error while without it it seems to default to the <code>server</code> value (lib subirectory only contains the server version). With Liberica, leaving the parameter out it generates <code>server</code>, <code>client</code> and <code>minimal</code>."}],"answers":[{"owner":{"user_id":1155209,"display_name":"jewelsea"},"up_vote_count":3,"is_accepted":true,"creation_date":1675107345,"answer_id":75289286,"body":"<p>Don't use the <code>jlink</code> option:</p>\n<pre><code>--vm=client\n</code></pre>\n<p>At least for Oracle JDK, and probably for other JDK distributions as well, the <a href=\"https://docs.oracle.com/javase/9/vm/java-virtual-machine-technology-overview.htm#JSJVM-GUID-982B244A-9B01-479A-8651-CB6475019281\" rel=\"nofollow noreferrer\">client VM is no longer part of the distribution</a>:</p>\n<blockquote>\n<p>In Oracle Java Runtime Environment (JRE) 8 and earlier, different implementations of the JVM, (the client VM, server VM, and minimal VM), were supported for configurations commonly used as clients, servers, and for embedded systems. As most systems can now take advantage of the server VM, the Oracle Java Runtime Environment (JRE) 9 provides only that VM implementation.</p>\n</blockquote>\n<p>The <a href=\"https://docs.oracle.com/en/java/javase/19/docs/specs/man/jlink.html#jlink-plug-ins\" rel=\"nofollow noreferrer\"><code>jlink</code></a> documentation states:</p>\n<blockquote>\n<p>Plug-ins not listed in this section aren't supported and are subject to change.</p>\n</blockquote>\n<p>The <code>vm</code> plugin isn't listed in the documentation, so it really should not be used.</p>\n"}],"owner":{"user_id":720236,"display_name":"Andrea Vacondio"},"view_count":96,"up_vote_count":2,"accepted_answer_id":75289286,"answer_count":1,"score":2,"creation_date":1675014242,"question_id":75277031,"body":"<p>I'm trying to generate the Windows bundle of my JavaFX application using JPackage. I'm running on Liberica JDK 19 and my scripts first generate a runtime using JLink with a <code>--vm=client</code> argument and then they run jpackage with a <code>--runtime-image</code> pointing to the generated image.</p>\n<p>Everything runs fine when I launch the application generated by jpackage using a .bat script, but when I run the the generated .exe I get an error and, looking at the debug information, it seems the .exe is loading the jvm.dll from the <code>runtime\\bin\\server</code> instead of the <code>runtime\\bin\\client</code> folder:</p>\n<pre class=\"lang-none prettyprint-override\"><code>[TRACE] app.cpp:123: Entering app::launch\n[TRACE] AppLauncher.cpp:116: Launcher config file path: &quot;C:\\delete\\pdfsam-5.0.0-SNAPSHOT-windows\\pdfsam\\app\\pdfsam.cfg&quot;\n[TRACE] JvmLauncher.cpp:44: Jvm(000001319907E960)::Jvm()\n[TRACE] AppLauncher.cpp:76: Property &quot;app.runtime&quot; not found in &quot;Application&quot; section of launcher config file. Using Java runtime from &quot;C:\\delete\\pdfsam-5.0.0-SNAPSHOT-windows\\pdfsam\\runtime&quot; directory\n[TRACE] JvmLauncher.cpp:49: Jvm(000001319907E960)::~Jvm()\n[TRACE] app.cpp:123: Entering app::launch\n[TRACE] AppLauncher.cpp:116: Launcher config file path: &quot;C:\\delete\\pdfsam-5.0.0-SNAPSHOT-windows\\pdfsam\\app\\pdfsam.cfg&quot;\n[TRACE] JvmLauncher.cpp:44: Jvm(00000200C91AE310)::Jvm()\n[TRACE] AppLauncher.cpp:76: Property &quot;app.runtime&quot; not found in &quot;Application&quot; section of launcher config file. Using Java runtime from &quot;C:\\delete\\pdfsam-5.0.0-SNAPSHOT-windows\\pdfsam\\runtime&quot; directory\n[TRACE] WinLauncher.cpp:216: SetDllDirectory to: C:\\delete\\pdfsam-5.0.0-SNAPSHOT-windows\\pdfsam\\runtime\\bin\n[TRACE] WinLauncher.cpp:73: Entering `anonymous-namespace'::loadDllWithAddDllDirectory\n[TRACE] WinLauncher.cpp:89: AddDllDirectory(C:\\delete\\pdfsam-5.0.0-SNAPSHOT-windows\\pdfsam\\runtime\\bin): OK\n[TRACE] WinLauncher.cpp:97: LoadLibraryEx(C:\\delete\\pdfsam-5.0.0-SNAPSHOT-windows\\pdfsam\\runtime\\bin\\jli.dll, LOAD_LIBRARY_SEARCH_DEFAULT_DIRS): 00007FFCCB100000\n[TRACE] WinLauncher.cpp:0: Exiting `anonymous-namespace'::loadDllWithAddDllDirectory (entered at WinLauncher.cpp:73)\n[TRACE] WinLauncher.cpp:73: Entering `anonymous-namespace'::loadDllWithAddDllDirectory\n[TRACE] WinLauncher.cpp:0: Exiting `anonymous-namespace'::loadDllWithAddDllDirectory (entered at WinLauncher.cpp:73)\n[TRACE] WinLauncher.cpp:52: Entering `anonymous-namespace'::loadDllWithAlteredPATH\n[TRACE] WinLauncher.cpp:62: New value of PATH: SOME PATH HERE;C:\\delete\\pdfsam-5.0.0-SNAPSHOT-windows\\pdfsam\\app;C:\\delete\\pdfsam-5.0.0-SNAPSHOT-windows\\pdfsam\\runtime\\bin\\server\n[TRACE] WinLauncher.cpp:0: Exiting `anonymous-namespace'::loadDllWithAlteredPATH (entered at WinLauncher.cpp:52)\n[TRACE] JvmLauncher.cpp:49: Jvm(00000200C91AE310)::~Jvm()\n[ERROR] app.cpp:179: Exception with message 'WinDll.cpp(40) at `anonymous-namespace'::loadLibrary(): LoadLibraryW(C:\\delete\\pdfsam-5.0.0-SNAPSHOT-windows\\pdfsam\\runtime\\bin\\server\\jvm.dll) failed. System error [126](system error 126 (Impossibile trovare il modulo specificato))' caught\nLoadLibraryW(C:\\delete\\pdfsam-5.0.0-SNAPSHOT-windows\\pdfsam\\runtime\\bin\\server\\jvm.dll) failed. System error [126](system error 126 (Impossibile trovare il modulo specificato))\n[TRACE] app.cpp:0: Exiting app::launch (entered at app.cpp:123)\n</code></pre>\n<p>Any idea what I might be doing wrong?</p>\n"},{"tags":["java","math","javafx"],"comments":[{"owner":{"user_id":1291492,"display_name":"ControlAltDel"},"edited":false,"comment_id":132805313,"body":"My honest recommendation to you would be not to do this in Java, and to find a good open source 3D game engine instead. Trying to do this in Java to me seems like an effort to frustrate one&#39;s self"},{"owner":{"user_id":1291492,"display_name":"ControlAltDel"},"edited":false,"comment_id":132805376,"body":"Oh and FYI, &quot;Flugzeug&quot; is one of my favorite German words :)"},{"owner":{"user_id":2423906,"display_name":"SedJ601"},"edited":false,"comment_id":132805573,"body":"I probably will not be of any help, but post your <code>pom.xml</code> and <code>Earth_diffuse_8k.png</code>. I was able to create the pom but the app did not run because I do not have the <code>png</code>."},{"owner":{"user_id":21094756,"display_name":"Lajos"},"edited":false,"comment_id":132805591,"body":"Yeah i know Java isn‘t a good Language for 3D Games, but i try to do as much as i can. Maybe my next Idea will be realized with Unity or something else."},{"owner":{"user_id":21094756,"display_name":"Lajos"},"edited":false,"comment_id":132805759,"body":"I don‘t have a pom.xml, i‘m programming with IntelliJ and only build a Starter Class for the Programm.  The Diffuse Map can be any Picture you wan‘t, it‘s only wrapping around the Sphere. I‘ve found the Earth Picture in Google.  <a href=\"https://www.h-schmidt.net/map/\" rel=\"nofollow noreferrer\">link</a> you can use this Map, if you downscale it."},{"owner":{"user_id":7587451,"display_name":"Giovanni Contreras"},"edited":false,"comment_id":132805828,"body":"do you want something like moon/earth   system ?"},{"owner":{"user_id":21094756,"display_name":"Lajos"},"edited":false,"comment_id":132806001,"body":"My Idea is an Airplane, flying around the Earth. But the Plane can also be a Satellite or Planet, i think its the same problem, if you want to manipulate the rotation by keyboard."},{"owner":{"user_id":1155209,"display_name":"jewelsea"},"edited":false,"comment_id":132813956,"body":"<i>”i‘ve never had matrix calculation”</i> -&gt; Time to <a href=\"https://moodle.cornellcollege.edu/pluginfile.php/47335/mod_resource/content/1/lect05_Transformations.pdf\" rel=\"nofollow noreferrer\">study</a>.  As noted by Giovanni,  there are many things in the API which provide these functions, for example Point3D, <a href=\"https://openjfx.io/javadoc/17/javafx.graphics/javafx/scene/transform/package-summary.html\" rel=\"nofollow noreferrer\">tranforms</a> and transition animations.  But it is best to understand the basic math and concepts."}],"answers":[{"owner":{"user_id":7587451,"display_name":"Giovanni Contreras"},"up_vote_count":3,"is_accepted":true,"creation_date":1674845626,"answer_id":75262251,"body":"<p><strong>Rotating a <code>Group</code>  inside another <code>Group</code> in 3d scene</strong></p>\n<p><a href=\"https://i.stack.imgur.com/MyPUg.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MyPUg.gif\" alt=\"rotating\" /></a></p>\n<p>In this approach  <code>Box</code> instance  doesn't seem to move 'cause it's moving with the camera . Camera and box are moving together because is it's <code>Group</code>  parent who is rotating with keyboard event . The <code>Sphere</code> node is in another group and is not affected . Sphere itself is rotating in Y axis</p>\n<p><strong>App.java</strong></p>\n<pre><code>public class App extends Application {\n\n    @Override\n    public void start(Stage stage) {\n\n        Shape3D sphere = new Sphere(10);\n\n        PhongMaterial mat = new PhongMaterial();\n        mat.setDiffuseMap(new Image(&quot;https://www.h-schmidt.net/map/map.jpg&quot;));\n        sphere.setMaterial(mat);\n\n        RotateTransition sphereRotation = new RotateTransition(Duration.seconds(40), sphere);\n        sphereRotation.setAxis(Rotate.Y_AXIS);\n        sphereRotation.setToAngle(360);\n        sphereRotation.setInterpolator(Interpolator.LINEAR);\n        sphereRotation.setCycleCount(Animation.INDEFINITE);\n        sphereRotation.play();\n\n        Shape3D box = new Box(2, 2, 2);\n        box.setMaterial(new PhongMaterial(Color.ORANGE));\n        box.setTranslateZ(-11);\n\n        PerspectiveCamera camera = new PerspectiveCamera(true);\n        camera.setTranslateZ(-30);\n\n        var planeGroup = new Group(box, camera);\n\n        Group sphereGroup = new Group(sphere);\n        Group group3d = new Group(planeGroup, sphereGroup);\n        Scene scene = new Scene(group3d, 640, 480, true, SceneAntialiasing.BALANCED);\n\n        scene.setOnKeyPressed((t) -&gt; {\n\n            if (t.getCode() == KeyCode.UP) {\n\n                Rotate r = new Rotate(-2);\n                r.setAxis(Rotate.X_AXIS);\n                planeGroup.getTransforms().add(r);\n\n            }\n            if (t.getCode() == KeyCode.LEFT) {\n\n                Rotate r = new Rotate(2);\n                r.setAxis(Rotate.Y_AXIS);\n                planeGroup.getTransforms().add(r);\n\n            }\n            if (t.getCode() == KeyCode.RIGHT) {\n\n                Rotate r = new Rotate(-2);\n                r.setAxis(Rotate.Y_AXIS);\n                planeGroup.getTransforms().add(r);\n\n            }\n            if (t.getCode() == KeyCode.DOWN) {\n\n                Rotate r = new Rotate(2);\n                r.setAxis(Rotate.X_AXIS);\n                planeGroup.getTransforms().add(r);\n\n            }\n\n        });\n\n        scene.setCamera(camera);\n        stage.setScene(scene);\n        stage.show();\n    }\n\n    public static void main(String[] args) {\n        launch();\n    }\n\n    }\n</code></pre>\n"}],"owner":{"user_id":21094756,"display_name":"Lajos"},"view_count":153,"up_vote_count":2,"accepted_answer_id":75262251,"answer_count":1,"score":2,"creation_date":1674837070,"question_id":75260841,"body":"<p>I have an object, like a box in this example.\nI want this box to move in a sine to the left on the sphere when the Z-axis is rotated. But after the box has made a curve, i.e. the rotation of the Z-axis is back to 0. The sphere no longer rotates downwards as it did at the start, but upwards to the right.</p>\n<pre><code>import javafx.animation.AnimationTimer;\nimport javafx.application.Application;\nimport javafx.scene.*;\nimport javafx.scene.image.Image;\nimport javafx.scene.paint.Color;\nimport javafx.scene.paint.PhongMaterial;\nimport javafx.scene.shape.Box;\nimport javafx.scene.shape.Sphere;\nimport javafx.scene.transform.*;\nimport javafx.stage.Stage;\nimport org.joml.Matrix4f;\nimport org.joml.Quaternionf;\n\nimport java.util.ArrayList;\n\npublic class TestFX extends Application {\n\n    public static final float WIDTH = 1400;\n    public static final float HEIGHT = 1000;\n\n    private final ArrayList&lt;String&gt; input = new ArrayList&lt;&gt;();\n\n    private final Sphere sphere = new Sphere(500);\n\n    public static void main(String[] args) {\n        launch(args);\n    }\n\n    @Override\n    public void start(Stage primaryStage) {\n        Flugzeug flieger = new Flugzeug(30, 30, 50);\n        flieger.setMaterial(new PhongMaterial(Color.GREEN));\n        flieger.setTranslateZ(330);\n        flieger.getTransforms().add(new Rotate(20, Rotate.X_AXIS));\n\n        sphere.translateZProperty().set(710);\n        sphere.translateYProperty().set(420);\n        PhongMaterial phongMaterial = new PhongMaterial();\n        phongMaterial.setDiffuseMap(new Image(getClass().getResourceAsStream(&quot;Earth_diffuse_8k.png&quot;)));\n        sphere.setMaterial(phongMaterial);\n\n        PerspectiveCamera camera = new PerspectiveCamera(true);\n        camera.setFarClip(40000);\n\n        Group root = new Group(flieger, sphere);\n\n        Scene scene = new Scene(root, WIDTH, HEIGHT, true);\n        scene.setCamera(camera);\n\n        primaryStage.setTitle(&quot;FliegenFX&quot;);\n        primaryStage.setScene(scene);\n        primaryStage.show();\n\n        new AnimationTimer() {\n            @Override\n            public void handle(long now) {\n                initGameLogic(flieger);\n                dreheErde(flieger, sphere);\n            }\n        }.start();\n\n        scene.setOnKeyPressed(event -&gt; {\n            String code = event.getCode().toString();\n            if (!input.contains(code))\n                input.add(code);\n        });\n\n        scene.setOnKeyReleased(event -&gt; {\n            String code = event.getCode().toString();\n            input.remove(code);\n        });\n    }\n\n    // TODO Erddrehung nach Drehung beibehalten\n\n    private void dreheErde(Flugzeug flieger, Sphere erde) {\n        double rotationFactor = 0.005;\n        double drehung = flieger.getDrehung() * rotationFactor;\n        double amplitude = 2;\n        double frequency = 0.001;\n        float angle = (float) (Math.sin(drehung * frequency) * amplitude);\n\n        Quaternionf quat = new Quaternionf();\n        Matrix4f matrix4f = new Matrix4f();\n        Affine affine = new Affine();\n\n        quat.rotateY(angle);\n        quat.rotateZ(angle);\n        quat.rotateX(-0.001f);\n\n        quat.normalize();\n        quat.get(matrix4f);\n        float[] matrixArray = new float[16];\n        matrix4f.get(matrixArray);\n        double[] matrix = new double[16];\n        for (int i = 0 ; i &lt; matrixArray.length; i++)\n        {\n            matrix[i] = matrixArray[i];\n        }\n\n        affine.append(matrix, MatrixType.MT_3D_4x4, 0);\n\n        erde.getTransforms().add(affine);\n    }\n\n    private void initGameLogic(Flugzeug flieger) {\n        if (input.contains(&quot;LEFT&quot;)) {\n            flieger.rotateByZ(-0.5);\n        }\n        if (input.contains(&quot;RIGHT&quot;)) {\n            flieger.rotateByZ(0.5);\n        }\n    }\n\n    private class Flugzeug extends Box{\n        private double drehung = 0;\n        private Rotate r;\n        private Transform t = new Rotate();\n\n        public Flugzeug(double width, double height, double depth){\n            super(width, height, depth);\n        }\n\n        public void rotateByZ(double ang){\n            drehung += ang;\n            r = new Rotate(ang, Rotate.Z_AXIS);\n            t = t.createConcatenation(r);\n            getTransforms().clear();\n            getTransforms().addAll(t);\n        }\n\n        public double getDrehung() {\n            return drehung;\n        }\n    }\n}\n\n</code></pre>\n<p>I have tried many different ways with trigonometry but they have not been successful. This was for example to move the X-axis of the sphere also according to the sine or to subtract the movements of the Y and Z axis of the sphere as cosine.</p>\n<p>I think it has to be transformed in a Rotation Matrix, but i‘ve never had matrix calculation.</p>\n"},{"tags":["java","android"],"comments":[{"owner":{"user_id":1631193,"display_name":"Gabe Sechan"},"edited":false,"comment_id":132748364,"body":"There is no such thing as running an unsigned APK-  Android won&#39;t run those.  Even debug APKs are signed, they&#39;re just signed by a key created by the IDE.  They&#39;re created only for users who want to separate the signing and compiling steps."},{"owner":{"user_id":1353621,"display_name":"fabiobh"},"edited":false,"comment_id":132771726,"body":"You are correct, the debug APK works perfectly. The APK that I sign with my own key is the one that didn&#39;t work properly."},{"owner":{"user_id":3050249,"display_name":"Miha_x64"},"edited":false,"comment_id":132789590,"body":"What&#39;s in your app-level build.gradle, do you have minifyEnabled or something else interesting?"},{"owner":{"user_id":12763954,"display_name":"Olivier"},"edited":false,"comment_id":132814996,"body":"According to the error, you are not <i>opening</i> a PDF. You are <i>generating</i> one. You should debug to figure out why the generated document is empty."}],"answers":[{"owner":{"user_id":4013399,"display_name":"Zac1"},"up_vote_count":3,"is_accepted":true,"creation_date":1674867225,"answer_id":75264677,"body":"<p><code>Proguard</code> could be one issue like you're speculating. It's hard to know based on the information you provided. But, here are things you can try;</p>\n<ol>\n<li><p>Disable Proguard: You can disable Proguard in your build.gradle file by removing the following line: minifyEnabled true</p>\n</li>\n<li><p>Configure Proguard: You can configure Proguard to keep the necessary code or resources by adding specific rules in the proguard-rules.pro file. For example, to keep the iText library that you are using to open the PDF file, you can add the following rule: -keep class com.itextpdf.** { *; }</p>\n</li>\n<li><p>Check the PDF file: The error message &quot;The document has no pages&quot; suggests that the app is trying to open an empty or invalid PDF file. Make sure that the PDF file that you are trying to open is not empty and is not corrupted.</p>\n</li>\n<li><p>Check the Permission: Make sure you have &quot;android.permission.INTERNET&quot; in your AndroidManifest.xml file.</p>\n</li>\n<li><p>Check the PDF reader library: Make sure you are using the right version of iText library and it is compatible with your android version.</p>\n</li>\n</ol>\n<p>The summary is that it depends on the specifics of your app and the PDF file that you are trying to open.</p>\n"},{"owner":{"user_id":9337248,"display_name":"Sagar Sah"},"up_vote_count":1,"is_accepted":false,"creation_date":1675356574,"answer_id":75326410,"body":"<p>Check below things may help.\n1.INTERNET PERMISSION\n2.check READ PERMISSION or add below code in manifest.</p>\n<pre><code>&lt;uses-permission\nandroid:name=&quot;android.permission.READ_EXTERNAL_STORAGE&quot;\nandroid:maxSdkVersion=&quot;32&quot; /&gt;\n</code></pre>\n"}],"owner":{"user_id":1353621,"display_name":"fabiobh"},"view_count":146,"up_vote_count":2,"accepted_answer_id":75264677,"answer_count":2,"score":2,"creation_date":1674591246,"question_id":75226819,"body":"<p>I use the code below to open a PDF file and it works perfectly if I distribute the APK file unsigned.</p>\n<p>Code: <a href=\"https://www.online-java.com/i5u7QPU9N4\" rel=\"nofollow noreferrer\">https://www.online-java.com/i5u7QPU9N4</a></p>\n<p>But if I sign the APK that I created using my Android Studio, the app crash with the following message:</p>\n<pre><code>Caused by: ExceptionConverter: java.io.IOException: The document has no pages.\n01-24 17:06:20.750 29758 29758 E AndroidRuntime: Caused by: java.io.IOException: The document has no pages.\n01-24 17:06:20.750 29758 29758 E AndroidRuntime:    at com.itextpdf.text.pdf.PdfPages.writePageTree(\n</code></pre>\n<p>Is it possible that something like Proguard was affecting the signed APK ? Or it can be other problem ?</p>\n<p>EDIT</p>\n<p>This is my app-level build.gradle file.</p>\n<p><a href=\"https://codebeautify.org/alleditor/y2356950e\" rel=\"nofollow noreferrer\">https://codebeautify.org/alleditor/y2356950e</a></p>\n<p>I have minifyEnabled, but it is declared false.</p>\n"},{"tags":["java","spring-boot","log4j2"],"comments":[{"owner":{"user_id":1413756,"display_name":"Dan"},"edited":false,"comment_id":132742236,"body":"Obvious question, but do you have the dependency on your classpath?  Have you confirmed?"},{"owner":{"user_id":12567365,"display_name":"andrewJames"},"edited":false,"comment_id":132743101,"body":"What happens if you remove the exclusion from your POM - the one for <code>spring-boot-starter-logging</code>? (I&#39;m not saying this will allow emails to be sent - but it should resolve the <code>NoClassDefFoundError</code> you are currently getting.)"}],"answers":[{"owner":{"user_id":2991440,"display_name":"krishnan"},"up_vote_count":1,"is_accepted":false,"creation_date":1674584631,"answer_id":75225696,"body":"<p>Try replacing</p>\n<pre><code>    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-mail&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n</code></pre>\n<p>with the following the dependencies</p>\n<pre><code>    &lt;dependency&gt;\n        &lt;groupId&gt;com.sun.mail&lt;/groupId&gt;\n        &lt;artifactId&gt;javax.mail&lt;/artifactId&gt;\n        &lt;version&gt;1.6.2&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;javax.activation&lt;/groupId&gt;\n        &lt;artifactId&gt;javax.activation-api&lt;/artifactId&gt;\n        &lt;version&gt;1.2.0&lt;/version&gt;\n        &lt;scope&gt;runtime&lt;/scope&gt;\n    &lt;/dependency&gt;\n</code></pre>\n"},{"owner":{"user_id":11748454,"display_name":"Piotr P. Karwasz"},"up_vote_count":3,"is_accepted":false,"creation_date":1674586709,"answer_id":75226055,"body":"<p>Your are facing one of the side-effects of the gap between Java EE 8 and Jakarta EE 9 (it's a very disruptive renaming of classes): Spring Boot 3.x contains an implementation of Jakarta Mail 2.0, while the SMTP appender in Log4j2 Core requires and implementation of Java Mail 1.6.</p>\n<p>To fill the gap, we published an alternative implementation of <a href=\"https://logging.apache.org/log4j/2.x/log4j-core/apidocs/org/apache/logging/log4j/core/net/MailManager.html\" rel=\"nofollow noreferrer\"><code>MailManager</code></a> (the engine behind the SMTP appender) in the <a href=\"https://mvnrepository.com/artifact/org.apache.logging.log4j/log4j-jakarta-smtp\" rel=\"nofollow noreferrer\"><code>log4j-jakarta-smtp</code></a> artifact. To use it, you just need to add it to your runtime classpath:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\n    &lt;artifactId&gt;log4j-jakarta-smtp&lt;/artifactId&gt;\n    &lt;scope&gt;runtime&lt;/scope&gt;\n    &lt;exclusions&gt;\n        &lt;exclusion&gt;\n            &lt;groupId&gt;com.sun.activation&lt;/groupId&gt;\n            &lt;artifactId&gt;jakarta-activation&lt;/artifactId&gt;\n        &lt;/exclusion&gt;\n        &lt;exclusion&gt;\n            &lt;groupId&gt;com.sun.mail&lt;/groupId&gt;\n            &lt;artifactId&gt;smtp&lt;/artifactId&gt;\n        &lt;/exclusion&gt;\n    &lt;/exclusions&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>(the version is managed by Spring Boot).</p>\n"}],"owner":{"user_id":12553074,"display_name":"Th&#233;o"},"view_count":328,"up_vote_count":2,"answer_count":2,"score":2,"creation_date":1674578734,"question_id":75224628,"body":"<p>I'm completely new to springboot and log4j2, and I cannot manage to send e-mail for a certain type of log (Warn&amp;Error). I dont' understand why i get &quot;ERROR Unable to invoke factory method in class org.apache.logging.log4j.core.appender.SmtpAppender&quot; message. Does anyone have a clue?</p>\n<p><strong>log4j2.xml</strong></p>\n\n\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;!DOCTYPE Configuration SYSTEM &quot;log4j2.dtd&quot;&gt;\n&lt;Configuration status=&quot;debug&quot; monitorInterval=&quot;30&quot;&gt;\n    &lt;Appenders&gt;\n        &lt;SMTP name=&quot;Mailer&quot; subject=&quot;Error Log&quot; to=&quot;email@email.com&quot;\n            from=&quot;email2@email.com&quot;\n            smtpHost=&quot;host&quot; smtpUsername=&quot;username&quot;\n            smtpPassword=&quot;mdp&quot; smtpProtocol=&quot;smtp&quot;\n            bufferSize=&quot;50&quot;&gt;\n            &lt;HtmlLayout /&gt;\n            &lt;PatternLayout pattern=&quot;%d{yyyy-MM-dd HH:mm:ss} %-5p %c:%L - %m%n&quot; /&gt;\n        &lt;/SMTP&gt;\n    &lt;/Appenders&gt;\n    &lt;Loggers&gt;\n        &lt;Root level=&quot;info&quot;&gt;\n            &lt;AppenderRef ref=&quot;Mailer&quot; /&gt;\n        &lt;/Root&gt;\n    &lt;/Loggers&gt;\n&lt;/Configuration&gt;\n</code></pre>\n<p><strong>pom.xml</strong></p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;\n    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n    xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;3.0.2&lt;/version&gt;\n        &lt;relativePath /&gt; &lt;!-- lookup parent from repository --&gt;\n    &lt;/parent&gt;\n    &lt;groupId&gt;com.example&lt;/groupId&gt;\n    &lt;artifactId&gt;smtp&lt;/artifactId&gt;\n    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n    &lt;name&gt;smtp&lt;/name&gt;\n    &lt;description&gt;Demo project for Spring Boot&lt;/description&gt;\n    &lt;properties&gt;\n        &lt;java.version&gt;17&lt;/java.version&gt;\n    &lt;/properties&gt;\n\n\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;\n            &lt;exclusions&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                    &lt;artifactId&gt;spring-boot-starter-logging&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n            &lt;/exclusions&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-mail&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-log4j2&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-mail&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n    &lt;/dependencies&gt;\n\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n\n&lt;/project&gt;\n</code></pre>\n<p><strong>SmtpApplication.java</strong></p>\n<pre><code>package com.example.smtp;\n\nimport org.apache.logging.log4j.LogManager;\nimport org.apache.logging.log4j.Logger;\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\n\n@SpringBootApplication\npublic class SmtpApplication {\n    private static final Logger logger = LogManager.getLogger(SmtpApplication.class);\n\n    public static void main(String[] args) {\n        SpringApplication.run(SmtpApplication.class, args);\n\n        logger.debug(&quot;Debugging log&quot;);\n        logger.info(&quot;Info log&quot;);\n        logger.warn(&quot;Hey, This is a warning!&quot;);\n        logger.error(&quot;Oops! We have an Error. OK&quot;);\n        logger.fatal(&quot;Damn! Fatal error. Please fix me.&quot;);\n    }\n\n}\n</code></pre>\n<p><strong>LOG</strong></p>\n<pre><code>2023-01-24 17:30:17,730 main DEBUG AsyncLogger.ThreadNameStrategy=UNCACHED (user specified null, default is UNCACHED)\n2023-01-24 17:30:17,731 main DEBUG org.apache.logging.log4j.core.util.SystemClock supports precise timestamps.\n2023-01-24 17:31:47,540 Log4j2-TF-4-Scheduled-2 INFO Source 'C:\\Users\\theo.lalande\\Desktop\\smtp\\target\\classes\\log4j2.xml' was modified on Tue Jan 24 17:31:33 CET 2023 (1674577893351), previous modification was on Tue Jan 24 17:29:57 CET 2023 (1674577797490)\n2023-01-24 17:31:47,542 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG Reconfiguration started for context 6d5380c2 (org.apache.logging.log4j.core.LoggerContext@7674b62c)\n2023-01-24 17:31:47,544 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG PluginManager 'Lookup' found 17 plugins\n2023-01-24 17:31:47,546 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG Closing FileInputStream java.io.FileInputStream@465ecc51\n2023-01-24 17:31:47,550 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG Watching configuration 'C:\\Users\\theo.lalande\\Desktop\\smtp\\target\\classes\\log4j2.xml' for lastModified Tue Jan 24 17:31:33 CET 2023 (1674577893351)\n2023-01-24 17:31:47,552 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG Apache Log4j Core 2.19.0 initializing configuration XmlConfiguration[location=C:\\Users\\theo.lalande\\Desktop\\smtp\\target\\classes\\log4j2.xml]        \n2023-01-24 17:31:47,553 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG PluginManager 'Core' found 131 plugins\n2023-01-24 17:31:47,554 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG PluginManager 'Level' found 0 plugins\n2023-01-24 17:31:47,554 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG PluginManager 'Lookup' found 17 plugins\n2023-01-24 17:31:47,556 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG Building Plugin[name=layout, class=org.apache.logging.log4j.core.layout.HtmlLayout].\n2023-01-24 17:31:47,557 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG HtmlLayout$Builder(locationInfo=&quot;null&quot;, title=&quot;null&quot;, contentType=&quot;null&quot;, charset=&quot;null&quot;, fontSize=&quot;null&quot;, fontName=&quot;null&quot;, datePattern=&quot;null&quot;, timezone=&quot;null&quot;)\n2023-01-24 17:31:47,557 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG Building Plugin[name=layout, class=org.apache.logging.log4j.core.layout.PatternLayout].\n2023-01-24 17:31:47,558 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG PatternLayout$Builder(pattern=&quot;%d{yyyy-MM-dd HH:mm:ss} %-5p %c:%L - %m%n&quot;, PatternSelector=null, Configuration(C:\\Users\\theo.lalande\\Desktop\\smtp\\target\\classes\\log4j2.xml), Replace=null, charset=&quot;null&quot;, alwaysWriteExceptions=&quot;null&quot;, disableAnsi=&quot;null&quot;, noConsoleNoAnsi=&quot;null&quot;, header=&quot;null&quot;, footer=&quot;null&quot;)\n2023-01-24 17:31:47,558 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG PluginManager 'Converter' found 48 plugins\n2023-01-24 17:31:47,559 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG Building Plugin[name=appender, class=org.apache.logging.log4j.core.appender.SmtpAppender].\n2023-01-24 17:31:47,561 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG SmtpAppender$Builder(to=&quot;email@email.com&quot;, cc=&quot;null&quot;, bcc=&quot;null&quot;, from=&quot;email2@email.com&quot;, replyTo=&quot;null&quot;, subject=&quot;Error Log&quot;, smtpProtocol=&quot;smtp&quot;, smtpHost=&quot;host&quot;, smtpPort=&quot;null&quot;, smtpUsername=&quot;username&quot;, smtpPassword=&quot;*****&quot;, smtpDebug=&quot;null&quot;, bufferSize=&quot;50&quot;, SSL=null, ignoreExceptions=&quot;null&quot;, HtmlLayout(org.apache.logging.log4j.core.layout.HtmlLayout@42614042), name=&quot;Mailer&quot;, Configuration(C:\\Users\\theo.lalande\\Desktop\\smtp\\target\\classes\\log4j2.xml), Filter=null, ={})\n2023-01-24 17:31:47,563 Log4j2-TF-3-ConfigurationFileWatcher-3 ERROR appender SMTP has no parameter that matches element PatternLayout\n2023-01-24 17:31:47,566 Log4j2-TF-3-ConfigurationFileWatcher-3 ERROR Could not create plugin of type class org.apache.logging.log4j.core.appender.SmtpAppender for element SMTP: java.lang.NoClassDefFoundError: javax/mail/MessagingException java.lang.NoClassDefFoundError: javax/mail/MessagingException\n        at org.apache.logging.log4j.core.appender.SmtpAppender$Builder.lambda$build$0(SmtpAppender.java:288)\n        at java.base/java.util.Optional.orElseGet(Unknown Source)\n        at org.apache.logging.log4j.core.appender.SmtpAppender$Builder.build(SmtpAppender.java:288)\n        at org.apache.logging.log4j.core.appender.SmtpAppender$Builder.build(SmtpAppender.java:92)\n        at org.apache.logging.log4j.core.config.plugins.util.PluginBuilder.build(PluginBuilder.java:124)\n        at org.apache.logging.log4j.core.config.AbstractConfiguration.createPluginObject(AbstractConfiguration.java:1138)\n        at org.apache.logging.log4j.core.config.AbstractConfiguration.createConfiguration(AbstractConfiguration.java:1063)\n        at org.apache.logging.log4j.core.config.AbstractConfiguration.createConfiguration(AbstractConfiguration.java:1055)\n        at org.apache.logging.log4j.core.config.AbstractConfiguration.doConfigure(AbstractConfiguration.java:664)\n        at org.apache.logging.log4j.core.config.AbstractConfiguration.initialize(AbstractConfiguration.java:258)\n        at org.apache.logging.log4j.core.config.AbstractConfiguration.start(AbstractConfiguration.java:304)\n        at org.apache.logging.log4j.core.LoggerContext.setConfiguration(LoggerContext.java:621)\n        at org.apache.logging.log4j.core.LoggerContext.onChange(LoggerContext.java:757)\n        at org.apache.logging.log4j.core.util.AbstractWatcher$ReconfigurationRunnable.run(AbstractWatcher.java:93)\n        at java.base/java.lang.Thread.run(Unknown Source)\nCaused by: java.lang.ClassNotFoundException: javax.mail.MessagingException\n        at java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(Unknown Source)\n        at java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(Unknown Source)\n        at java.base/java.lang.ClassLoader.loadClass(Unknown Source)\n        ... 15 more\n\n2023-01-24 17:31:47,571 Log4j2-TF-3-ConfigurationFileWatcher-3 ERROR Unable to invoke factory method in class org.apache.logging.log4j.core.appender.SmtpAppender for element SMTP: java.lang.IllegalStateException: No factory method found for class org.apache.logging.log4j.core.appender.SmtpAppender java.lang.IllegalStateException: No factory method found for class org.apache.logging.log4j.core.appender.SmtpAppender\n        at org.apache.logging.log4j.core.config.plugins.util.PluginBuilder.findFactoryMethod(PluginBuilder.java:260)\n        at org.apache.logging.log4j.core.config.plugins.util.PluginBuilder.build(PluginBuilder.java:136)\n        at org.apache.logging.log4j.core.config.AbstractConfiguration.createPluginObject(AbstractConfiguration.java:1138)\n        at org.apache.logging.log4j.core.config.AbstractConfiguration.createConfiguration(AbstractConfiguration.java:1063)\n        at org.apache.logging.log4j.core.config.AbstractConfiguration.createConfiguration(AbstractConfiguration.java:1055)\n        at org.apache.logging.log4j.core.config.AbstractConfiguration.doConfigure(AbstractConfiguration.java:664)\n        at org.apache.logging.log4j.core.config.AbstractConfiguration.initialize(AbstractConfiguration.java:258)\n        at org.apache.logging.log4j.core.config.AbstractConfiguration.start(AbstractConfiguration.java:304)\n        at org.apache.logging.log4j.core.LoggerContext.setConfiguration(LoggerContext.java:621)\n        at org.apache.logging.log4j.core.LoggerContext.onChange(LoggerContext.java:757)\n        at org.apache.logging.log4j.core.util.AbstractWatcher$ReconfigurationRunnable.run(AbstractWatcher.java:93)\n        at java.base/java.lang.Thread.run(Unknown Source)\n\n2023-01-24 17:31:47,575 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG Building Plugin[name=appenders, class=org.apache.logging.log4j.core.config.AppendersPlugin].\n2023-01-24 17:31:47,577 Log4j2-TF-3-ConfigurationFileWatcher-3 ERROR Null object returned for SMTP in Appenders.\n2023-01-24 17:31:47,579 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG createAppenders(={})\n2023-01-24 17:31:47,580 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG Building Plugin[name=AppenderRef, class=org.apache.logging.log4j.core.config.AppenderRef].\n2023-01-24 17:31:47,581 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG createAppenderRef(ref=&quot;Mailer&quot;, level=&quot;null&quot;, Filter=null)\n2023-01-24 17:31:47,581 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG Building Plugin[name=root, class=org.apache.logging.log4j.core.config.LoggerConfig$RootLogger].\n2023-01-24 17:31:47,582 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG LoggerConfig$RootLogger$Builder(additivity=&quot;null&quot;, level=&quot;INFO&quot;, levelAndRefs=&quot;null&quot;, includeLocation=&quot;null&quot;, ={Mailer}, ={}, Configuration(C:\\Users\\theo.lalande\\Desktop\\smtp\\target\\classes\\log4j2.xml), Filter=null)\n2023-01-24 17:31:47,583 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG Building Plugin[name=loggers, class=org.apache.logging.log4j.core.config.LoggersPlugin].\n2023-01-24 17:31:47,584 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG createLoggers(={root})\n2023-01-24 17:31:47,585 Log4j2-TF-3-ConfigurationFileWatcher-3 ERROR Unable to locate appender &quot;Mailer&quot; for logger config &quot;root&quot;\n2023-01-24 17:31:47,586 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG Configuration XmlConfiguration[location=C:\\Users\\theo.lalande\\Desktop\\smtp\\target\\classes\\log4j2.xml] initialized\n2023-01-24 17:31:47,587 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG Starting configuration XmlConfiguration[location=C:\\Users\\theo.lalande\\Desktop\\smtp\\target\\classes\\log4j2.xml]\n2023-01-24 17:31:47,588 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG Log4j2 ConfigurationScheduler starting 1 threads\n2023-01-24 17:31:47,589 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG Started configuration XmlConfiguration[location=C:\\Users\\theo.lalande\\Desktop\\smtp\\target\\classes\\log4j2.xml] OK.\n2023-01-24 17:31:47,590 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG Log4jBridgeHandler.propertyChange(): java.beans.PropertyChangeEvent[propertyName=config; oldValue=XmlConfiguration[location=C:\\Users\\theo.lalande\\Desktop\\smtp\\target\\classes\\log4j2.xml]; newValue=XmlConfiguration[location=C:\\Users\\theo.lalande\\Desktop\\smtp\\target\\classes\\log4j2.xml]; propagationId=null; source=org.apache.logging.log4j.core.LoggerContext@7674b62c]        \n2023-01-24 17:31:47,591 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG Log4jBridgeHandler.propagateLogLevels(): XmlConfiguration[location=C:\\Users\\theo.lalande\\Desktop\\smtp\\target\\classes\\log4j2.xml]\n2023-01-24 17:31:47,593 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG Log4j2 ConfigurationScheduler shutting down threads in java.util.concurrent.ScheduledThreadPoolExecutor@6302a2c0[Running, pool size = 1, active threads \n= 0, queued tasks = 1, completed tasks = 3]\n2023-01-24 17:31:47,595 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG Stopped XmlConfiguration[location=C:\\Users\\theo.lalande\\Desktop\\smtp\\target\\classes\\log4j2.xml] OK\n2023-01-24 17:31:47,596 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG Log4jBridgeHandler.propertyChange(): java.beans.PropertyChangeEvent[propertyName=config; oldValue=XmlConfiguration[location=C:\\Users\\theo.lalande\\Desktop\\smtp\\target\\classes\\log4j2.xml]; newValue=XmlConfiguration[location=C:\\Users\\theo.lalande\\Desktop\\smtp\\target\\classes\\log4j2.xml]; propagationId=null; source=org.apache.logging.log4j.core.LoggerContext@7674b62c]        \n2023-01-24 17:31:47,599 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG Log4jBridgeHandler.propagateLogLevels(): XmlConfiguration[location=C:\\Users\\theo.lalande\\Desktop\\smtp\\target\\classes\\log4j2.xml]\n2023-01-24 17:31:47,602 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG Registering MBean org.apache.logging.log4j2:type=6d5380c2\n2023-01-24 17:31:47,603 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG Registering MBean org.apache.logging.log4j2:type=6d5380c2,component=StatusLogger\n2023-01-24 17:31:47,604 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG Registering MBean org.apache.logging.log4j2:type=6d5380c2,component=ContextSelector\n2023-01-24 17:31:47,606 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG Registering MBean org.apache.logging.log4j2:type=6d5380c2,component=Loggers,name=\n2023-01-24 17:31:47,606 Log4j2-TF-3-ConfigurationFileWatcher-3 DEBUG Reconfiguration completed for 6d5380c2 (org.apache.logging.log4j.core.LoggerContext@7674b62c) in 65 milliseconds.\n</code></pre>\n<p>I've tried plenty of things, but cannot mannage du make it work. Does anyone avec a clue?</p>\n"},{"tags":["java","java-stream","lazy-evaluation","short-circuiting"],"answers":[{"owner":{"user_id":525036,"display_name":"Didier L"},"up_vote_count":3,"is_accepted":true,"creation_date":1674581972,"answer_id":75225246,"body":"<p>This is caused by <a href=\"https://bugs.openjdk.org/browse/JDK-8277306\" rel=\"nofollow noreferrer\">JDK-8277306: stream with sorted() and concat() causes some ops not to be lazy</a>, which was closed as “<em>Won’t fix</em>” with the following comment:</p>\n<blockquote>\n<p>Stream.concat takes the spliterator from each input stream and combines them to create a new spliterator from which a new stream is constructed. Thereby it binds to the sources of each stream to concatenate.</p>\n<p>It is currently not possible propagate the short circuiting property of the stream pipeline after the concatenation to pipeline before the concatenation. It comes down to resolving the push vs. pull differences across the spliterator boundary. That's a tricky problem, and one that Ilikely requires significant effort that I find hard to justify given the scope of the problem.</p>\n</blockquote>\n"}],"owner":{"user_id":1869409,"display_name":"aviad cohen"},"view_count":68,"up_vote_count":2,"accepted_answer_id":75225246,"answer_count":1,"score":2,"creation_date":1674562900,"question_id":75221416,"body":"<p>Stream evaluation is usually lazy (by default), unless statefull operations exist as part of the pipeline. I encountered a case where the lazyness is violated due to stateful operation and I don't understand why it happens.</p>\n<p>Consider the following code:</p>\n<pre><code>List&lt;Integer&gt; l1 = List.of(4, 5, 3, 1, 2);\nList&lt;Integer&gt; l2 = List.of(6, 7, 8, 9, 10);\n\nStream\n    .concat(\n        l1.stream()\n            .map(i -&gt; {\n                System.out.println(&quot;in the map for &quot; + i);\n                if (i % 3 != 0) {\n                    return null;\n                }\n                return i;\n            }),\n        l2.stream())\n    .filter(i -&gt; {\n        System.out.println(&quot;in the filter &quot; + i);\n        return i != null;\n    })\n    .findAny();\n</code></pre>\n<p>In details:</p>\n<p>I have two steams constructed out of integer lists (<code>l1</code> &amp; <code>l2</code>). Both streams are concatenated to form a new stream.</p>\n<p>The <code>l1</code> stream goes through some mapping that converts every item not divisible by 3 to <code>null</code>; the <code>l2</code> stream is taken as is. On the concatenated stream, I am adding a filter (filters the non-null values only --&gt; so from the first stream, only the items divided to 3 will go through the pipeline) and finally a terminal operation <code>findAny</code> which triggers the stream's pipeline (and will effectively deliver back the first item divisible by 3 and stop the stream processing).</p>\n<p>This code works as expected: first all <code>l1</code> items are consumed before <code>l2</code> items are reached. The output shows how <code>l1</code> mapping function is called followed by the concatenated-stream-filter function for the first two <code>l1</code> items, and the whole stream is finished when the 3rd item of <code>l1</code> is not converted to null and thus survives the filter:</p>\n<pre><code>in the map for 4\nin the filter null\nin the map for 5\nin the filter null\nin the map for 3\nin the filter 3\n</code></pre>\n<p>The problem (or the thing I don't understand) starts when the <code>l1</code> stream is modified with the <code>.sorted</code> operation:</p>\n<pre><code>Stream\n    .concat(\n        l1.stream()\n            .sorted()\n            .map(i -&gt; {\n                System.out.println(&quot;in the map for &quot; + i);\n                if (i % 3 != 0) {\n                    return null;\n                }\n                return i;\n            }),\n        l2.stream())\n    .filter(i -&gt; {\n        System.out.println(&quot;in the filter &quot; + i);\n        return i != null;\n    })\n    .findAny();\n</code></pre>\n<p>... now things look different:</p>\n<pre><code>in the map for 1\nin the map for 2\nin the map for 3\nin the map for 4\nin the map for 5\nin the filter null\nin the filter null\nin the filter 3\n</code></pre>\n<p>as sorted is statefull operation, I know that it first needs to consume the entire <code>l1</code> stream to sort its values. My surprise came as it seems that it also affects <strong>the remaining of the <code>l1</code> pipeline</strong> as the <code>map</code> function is called <strong>eagerly</strong> before any of the concatenated-stream-filter method invocations, as was before.</p>\n<p>I read <a href=\"https://stackoverflow.com/questions/61114380/java-streams-buffering-huge-streams\">Java Streams - Buffering huge streams</a> and <a href=\"https://stackoverflow.com/questions/29229373/why-filter-after-flatmap-is-not-completely-lazy-in-java-streams/29230939#29230939\">Why filter() after flatMap() is &quot;not completely&quot; lazy in Java streams?</a>, and I am already running on java 17 and working with <code>Stream.concat()</code> and I am not using <code>flatMap()</code> (at least not explicitly).</p>\n<p>Can you explain why ? What am I missing here ?</p>\n"},{"tags":["java","maven","javafx","javafx-css"],"comments":[{"owner":{"user_id":6395627,"display_name":"Slaw"},"edited":false,"comment_id":132692452,"body":"There&#39;s a <code>module-info</code> descriptor, so my guess is that the resource is encapsulated, assuming the path is correct (it <i>seems</i> correct). That said, <a href=\"https://github.com/kordamp/bootstrapfx\" rel=\"nofollow noreferrer\">the example in the project&#39;s readme</a> &quot;installs&quot; the stylesheet <i>in code</i> using <code>scene.getStylesheets().add(BootstrapFX.bootstrapFXStylesheet&zwnj;&#8203;());</code>. Perhaps you should try that approach (i.e., add the stylesheet in the controller) rather than trying to do it in FXML."},{"owner":{"user_id":243532,"display_name":"Juanan"},"edited":false,"comment_id":132692911,"body":"Indeed, adding the BootstrapFX CSS programmatically (following the README of the project), works as expected, but I would like to specify the CSS path in the FXML (Setting it in the FXML allows me to preview the styles directly in SceneBuilder -after adding the BootstrapFX JAR in the JAR/FXML manager of SB-)"},{"owner":{"user_id":1155209,"display_name":"jewelsea"},"edited":false,"comment_id":132693443,"body":"Please don’t screenshot text, add the code as code formatted as text."},{"owner":{"user_id":243532,"display_name":"Juanan"},"edited":false,"comment_id":132693640,"body":"Thanks. As requested I added the code referenced in the screenshot but kept the screenshot because it shows the exact error in a popup; also it shows in red a possible error (that the CSS does not exist) and finally it also shows the &quot;@&quot; sign in green (meaning that it is syntactically correct to add that prefix). That &quot;@&quot; prefix is added by SceneBuilder whenever you reference an external CSS stylesheet in the FXML. Just in case I removed it, tried again and obtained the same results."},{"owner":{"user_id":6395627,"display_name":"Slaw"},"edited":false,"comment_id":132693752,"body":"Does doing something like <code>&lt;stylesheets&gt;&lt;BootstrapFX fx:factory=&quot;bootstrapFXStylesheet&quot;&#47;&gt;&lt;&#47;stylesheets&gt;</code> work?"},{"owner":{"user_id":243532,"display_name":"Juanan"},"edited":false,"comment_id":132693979,"body":"Wow! That did the trick! Thanks @Slaw! I didn&#39;t know that we could do that magic inside the &lt;stylesheets&gt; tag. Please, can you post it like an answer? I will gratefully accept it as the valid one."}],"answers":[{"owner":{"user_id":6395627,"display_name":"Slaw"},"up_vote_count":3,"is_accepted":true,"creation_date":1674353286,"answer_id":75197792,"body":"<p>Given it appears <em>BootstrapFX</em> is modularized, my guess is that the stylesheet is <a href=\"https://docs.oracle.com/en/java/javase/19/docs/api/java.base/java/lang/Module.html#getResourceAsStream(java.lang.String)\" rel=\"nofollow noreferrer\">encapsulated</a>. That means code from outside the library's module cannot access the resource, because the library does not declare the necessary <code>opens</code> directives. Though this should only take effect if <em>BootstrapFX</em> is being loaded as a named module (i.e., on the module-path). Otherwise, I would expect this to work:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;VBox stylehsheets=&quot;org/kordamp/bootstrapfx/bootstrapfx.css&quot;/&gt;\n</code></pre>\n<p><sup><strong>Note:</strong> In FXML, the <code>@</code> prefix is the <a href=\"https://openjfx.io/javadoc/19/javafx.fxml/javafx/fxml/doc-files/introduction_to_fxml.html#location_resolution\" rel=\"nofollow noreferrer\">&quot;location resolution operator&quot;</a>. It means to treat the subsequent path as being relative <em>to the current FXML file</em>. I doubt the stylesheet is located at <code>org/kordamp/bootstrapfx/bootstrapfx.css</code> relative to your FXML file.</sup></p>\n<p>That said, it looks like <a href=\"https://github.com/kordamp/bootstrapfx#installing\" rel=\"nofollow noreferrer\">the intended approach</a> is to use <code>BootstrapFX#bootstrapFXStylesheet()</code> in code. That method returns a string URL pointing to the stylesheet. The URL mechanism &quot;bypasses&quot; the encapsulation issue. That means you should consider adding the stylehsheet in the controller. For example:</p>\n<pre class=\"lang-java prettyprint-override\"><code>import javafx.fxml.FXML;\nimport javafx.scene.layout.VBox;\nimport org.kordamp.bootstrapfx.BootstrapFX;\n\npublic class Controller {\n\n    @FXML private VBox theVBox;\n\n    @FXML\n    private void initialize() {\n         theVBox.getStylesheets().add(BootstrapFX.bootstrapFXStylesheet());\n    }\n}\n</code></pre>\n<p>However, it is possible to call the <code>bootstrapFXStylesheet()</code> method via FXML using <a href=\"https://openjfx.io/javadoc/19/javafx.fxml/javafx/fxml/doc-files/introduction_to_fxml.html#instance_declaration_elements\" rel=\"nofollow noreferrer\"><code>fx:factory</code></a>. For example:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n\n&lt;?import javafx.scene.layout.VBox?&gt;\n&lt;?import org.kordamp.bootstrapfx.BootstrapFX?&gt;\n\n&lt;VBox xmlns=&quot;http://javafx.com/javafx&quot; xmlns:fx=&quot;http://javafx.com/fxml&quot;&gt;\n    &lt;stylesheets&gt;\n        &lt;BootstrapFX fx:factory=&quot;bootstrapFXStylesheet&quot;/&gt;\n    &lt;/stylesheets&gt;\n&lt;/VBox&gt;\n</code></pre>\n"}],"owner":{"user_id":243532,"display_name":"Juanan"},"view_count":123,"up_vote_count":2,"accepted_answer_id":75197792,"answer_count":1,"score":2,"creation_date":1674323213,"question_id":75195364,"body":"<p>When I open the following FXML file in IntelliJ:</p>\n<pre><code>&lt;VBox alignment=&quot;CENTER&quot; spacing=&quot;20.0&quot; stylesheets=&quot;@/org/kordamp/bootstrapfx/bootstrapfx.css&quot; xmlns=&quot;http://javafx.com/javafx/19&quot; xmlns:fx=&quot;http://javafx.com/fxml/1&quot; fx:controller=&quot;com.example.demo2.HelloController&quot;&gt;\n    &lt;padding&gt;\n        &lt;Insets bottom=&quot;20.0&quot; left=&quot;20.0&quot; right=&quot;20.0&quot; top=&quot;20.0&quot; /&gt;\n    &lt;/padding&gt;\n   \n    &lt;Label fx:id=&quot;welcomeText&quot; /&gt;\n    &lt;Button onAction=&quot;#onHelloButtonClick&quot; styleClass=&quot;alert-danger&quot; text=&quot;Hello!&quot; /&gt;\n&lt;/VBox&gt;\n</code></pre>\n<p>I get this error:</p>\n<p><a href=\"https://i.stack.imgur.com/H6lGt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/H6lGt.png\" alt=\"enter image description here\" /></a></p>\n<p>Note that in this project I have the BootstrapFX library defined as a dependency in Maven.</p>\n<p>I'm assuming that stylesheets=&quot;@/org/kordamp/bootstrapfx/bootstrapfx.css&quot; should look into the proper JAR dependency in my Maven external libraries and get the CSS file from there...</p>\n<p><a href=\"https://i.stack.imgur.com/Z1DJD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Z1DJD.png\" alt=\"enter image description here\" /></a></p>\n<p>Of course, when I run the application from IntelliJ, it yields this error (the css is not found on the classpath):</p>\n<pre><code>Caused by: javafx.fxml.LoadException: Invalid resource: /org/kordamp/bootstrapfx/bootstrapfx.css not found on the classpath\n</code></pre>\n<p>So how can I specify in the stylesheets attribute of the FXML (or in my project's configuration) a path to a CSS file located inside a JAR file?</p>\n<p>(I know that I can extract the css from the JAR file, copy it in my resources/ folder and include it in the FXML file specifying the relative path to my external css, and it works like a charm, but I would like to know how to do it directly from the JAR file)</p>\n"},{"tags":["java","spring-boot","ubuntu"],"comments":[{"owner":{"user_id":10016327,"display_name":"satyesht"},"edited":false,"comment_id":132660701,"body":"instead of exporting in shell session export LOG_HOME = /home/ubuntu/logs try this as -D argument in your starup command  eg: java -cp=xxx main -DLOG_HOME=/home/ubuntu/log"}],"answers":[{"owner":{"user_id":10016327,"display_name":"satyesht"},"up_vote_count":1,"is_accepted":true,"creation_date":1674156974,"answer_id":75177421,"body":"<p>Instead of exporting in shell session like</p>\n<pre><code>export LOG_HOME = /home/ubuntu/logs\n</code></pre>\n<p>try this as -D VM argument in your starup command\neg:\n<code>java -cp=xxx mainclass -DLOG_HOME=/home/ubuntu/log</code></p>\n<p>if you are using tomcat then :\nVM args can be added  <code>catalina.sh file under CATALINA_OPTS.</code></p>\n"},{"owner":{"user_id":888580,"display_name":"lane.maxwell"},"up_vote_count":1,"is_accepted":false,"creation_date":1674159345,"answer_id":75177803,"body":"<p>For tomcat, add your environment variables to <code>$TOMCAT_HOME/bin/setenv.sh</code> where <code>$TOMCAT_HOME</code> is the directory of your tomcat installation.</p>\n"},{"owner":{"user_id":5120843,"display_name":"Morkus"},"up_vote_count":1,"is_accepted":false,"creation_date":1674160199,"answer_id":75177944,"body":"<p>The solution for me posted by the extremely helpful satyesht above, was to edit the Catalina.sh file and add the &quot;-D&quot; name-value pair option under CATALINA_OPTS. Thanks to all who posted. :)</p>\n"}],"owner":{"user_id":5120843,"display_name":"Morkus"},"view_count":155,"up_vote_count":2,"accepted_answer_id":75177421,"answer_count":3,"score":2,"creation_date":1674151373,"question_id":75176491,"body":"<p>Here's what I do in SpringBoot on Windows to read an environment variable (location of log folder).</p>\n<ol>\n<li><p>In Windows Server, I set a System environment variable for &quot;LOG_HOME&quot; with the value with the directory that SpringBoot should use to write logs.</p>\n</li>\n<li><p>In SpringBoot's application.properties, I have:</p>\n</li>\n</ol>\n<p>logging.file.name= ${LOG_HOME}/ws.log</p>\n<p>Works great!</p>\n<hr />\n<p>But in Ubuntu Linux 20.04, the same approach doesn't work for me at all.</p>\n<p>When the WAR file tries to deploy on Ubuntu 20.04 using this similar technique:</p>\n<ol>\n<li>(in .bashrc): export LOG_HOME = /home/ubuntu/logs</li>\n<li>reboot (to reload the environment for sure)</li>\n</ol>\n<p>I get this error in the Tomcat log when trying to deploy the WAR file:</p>\n<p>java.lang.IllegalArgumentException: Could not resolve placeholder 'LOG_HOME' in value &quot;${LOG_HOME}/ws.log&quot;</p>\n<p>So, it seems that Spring doesn't see the environment variable set in Ubuntu.</p>\n<p>I wrote a simple Java program just to check the value of the environment variables and they were all created as expected including the LOG_HOME as shown in Linux &quot;printenv&quot;.</p>\n<p>If possible, I need a technique that will work on Ubuntu without changing the working SpringBoot implementation on Windows Server.</p>\n<p>Thanks in advance for suggestions.</p>\n"},{"tags":["java","spring-boot","mockito","junit5"],"answers":[{"owner":{"user_id":3305737,"display_name":"Jonasz"},"up_vote_count":3,"is_accepted":true,"creation_date":1674064328,"answer_id":75163319,"body":"<p>The difference between <code>@Mock</code> and <code>@MockBean</code> is simply the fact that <code>@MockBean</code> annotates an object, which is injected into the Spring context and used as a bean in the test, and is also a mock. <code>@MockBean</code> extends the functionality of <code>@Mock</code>, which is not related to the Spring framework.</p>\n<p>The test of your <code>Service</code> has <strong>nothing to do with Spring</strong> whatsoever - you can verify that simply by looking at the imports of the class. There is not a single import from the <code>org.springframework</code> package. Using <code>@Mock</code> here is perfectly fine on its own. Combination of <code>MockitoExtension</code> and <code>@InjectMocks</code> takes care of the mocks' lifecycle. The mock instance is created and injected into the test subject (<code>consumerService</code>). Spring context is not created.</p>\n<p>In case of the <code>Controller</code> test, you're using Spring-related classes, especially <code>MockMvc</code> and <code>@WebMvcTest</code> - the first is injected automatically thanks to the latter and <code>@WebMvcTest</code> sets up the <strong>Spring context for web layer handling</strong>. Controller classes are scanned and beans are created, thanks to which the requests performed on <code>MockMvc</code> can access the endpoints. The important part here is that other components (layers) are not scanned and injected automatically. That's the reason the error states:</p>\n<blockquote>\n<p>Error creating bean with name 'consumerController': Unsatisfied dependency (...)</p>\n</blockquote>\n<p>Spring tries to create the controller bean, but the service bean cannot be found. <code>@MockBean</code> notifies Spring that the mock should be created and used as a bean. That's why the test with this annotation works - Spring context can be properly created and the beans can be injected. Some of them (the service) as mocks.</p>\n<p>For more information see the description and examples in: <a href=\"https://spring.io/guides/gs/testing-web\" rel=\"nofollow noreferrer\">Testing the Web Layer in Spring docs</a>.</p>\n<p>Additionally, <a href=\"https://github.com/Jonarzz/personal-restaurants-knowledge-base/blob/5da49cf4a8d5eb40ca9eaa468d421f4c2c2bc924/restaurants-knowledge-web/src/test/java/io/github/jonarzz/restaurant/knowledge/domain/RestaurantDynamoDbCacheTest.java#L67\" rel=\"nofollow noreferrer\">here</a> you can find an example of a spy bean created programmatically using <code>@TestConfiguration</code>. That's similar to using <code>@SpyBean</code> annotation, but can help in some more complicated cases and it's worth noting here. To simplify: <code>@TestConfiguration</code> and <code>mock</code> work similar to <code>@MockBean</code>, which makes Spring tests configuration easier.</p>\n"}],"owner":{"user_id":8324785,"display_name":"Akshay Sumbe"},"view_count":757,"up_vote_count":2,"accepted_answer_id":75163319,"answer_count":1,"score":2,"creation_date":1674060728,"question_id":75162635,"body":"<p>I'm learning to write test cases for controller layer in a spring boot application. I've used @Mock to mock the repository interface in service layer test case and it worked/ compiled &amp; test case got executed. In controller layer test case @Mock is resulting in exception but @MockBean works.</p>\n<p>I tried to understand the difference between @Mock &amp; @MockBean from other resources, but expecting more clarity why @Mock works in service tests but does not work in controller tests.</p>\n<p>Please refer my code -</p>\n<ol>\n<li><p>Entity</p>\n<pre><code>package com.learning.microservices.userservice.model;\n\nimport lombok.AllArgsConstructor;\nimport lombok.Builder;\nimport lombok.Data;\nimport lombok.NoArgsConstructor;\nimport org.springframework.data.annotation.Id;\nimport org.springframework.data.mongodb.core.mapping.Document;\n\n@Data\n@Builder\n@NoArgsConstructor\n@AllArgsConstructor\n@Document(collection = &quot;Consumer&quot;)\npublic class Consumer {\n    @Id\n    private Long consumerId;\n    private String consumerName;\n    private String emailAddress;\n}\n</code></pre>\n</li>\n<li><p>Repository</p>\n<pre><code>package com.learning.microservices.userservice.repository;\n\nimport com.learning.microservices.userservice.model.Consumer;\nimport org.springframework.data.mongodb.repository.MongoRepository;\nimport org.springframework.stereotype.Repository;\n\n@Repository\npublic interface ConsumerRepository extends MongoRepository&lt;Consumer, Long&gt; {\n}\n</code></pre>\n</li>\n<li><p>Service</p>\n<ol>\n<li><p>Interface</p>\n<pre><code>package com.learning.microservices.userservice.Service;\n\nimport com.learning.microservices.userservice.model.Consumer;\n\npublic interface ConsumerService {\n    public Consumer saveConsumer(Consumer consumer);\n}\n</code></pre>\n</li>\n<li><p>Implementation</p>\n<pre><code>package com.learning.microservices.userservice.Service;\n\nimport com.learning.microservices.userservice.model.Consumer;\nimport com.learning.microservices.userservice.repository.ConsumerRepository;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.stereotype.Service;\n\n@Service\npublic class ConsumerServiceImpl implements ConsumerService {\n    @Autowired\n    ConsumerRepository consumerRepository;\n\n    public Consumer saveConsumer(Consumer consumer){\n        if (consumerRepository.findById(consumer.getConsumerId()).isPresent())\n            throw new RuntimeException(&quot;Consumer already exists&quot;);//should return 409\n        return consumerRepository.save(consumer);\n    }\n}\n</code></pre>\n</li>\n</ol>\n</li>\n<li><p>Controller</p>\n<pre><code>package com.learning.microservices.userservice.controller;\n\nimport com.learning.microservices.userservice.Service.ConsumerService;\nimport com.learning.microservices.userservice.model.Consumer;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.http.ResponseEntity;\nimport org.springframework.web.bind.annotation.PostMapping;\nimport org.springframework.web.bind.annotation.RequestBody;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RestController;\nimport org.springframework.web.servlet.support.ServletUriComponentsBuilder;\n\nimport java.net.URI;\n\n@RestController\n@RequestMapping(&quot;/consumers&quot;)\npublic class ConsumerController {\n\n    @Autowired\n    ConsumerService consumerService;\n\n    @PostMapping\n    public ResponseEntity&lt;Consumer&gt; saveConsumer(@RequestBody Consumer consumer) {\n        Consumer savedConsumer = consumerService.saveConsumer(consumer);\n        URI consumerLocation = ServletUriComponentsBuilder.fromCurrentRequest().path(&quot;/{consumerId}&quot;).buildAndExpand(savedConsumer.getConsumerId()).toUri();\n        return ResponseEntity.created(consumerLocation).build();\n    }\n\n}\n</code></pre>\n</li>\n<li><p>Test Cases</p>\n<ol>\n<li><p>Service</p>\n<pre><code>package com.learning.microservices.userservice.Service;\n\nimport com.learning.microservices.userservice.model.Consumer;\nimport com.learning.microservices.userservice.repository.ConsumerRepository;\nimport org.junit.jupiter.api.AfterEach;\nimport org.junit.jupiter.api.BeforeEach;\nimport org.junit.jupiter.api.Test;\nimport org.junit.jupiter.api.extension.ExtendWith;\nimport org.mockito.InjectMocks;\nimport org.mockito.Mock;\nimport org.mockito.junit.jupiter.MockitoExtension;\n\nimport java.util.Optional;\n\nimport static org.assertj.core.api.Assertions.assertThat;\nimport static org.mockito.BDDMockito.given;\n\n@ExtendWith(MockitoExtension.class)\nclass ConsumerServiceImplTest {\n\n    @Mock\n    private ConsumerRepository consumerRepository;\n\n    @InjectMocks\n    private ConsumerServiceImpl consumerService;\n\n    private Consumer consumer;\n\n    @BeforeEach\n    public void setUp() {\n        consumer = Consumer.builder()\n                .consumerId(1L)\n                .consumerName(&quot;Test Consumer&quot;)\n                .emailAddress(&quot;test.consumer@test.com&quot;)\n                .build();\n    }\n\n    @AfterEach\n    public void tearDown() {\n        consumer = null;\n    }\n    @Test\n    void saveConsumer() {\n        given(consumerRepository.findById(consumer.getConsumerId())).willReturn(Optional.empty());\n        given(consumerService.saveConsumer(consumer)).willReturn(consumer);\n        Consumer savedConsumer = consumerService.saveConsumer(consumer);\n        assertThat(savedConsumer).isNotNull();\n    }\n\n}\n</code></pre>\n</li>\n<li><p>Controller</p>\n<pre><code>package com.learning.microservices.userservice.controller;\n\nimport com.fasterxml.jackson.databind.ObjectMapper;\nimport com.learning.microservices.userservice.Service.ConsumerServiceImpl;\nimport com.learning.microservices.userservice.model.Consumer;\nimport org.junit.jupiter.api.AfterEach;\nimport org.junit.jupiter.api.BeforeEach;\nimport org.junit.jupiter.api.Test;\nimport org.mockito.InjectMocks;\nimport org.mockito.Mock;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTest;\nimport org.springframework.http.MediaType;\nimport org.springframework.test.web.servlet.MockMvc;\nimport org.springframework.test.web.servlet.request.MockMvcRequestBuilders;\nimport org.springframework.test.web.servlet.result.MockMvcResultMatchers;\n\nimport java.nio.charset.StandardCharsets;\n\nimport static org.mockito.BDDMockito.given;\n\n@WebMvcTest\nclass ConsumerControllerTest {\n\n    private ObjectMapper objectMapper;\n    private Consumer consumer;\n\n    @Autowired\n    private MockMvc mockMvc;\n\n    @Mock\n    private ConsumerServiceImpl consumerService;\n\n    @InjectMocks\n    private ConsumerController consumerController;\n\n\n    @BeforeEach\n    public void setUp() {\n        consumer = Consumer.builder()\n                .consumerId(1L)\n                .consumerName(&quot;Test Consumer&quot;)\n                .emailAddress(&quot;test.consumer@test.com&quot;)\n                .build();\n        objectMapper = new ObjectMapper();\n    }\n\n    @AfterEach\n    public void tearDown() {\n        consumer = null;\n        objectMapper = null;\n    }\n\n    @Test\n    void saveConsumer() throws Exception {\n        given(consumerService.saveConsumer(consumer)).willReturn(consumer);\n        mockMvc.perform(MockMvcRequestBuilders.post(&quot;/consumers&quot;)\n                .contentType(MediaType.APPLICATION_JSON)\n                .content(objectMapper.writeValueAsString(consumer))\n                .characterEncoding(StandardCharsets.UTF_8)\n        )\n        .andExpect(MockMvcResultMatchers.status().isCreated());\n    }\n}\n</code></pre>\n</li>\n<li><p>Exception logs</p>\n<pre><code>java.lang.IllegalStateException: Failed to load ApplicationContext for [WebMergedContextConfiguration@5f8a02cf testClass = com.learning.microservices.userservice.controller.ConsumerControllerTest, locations = [], classes = [com.learning.microservices.userservice.UserServiceApplication], contextInitializerClasses = [], activeProfiles = [], propertySourceLocations = [], propertySourceProperties = [&quot;org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTestContextBootstrapper=true&quot;], contextCustomizers = [[ImportsContextCustomizer@26d5a317 key = [org.springframework.boot.autoconfigure.cache.CacheAutoConfiguration, org.springframework.boot.autoconfigure.context.MessageSourceAutoConfiguration, org.springframework.boot.autoconfigure.data.web.SpringDataWebAutoConfiguration, org.springframework.boot.autoconfigure.freemarker.FreeMarkerAutoConfiguration, org.springframework.boot.autoconfigure.groovy.template.GroovyTemplateAutoConfiguration, org.springframework.boot.autoconfigure.gson.GsonAutoConfiguration, org.springframework.boot.autoconfigure.hateoas.HypermediaAutoConfiguration, org.springframework.boot.autoconfigure.http.HttpMessageConvertersAutoConfiguration, org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration, org.springframework.boot.autoconfigure.jsonb.JsonbAutoConfiguration, org.springframework.boot.autoconfigure.mustache.MustacheAutoConfiguration, org.springframework.boot.autoconfigure.task.TaskExecutionAutoConfiguration, org.springframework.boot.autoconfigure.thymeleaf.ThymeleafAutoConfiguration, org.springframework.boot.autoconfigure.validation.ValidationAutoConfiguration, org.springframework.boot.autoconfigure.web.servlet.error.ErrorMvcAutoConfiguration, org.springframework.boot.autoconfigure.web.servlet.HttpEncodingAutoConfiguration, org.springframework.boot.autoconfigure.web.servlet.WebMvcAutoConfiguration, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcAutoConfiguration, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcWebClientAutoConfiguration, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcWebDriverAutoConfiguration, org.springframework.boot.autoconfigure.security.oauth2.client.servlet.OAuth2ClientAutoConfiguration, org.springframework.boot.autoconfigure.security.oauth2.resource.servlet.OAuth2ResourceServerAutoConfiguration, org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration, org.springframework.boot.autoconfigure.security.servlet.SecurityFilterAutoConfiguration, org.springframework.boot.autoconfigure.security.servlet.UserDetailsServiceAutoConfiguration, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcSecurityConfiguration, org.springframework.boot.test.autoconfigure.web.reactive.WebTestClientAutoConfiguration]], org.springframework.boot.test.context.filter.ExcludeFilterContextCustomizer@2034b64c, org.springframework.boot.test.json.DuplicateJsonObjectContextCustomizerFactory$DuplicateJsonObjectContextCustomizer@7161d8d1, org.springframework.boot.test.mock.mockito.MockitoContextCustomizer@0, org.springframework.boot.test.autoconfigure.OverrideAutoConfigurationContextCustomizerFactory$DisableAutoConfigurationContextCustomizer@d737b89, org.springframework.boot.test.autoconfigure.actuate.observability.ObservabilityContextCustomizerFactory$DisableObservabilityContextCustomizer@9da1, org.springframework.boot.test.autoconfigure.filter.TypeExcludeFiltersContextCustomizer@234914f5, org.springframework.boot.test.autoconfigure.properties.PropertyMappingContextCustomizer@e322556a, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverContextCustomizerFactory$Customizer@2ab4bc72, org.springframework.boot.test.context.SpringBootTestAnnotation@4ddbcfe0], resourceBasePath = &quot;src/main/webapp&quot;, contextLoader = org.springframework.boot.test.context.SpringBootContextLoader, parent = null]\n\n  at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:142)\n  at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:127)\n  at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:141)\n  at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:97)\n  at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:241)\n  at org.springframework.test.context.junit.jupiter.SpringExtension.postProcessTestInstance(SpringExtension.java:138)\n  at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$invokeTestInstancePostProcessors$10(ClassBasedTestDescriptor.java:377)\n  at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.executeAndMaskThrowable(ClassBasedTestDescriptor.java:382)\n  at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$invokeTestInstancePostProcessors$11(ClassBasedTestDescriptor.java:377)\n  at java.base/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:197)\n  at java.base/java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:179)\n  at java.base/java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1625)\n  at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:509)\n  at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499)\n  at java.base/java.util.stream.StreamSpliterators$WrappingSpliterator.forEachRemaining(StreamSpliterators.java:310)\n  at java.base/java.util.stream.Streams$ConcatSpliterator.forEachRemaining(Streams.java:735)\n  at java.base/java.util.stream.Streams$ConcatSpliterator.forEachRemaining(Streams.java:734)\n  at java.base/java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:762)\n  at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeTestInstancePostProcessors(ClassBasedTestDescriptor.java:376)\n  at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$instantiateAndPostProcessTestInstance$6(ClassBasedTestDescriptor.java:289)\n  at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\n  at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.instantiateAndPostProcessTestInstance(ClassBasedTestDescriptor.java:288)\n  at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$testInstancesProvider$4(ClassBasedTestDescriptor.java:278)\n  at java.base/java.util.Optional.orElseGet(Optional.java:364)\n  at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$testInstancesProvider$5(ClassBasedTestDescriptor.java:277)\n  at org.junit.jupiter.engine.execution.TestInstancesProvider.getTestInstances(TestInstancesProvider.java:31)\n  at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$prepare$0(TestMethodTestDescriptor.java:105)\n  at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\n  at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.prepare(TestMethodTestDescriptor.java:104)\n  at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.prepare(TestMethodTestDescriptor.java:68)\n  at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$prepare$2(NodeTestTask.java:123)\n  at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\n  at org.junit.platform.engine.support.hierarchical.NodeTestTask.prepare(NodeTestTask.java:123)\n  at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:90)\n  at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)\n  at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)\n  at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)\n  at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\n  at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)\n  at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)\n  at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)\n  at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\n  at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)\n  at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)\n  at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)\n  at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)\n  at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)\n  at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\n  at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)\n  at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)\n  at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)\n  at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\n  at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)\n  at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)\n  at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)\n  at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)\n  at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)\n  at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:147)\n  at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:127)\n  at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:90)\n  at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:55)\n  at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:102)\n  at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:54)\n  at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)\n  at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)\n  at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)\n  at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:53)\n  at com.intellij.junit5.JUnit5IdeaTestRunner.startRunnerWithArgs(JUnit5IdeaTestRunner.java:57)\n  at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)\n  at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)\n  at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)\n  at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:235)\n  at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:54)\nCaused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'consumerController': Unsatisfied dependency expressed through field 'consumerService': No qualifying bean of type 'com.learning.microservices.userservice.Service.ConsumerService' available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=true)}\n  at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:712)\n  at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:692)\n  at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:127)\n  at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessProperties(AutowiredAnnotationBeanPostProcessor.java:481)\n  at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1397)\n  at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:598)\n  at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:521)\n  at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326)\n  at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)\n  at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324)\n  at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200)\n  at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:961)\n  at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:915)\n  at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:584)\n  at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:730)\n  at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:432)\n  at org.springframework.boot.SpringApplication.run(SpringApplication.java:308)\n  at org.springframework.boot.test.context.SpringBootContextLoader.lambda$loadContext$3(SpringBootContextLoader.java:137)\n  at org.springframework.util.function.ThrowingSupplier.get(ThrowingSupplier.java:59)\n  at org.springframework.util.function.ThrowingSupplier.get(ThrowingSupplier.java:47)\n  at org.springframework.boot.SpringApplication.withHook(SpringApplication.java:1386)\n  at org.springframework.boot.test.context.SpringBootContextLoader$ContextLoaderHook.run(SpringBootContextLoader.java:543)\n  at org.springframework.boot.test.context.SpringBootContextLoader.loadContext(SpringBootContextLoader.java:137)\n  at org.springframework.boot.test.context.SpringBootContextLoader.loadContext(SpringBootContextLoader.java:108)\n  at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:184)\n  at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:118)\n  ... 72 more\nCaused by: org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type 'com.learning.microservices.userservice.Service.ConsumerService' available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=true)}\n  at org.springframework.beans.factory.support.DefaultListableBeanFactory.raiseNoMatchingBeanFound(DefaultListableBeanFactory.java:1812)\n  at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1371)\n  at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1325)\n  at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:709)\n  ... 97 more\n</code></pre>\n</li>\n</ol>\n</li>\n</ol>\n"},{"tags":["java","lambda","split","hashmap","java-stream"],"comments":[{"owner":{"user_id":5445670,"display_name":"Solomon Ucko"},"edited":false,"comment_id":132622590,"body":"What is the full code you are trying to use? Would <a href=\"https://docs.oracle.com/javase/8/docs/api/java/lang/String.html#replace-java.lang.CharSequence-java.lang.CharSequence-\" rel=\"nofollow noreferrer\"><code>String.replace</code></a> be useful?"}],"answers":[{"owner":{"user_id":15167167,"display_name":"cheng gen"},"up_vote_count":1,"is_accepted":false,"creation_date":1674016288,"answer_id":75154697,"body":"<pre><code>List&lt;String&gt; filtersQuery = new ArrayList&lt;&gt;();\n        filtersQuery.add(&quot;brand:nike,adidas&quot;);\n        filtersQuery.add(&quot;category:running&quot;);\n\n        Map&lt;String, String&gt; filtersMap = filtersQuery\n                .stream()\n                .collect(Collectors.toMap(k -&gt; k.split(&quot;:&quot;)[0],\n                        v -&gt; v.split(&quot;:&quot;)[1]));\n\n        System.out.println(filtersMap);\n</code></pre>\n<p>It works.</p>\n"},{"owner":{"user_id":10870817,"display_name":"SoT"},"up_vote_count":2,"is_accepted":true,"creation_date":1674016619,"answer_id":75154733,"body":"<pre><code>List&lt;String&gt; filtersQuery = new ArrayList&lt;&gt;();\n        filtersQuery.add(&quot;brand:nike,adidas&quot;);\n        filtersQuery.add(&quot;category:running&quot;);\n\nMap&lt;String, String&gt; filtersMap = filtersQuery\n                .stream()\n                .map(k -&gt; k.split(&quot;:&quot;))\n                .collect(Collectors.toMap(a -&gt; a[0],\n                        a -&gt; a[1]));\n</code></pre>\n<p>This give you better performance than @cheng gen answer</p>\n"}],"owner":{"user_id":9209289,"display_name":"Troy"},"view_count":53,"up_vote_count":2,"accepted_answer_id":75154733,"answer_count":2,"score":2,"creation_date":1674014461,"question_id":75154561,"body":"<p>I have a method that takes a parameter of filters that is an  ArrayList&lt;&gt;() of strings that I need to split on &quot;:&quot; and put in a map.</p>\n<pre><code>List&lt;String&gt; filtersQuery = new ArrayList&lt;&gt;();\n        filtersQuery.add(&quot;brand:nike,adidas&quot;);\n        filtersQuery.add(&quot;catagory:running&quot;);\n</code></pre>\n<p>And would like the output of the map to be:</p>\n<pre><code>brand=nike,adidas\ncatagory=running\n</code></pre>\n<p>I am currently trying to use stream(). Im new to Java and running into issues with getting it to parse correctly.</p>\n"},{"tags":["java","java-stream"],"comments":[{"owner":{"user_id":2846138,"display_name":"cyberbrain"},"edited":false,"comment_id":132614549,"body":"are you sure you want to map everything on your own and not use something more flexible like <a href=\"https://modelmapper.org/\" rel=\"nofollow noreferrer\">ModelMapper</a>? The task looks predestined for a mapping lib."},{"owner":{"user_id":7447660,"display_name":"Koenigsberg"},"edited":false,"comment_id":132626314,"body":"@cyberbrain How to use that mapper to achieve my task? The mapping is not from <code>C</code> to <code>D</code>, but from <code>C</code> to a collection of objects <code>D</code>, where these are different permutations of <code>C</code> and collections held by <code>C</code> and more collections down the object hierarchy. After looking at the documentation I don&#39;t see yet how to achieve that, without defining custom property mappings that are probably more complex than just using <code>stream</code> for this specific use case. Can you apply &quot;ModelMapper&quot; to my trivial example (the real classes are even more convoluted)?"}],"answers":[{"owner":{"user_id":5176992,"display_name":"Eritrean"},"up_vote_count":3,"is_accepted":true,"creation_date":1673978044,"answer_id":75150366,"body":"<p>In order to get the same result as with your classical for-loop approach you need to use <code>flatMap</code>. Get the list of <code>B</code> s from your object and stream over it, flatmap and get every <code>A</code> for each <code>B</code> by calling <code>getBList()</code> and map the data to a new <code>D</code> object and finally collect to list of <code>D</code> objects. Something like below should give you what you are looking for</p>\n<pre><code>C c = someGetterForC();\n\nList&lt;D&gt; dList = c.getCList()\n                 .stream()\n                 .flatMap(b -&gt; b.getBList()\n                                .stream()\n                                .map(a -&gt; new D(a.getA1(), b.getB1(), c.getC1(), c.getC2())))\n                 .collect(Collectors.toList());\n</code></pre>\n"}],"owner":{"user_id":7447660,"display_name":"Koenigsberg"},"view_count":45,"up_vote_count":2,"accepted_answer_id":75150366,"answer_count":1,"score":2,"creation_date":1673975578,"question_id":75149964,"body":"<h3>Problem statement</h3>\n<p>In my architecture there are data objects which I intend to display in a structured fashion. These objects look like this:</p>\n<pre><code>public class A\n{\n   private final String a1;\n\n   public A( String a1 )\n   {\n      this.a1 = a1;\n   }\n\n   public String getA1()\n   {\n      return a1;\n   }\n}\n</code></pre>\n<pre><code>public class B\n{\n   private final String b1;\n   private final List&lt;A&gt; bList;\n\n   public B( String b1, List&lt;A&gt; list )\n   {\n      this.b1 = b1;\n      this.bList = list;\n   }\n\n   public String getB1()\n   {\n      return b1;\n   }\n\n   public List&lt;A&gt; getBList()\n   {\n      return bList;\n   }\n}\n</code></pre>\n<pre><code>public class C\n{\n   private final String c1;\n   private final int c2;\n   private final List&lt;B&gt; cList;\n\n   public C( String c1, int c2, List&lt;B&gt; list )\n   {\n      this.c1 = c1;\n      this.c2 = c2;\n      this.cList = list;\n   }\n\n   public String getC1()\n   {\n      return c1;\n   }\n\n   public int getC2()\n   {\n      return c2;\n   }\n\n   public List&lt;B&gt; getCList()\n   {\n      return cList;\n   }\n}\n</code></pre>\n<p>So an object <code>C</code> holds some values, as well as a list of objects <code>B</code> and those objects <code>B</code> hold some values of their own as well as respectively a list of objects <code>A</code>, which in turn hold some values themselves.</p>\n<p>The requirements I am trying to comply with are <strong>putting these into a JSON structure</strong> and also <strong>create a list of objects, where every entry looks like a collection of all of those data properties in a single object</strong>. The latter is supposed to look like this:</p>\n<pre><code>public class D\n{\n   public final String a1;\n   public final String b1;\n   public final String c1;\n   public final int c2;\n\n   public D( String a1, String b1, String c1, int c2 )\n   {\n      this.a1 = a1;\n      this.b1 = b1;\n      this.c1 = c1;\n      this.c2 = c2;\n   }\n}\n</code></pre>\n<p>The declared goal is to have those collected in a <code>List&lt;D&gt;</code>.</p>\n<h3>My solutions so far</h3>\n<p>The JSON structuring was easy to accomplish with Jackson:</p>\n<pre><code>C c = someGetterForC();\nObjectMapper mapper = new ObjectMapper();\nmapper.enable( SerializationFeature.INDENT_OUTPUT );\ntry\n{\n   return mapper.writeValueAsString( c );\n}\ncatch( JsonProcessingException e )\n{\n   // do error handling here\n}\n</code></pre>\n<p>This gives me a well formatted JSON string and complies with the first requirement. For the second requirement I initially used a very trivial approach, <em>i.e.</em>  simply to collect all data in <code>for</code>-loops, thereby creating instances of <code>D</code> and putting them in a list. This looked somewhat like this:</p>\n<pre><code>List&lt;D&gt; dList = new ArrayList&lt;&gt;();\nC c = someGetterForC();\nfor( B b : c.getCList() )\n{\n   for( A a : b.getBList() )\n   {\n      D d = new D( a.getA1(), b.getB1(), c.getC1(), c.getC2() )\n      dList.add( d );\n   }\n}\n</code></pre>\n<p>However I would like to learn to do this using Java-Streams in order to create instances of <code>D</code>, because I am still having trouble with understanding some of its concepts. The struggle I am facing is with</p>\n<ul>\n<li>Streaming the list of objects <code>A</code> after streaming lists of object <code>B</code></li>\n<li>Accessing non-list members from <code>A</code>, <code>B</code> and <code>C</code> in the same call and collecting them in instances of <code>D</code></li>\n</ul>\n<p><strong>Can this be done in a single stream-API call, <em>i.e.</em></strong></p>\n<pre><code>C c = someGetterForC();\nc.stream()\n// how to continue?\n</code></pre>\n<p><strong>and if so, does it make sense to do so?</strong></p>\n<h3>Notes</h3>\n<ul>\n<li>Java 11 is mandatory, the project has currently no access to newer Java data structures</li>\n<li>The fact that given the <code>for</code>-loops there will be redundant data in the instances of <code>D</code> is of no concern and intended</li>\n</ul>\n<h3>Example</h3>\n<p>Assume there is an object <code>C c_alpha</code> which holds:</p>\n<pre><code>c1 = &quot;car&quot;\nc2 = 42;\ncList = {b_alpha, b_beta}\n</code></pre>\n<p>Where <code>B b_alpha</code> holds:</p>\n<pre><code>b1 = &quot;boulder&quot;\nbList = {a_alpha}\n</code></pre>\n<p>And <code>B b_beta</code> holds:</p>\n<pre><code>b1 = &quot;bomb&quot;\nbList = {a_beta, a_gamma}\n</code></pre>\n<p>Lastly there are the type <code>A</code> objects left, <code>A a_alpha</code> holds:</p>\n<pre><code>a1 = &quot;ape&quot;\n</code></pre>\n<p><code>A a_beta</code> holds:</p>\n<pre><code>a1 = &quot;andromeda&quot;\n</code></pre>\n<p>And <code>A a_gamma</code> holds:</p>\n<pre><code>a1 = &quot;axe&quot;\n</code></pre>\n<p>Then the collected list of objects <code>D</code> that I am trying to get by leveraging the stream-API should look like this:</p>\n<pre><code>{ &quot;42&quot;, &quot;car&quot;, &quot;boulder&quot;, &quot;ape&quot; },\n{ &quot;42&quot;, &quot;car&quot;, &quot;bomb&quot;, &quot;andromeda&quot; },\n{ &quot;42&quot;, &quot;car&quot;, &quot;bomb&quot;, &quot;axe&quot; },\n</code></pre>\n<h3>TL;DR</h3>\n<p>Given objects which hold primitive types + strings as members, as well as lists of objects, which in turn hold primitive types + strings as members as well as lists of objects - how to stream them in a single call to retrieve tuples of the primitive types + strings accross all types in a single call?</p>\n<p>I realize this is hard to properly formulate, the example above should clear things up.</p>\n"},{"tags":["java","javafx","3d","blender","javafx-3d"],"answers":[{"owner":{"user_id":7587451,"display_name":"Giovanni Contreras"},"up_vote_count":3,"is_accepted":true,"creation_date":1673815691,"answer_id":75128302,"body":"<p><strong>Importing from blender 3.3.1  to javafx 17.0.2 or ++</strong></p>\n<p><strong>Blender</strong></p>\n<p>In blender highlight the mesh you want to export , then choose File &gt;&gt; export &gt;&gt; wavefront (.obj).\nSince javafx is -Y  axis up and +z forward ; you have to tweak export settings like so :</p>\n<p><a href=\"https://i.stack.imgur.com/g4JOd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/g4JOd.png\" alt=\"obj export blender\" /></a></p>\n<p><strong>3DViewer</strong></p>\n<p><a href=\"https://github.com/Eclion/3DViewer/blob/master/src/main/java/com/javafx/experiments/importers/Importer3D.java\" rel=\"nofollow noreferrer\">3DViewer</a> app (made with javafx) allow to export into fxml or java class . In this approach I'll export as fxml file</p>\n<p><a href=\"https://i.stack.imgur.com/SnCBf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SnCBf.png\" alt=\"3dviewer\" /></a></p>\n<p><strong>Javafx</strong></p>\n<p>The root of the exported fxml file is <code>group</code> node and its child is a <code>meshview</code>. In order to cast as meshview we need to erase group and children tags.</p>\n<p>This is a single javafx app with a fxml file you can try</p>\n<p><strong>App.class</strong></p>\n<pre><code>public class App extends Application {\n\n    @Override\n    public void start(Stage stage) throws IOException {\n        PerspectiveCamera camera = new PerspectiveCamera(true);\n        camera.setTranslateZ(-10);\n\n        FXMLLoader loader = new FXMLLoader(App.class.getResource(&quot;/suzzane.fxml&quot;));\n        loader.load();\n        MeshView mesh = (MeshView) loader.getRoot();\n        Group group3d = new Group(camera, mesh);\n        Scene scene = new Scene(group3d, 640, 480, true, SceneAntialiasing.BALANCED);\n        scene.setCamera(camera);\n        stage.setScene(scene);\n        stage.setTitle(&quot;suzzane import&quot;);\n        stage.show();\n    }\n\n    public static void main(String[] args) {\n        launch();\n    }\n\n}\n</code></pre>\n<p><strong>suzzane.fxml</strong></p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n\n&lt;?import javafx.scene.*?&gt;\n&lt;?import javafx.scene.paint.*?&gt;\n&lt;?import javafx.scene.shape.*?&gt;\n\n\n    &lt;MeshView id=&quot;default&quot;&gt;\n      &lt;material&gt;\n        &lt;PhongMaterial diffuseColor=&quot;#93C54B&quot;/&gt;\n      &lt;/material&gt;\n      &lt;mesh&gt;\n        &lt;TriangleMesh&gt;\n          &lt;points&gt;\n            0.467091, -0.308394, -0.768123, 0.411605, -0.129821, -0.794655, 0.633369, -0.242106, -0.566534, -0.411605, -0.129821, -0.794655, -0.466618, -0.309081, -0.76814, -0.633263, -0.24203, -0.566494, 0.348823, 0.039891, -0.626154, 0.546875, -0.054688, -0.578125, -0.348823, 0.039891, -0.626154, -0.546875, -0.054688, -0.578125, 0.243436, -0.183277, -0.809088, -0.243136, -0.183168, -0.809604, 0.065623, -0.241473, -0.664332, 0.15625, -0.054688, -0.648438, 0.296268, -0.364523, -0.805121, -0.293751, -0.363527, -0.805224, -0.066086, -0.241075, -0.663968, -0.15625, -0.4375, -0.648438, -0.351562, -0.515625, -0.617188, 0.546875, -0.4375, -0.578125, 0.351562, -0.515625, -0.617188, -0.248244, -0.648821, -0.854577, -0.253433, -0.768836, -0.748109, -0.730324, -0.381592, -0.681374, -0.261609, -0.481956, -0.761877, -0.006031, -0.325982, -0.829469, 0.109622, 0.127367, -0.784855, 0.404942, 0.022652, -0.679367, 0.207694, -0.152361, -0.750915, -0.102173, -0.130465, -0.742287, 0.017284, 0.984477, -0.591458, -0.065943, 0.865276, -0.683015, -0.272967, 0.886192, -0.649776, 0.081207, 0.860197, -0.701942, 0.356416, 0.923432, -0.574956, 0.065857, 0.759863, -0.734646, 0.14146, 0.23819, -0.733421, 0.130492, 0.225592, -0.812825, -0.130561, 0.226255, -0.812502, -0.091305, 0.118257, -0.792388, -0.138343, 0.24268, -0.73199, 0.031197, 0.157521, -0.82214, 0.0, 0.140625, -0.742188, 0.0, 0.1875, -0.796875, 0.0, 0.195312, -0.75, -0.00351, 0.332462, -0.762465, -0.098573, 0.730395, -0.728907, 0.093144, 0.792467, -0.647164, 0.611977, -0.172832, -0.665211, 0.373829, -0.086535, -0.728236, -0.46076, -0.120128, -0.707842, -0.539893, 0.002377, -0.638478, -0.374026, -0.085633, -0.727129, -0.543159, -0.212734, -0.683209, -0.574115, -0.365077, -0.686721, -0.412973, -0.388532, -0.752534, 0.19815, -0.3041, -0.760369, 0.293952, -0.398592, -0.778324, 0.306832, -0.476701, -0.752781, -0.280962, -0.396572, -0.770937, 0.41156, -0.390627, -0.752042, 0.551672, -0.288132, -0.675783, 0.572695, -0.365439, -0.688196, -0.54685, -0.292564, -0.686891, 0.546875, -0.210938, -0.671875, 0.460938, -0.117188, -0.703125, 0.242188, -0.125, -0.757812, -0.121205, -0.483398, -0.607582, -4.67E-4, -0.418818, -0.744456, 0.05374, -0.428979, -0.616572, -0.261462, -0.709033, -0.606235, -0.457458, -0.528564, -0.474708, 0.795853, -0.151428, -0.417778, 0.717463, -0.403459, -0.312642, 0.841731, -0.416465, -0.572731, 2.82E-4, 0.495311, -0.307091, 0.321192, 0.910612, -0.408725, -0.027229, 0.950352, -0.402103, -0.214052, 0.41023, -0.341908, -0.364485, 0.934935, -0.527463, -0.322199, 0.914282, -0.396656, 0.199753, 0.398234, -0.297475, -0.223717, 0.193371, -0.529801, -0.574942, 0.088264, -0.540223, -0.436074, 0.104066, -0.453043, 0.347695, 0.237654, 0.431147, 0.0, 0.382812, 0.351562, -0.011619, 0.07516, 0.77936, 0.465608, -0.900982, -0.152219, 0.0, -0.984375, 0.078125, 0.0, -0.898438, -0.289062, 0.45972, -0.41102, 0.70957, 0.770823, -0.623203, 0.342437, 0.833846, -0.352238, 0.391235, 0.781498, -0.576058, -0.095848, -0.781498, -0.576058, -0.095848, -0.476077, -0.899132, -0.128827, -0.774117, -0.618565, 0.345925, 0.260303, -0.708855, -0.607407, 0.460237, -0.527298, -0.472638, -0.803836, -0.161472, -0.420019, -0.711654, -0.400774, -0.307327, -0.79584, -0.041023, -0.158112, 0.838238, -0.304138, 0.194035, -0.851212, -0.363598, 0.191879, 0.539567, 0.142898, 0.15848, 0.527753, 0.047276, -0.4504, 0.814251, -0.064879, -0.177529, 0.53391, -0.047078, 0.538381, -0.490828, -0.417757, 0.691108, -0.39169, 0.080613, 0.56466, -1.210536, -0.48592, 0.399701, -1.36325, -0.31343, 0.444733, -1.233435, -0.252704, 0.432477, 1.234498, -0.248681, 0.433467, 1.238196, -0.056204, 0.404615, 1.36328, -0.310916, 0.445376, -0.845118, 0.049599, 0.146843, -1.048997, 0.073373, 0.319236, -0.637334, 0.131573, 0.129306, 1.142695, -0.041631, 0.458032, 1.037881, 0.075968, 0.309556, 1.170774, -0.345162, 0.460286, 1.207696, -0.489413, 0.396355, 0.709322, 0.014957, 0.168345, -0.712712, -0.004226, 0.186871, 0.799217, 0.111136, 0.120197, 0.851778, 4.11E-4, 0.293091, -0.849688, 0.002268, 0.295795, -0.795922, -0.102855, 0.308274, -0.980884, -0.37646, 0.258508, 0.790779, -0.104465, 0.308961, 0.972471, -0.311042, 0.359196, 1.005483, -0.430324, 0.271337, 1.059998, -0.205557, 0.380618, -1.074143, -0.218953, 0.386767, -1.147014, -0.048217, 0.43788, -1.170348, -0.345691, 0.460999, -0.95787, -0.304972, 0.342476, 1.227002, -0.480829, 0.552827, -0.831749, -0.350337, 0.387405, -1.223191, -0.48949, 0.551496, -1.315084, -0.07219, 0.487198, -1.039062, 0.085938, 0.492188, 1.225087, 0.009861, 0.547001, 0.789062, 0.125, 0.328125, -0.15625, -0.054688, -0.648438, 0.15625, -0.4375, -0.648438, -0.546875, -0.4375, -0.578125, 0.223095, 0.182572, -0.53752, 0.582274, 0.083975, -0.538726, 0.701861, -0.406364, -0.701875, -0.852831, -0.421193, -0.58827, 0.253604, -0.768544, -0.74656, 0.252976, -0.656178, -0.850654, -0.196071, -0.294624, -0.761091, -0.22714, -0.134763, -0.760223, -0.352624, 0.254787, 0.24985, 0.0, -0.5625, 0.851562, 0.453125, -0.867188, 0.382812, 0.0, -0.898438, 0.546875, -0.453125, -0.867188, 0.382812, -0.738105, 0.086049, 0.332369\n          &lt;/points&gt;\n          &lt;texCoords&gt;\n            0.900073, 0.39930397, 0.865294, 0.40357202, 0.920246, 0.47563398, 0.863045, 0.185498, 0.897948, 0.18823099, 0.914742, 0.11107397, 0.798506, 0.430448, 0.853018, 0.47843802, 0.79513, 0.161614, 0.847458, 0.11125201, 0.860051, 0.36913502, 0.859266, 0.22008902, 0.842259, 0.297248, 0.791018, 0.35455698, 0.897193, 0.36556703, 0.896148, 0.22239, 0.84475, 0.29274702, 0.92118, 0.286287, 0.968213, 0.22978002, 0.968392, 0.426188, 0.968392, 0.354667, 0.434535, 0.619641, 0.424353, 0.599433, 0.354303, 0.679791, 0.438956, 0.65699, 0.52203, 0.65392303, 0.540503, 0.80829203, 0.620264, 0.765208, 0.576273, 0.720769, 0.491024, 0.739273, 0.521557, 0.947385, 0.513037, 0.927336, 0.494152, 0.932383, 0.527362, 0.927079, 0.551123, 0.937522, 0.525584, 0.914574, 0.548649, 0.835652, 0.536374, 0.824051, 0.501713, 0.824062, 0.500449, 0.808166, 0.489319, 0.834218, 0.524426, 0.814906, 0.519841, 0.799157, 0.519132, 0.814618, 0.517577, 0.809393, 0.517872, 0.846092, 0.5083, 0.914279, 0.523492, 0.921718, 0.655324, 0.728105, 0.612627, 0.73852897, 0.408797, 0.730193, 0.391525, 0.749842, 0.42627, 0.736427, 0.39158, 0.71265304, 0.384364, 0.687312, 0.41354, 0.675645, 0.57959, 0.68933904, 0.603696, 0.672222, 0.610356, 0.660578, 0.439501, 0.66901803, 0.626943, 0.67934597, 0.649104, 0.702423, 0.658692, 0.68921, 0.390612, 0.69717896, 0.647785, 0.716514, 0.629829, 0.732737, 0.585166, 0.72900903, 0.492809, 0.565462, 0.523776, 0.613289, 0.537579, 0.566644, 0.415857, 0.569509, 0.350292, 0.603771, 0.722013, 0.738732, 0.766492, 0.69154596, 0.706787, 0.688868, 0.643405, 0.980296, 0.558356, 0.946276, 0.539877, 0.978673, 0.394896, 0.980785, 0.511783, 0.978442, 0.399481, 0.917884, 0.484771, 0.940064, 0.479748, 0.946195, 0.645964, 0.917111, 0.423632, 0.841861, 0.370168, 0.775519, 0.355825, 0.803544, 0.823446, 0.908269, 0.805584, 0.989214, 0.923249, 0.938283, 0.871997, 0.672153, 0.962901, 0.655248, 0.911671, 0.597571, 0.907785, 0.816683, 0.861899, 0.763958, 0.836684, 0.796094, 0.819308, 0.721411, 0.208596, 0.712271, 0.14722, 0.65815496, 0.159892, 0.759454, 0.817923, 0.542867, 0.763149, 0.568545, 0.786595, 0.63099897, 0.279331, 0.54214203, 0.217614, 0.522479, 0.249207, 0.612036, 0.845499, 0.550033, 0.314147, 0.733427, 0.262597, 0.68316, 0.259721, 0.79195297, 0.819338, 0.78603697, 0.203277, 0.782518, 0.78178, 0.858065, 0.68138, 0.79565597, 0.772331, 0.789913, 0.854987, 0.858227, 0.114059, 0.820314, 0.107997, 0.953605, 0.178798, 0.892743, 0.162246, 0.13434899, 0.137396, 0.22570097, 0.185423, 0.21681798, 0.570175, 0.21110398, 0.55487, 0.25643897, 0.618903, 0.21866101, 0.317028, 0.31699502, 0.253991, 0.300781, 0.357746, 0.37724602, 0.52947, 0.248371, 0.504669, 0.295955, 0.553337, 0.18053901, 0.591638, 0.128066, 0.796877, 0.82160103, 0.245969, 0.848998, 0.230248, 0.820848, 0.436457, 0.33172297, 0.393069, 0.30981702, 0.391039, 0.38810903, 0.369361, 0.303954, 0.442893, 0.274863, 0.316181, 0.279792, 0.343481, 0.14339602, 0.332923, 0.25175, 0.305456, 0.13818902, 0.425874, 0.24626398, 0.488922, 0.17751598, 0.451245, 0.12131101, 0.507886, 0.21216601, 0.247626, 0.21315002, 0.22592, 0.255782, 0.202249, 0.18607098, 0.276772, 0.18210399, 0.661965, 0.26444602, 0.707492, 0.240116, 0.742304, 0.40264302, 0.044323, 0.457691, 0.10675, 0.41741103, 0.095807, 0.274346, 0.183755, 0.274588, 0.216123, 0.32187998, 0.568363, 0.287686, 0.658213, 0.414324, 0.484068, 0.371224, 0.498072, 0.447685, 0.791018, 0.23776197, 0.918898, 0.30030298, 0.965038, 0.15832901, 0.611847, 0.840123, 0.667757, 0.776498, 0.680013, 0.679761, 0.330866, 0.682853, 0.619594, 0.603917, 0.609776, 0.62346804, 0.461186, 0.688787, 0.45683, 0.724813, 0.628962, 0.57457304, 0.692106, 0.611726, 0.73401, 0.68208396, 0.232648, 0.996516, 0.24649, 0.90672, 0.994525, 0.832295, 0.91536, 0.740196, 0.999856, 0.74536, 0.011829, 0.844633, 0.1064, 0.567348, 0.043968, 0.632962, 1.44E-4, 0.740887, 0.098965, 0.733032, 0.176788, 0.80382097, 0.196622, 0.844759, 0.392564, 0.17668003, 0.27347, 0.39535397, 0.049526, 0.251176, 0.834578, 0.793121\n          &lt;/texCoords&gt;\n          &lt;faces&gt;\n            0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 1, 1, 6, 6, 7, 7, 8, 8, 3, 3, 9, 9, 1, 1, 10, 10, 6, 6, 11, 11, 3, 3, 8, 8, 12, 12, 13, 13, 10, 10, 10, 10, 14, 14, 12, 12, 15, 15, 11, 11, 16, 16, 15, 15, 16, 16, 17, 17, 15, 15, 17, 17, 18, 18, 2, 2, 19, 19, 0, 0, 1, 1, 14, 14, 10, 10, 11, 11, 15, 15, 3, 3, 1, 1, 0, 0, 14, 14, 15, 15, 4, 4, 3, 3, 20, 20, 14, 14, 0, 0, 20, 20, 0, 0, 19, 19, 21, 21, 22, 22, 23, 23, 24, 24, 25, 25, 21, 21, 23, 23, 24, 24, 21, 21, 26, 26, 27, 27, 28, 28, 28, 28, 29, 29, 26, 26, 30, 30, 31, 31, 32, 32, 33, 33, 34, 34, 35, 35, 36, 36, 35, 35, 34, 34, 26, 26, 37, 37, 36, 36, 38, 38, 39, 39, 40, 40, 41, 41, 26, 26, 42, 42, 43, 43, 42, 42, 44, 44, 43, 43, 42, 42, 39, 39, 40, 40, 45, 45, 38, 38, 41, 41, 45, 45, 37, 37, 45, 45, 41, 41, 38, 38, 42, 42, 26, 26, 29, 29, 39, 39, 42, 42, 29, 29, 35, 35, 46, 46, 47, 47, 31, 31, 47, 47, 46, 46, 27, 27, 48, 48, 49, 49, 50, 50, 51, 51, 52, 52, 53, 53, 51, 51, 50, 50, 24, 24, 54, 54, 55, 55, 56, 56, 57, 57, 58, 58, 24, 24, 55, 55, 59, 59, 60, 60, 61, 61, 62, 62, 54, 54, 53, 53, 63, 63, 48, 48, 64, 64, 65, 65, 49, 49, 66, 66, 28, 28, 67, 67, 68, 68, 69, 69, 22, 22, 70, 70, 71, 71, 72, 72, 73, 73, 74, 74, 75, 75, 76, 76, 77, 77, 75, 78, 77, 79, 78, 80, 77, 79, 79, 81, 80, 82, 34, 34, 76, 76, 81, 83, 80, 82, 79, 81, 78, 80, 76, 76, 75, 75, 81, 83, 82, 84, 83, 85, 84, 86, 85, 87, 86, 88, 87, 89, 88, 90, 89, 91, 90, 92, 91, 93, 92, 94, 93, 95, 88, 90, 94, 96, 92, 94, 95, 97, 96, 98, 97, 99, 69, 100, 98, 101, 99, 102, 70, 103, 67, 104, 71, 105, 69, 100, 99, 102, 67, 106, 100, 107, 101, 108, 102, 109, 103, 110, 92, 94, 94, 96, 97, 99, 104, 111, 95, 97, 92, 94, 103, 110, 93, 95, 85, 87, 105, 112, 81, 83, 106, 113, 105, 112, 107, 114, 84, 86, 78, 80, 82, 84, 108, 115, 91, 93, 93, 95, 109, 116, 87, 117, 110, 118, 111, 119, 112, 120, 113, 121, 114, 122, 115, 123, 116, 124, 117, 125, 118, 126, 119, 127, 115, 123, 120, 128, 121, 129, 122, 130, 114, 122, 123, 131, 105, 112, 124, 132, 107, 114, 119, 133, 102, 109, 125, 134, 126, 135, 124, 136, 105, 137, 119, 127, 125, 138, 117, 125, 107, 114, 124, 132, 103, 110, 126, 135, 127, 139, 124, 136, 128, 140, 117, 125, 125, 138, 104, 141, 129, 142, 125, 138, 104, 141, 130, 143, 129, 142, 102, 109, 104, 111, 125, 134, 131, 144, 132, 145, 133, 146, 127, 139, 134, 147, 131, 144, 131, 144, 134, 147, 132, 145, 120, 128, 134, 147, 127, 139, 135, 148, 136, 149, 128, 140, 134, 147, 120, 128, 114, 122, 122, 130, 134, 147, 114, 122, 135, 148, 137, 150, 113, 121, 132, 145, 134, 147, 122, 130, 137, 150, 135, 148, 138, 151, 116, 124, 139, 152, 123, 153, 123, 153, 139, 152, 133, 154, 104, 155, 140, 156, 141, 157, 142, 158, 141, 157, 143, 159, 139, 152, 116, 124, 144, 160, 142, 158, 112, 120, 141, 157, 93, 161, 145, 162, 108, 163, 2, 2, 1, 1, 7, 7, 9, 9, 3, 3, 5, 5, 6, 6, 10, 10, 13, 13, 146, 164, 11, 11, 8, 8, 16, 16, 11, 11, 146, 164, 14, 14, 147, 165, 12, 12, 14, 14, 20, 20, 147, 165, 18, 18, 148, 166, 4, 4, 18, 18, 4, 4, 15, 15, 82, 84, 79, 81, 32, 32, 82, 84, 32, 32, 40, 40, 5, 5, 4, 4, 148, 166, 32, 32, 79, 81, 30, 30, 149, 167, 36, 36, 34, 34, 27, 27, 26, 26, 149, 167, 27, 27, 149, 167, 150, 168, 82, 84, 39, 39, 51, 51, 82, 84, 51, 51, 83, 85, 48, 48, 72, 72, 74, 74, 48, 48, 74, 74, 151, 169, 150, 168, 48, 48, 27, 27, 150, 168, 72, 72, 48, 48, 51, 51, 100, 107, 83, 85, 51, 51, 23, 23, 152, 170, 51, 51, 152, 170, 100, 107, 151, 169, 74, 74, 153, 171, 151, 169, 153, 171, 154, 172, 154, 172, 153, 171, 68, 68, 154, 172, 68, 68, 25, 25, 22, 22, 152, 170, 23, 23, 21, 21, 25, 25, 68, 68, 21, 21, 68, 68, 22, 22, 25, 25, 56, 56, 58, 58, 25, 25, 58, 58, 154, 172, 58, 58, 62, 62, 151, 169, 58, 58, 151, 169, 154, 172, 54, 54, 23, 23, 51, 51, 54, 54, 51, 51, 53, 53, 23, 23, 54, 54, 24, 24, 48, 48, 151, 169, 62, 62, 29, 29, 28, 28, 56, 56, 29, 29, 56, 56, 25, 25, 39, 39, 29, 29, 51, 51, 25, 25, 24, 24, 155, 173, 30, 30, 34, 34, 33, 33, 30, 30, 33, 33, 31, 31, 29, 29, 25, 25, 155, 173, 40, 40, 32, 32, 46, 46, 40, 40, 46, 46, 45, 45, 31, 31, 46, 46, 32, 32, 46, 46, 35, 35, 36, 36, 46, 46, 36, 36, 45, 45, 29, 29, 156, 174, 52, 52, 29, 29, 52, 52, 51, 51, 43, 43, 41, 41, 42, 42, 36, 36, 37, 37, 45, 45, 39, 39, 41, 41, 43, 43, 37, 37, 26, 26, 41, 41, 38, 38, 41, 41, 39, 39, 149, 167, 26, 26, 36, 36, 40, 40, 39, 39, 82, 84, 33, 33, 47, 47, 31, 31, 33, 33, 35, 35, 47, 47, 156, 174, 29, 29, 155, 173, 28, 28, 27, 27, 49, 49, 64, 64, 48, 48, 62, 62, 64, 64, 62, 62, 61, 61, 58, 58, 60, 60, 62, 62, 155, 173, 24, 24, 59, 59, 58, 58, 57, 57, 60, 60, 55, 55, 54, 54, 63, 63, 98, 175, 69, 69, 68, 68, 98, 175, 68, 68, 153, 171, 48, 48, 65, 65, 49, 49, 68, 68, 67, 67, 70, 70, 68, 68, 70, 70, 22, 22, 99, 176, 153, 171, 74, 74, 99, 176, 74, 74, 73, 177, 153, 171, 99, 176, 98, 175, 71, 71, 101, 108, 152, 170, 71, 71, 152, 170, 22, 22, 77, 79, 76, 76, 34, 34, 77, 79, 34, 34, 30, 30, 100, 107, 152, 170, 101, 108, 72, 72, 150, 168, 106, 113, 84, 86, 83, 85, 100, 107, 77, 79, 30, 30, 79, 81, 86, 178, 157, 179, 110, 118, 86, 178, 110, 118, 87, 117, 78, 80, 77, 79, 80, 82, 149, 167, 34, 34, 81, 83, 78, 80, 79, 81, 82, 84, 149, 167, 106, 113, 150, 168, 108, 115, 85, 87, 87, 89, 81, 83, 75, 75, 86, 88, 81, 83, 86, 88, 85, 87, 86, 178, 75, 78, 78, 80, 86, 178, 78, 80, 157, 179, 87, 89, 158, 180, 91, 93, 87, 89, 91, 93, 108, 115, 72, 72, 106, 113, 107, 114, 102, 109, 84, 86, 100, 107, 159, 181, 160, 182, 89, 91, 159, 181, 89, 91, 88, 90, 109, 116, 158, 183, 87, 117, 96, 98, 90, 184, 89, 185, 89, 185, 160, 186, 161, 187, 89, 185, 161, 187, 96, 98, 91, 93, 158, 180, 160, 182, 91, 93, 160, 182, 159, 181, 160, 186, 158, 183, 109, 116, 160, 186, 109, 116, 161, 187, 73, 73, 94, 96, 88, 90, 73, 73, 88, 90, 99, 102, 109, 116, 140, 188, 97, 99, 91, 93, 159, 181, 92, 94, 97, 99, 161, 187, 109, 116, 159, 181, 88, 90, 92, 94, 97, 99, 96, 98, 161, 187, 96, 98, 95, 97, 101, 108, 96, 98, 101, 108, 71, 105, 90, 92, 67, 106, 99, 102, 90, 92, 99, 102, 88, 90, 90, 184, 96, 98, 71, 105, 90, 184, 71, 105, 67, 104, 94, 96, 73, 73, 107, 114, 94, 96, 107, 114, 103, 110, 72, 72, 107, 114, 73, 73, 102, 109, 101, 108, 95, 97, 102, 109, 95, 97, 104, 111, 119, 133, 157, 179, 84, 86, 119, 133, 84, 86, 102, 109, 97, 99, 140, 188, 104, 111, 157, 179, 78, 80, 84, 86, 81, 83, 105, 112, 106, 113, 81, 83, 106, 113, 149, 167, 109, 116, 110, 118, 162, 189, 109, 116, 162, 189, 140, 188, 162, 189, 110, 118, 157, 179, 162, 189, 157, 179, 119, 133, 142, 158, 136, 149, 113, 121, 142, 158, 113, 121, 112, 120, 85, 87, 108, 115, 105, 112, 111, 119, 130, 143, 104, 141, 123, 131, 114, 122, 116, 124, 127, 139, 126, 135, 121, 129, 127, 139, 121, 129, 120, 128, 136, 149, 142, 158, 118, 126, 123, 131, 133, 146, 132, 145, 123, 131, 132, 145, 122, 130, 117, 125, 136, 149, 118, 126, 114, 122, 120, 128, 115, 123, 137, 150, 111, 119, 113, 121, 111, 119, 137, 150, 138, 151, 111, 119, 138, 151, 130, 143, 138, 151, 135, 148, 128, 140, 138, 151, 128, 140, 129, 142, 131, 144, 124, 136, 127, 139, 128, 140, 125, 138, 129, 142, 103, 190, 124, 136, 131, 144, 103, 190, 131, 144, 133, 146, 129, 142, 130, 143, 138, 151, 136, 149, 117, 125, 128, 140, 145, 162, 144, 160, 121, 129, 145, 162, 121, 129, 126, 135, 135, 148, 113, 121, 136, 149, 118, 126, 143, 159, 162, 191, 118, 126, 162, 191, 119, 127, 93, 161, 139, 152, 144, 160, 93, 161, 144, 160, 145, 162, 115, 123, 121, 129, 144, 160, 143, 159, 118, 126, 142, 158, 115, 123, 144, 160, 116, 124, 112, 120, 111, 192, 141, 157, 111, 192, 104, 155, 141, 157, 133, 154, 139, 152, 93, 161, 140, 156, 162, 191, 143, 159, 140, 156, 143, 159, 141, 157, 145, 162, 126, 135, 105, 137, 145, 162, 105, 137, 108, 163, 103, 110, 133, 193, 93, 95\n          &lt;/faces&gt;\n          &lt;faceSmoothingGroups&gt;\n            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8388608, 8388608, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4194304, 0, 0, 0, 536870912, 4194304, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2097152, 2097152, 1048576, 1048576, 0, 0, 0, 524288, 524288, 262144, 262144, 131072, 131072, 0, 0, 0, 65536, 65536, 32768, 32768, 16384, 16384, 0, 8192, 8192, 4096, 4096, 2048, 2048, 1024, 1024, 0, 0, 512, 512, 0, 0, 256, 256, 0, 128, 128, 0, 64, 64, 32, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16, 16, 0, 0, 0, 0, 8, 8, 0, 4, 4, 2, 2, 0, 1, 1, -2147483648, -2147483648, 0, 0, 0, 0, 1073741824, 1073741824, 0, 0, 536870912, 0, 0, 268435456, 268435456, 134217728, 134217728, 67108864, 67108864, 0, 0, 33554432, 33554432, 0, 0, 16777216, 16777216, 8388608, 8388608, 4194304, 4194304, 2097152, 2097152, 0, 0, 0, 0, 0, 1048576, 1048576, 524288, 524288, 262144, 262144, 131072, 131072, 0, 65536, 65536, 32768, 32768, 0, 0, 16384, 16384, 8192, 8192, 4096, 4096, 2048, 2048, 0, 0, 0, 1024, 1024, 0, 512, 512, 0, 0, 0, 256, 256, 128, 128, 0, 0, 0, 0, 0, 0, 64, 64, 0, 32, 32, 16, 16, 0, 0, 0, 0, 8, 4, 2, 2, 1, 1, 0\n          &lt;/faceSmoothingGroups&gt;\n        &lt;/TriangleMesh&gt;\n      &lt;/mesh&gt;\n    &lt;/MeshView&gt;\n  \n</code></pre>\n<p><strong>result</strong></p>\n<p>*this is a decimated version of suzzane primitive</p>\n<p><a href=\"https://i.stack.imgur.com/GPPYF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GPPYF.png\" alt=\"import 3d javafx\" /></a></p>\n"}],"owner":{"user_id":7587451,"display_name":"Giovanni Contreras"},"view_count":111,"up_vote_count":2,"accepted_answer_id":75128302,"answer_count":1,"score":2,"creation_date":1673815691,"question_id":75128301,"body":"<p>How to import from blender to javafx properly ? I mean with same orientation 'cause blender is z up and javafx is -y up</p>\n"},{"tags":["java","spring","authentication","spring-security"],"answers":[{"owner":{"user_id":20979858,"display_name":"Harsha Gandikota"},"up_vote_count":3,"is_accepted":true,"creation_date":1673436864,"answer_id":75082379,"body":"<p>This is happening because you have used a STATELESS sessionCreationPolicy in your web security config. The stateless creation policy means that the logged-in user details are not maintained on the server side. This is why you are getting anonymousUser from the principal. The server authenticates the client for each and every single request and checks the authority of the user. This is generally used in situations when the authentication is done using tokens to increase the scalability of the application.\nThe default value of the sessionCreationPolicy attribute is <code>SessionCreationPolicy.IF_REQUIRED</code>. Using this should solve your problem. Let me know if it helps.</p>\n"}],"owner":{"user_id":20981958,"display_name":"Helen Barskaya"},"view_count":80,"up_vote_count":3,"accepted_answer_id":75082379,"answer_count":1,"score":2,"creation_date":1673434577,"question_id":75081942,"body":"<p>I am writing authentication using Spring Security and faced the following problem: after entering my username and password, I am redirected to defaultSuccessUrl(&quot;/&quot;), however, the SecurityContextHolder.getContext() method.getAuthentication().getPrincipal().toString() returns anonimousUser. Why is this happening and how to fix it? I will be grateful for your help.</p>\n<p>Here is the code I wrote.\nMy pom.xml:</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;3.0.1&lt;/version&gt;\n        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;\n    &lt;/parent&gt;\n    &lt;groupId&gt;com.example&lt;/groupId&gt;\n    &lt;artifactId&gt;MyStore&lt;/artifactId&gt;\n    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n    &lt;name&gt;MyStore&lt;/name&gt;\n    &lt;description&gt;MyStore&lt;/description&gt;\n    &lt;properties&gt;\n        &lt;java.version&gt;17&lt;/java.version&gt;\n        &lt;maven.compiler.source&gt;12&lt;/maven.compiler.source&gt;\n        &lt;maven.compiler.target&gt;12&lt;/maven.compiler.target&gt;\n    &lt;/properties&gt;\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.thymeleaf.extras&lt;/groupId&gt;\n            &lt;artifactId&gt;thymeleaf-extras-springsecurity6&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.mysql&lt;/groupId&gt;\n            &lt;artifactId&gt;mysql-connector-j&lt;/artifactId&gt;\n            &lt;scope&gt;runtime&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;\n            &lt;artifactId&gt;lombok&lt;/artifactId&gt;\n            &lt;optional&gt;true&lt;/optional&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n                &lt;configuration&gt;\n                    &lt;excludes&gt;\n                        &lt;exclude&gt;\n                            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;\n                            &lt;artifactId&gt;lombok&lt;/artifactId&gt;\n                        &lt;/exclude&gt;\n                    &lt;/excludes&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n                &lt;configuration&gt;\n                    &lt;source&gt;16&lt;/source&gt;\n                    &lt;target&gt;16&lt;/target&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n\n&lt;/project&gt;\n</code></pre>\n<p>My WebSecurityConfig:</p>\n<pre><code>package com.example.mystore.security;\n\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.security.config.annotation.web.builders.HttpSecurity;\nimport org.springframework.security.config.annotation.web.configurers.AuthorizeHttpRequestsConfigurer;\nimport org.springframework.security.config.annotation.web.configurers.FormLoginConfigurer;\nimport org.springframework.security.config.annotation.web.configurers.LogoutConfigurer;\nimport org.springframework.security.config.http.SessionCreationPolicy;\nimport org.springframework.security.core.userdetails.UserDetailsService;\nimport org.springframework.security.web.SecurityFilterChain;\n\n@Configuration\npublic class WebSecurityConfig {\n\n    protected UserDetailsService userDetailsService;\n\n    public WebSecurityConfig(UserDetailsService userDetailsService) {\n        this.userDetailsService = userDetailsService;\n    }\n\n    public static final String[] possiblePatterns = new String[]{\n            &quot;/&quot;,\n            &quot;/registration&quot;,\n            &quot;/category&quot;,\n            &quot;/style.css&quot;\n    };\n\n    @Bean\n    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {\n        http\n//                .cors()\n//                .and()\n//                .csrf()\n//                .disable()\n\n                .authorizeHttpRequests(this::buildRequests)\n                .formLogin(this::formCustomizer)\n                .logout(LogoutConfigurer::permitAll)\n                .userDetailsService(userDetailsService)\n                .httpBasic()\n                .and()\n                .sessionManagement()\n                .sessionCreationPolicy(SessionCreationPolicy.STATELESS);\n\n        return http.build();\n    }\n\n    protected AuthorizeHttpRequestsConfigurer&lt;HttpSecurity&gt;.AuthorizationManagerRequestMatcherRegistry\n    buildRequests(AuthorizeHttpRequestsConfigurer&lt;HttpSecurity&gt;.AuthorizationManagerRequestMatcherRegistry requests) {\n        return requests.requestMatchers(possiblePatterns)\n                .permitAll()\n                .anyRequest()\n                .permitAll();\n    }\n\n    private FormLoginConfigurer&lt;HttpSecurity&gt; formCustomizer(FormLoginConfigurer&lt;HttpSecurity&gt; form) {\n        return form.loginPage(&quot;/login&quot;)\n                .defaultSuccessUrl(&quot;/&quot;)\n                .permitAll();\n    }\n}\n\n</code></pre>\n<p>User:</p>\n<pre><code>package com.example.mystore.model;\n\nimport jakarta.persistence.*;\nimport lombok.Getter;\nimport lombok.NoArgsConstructor;\nimport lombok.Setter;\nimport org.springframework.security.core.GrantedAuthority;\nimport org.springframework.security.core.authority.SimpleGrantedAuthority;\nimport org.springframework.security.core.userdetails.UserDetails;\n\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.Collection;\nimport java.util.List;\n\n@Entity\n@Table(name = &quot;user&quot;)\n@Getter\n@Setter\n@NoArgsConstructor\npublic class User implements UserDetails, GrantedAuthority {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.AUTO)\n    @Column(name = &quot;id&quot;, nullable = false)\n    protected int id;\n\n    @Column(name = &quot;username&quot;, nullable = false)\n    protected String username;\n\n    @Column(name = &quot;password&quot;, nullable = false)\n    protected String password;\n\n    @Column(name = &quot;role&quot;, nullable = false)\n    protected String role;\n\n    public User(String username, String password, String role) {\n        this.username = username;\n        this.password = password;\n        this.role = role;\n    }\n\n    @Override\n    public Collection&lt;? extends GrantedAuthority&gt; getAuthorities() {\n                return Arrays.stream(this.getRole().split(&quot;,&quot;))\n                .map(SimpleGrantedAuthority::new)\n                .toList();\n    }\n\n    @Override\n    public boolean isAccountNonExpired() {\n        return true;\n    }\n\n    @Override\n    public boolean isAccountNonLocked() {\n        return true;\n    }\n\n    @Override\n    public boolean isCredentialsNonExpired() {\n        return true;\n    }\n\n    @Override\n    public boolean isEnabled() {\n        return true;\n    }\n\n    @Override\n    public String getAuthority() {\n        return getRole();\n    }\n}\n\n</code></pre>\n<p>UserRepository:</p>\n<pre><code>package com.example.mystore.repository;\n\nimport com.example.mystore.model.User;\nimport org.springframework.data.jpa.repository.JpaRepository;\n\nimport java.util.Optional;\n\npublic interface UserRepository extends JpaRepository&lt;User, Integer&gt; {\n    Optional&lt;User&gt; findByUsername(String username);\n}\n\n</code></pre>\n<p>UserService:</p>\n<pre><code>package com.example.mystore.service;\n\nimport com.example.mystore.model.User;\nimport com.example.mystore.repository.UserRepository;\nimport org.springframework.stereotype.Service;\n\nimport java.util.Optional;\n\n@Service\npublic class UserService {\n    UserRepository userRepository;\n\n    public UserService(UserRepository userRepository) {\n        this.userRepository = userRepository;\n    }\n\n    public User saveUser(User user){\n        return userRepository.save(user);\n    }\n    public User getByUsername( String username)\n    {\n        Optional&lt;User&gt; optionalUser = userRepository.findByUsername(username);\n        return optionalUser.orElse(null);\n    }\n}\n\n</code></pre>\n<p>JpaUserDetailService:</p>\n<pre><code>package com.example.mystore.service;\n\nimport com.example.mystore.model.User;\nimport com.example.mystore.repository.UserRepository;\nimport org.springframework.security.core.userdetails.UserDetails;\nimport org.springframework.security.core.userdetails.UserDetailsService;\nimport org.springframework.security.core.userdetails.UsernameNotFoundException;\nimport org.springframework.stereotype.Service;\n\n@Service\npublic class JpaUserDetailsService implements UserDetailsService {\n    UserRepository userRepository;\n\n    public JpaUserDetailsService(UserRepository userRepository) {\n        this.userRepository = userRepository;\n    }\n\n    @Override\n    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {\n        return userRepository\n                .findByUsername(username)\n                .map(this::userMapper)\n                .orElseThrow(() -&gt; new UsernameNotFoundException(&quot;Username not found: &quot; + username));\n    }\n\n    protected User userMapper(User user) {\n        String password = user.getPassword();\n        user.setPassword(&quot;{noop}&quot; + password);\n\n        return user;\n    }\n}\n</code></pre>\n"},{"tags":["java","generics","abstract"],"comments":[{"owner":{"user_id":5133585,"display_name":"Sweeper"},"edited":false,"comment_id":132494913,"body":"In any case, the eclipse compiler is incorrect. Producing an abstract method error at runtime is something that should not happen. It is the compiler&#39;s job to make sure that abstract methods are all implemented, and produce <i>compiler errors</i> if they aren&#39;t. I <i>think</i> <code>javac</code> is correct."}],"answers":[{"owner":{"user_id":773113,"display_name":"Mike Nakis"},"up_vote_count":3,"is_accepted":true,"creation_date":1673430483,"answer_id":75081064,"body":"<p>This is happening because Eclipse does not internally use javac: they have their own java compiler implementation built into Eclipse.</p>\n<p>You can read about it here: <a href=\"https://www.codejava.net/ides/eclipse/why-does-eclipse-use-its-own-java-compiler\" rel=\"nofollow noreferrer\">CodeJava - Why does Eclipse use its own Java compiler?</a></p>\n<p>Obviously, as you have discovered by yourself, the Java compiler that is built into Eclipse does not work in exactly the same way as <code>javac</code>; hence, there will be some discrepancies.</p>\n<p>That was the answer to your question. What follows from here on is opinions.</p>\n<p>Perhaps it made sense for eclipse to contain its own Java compiler back in the days of Java 1.3, when the language was still quite simple, or at any rate back in the days before Java started following a regular two-releases-per-year schedule. Nowadays, maintaining a java compiler implementation that faithfully emulates all of the complexity of <code>javac</code> <em>and</em> following up with new developments of <code>javac</code> that add more and more complexity once or twice a year is an untenable proposition.</p>\n<p>Eclipse should not be trying to do this. It keeps trying to do this because not only it is 30 years old, but in many ways it is also stuck 30 years in the past.</p>\n<p>I know you did not ask for it, but here is my recommendation on how you could avoid this problem:</p>\n<p>Switch to a decent IDE.</p>\n<p>That would be IntelliJ IDEA. IntelliJ IDEA uses Javac. They only use their own built-in parser for syntax highlighting and error underlining, so in the rare event that there is a discrepancy between their own parser and <code>javac</code>, it will only affect visual aspects of editing, it will never affect the actual code which gets generated and which is then run, and debugged.</p>\n"}],"owner":{"user_id":13526853,"display_name":"XenonDB"},"view_count":82,"up_vote_count":2,"accepted_answer_id":75081064,"answer_count":1,"score":2,"creation_date":1673428393,"question_id":75080635,"body":"<p>Recently I'm testing java generic feature.\nHere is the testing code:</p>\n<pre><code>package test;\n\npublic class GenericAndMethodSignature {\n\n    public static void main(String[] args) {\n        (new ClazzAAA()).fooo();\n    }\n\n    public abstract static class ClazzAA&lt;T&gt; {\n\n        public final void fooo() {\n            System.out.println(this.foo((T) null));\n        }\n\n        public abstract String foo(T input);\n\n        public final String foo(Integer input) {\n            return &quot;foo&quot;;\n        }\n\n    }\n\n    public static class ClazzAAA extends ClazzAA&lt;Integer&gt; {\n    }\n}\n\n</code></pre>\n<p>If I compile and run it with Eclipse, console will show:</p>\n<pre><code>Exception in thread &quot;main&quot; java.lang.AbstractMethodError: test.GenericAndMethodSignature$ClazzAA.foo(Ljava/lang/Object;)Ljava/lang/String;\n    at test.GenericAndMethodSignature$ClazzAA.fooo(GenericAndMethodSignature.java:12)\n    at test.GenericAndMethodSignature.main(GenericAndMethodSignature.java:6)\n</code></pre>\n<p>However, if I compile it with javac command:</p>\n<pre><code>javac test/GenericAndMethodSignature.java\n</code></pre>\n<p>and run it with command</p>\n<pre><code>java test.GenericAndMethodSignature\n</code></pre>\n<p>The terminal will show &quot;foo&quot; successfully.</p>\n<p>Also, an interesting thing, if I run the class compiled by eclipse with <code>java</code> command, I will get java.lang.AbstractMethodError too.</p>\n<p>I use java byte code editor to check those two class, and find <code>ClazzAAA</code> compiled by <code>javac</code> overrides the generic method while class compiled by eclipse not.</p>\n<p>Does anyone know why the behavior of these two compiler is different?</p>\n<p>Not sure which result is correct.</p>\n"},{"tags":["java","sonarqube","sonarqube-scan","findbugs"],"answers":[{"owner":{"user_id":10929107,"display_name":"MohammadMH"},"up_vote_count":1,"is_accepted":false,"creation_date":1673347224,"answer_id":75068760,"body":"<p>when you put initiation on <code>(HttpsURLConnection)urlStr.openConnection(proxy);</code> it is possible to have an exception and don't initiate conn also finally will be run at any situation so sonar predicate a nullPointerException. maybe you need check <code>conn != null</code> before calling <code>conn.disconnect();</code> in finally.</p>\n"},{"owner":{"user_id":112968,"display_name":"knittl"},"up_vote_count":2,"is_accepted":true,"creation_date":1673347286,"answer_id":75068773,"body":"<p>Let me highlight the location of a possible exception:</p>\n<pre><code>Proxy proxy = new Proxy(Proxy.Type.HTTP, proxnet);    \nHttpsURLConnection conn;\nconn = (HttpsURLConnection)urlStr.openConnection(proxy) /* EXCEPTION! variable is not assigned */;\ncon.set...();\n\nfinally{\n   conn.disconnect();\n}\n</code></pre>\n<p><code>conn</code> remains set to its initial value (<code>null</code>). The safe route is to add a null check in the finally block:</p>\n<pre><code>finally {\n  if (conn != null) conn.disconnect();\n}\n</code></pre>\n"}],"owner":{"user_id":1018075,"display_name":"Mdhar9e"},"view_count":118,"up_vote_count":2,"accepted_answer_id":75068773,"answer_count":2,"score":2,"creation_date":1673346404,"question_id":75068608,"body":"<p>I have created the connection from HttpsURLConnection to set all the parameters to it. In the end finally block i am disconnecting it as showin below. But the SonarQube build is not passing. Showing as bug while disconnecting the connection.</p>\n<pre><code>Proxy proxy = new Proxy(Proxy.Type.HTTP, proxnet);    \nHttpsURLConnection conn = (HttpsURLConnection)urlStr.openConnection(proxy);\ncon.set...();\n\nfinally{\n   conn.disconnect();\n}\n</code></pre>\n<p>SonarQube addressing the Bug inside finally block with NullPointerException.</p>\n<p>keeping a NotNull check enough to the conn object? Or is anything to be done here apart from a not-null check? I am trying in different ways.</p>\n<p>A &quot;NullPointerException&quot; could be thrown; &quot;conn&quot; is nullable here.</p>\n"},{"tags":["java","scheduledexecutorservice"],"comments":[{"owner":{"user_id":637853,"display_name":"Thomas"},"edited":false,"comment_id":132472602,"body":"You seem to have a misconception in the first snippet: you print <code>(alertTimeInMillis - now)</code> as the time to alert but only pass <code>alertTimeInMillis</code> to <code>schedule(...)</code>. If you read the JavaDoc on <code>Calendar.getTimeInMillis()</code> you&#39;ll see that this is the number of milliseconds since epoch (i.e. 1/1/1970 00:00:00,000 UTC) and if you delay by that amount of millis you&#39;d wait another 53 years for the alert :) - Btw, the second snippet is better anyway as it ditches the old <code>java.util.Date</code> API."},{"owner":{"user_id":1373232,"display_name":"Nom1fan"},"edited":false,"comment_id":132475405,"body":"I understand, thanks ! The reason I use the old <code>Date</code> is because I&#39;m trying to help someone with an exercise which requires them to work with it (unfortunately:)."},{"owner":{"user_id":5772882,"display_name":"Ole V.V."},"edited":false,"comment_id":132478029,"body":"That is indeed very unfortunate. No one should learn to use the troublesome and long outdated <code>Date</code>, <code>Calendar</code>, <code>SimpleDateFormat</code> and <code>TimZone</code> classes."}],"answers":[{"owner":{"user_id":642706,"display_name":"Basil Bourque"},"up_vote_count":3,"is_accepted":true,"creation_date":1673387353,"answer_id":75076209,"body":"<h1>Debugging legacy code</h1>\n<blockquote>\n<p><code>ScheduledExecutorService scheduledExecutorService = Executors.newSingleThreadScheduledExecutor(Thread::new);</code></p>\n</blockquote>\n<p>No need for that <code>Thread::new</code>. Use empty parens, no arguments needed.</p>\n<blockquote>\n<p><code>TimeZone timeZone = TimeZone.getTimeZone(ZoneId.systemDefault());</code></p>\n</blockquote>\n<p>Weird. You are mixing the legacy <code>TimeZone</code> class with its replacement <code>ZoneId</code> from <em>java.time</em>. Use only <em>java.time</em>; never use the terribly flawed legacy date-time classes.</p>\n<pre><code>ZoneId z = ZoneId.sytemDefault() ;\n</code></pre>\n<p>New conversion methods were added to the old classes for writing code to interoperate with old code not yet updated to java.time. TimeZone.getTimeZone( ZoneId ) is one such conversion method.</p>\n<p>Also, be aware that the JVM’s current default time zone can be changed at any moment by any code in any thread. Consider if you really want your code to spin the wheel on time-zone-<a href=\"https://en.m.wikipedia.org/wiki/Roulette\" rel=\"nofollow noreferrer\">roulette</a> at runtime.</p>\n<blockquote>\n<p><code>new SimpleDateFormat(&quot;dd-MM-yyyy hh:mm:ss&quot;);</code></p>\n</blockquote>\n<p>Your formatting code uses <code>hh</code> in lowercase. This means 12-hour clock. But you neglected to collect an indicator of which half of the day. If the user types a time for <code>02:00:00</code>, we cannot know if they meant 2 AM or 2 PM. I will change this to <code>HH</code> for 24-hour clock in example code below.</p>\n<blockquote>\n<p><code>SimpleDateFormat sdf = new SimpleDateFormat(&quot;dd-MM-yyyy hh:mm:ss&quot;);</code>\n<code>Date date = sdf.parse(dateStr);</code></p>\n</blockquote>\n<p>Be aware that <code>SimpleDateFormat</code> is using a default time zone to parse that date-with-time string. You happen to want the default time zone in your earlier code, so this may work out well. Or this may not work out well if some code has changed your JVM’s current default time zone in the interim.</p>\n<blockquote>\n<p><code>ScheduledFuture&lt;?&gt; scheduledFuture = scheduledExecutorService.schedule(() -&gt; System.out.println(&quot;alert!&quot;) , alertTimeInMillis, TimeUnit.MILLISECONDS);</code></p>\n</blockquote>\n<p>👉 This line is the source of your problem. You told the scheduled executor service to wait a number of milliseconds before executing. Your number of executors is the number of milliseconds since the epoch reference of first moment of 1970 in UTC — decades, that is. You told the executor service to wait decades, about 53 years (2023-1970 = 53). Which the executor service will do, faithfully, if you leave your computer running that long.</p>\n<p>Your code:</p>\n<pre><code>long alertTimeInMillis = calendar.getTimeInMillis();\n</code></pre>\n<p>… calls the <a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Calendar.html#getTimeInMillis()\" rel=\"nofollow noreferrer\"><code>Calendar#getTimeInMillis</code></a> method. Javadoc says:</p>\n<blockquote>\n<p>Returns: the current time as UTC milliseconds from the epoch.</p>\n</blockquote>\n<p>What you meant to do is what you <em>did</em> do in your <code>System.out.println</code>: Calculate time to elapse between the current moment and that target moment.</p>\n<pre><code>(alertTimeInMillis - now)\n</code></pre>\n<p>Tip: Generally best to log <em>existing</em> values, rather than <em>generating</em> a value to log.</p>\n<h1>Modern solution: <em>java.time</em></h1>\n<p>But enough of struggling with the terribly flawed legacy date-time classes. Never use <code>Calendar</code>, <code>Date</code>, or <code>SimpleDateFormat</code>. Always use <em>java.time</em> classes.</p>\n<p>Firstly, if using an executor service, copy the boilerplate code for a graceful shutdown. Find that code on <a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/ExecutorService.html\" rel=\"nofollow noreferrer\"><code>ExecutorService</code></a> Javadoc. Here is a slightly modified version.</p>\n<pre class=\"lang-java prettyprint-override\"><code>package work.basil.example.time;\n\nimport java.time.Duration;\nimport java.util.concurrent.ExecutorService;\nimport java.util.concurrent.TimeUnit;\n\npublic class WaitToRunDemo\n{\n    public static void main ( String[] args )\n    {\n        WaitToRunDemo app = new WaitToRunDemo();\n        app.demo();\n    }\n\n    private void demo ( )\n    {\n    }\n\n    // My slightly modified version of boilerplate code taken from Javadoc of `ExecutorService`.\n    // https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/ExecutorService.html \n    void shutdownAndAwaitTermination ( final ExecutorService executorService , final Duration waitForTasksToWork , final Duration waitForTasksToComplete )\n    {\n        executorService.shutdown(); // Disable new tasks from being submitted\n        try\n        {\n            // Wait a while for existing tasks to terminate\n            if ( ! executorService.awaitTermination( waitForTasksToWork.toMillis() , TimeUnit.MILLISECONDS ) )\n            {\n                executorService.shutdownNow(); // Cancel currently executing tasks\n                // Wait a while for tasks to respond to being cancelled\n                if ( ! executorService.awaitTermination( waitForTasksToComplete.toMillis() , TimeUnit.MILLISECONDS ) )\n                { System.err.println( &quot;ExecutorService did not terminate.&quot; ); }\n            }\n        }\n        catch ( InterruptedException ex )\n        {\n            // (Re-)Cancel if current thread also interrupted\n            executorService.shutdownNow();\n            // Preserve interrupt status\n            Thread.currentThread().interrupt();\n        }\n    }\n}\n</code></pre>\n<p>Here is complete example code.</p>\n<p>Let's break up your long code into a few separate methods, each with a specific goal.</p>\n<p>To represent a span of time not attached to the timeline, use <a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/time/Duration.html\" rel=\"nofollow noreferrer\"><code>Duration</code></a> class.</p>\n<p>Notice how we minimized the use of <code>LocalDateTime</code>. That class cannot represent a moment, a point on the timeline as it lacks the context of a time zone or offset-from-UTC. I cannot imagine a situation where calling <code>LocalDateTime.now</code> is optimal.</p>\n<pre class=\"lang-java prettyprint-override\"><code>package work.basil.example.time;\n\nimport java.time.*;\nimport java.time.format.DateTimeFormatter;\nimport java.time.temporal.ChronoUnit;\nimport java.util.concurrent.ExecutorService;\nimport java.util.concurrent.Executors;\nimport java.util.concurrent.ScheduledExecutorService;\nimport java.util.concurrent.TimeUnit;\n\npublic class WaitToRunDemo\n{\n    public static void main ( String[] args )\n    {\n        WaitToRunDemo app = new WaitToRunDemo();\n        app.demo();\n    }\n\n    private void demo ( )\n    {\n        ZonedDateTime then = this.gatherInput();\n        Duration delayUntilTaskRuns = this.calculateTimeToElapse( then );\n        System.out.println( &quot;INFO - Now: &quot; + Instant.now() + &quot;. Scheduling task to run after delay of: &quot; + delayUntilTaskRuns.toString() );\n\n        this.runTask( delayUntilTaskRuns );\n        System.out.println( &quot;Demo done at &quot; + Instant.now() );\n    }\n\n    private ZonedDateTime gatherInput ( )\n    {\n        // Put your `Scanner` code here. Tip: Confirm the time zone with the user.\n\n        // Simulate the user entering text for the start of the next minute.\n        ZoneId zoneId = ZoneId.systemDefault();\n        ZonedDateTime now = ZonedDateTime.now( zoneId );\n        ZonedDateTime startOfNextMinute = now.truncatedTo( ChronoUnit.MINUTES ).plusMinutes( 1 );\n\n        DateTimeFormatter f = DateTimeFormatter.ofPattern( &quot;dd-MM-uuuu HH:mm:ss&quot; );\n        String userInput = startOfNextMinute.format( f );\n        System.out.println( &quot;DEBUG startOfNextMinute = &quot; + startOfNextMinute );\n        System.out.println( &quot;DEBUG userInput = &quot; + userInput );\n\n        // Parse user input text into a `LocalDateTime` object to represent date with time-of-day but lacking any time zone or offset-from-UTC. \n        LocalDateTime ldt = LocalDateTime.parse( userInput , f );\n        ZonedDateTime zdt = ldt.atZone( zoneId );\n\n        return zdt;\n    }\n\n    private Duration calculateTimeToElapse ( final ZonedDateTime then )\n    {\n        Instant now = Instant.now();\n        Duration delayUntilTaskRuns = Duration.between( now , then.toInstant() );\n        if ( delayUntilTaskRuns.isNegative() ) { throw new IllegalStateException( &quot;Specified wait time is negative (in the past).&quot; ); }\n        return delayUntilTaskRuns;\n    }\n\n    private void runTask ( Duration delay )\n    {\n        ScheduledExecutorService ses = Executors.newSingleThreadScheduledExecutor();\n        Runnable task = ( ) -&gt; System.out.println( &quot;Done running task at &quot; + Instant.now() );\n        ses.schedule( task , delay.toMillis() , TimeUnit.MILLISECONDS );\n        this.shutdownAndAwaitTermination( ses , Duration.ofMinutes( 2 ) , Duration.ofMinutes( 1 ) );\n    }\n\n    // My slightly modified version of boilerplate code taken from Javadoc of `ExecutorService`.\n    // https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/ExecutorService.html\n    void shutdownAndAwaitTermination ( final ExecutorService executorService , final Duration waitForTasksToWork , final Duration waitForTasksToComplete )\n    {\n        executorService.shutdown(); // Disable new tasks from being submitted\n        try\n        {\n            // Wait a while for existing tasks to terminate\n            if ( ! executorService.awaitTermination( waitForTasksToWork.toMillis() , TimeUnit.MILLISECONDS ) )\n            {\n                executorService.shutdownNow(); // Cancel currently executing tasks\n                // Wait a while for tasks to respond to being cancelled\n                if ( ! executorService.awaitTermination( waitForTasksToComplete.toMillis() , TimeUnit.MILLISECONDS ) )\n                { System.err.println( &quot;ExecutorService did not terminate.&quot; ); }\n            }\n        }\n        catch ( InterruptedException ex )\n        {\n            // (Re-)Cancel if current thread also interrupted\n            executorService.shutdownNow();\n            // Preserve interrupt status\n            Thread.currentThread().interrupt();\n        }\n    }\n}\n</code></pre>\n<p>Where run:</p>\n<pre class=\"lang-none prettyprint-override\"><code>DEBUG startOfNextMinute = 2023-01-10T14:30-08:00[America/Los_Angeles]\nDEBUG userInput = 10-01-2023 14:30:00\nINFO - Now: 2023-01-10T22:29:37.091459Z. Scheduling task to run after delay of: PT22.908594S\nDone running task at 2023-01-10T22:30:00.012244Z\nDemo done at 2023-01-10T22:30:00.024242Z\n</code></pre>\n<p>My example code when run was aiming to run the task at 2023-01-10T14:30-08:00[America/Los_Angeles]. That is the exact same moment, same point on the timeline as 2023-01-10T22:30:00Z where the “Z” means an offset from UTC of zero hours-minutes-seconds. The 14:30 in America/Los_Angeles is 8 hours behind UTC, so adding 8 hours brings us to 22:30 in UTC — same moment, different wall-clock time.</p>\n<p>In other words… Alice in Portland Oregon notices her clock on the wall strike 2:30 PM (14:30) as she dials the phone to call Bob in <a href=\"https://en.m.wikipedia.org/wiki/Reykjav%C3%ADk\" rel=\"nofollow noreferrer\">Reykjavík</a>. As Bob answers the call, he notices <a href=\"https://en.m.wikipedia.org/wiki/Time_in_Iceland\" rel=\"nofollow noreferrer\">his own clock on the wall</a> reads 10:30 PM (22:30). Same moment, different wall-clock time.</p>\n<hr />\n<p>By the way, be aware that lines sent to <code>System.out.println</code> across threads may <em>not</em> appear in the console in chronological order. Always include a timestamp such as <code>Instant.now()</code>. If you care about sequence, study those timestamps.</p>\n"},{"owner":{"user_id":1373232,"display_name":"Nom1fan"},"up_vote_count":0,"is_accepted":false,"creation_date":1673427414,"answer_id":75080463,"body":"<p>I modified Basil's modern answer slightly so the prints are on the same time zone and make more sense to me. Feel free to correct me if I've done something wrong.</p>\n<pre><code>import java.time.*;\nimport java.time.format.DateTimeFormatter;\nimport java.time.temporal.ChronoUnit;\nimport java.util.concurrent.ExecutorService;\nimport java.util.concurrent.Executors;\nimport java.util.concurrent.ScheduledExecutorService;\nimport java.util.concurrent.TimeUnit;\n\npublic class WaitToRunDemo {\n    public static void main(String[] args) {\n        WaitToRunDemo app = new WaitToRunDemo();\n        app.demo();\n    }\n\n    private void demo() {\n        ZoneId zoneId = ZoneId.systemDefault();\n        ZonedDateTime now = ZonedDateTime.now(zoneId);\n        ZonedDateTime then = this.gatherInput(now, zoneId);\n        Duration delayUntilTaskRuns = this.calculateTimeToElapse(now, then);\n        System.out.println(&quot;INFO - Now: &quot; + now + &quot;. Scheduling task to run after delay of: &quot; + delayUntilTaskRuns);\n\n        this.runTask(delayUntilTaskRuns, zoneId);\n        System.out.println(&quot;Demo done at: &quot; + ZonedDateTime.now(zoneId));\n    }\n\n    private ZonedDateTime gatherInput(ZonedDateTime now, ZoneId zoneId) {\n        // Put your `Scanner` code here. Tip: Confirm the time zone with the user.\n\n        // Simulate the user entering text for the start of the next minute.\n        ZonedDateTime startOfNextMinute = now.truncatedTo(ChronoUnit.MINUTES).plusMinutes(1);\n\n        DateTimeFormatter f = DateTimeFormatter.ofPattern(&quot;dd-MM-uuuu HH:mm:ss&quot;);\n        String userInput = startOfNextMinute.format(f);\n        System.out.println(&quot;DEBUG startOfNextMinute = &quot; + startOfNextMinute);\n        System.out.println(&quot;DEBUG userInput = &quot; + userInput);\n\n        // Parse user input text into a `LocalDateTime` object to represent date with time-of-day but lacking any time zone or offset-from-UTC.\n        LocalDateTime ldt = LocalDateTime.parse(userInput, f);\n\n        return ldt.atZone(zoneId);\n    }\n\n    private Duration calculateTimeToElapse(final ZonedDateTime now, final ZonedDateTime then) {\n        Duration delayUntilTaskRuns = Duration.between(now, then);\n        if (delayUntilTaskRuns.isNegative()) {\n            throw new IllegalStateException(&quot;Specified wait time is negative (in the past).&quot;);\n        }\n        return delayUntilTaskRuns;\n    }\n\n    private void runTask(Duration delay, ZoneId zoneId) {\n        ScheduledExecutorService ses = Executors.newSingleThreadScheduledExecutor();\n        Runnable task = () -&gt; System.out.println(&quot;Done running task at: &quot; + ZonedDateTime.now(zoneId));\n        ses.schedule(task, delay.toMillis(), TimeUnit.MILLISECONDS);\n        this.shutdownAndAwaitTermination(ses, Duration.ofMinutes(2), Duration.ofMinutes(1));\n    }\n\n    // My slightly modified version of boilerplate code taken from Javadoc of `ExecutorService`.\n    // https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/ExecutorService.html\n    void shutdownAndAwaitTermination(final ExecutorService executorService, final Duration waitForTasksToWork, final Duration waitForTasksToComplete) {\n        executorService.shutdown(); // Disable new tasks from being submitted\n        try {\n            // Wait a while for existing tasks to terminate\n            if (!executorService.awaitTermination(waitForTasksToWork.toMillis(), TimeUnit.MILLISECONDS)) {\n                executorService.shutdownNow(); // Cancel currently executing tasks\n                // Wait a while for tasks to respond to being cancelled\n                if (!executorService.awaitTermination(waitForTasksToComplete.toMillis(), TimeUnit.MILLISECONDS)) {\n                    System.err.println(&quot;ExecutorService did not terminate.&quot;);\n                }\n            }\n        } catch (InterruptedException ex) {\n            // (Re-)Cancel if current thread also interrupted\n            executorService.shutdownNow();\n            // Preserve interrupt status\n            Thread.currentThread().interrupt();\n        }\n    }\n}\n</code></pre>\n<p>Output:</p>\n<pre><code>DEBUG startOfNextMinute = 2023-01-11T10:55+02:00[Asia/Jerusalem]\nDEBUG userInput = 11-01-2023 10:55:00\nINFO - Now: 2023-01-11T10:54:45.494618+02:00[Asia/Jerusalem]. Scheduling task to run after delay of: PT14.505382S\nDone running task at: 2023-01-11T10:55:00.036986+02:00[Asia/Jerusalem]\nDemo done at: 2023-01-11T10:55:00.037542+02:00[Asia/Jerusalem]\n</code></pre>\n"}],"owner":{"user_id":1373232,"display_name":"Nom1fan"},"view_count":73,"up_vote_count":2,"accepted_answer_id":75076209,"answer_count":2,"score":2,"creation_date":1673344993,"question_id":75068322,"body":"<p>The following code block does not work for me (alert is not being triggered):</p>\n<pre><code>public static void main(String[] args) throws InterruptedException, ParseException {        \n    ScheduledExecutorService scheduledExecutorService = Executors.newSingleThreadScheduledExecutor(Thread::new);\n    TimeZone timeZone = TimeZone.getTimeZone(ZoneId.systemDefault());\n    Calendar calendar = Calendar.getInstance(timeZone);\n\n    Scanner scanner = new Scanner(System.in);\n    System.out.println(&quot;The time now is: &quot; + calendar.getTime());\n    System.out.println(&quot;Enter alert date time: &quot;);\n    String dateStr = scanner.nextLine();\n    SimpleDateFormat sdf = new SimpleDateFormat(&quot;dd-MM-yyyy hh:mm:ss&quot;);\n    Date date = sdf.parse(dateStr);\n    calendar.setTime(date);\n    long alertTimeInMillis = calendar.getTimeInMillis();\n    long now = Calendar.getInstance(timeZone).getTimeInMillis();\n    System.out.println(&quot;Time to alert: &quot; + (alertTimeInMillis - now) + &quot; millis &quot;);\n\n    ScheduledFuture&lt;?&gt; scheduledFuture = scheduledExecutorService.schedule(() -&gt; System.out.println(&quot;alert!&quot;)\n            , alertTimeInMillis, TimeUnit.MILLISECONDS);\n    \n    while (!scheduledFuture.isDone()) {\n        System.out.println(&quot;The time now: &quot; + Calendar.getInstance(timeZone).getTime());\n        System.out.println(&quot;Expected alert time: &quot; + date);\n        Thread.sleep(1000);\n    }\n    scheduledExecutorService.shutdown();\n    scheduledExecutorService.awaitTermination(30, TimeUnit.SECONDS);\n}\n</code></pre>\n<p>While this code block does work:</p>\n<pre><code>public static void main(String[] args) throws InterruptedException {\n\n    ScheduledExecutorService scheduledExecutorService = Executors.newSingleThreadScheduledExecutor(Thread::new);\n    LocalDateTime localDateTime = LocalDateTime.of(2023, 1, 10, 12, 1);\n    ScheduledFuture&lt;?&gt; scheduledFuture = scheduledExecutorService.schedule(() -&gt;\n            System.out.println(&quot;alert!&quot;),\n            LocalDateTime.now().until(localDateTime, ChronoUnit.SECONDS), TimeUnit.SECONDS);\n\n    while (!scheduledFuture.isDone()) {\n        Thread.sleep(1000);\n    }\n    scheduledExecutorService.shutdown();\n    scheduledExecutorService.awaitTermination(30, TimeUnit.SECONDS);\n}\n</code></pre>\n<p>I don't understand the difference, or what exactly is wrong with the first block that I'm missing.</p>\n"},{"tags":["java","generics","enums"],"comments":[{"owner":{"user_id":458561,"display_name":"boneill"},"edited":false,"comment_id":132444756,"body":"I&#39;d start by defining a common base class for the type estimates which has the name, value, and code properties defined there."},{"owner":{"user_id":1553851,"display_name":"shmosel"},"edited":false,"comment_id":132444877,"body":"Enums can&#39;t extend other classes, but they can implement interfaces."}],"answers":[{"owner":{"user_id":10118965,"display_name":"davidalayachew"},"up_vote_count":1,"is_accepted":true,"creation_date":1673238189,"answer_id":75053164,"body":"<p>This answer is related and helpful -- <a href=\"https://stackoverflow.com/a/70596442/10118965\">https://stackoverflow.com/a/70596442/10118965</a></p>\n<p>But here is a more directed answer. In short, using interfaces, enums, and generics allows you to make this much easier to consolidate.</p>\n<p>First, create an interface that has all of the relevant functions. I called mine <code>ParentInterface</code>. In this case, you needed <code>::getName</code>, <code>::getValue</code>, and <code>::getCode</code>.</p>\n<p>Next, you need to create a method inside that interface that returns the values of the enum. This is a more complicated step because it requires you to take a pretty big step into the generics world, combined with enums.</p>\n<p>In short, if we look at the JavaDoc for enums, we see the following.</p>\n<p><a href=\"https://docs.oracle.com/en/java/javase/19/docs/api/java.base/java/lang/Enum.html\" rel=\"nofollow noreferrer\">https://docs.oracle.com/en/java/javase/19/docs/api/java.base/java/lang/Enum.html</a></p>\n<p><code>Class Enum&lt;E extends Enum&lt;E&gt;&gt;</code></p>\n<p>So in short, if we want to say that some type <code>E</code> is an enum, then we must say something like this.</p>\n<p><code>E extends Enum&lt;E&gt;</code></p>\n<p>Ok, now we know how to say that the parameterized type must be an enum. The reason why we did this is because we actually wanted to get <em><strong>the values</strong></em> of the enum. We can't do that without first making sure that we have an enum.</p>\n<p>But now that we do, we can write a method sort of like this.</p>\n<pre class=\"lang-java prettyprint-override\"><code>public static &lt;E extends Enum&lt;E&gt;&gt; List&lt;E&gt; values(final Class&lt;E&gt; clazz)\n{\n\n   return Arrays.asList(clazz.getEnumConstants());\n\n}\n</code></pre>\n<p>This method says that the <code>clazz</code> that we receive as a paramter must be a type of enum. Once it proves that, then we can safely call the <code>Class::getEnumConstants</code> method and be sure that we will get what we expect.</p>\n<p>So, now that we have wrote our static method, next we put a parameterized type on the interface. Specifically, we want to make sure that this interface only refers to enums.</p>\n<p>We add the following parameterized type to the interface.</p>\n<p><code>&lt;E extends Enum&lt;E&gt;&gt;</code></p>\n<p>And then finally, we modify our static method just slightly to make sure that it is only used to generate enum values for enums that implement our interface. Maybe you don't want that restriction, but in case you do, here is what you would add.</p>\n<p><code> &amp; ParentInterface&lt;E&gt;</code></p>\n<p>And with that, we are done. Here is what our interface should roughly look like.</p>\n<pre class=\"lang-java prettyprint-override\"><code>      public interface ParentInterface&lt;E extends Enum&lt;E&gt;&gt; // pick a better name\n      {\n      \n         String getName();\n         String getValue();\n         String getCode();\n         \n         public static &lt;E extends Enum&lt;E&gt; &amp; ParentInterface&lt;E&gt;&gt; List&lt;E&gt; values(final Class&lt;E&gt; clazz)\n         {\n         \n            return Arrays.asList(clazz.getEnumConstants());\n         \n         }\n      \n      }\n</code></pre>\n<p>Next, we need to make sure all of our enums implement this new interface. That is pretty easy to do.</p>\n<p><code>public enum EstimateFuelType implements ParentInterface&lt;EstimateFuelType&gt;</code></p>\n<p><code>public enum EstimateTransmissionType implements ParentInterface&lt;EstimateTransmissionType&gt;</code></p>\n<p>The actual internals of the enum shouldn't have to change. All you are doing is changing the outside.</p>\n<p>And then finally, let us rework our method to handle this brand new interface and our reworked enums.</p>\n<p>Let's start by building off of our <code>::getFuelTypeList</code> method. That means that we start with a duplicate, but renamed.</p>\n<pre class=\"lang-java prettyprint-override\"><code>      public static List&lt;Map&lt;String, Object&gt;&gt; getGenericTypeList() {\n      \n         List&lt;Map&lt;String, Object&gt;&gt; fuelList = new ArrayList&lt;&gt;();\n      \n         for(EstimateFuelType fuelType : EstimateFuelType.values()) {\n            Map&lt;String, Object&gt; transmission = new HashMap&lt;&gt;();\n            transmission.put(&quot;code&quot;, fuelType.getCode());\n            transmission.put(&quot;value&quot;, fuelType.getValue());\n            transmission.put(&quot;name&quot;, fuelType.getName());\n            fuelList.add(transmission);\n         }\n      \n         return fuelList;\n      \n      }\n</code></pre>\n<p>Other than the method name, this method is exactly the same as <code>::getFuelTypeList</code>.</p>\n<p>Let's start by changing the method signature to include the generics that we made. More specifically, let's introduce this method to the idea of our interface.</p>\n<p><code>public static &lt;E extends ParentInterface&lt;E&gt;&gt; List&lt;Map&lt;String, Object&gt;&gt; getGenericTypeList()</code></p>\n<p>However, if we try to do just this, the compiler will complain at us, saying that if we want <code>E</code> to extend our interface, it must also extend <code>Enum&lt;E&gt;</code> too. Otherwise, it will break the rule of our interface, which says that <em>&quot;Anything that extends me must have an enum in the type parameter that also extends me&quot;</em>. We made this rule earlier on when putting the type parameter on our interface.</p>\n<p>So, to get past this, we must specify that our type parameter also is an enum. That is easy enough to change.</p>\n<p><code>public static &lt;E extends Enum&lt;E&gt; &amp; ParentInterface&lt;E&gt;&gt; List&lt;Map&lt;String, Object&gt;&gt; getGenericTypeList()</code></p>\n<p>Now, the compiler is happy.</p>\n<p>So, because of this change, our method is now aware of a type called <code>E</code>. This type is a subtype of an enum, and is also a subtype of the interface that we made.</p>\n<p>Now that the method is aware of our type, let's actually put it to use. Here is what we have thus far.</p>\n<pre class=\"lang-java prettyprint-override\"><code>      public static &lt;E extends Enum&lt;E&gt; &amp; ParentInterface&lt;E&gt;&gt; List&lt;Map&lt;String, Object&gt;&gt; getGenericTypeList() {\n      \n         List&lt;Map&lt;String, Object&gt;&gt; fuelList = new ArrayList&lt;&gt;();\n      \n         for(EstimateFuelType fuelType : EstimateFuelType.values()) {\n            Map&lt;String, Object&gt; transmission = new HashMap&lt;&gt;();\n            transmission.put(&quot;code&quot;, fuelType.getCode());\n            transmission.put(&quot;value&quot;, fuelType.getValue());\n            transmission.put(&quot;name&quot;, fuelType.getName());\n            fuelList.add(transmission);\n         }\n      \n         return fuelList;\n      \n      }\n</code></pre>\n<p>Obviously, everything is still hardcoded to use <code>EstimateFuelType</code>. So let's start by changing that.</p>\n<pre class=\"lang-java prettyprint-override\"><code>      public static &lt;E extends Enum&lt;E&gt; &amp; ParentInterface&lt;E&gt;&gt; List&lt;Map&lt;String, Object&gt;&gt; getGenericTypeList() {\n      \n         List&lt;Map&lt;String, Object&gt;&gt; fuelList = new ArrayList&lt;&gt;();\n      \n         for(E fuelType : E.values()) {\n            Map&lt;String, Object&gt; transmission = new HashMap&lt;&gt;();\n            transmission.put(&quot;code&quot;, fuelType.getCode());\n            transmission.put(&quot;value&quot;, fuelType.getValue());\n            transmission.put(&quot;name&quot;, fuelType.getName());\n            fuelList.add(transmission);\n         }\n      \n         return fuelList;\n      \n      }\n</code></pre>\n<p>This almost works, but the compiler gets upset and says that it doesn't know where to find the <code>E::values</code> method. Annoyingly enough, Java does not permit us to override static methods, so this solution had to get needlessly complicated. Luckily, we already did the complicated part earlier. Instead of trying to use the unknown <code>E::values</code> method, why don't we use the static method we made earlier?</p>\n<p>However, in order to use that method, we need to provide a <code>Class&lt;E&gt;</code>. Simple enough, let's also modify our method to take in a <code>Class&lt;E&gt;</code>. And let's also replace that unknown method that just threw an error.</p>\n<pre class=\"lang-java prettyprint-override\"><code>      public static &lt;E extends Enum&lt;E&gt; &amp; ParentInterface&lt;E&gt;&gt; List&lt;Map&lt;String, Object&gt;&gt; getGenericTypeList(final Class&lt;E&gt; clazz) {\n      \n         List&lt;Map&lt;String, Object&gt;&gt; fuelList = new ArrayList&lt;&gt;();\n      \n         for(E fuelType : ParentInterface.values(clazz)) {\n            Map&lt;String, Object&gt; transmission = new HashMap&lt;&gt;();\n            transmission.put(&quot;code&quot;, fuelType.getCode());\n            transmission.put(&quot;value&quot;, fuelType.getValue());\n            transmission.put(&quot;name&quot;, fuelType.getName());\n            fuelList.add(transmission);\n         }\n      \n         return fuelList;\n      \n      }\n</code></pre>\n<p>And then that should be it. You can now delete the unnecessary methods that only work for the individual enums. Here is the complete solution, with some refactoring, renaming, and general clean up.</p>\n<pre class=\"lang-java prettyprint-override\"><code>import java.util.Arrays;\nimport java.util.List;\nimport java.util.Map;\n\n\n   public class SOQ_20230108\n   {\n   \n      public static void main(String[] args)\n      {\n      \n         System.out.println(getParentTypeList(EstimateFuelType.class));\n         System.out.println(getParentTypeList(EstimateTransmissionType.class));\n      \n      }\n   \n      public interface ParentInterface&lt;E extends Enum&lt;E&gt;&gt; // pick a better name\n      {\n      \n         String getName();\n         String getValue();\n         String getCode();\n         \n         public static &lt;E extends Enum&lt;E&gt;&gt; List&lt;E&gt; values(final Class&lt;E&gt; clazz)\n         {\n         \n            return Arrays.asList(clazz.getEnumConstants());\n         \n         }\n      \n      }\n   \n      public enum EstimateFuelType implements ParentInterface&lt;EstimateFuelType&gt;\n      {\n      \n         GASOLINE(&quot;가솔린&quot;, &quot;A001&quot;, &quot;001&quot;),\n         DIESEL(&quot;디젤&quot;, &quot;A002&quot;, &quot;002&quot;),\n         LPG_GENERAL(&quot;LPG(일반인 구입)&quot;, &quot;A003&quot;, &quot;003&quot;),\n         LPG_ALL(&quot;LPG&quot;, &quot;A004&quot;, &quot;004&quot;),\n         HYBRID(&quot;가솔린+전기&quot;, &quot;A005&quot;, &quot;005&quot;),\n         ELECTRONIC(&quot;전기&quot;, &quot;A009&quot;, &quot;009&quot;),\n         ETC(&quot;기타&quot;, &quot;A999&quot;, &quot;999&quot;);\n      \n         final String name;\n         final String value;\n         final String code;\n      \n         EstimateFuelType(String name, String value, String code) \n         {\n            \n            this.name = name;\n            this.value = value;\n            this.code = code;\n         \n         }\n      \n         public String getName() \n         {\n            \n            return name;\n         \n         }\n      \n         public String getValue() \n         {\n            \n            return value;\n         \n         }\n      \n         public String getCode() \n         {\n            \n            return code;\n         \n         }\n      \n      }\n   \n      public enum EstimateTransmissionType implements ParentInterface&lt;EstimateTransmissionType&gt;\n      {\n      \n         AUTO(&quot;오토(A/T)&quot;, &quot;A001&quot;, &quot;001&quot;),\n         MANUAL(&quot;수동(M/T)&quot;, &quot;A002&quot;, &quot;002&quot;),\n         ETC(&quot;기타&quot;, &quot;A999&quot;, &quot;999&quot;);\n      \n         final String name;\n         final String value;\n         final String code;\n      \n         EstimateTransmissionType(String name, String value, String code) \n         {\n            \n            this.name = name;\n            this.value = value;\n            this.code = code;\n         \n         }\n      \n         public String getName() \n         {\n            \n            return name;\n         \n         }\n      \n         public String getValue() \n         {\n            \n            return value;\n         \n         }\n      \n         public String getCode() \n         {\n            \n            return code;\n         \n         }\n      \n      }\n   \n      public static &lt;E extends Enum&lt;E&gt; &amp; ParentInterface&lt;E&gt;&gt; List&lt;Map&lt;String, Object&gt;&gt; getParentTypeList(Class&lt;E&gt; clazz) {\n      \n         final List&lt;Map&lt;String, Object&gt;&gt; typeList = new ArrayList&lt;&gt;();\n      \n         for(final E type : ParentInterface.values(clazz)) {\n            final Map&lt;String, Object&gt; typeMap = new HashMap&lt;&gt;();\n            typeMap.put(&quot;code&quot;, type.getCode());\n            typeMap.put(&quot;value&quot;, type.getValue());\n            typeMap.put(&quot;name&quot;, type.getName());\n            typeList.add(typeMap);\n         }\n      \n         return typeList;\n      \n      }\n   \n   }\n\n</code></pre>\n<p>This complete example has a main method, so you can run it yourself and see that it works.</p>\n<p>Finally, if you decide to make this method work for other enums that you add into the future, it is very easy to do. Simply ensure that each enum you add implements your interface, and the parameterized type for that interface should be the enum name itself. If that doesn't make sense, just follow the same format as the other enums and it should work out fine.</p>\n"},{"owner":{"user_id":1161878,"display_name":"Gene"},"up_vote_count":2,"is_accepted":false,"creation_date":1673241171,"answer_id":75053407,"body":"<p>The new old wisdom to prefer composition over inheritance seems to apply here. We can do all the common stuff in a delegate class:</p>\n<pre class=\"lang-java prettyprint-override\"><code>import java.util.Arrays;\nimport java.util.Map;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.stream.Collectors;\n\npublic class EnumDemo {\n  interface AttributeProvider {\n    EstimateAttributes getAttributes();\n  }\n  \n  public enum EstimateTransmissionType implements AttributeProvider {\n    AUTO(&quot;오토(A/T)&quot;, &quot;A001&quot;, &quot;001&quot;),\n    MANUAL(&quot;수동(M/T)&quot;, &quot;A002&quot;, &quot;002&quot;),\n    ETC(&quot;기타&quot;, &quot;A999&quot;, &quot;999&quot;);\n\n    private final final EstimateAttributes attributes;\n    \n    EstimateTransmissionType(String name, String value, String code) {\n      this.attributes = new EstimateAttributes(name, value, code);\n    }\n\n    @Override\n    public EstimateAttributes getAttributes() {\n      return attributes;\n    }\n  }\n  \n  public enum EstimateFuelType implements AttributeProvider {\n    GASOLINE(&quot;가솔린&quot;, &quot;A001&quot;, &quot;001&quot;),\n    DIESEL(&quot;디젤&quot;, &quot;A002&quot;, &quot;002&quot;),\n    LPG_GENERAL(&quot;LPG(일반인 구입)&quot;, &quot;A003&quot;, &quot;003&quot;),\n    LPG_ALL(&quot;LPG&quot;, &quot;A004&quot;, &quot;004&quot;),\n    HYBRID(&quot;가솔린+전기&quot;, &quot;A005&quot;, &quot;005&quot;),\n    ELECTRONIC(&quot;전기&quot;, &quot;A009&quot;, &quot;009&quot;),\n    ETC(&quot;기타&quot;, &quot;A999&quot;, &quot;999&quot;);\n\n    private final EstimateAttributes attributes;\n\n    EstimateFuelType(String name, String value, String code) {\n      attributes = new EstimateAttributes(name, value, code);\n    }\n\n    @Override\n    public EstimateAttributes getAttributes() {\n      return attributes;\n    }\n  }\n  \n  static class EstimateAttributes {\n    private final String name;\n    private final String value;\n    private final String code;\n\n    public EstimateAttributes(String name, String value, String code) {\n      this.name = name;\n      this.value = value;\n      this.code = code;\n    }\n    \n    public Map&lt;String, Object&gt; asMap() {\n     Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();\n     map.put(&quot;name&quot;, name);\n     map.put(&quot;value&quot;, value);\n     map.put(&quot;code&quot;, code);\n     return map;\n    }\n\n     // Add getters if needed.\n  }\n  \n  public static &lt;E extends Enum&lt;E&gt; &amp; AttributeProvider&gt; \n      List&lt;Map&lt;String, Object&gt;&gt; getAttributeMaps(Class&lt;E&gt; enumClass) {\n    return Arrays.stream(enumClass.getEnumConstants())\n        .map(enumValue -&gt; enumValue.getAttributes().asMap())\n        .collect(Collectors.toList());\n  }\n}\n</code></pre>\n<p>Now we can say <code>EnumDemo.getAttributeMaps(EstimateTransmissionType.class)</code> and <code>EnumDemo.getAttributeMaps(EstimateFuelType.class)</code>.</p>\n"}],"owner":{"user_id":3548162,"display_name":"Christopher"},"view_count":51,"up_vote_count":2,"accepted_answer_id":75053164,"answer_count":2,"score":2,"creation_date":1673231576,"question_id":75052709,"body":"<p>I would like to delete the duplicate source code below.</p>\n<pre><code>public static List&lt;Map&lt;String, Object&gt;&gt; getTransmissionTypeList() {\n\n    List&lt;Map&lt;String, Object&gt;&gt; transmissionList = new ArrayList&lt;&gt;();\n\n    for(EstimateTransmissionType transmissionType : EstimateTransmissionType.values()) {\n        Map&lt;String, Object&gt; transmission = new HashMap&lt;&gt;();\n        transmission.put(&quot;code&quot;, transmissionType.getCode());\n        transmission.put(&quot;value&quot;, transmissionType.getValue());\n        transmission.put(&quot;name&quot;, transmissionType.getName());\n        transmissionList.add(transmission);\n    }\n\n    return transmissionList;\n\n}\n\npublic static List&lt;Map&lt;String, Object&gt;&gt; getFuelTypeList() {\n\n    List&lt;Map&lt;String, Object&gt;&gt; fuelList = new ArrayList&lt;&gt;();\n\n    for(EstimateFuelType fuelType : EstimateFuelType.values()) {\n        Map&lt;String, Object&gt; transmission = new HashMap&lt;&gt;();\n        transmission.put(&quot;code&quot;, fuelType.getCode());\n        transmission.put(&quot;value&quot;, fuelType.getValue());\n        transmission.put(&quot;name&quot;, fuelType.getName());\n        fuelList.add(transmission);\n    }\n\n    return fuelList;\n\n}\n</code></pre>\n<p>For the <code>EstimateTransmissionType</code> and <code>EstimateFuelType</code>, those two enums are totally same structure inside.</p>\n<pre><code>public enum EstimateTransmissionType {\n\n    AUTO(&quot;오토(A/T)&quot;, &quot;A001&quot;, &quot;001&quot;),\n    MANUAL(&quot;수동(M/T)&quot;, &quot;A002&quot;, &quot;002&quot;),\n    ETC(&quot;기타&quot;, &quot;A999&quot;, &quot;999&quot;);\n\n    final String name;\n    final String value;\n    final String code;\n\n    EstimateTransmissionType(String name, String value, String code) {\n        this.name = name;\n        this.value = value;\n        this.code = code;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public String getValue() {\n        return value;\n    }\n\n    public String getCode() {\n        return code;\n    }\n}\n</code></pre>\n<pre><code>public enum EstimateFuelType {\n\n    GASOLINE(&quot;가솔린&quot;, &quot;A001&quot;, &quot;001&quot;),\n    DIESEL(&quot;디젤&quot;, &quot;A002&quot;, &quot;002&quot;),\n    LPG_GENERAL(&quot;LPG(일반인 구입)&quot;, &quot;A003&quot;, &quot;003&quot;),\n    LPG_ALL(&quot;LPG&quot;, &quot;A004&quot;, &quot;004&quot;),\n    HYBRID(&quot;가솔린+전기&quot;, &quot;A005&quot;, &quot;005&quot;),\n    ELECTRONIC(&quot;전기&quot;, &quot;A009&quot;, &quot;009&quot;),\n    ETC(&quot;기타&quot;, &quot;A999&quot;, &quot;999&quot;);\n\n    final String name;\n    final String value;\n    final String code;\n\n    EstimateFuelType(String name, String value, String code) {\n        this.name = name;\n        this.value = value;\n        this.code = code;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public String getValue() {\n        return value;\n    }\n\n    public String getCode() {\n        return code;\n    }\n}\n</code></pre>\n<p>I really want to improve my source code quality, but I have no idea where to start this.\nCould somebody give me a good inspiration or clear answer?</p>\n"},{"tags":["java","spring","spring-boot","testing","repository"],"answers":[{"owner":{"user_id":10231374,"display_name":"birca123"},"up_vote_count":3,"is_accepted":true,"creation_date":1673083399,"answer_id":75039256,"body":"<p>According to <a href=\"https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#repositories.special-parameters\" rel=\"nofollow noreferrer\">Spring documentation</a>:</p>\n<blockquote>\n<p>The infrastructure recognizes certain specific types like <code>Pageable</code> and\n<code>Sort</code>, to apply pagination and sorting to your queries dynamically.</p>\n</blockquote>\n<p>With that being said, you should replace <code>PageRequest</code> with <code>Pageable</code> in the <code>ProductRepository</code> method:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Repository\npublic interface ProductRepository extends JpaRepository&lt;Product, Long&gt; {\n    List&lt;Product&gt; findAllByPriceBetween(BigDecimal from, BigDecimal to, Pageable pageable);\n}\n</code></pre>\n<p><code>Pageable</code> should be instantiated as follows:</p>\n<pre class=\"lang-java prettyprint-override\"><code>Pageable pageable = PageRequest.of(0, 10, sort); \n</code></pre>\n"}],"owner":{"user_id":20945210,"display_name":"Igor Bukur"},"view_count":55,"up_vote_count":2,"accepted_answer_id":75039256,"answer_count":1,"score":2,"creation_date":1673078294,"question_id":75038881,"body":"<p>Im have repository:</p>\n<pre><code>@Repository\npublic interface ProductRepository extends JpaRepository&lt;Product, Long&gt; {\n    List&lt;Product&gt; findAllByPriceBetween(BigDecimal from, BigDecimal to, PageRequest pageRequest);\n}\n</code></pre>\n<p>In liquibase im just create table:</p>\n<pre><code>--liquibase formatted sql\n--changeset &lt;sniklz&gt;:&lt;create-products-table&gt;\nCREATE TABLE IF NOT EXISTS products\n(\n    id bigint auto_increment,\n    title varchar(255) not null,\n    price decimal      not null,\n    CONSTRAINT product_pl PRIMARY KEY (id)\n);\n\n--rollback DROP TABLE products;\n</code></pre>\n<p>then im try to test my repository:</p>\n<pre><code>@DataJpaTest\n@Testcontainers\n@AutoConfigureTestDatabase (replace = AutoConfigureTestDatabase.Replace.NONE)\nclass ProductRepositoryTest  {\n    @Container\n    static MySQLContainer&lt;?&gt; database = new MySQLContainer&lt;&gt;(&quot;mysql:8&quot;)\n            .withDatabaseName(&quot;springboot&quot;)\n            .withPassword(&quot;springboot&quot;)\n            .withUsername(&quot;springboot&quot;);\n\n    @DynamicPropertySource\n    static void setDataSourceProperties(DynamicPropertyRegistry propertyRegistry) {\n        propertyRegistry.add(&quot;spring.datasource.url&quot;, database::getJdbcUrl);\n        propertyRegistry.add(&quot;spring.datasource.username&quot;, database::getUsername);\n        propertyRegistry.add(&quot;spring.datasource.password&quot;, database::getPassword);\n    }\n\n    @Autowired\n    private ProductRepository productRepository;\n\n    @Test\n    @Sql(&quot;/scripts/init_four_products.sql&quot;)\n    void shouldReturnProductPriceGreaterThan1200() {\n        List&lt;Sort.Order&gt; order = new ArrayList&lt;&gt;();\n        order.add(new Sort.Order(Sort.Direction.DESC, &quot;price&quot;));\n        Sort sort = Sort.by(order);\n        PageRequest pageRequest = PageRequest.of(0, 10, sort);\n        List&lt;Product&gt; acutal = productRepository.findAllByPriceBetween(BigDecimal.valueOf(1200),\n                BigDecimal.valueOf(Integer.MAX_VALUE), pageRequest);\n        Assertions.assertEquals(1, acutal.size());\n        Assertions.assertEquals(&quot;iPhone XI&quot;, acutal.get(0).getTitle());\n    }\n}\n</code></pre>\n<p>in <code>/scripts/init_four_products.sql</code> im just create som products:</p>\n<pre><code>INSERT INTO products (title, price) VALUES (&quot;iPhone 8&quot;, 700);\nINSERT INTO products (title, price) VALUES (&quot;iPhone 9 &quot;, 800);\nINSERT INTO products (title, price) VALUES (&quot;iPhone X&quot;, 1000);\nINSERT INTO products (title, price) VALUES (&quot;iPhone XI&quot;, 1200);\n</code></pre>\n<p>But have error:</p>\n<blockquote>\n<p>org.springframework.dao.InvalidDataAccessApiUsageException: At least 3\nparameter(s) provided but only 2 parameter(s) present in query.;\nnested exception is java.lang.IllegalArgumentException: At least 3\nparameter(s) provided but only 2 parameter(s) present in query.</p>\n</blockquote>\n<p>did not find any useful information at google</p>\n"},{"tags":["java","mysql","spring-boot","api","jpa"],"comments":[{"owner":{"user_id":13087086,"display_name":"mr.loop"},"edited":false,"comment_id":132411357,"body":"Is ` if (product.isPresent()) {` working properly in orderService.java. Try logging the value before the <code>if</code> block"},{"owner":{"user_id":10498869,"display_name":"Dadinho2000"},"edited":false,"comment_id":132411396,"body":"How ? Didn&#39;t understand, sorry"},{"owner":{"user_id":13523946,"display_name":"notAPPP"},"edited":false,"comment_id":132411445,"body":"Where you check if product exist?"}],"answers":[{"owner":{"user_id":13087086,"display_name":"mr.loop"},"up_vote_count":3,"is_accepted":true,"creation_date":1673023739,"answer_id":75033787,"body":"<p>The only place where you are checking (and need to check) whether the product exists or not is in this block</p>\n<pre><code>public float getCartAmount(List&lt;ShoppingCart&gt; shoppingCartList) {\n\n        float totalCartAmount = 0f;\n        float singleCartAmount = 0f;\n\n        for (ShoppingCart cart : shoppingCartList) {\n\n            String cloudProductName = cart.getProductName();\n            Optional&lt;CloudProduct&gt; product = cloudProductRepository.findByProductName(cloudProductName);\n            if (product.isPresent()) {\n                CloudProduct cloudproduct = product.get();\n                singleCartAmount = cart.getQuantity() * cloudproduct.getpriceInEuros();\n                \n                totalCartAmount = totalCartAmount + singleCartAmount;\n                cart.setProductId(cloudproduct.getProductId());\n                cart.setAmount(singleCartAmount);\n                cloudProductRepository.save(cloudproduct);\n            }\n        }\n        return totalCartAmount;\n    }\n</code></pre>\n<p>Here you are fetching the <code>productId</code> and <code>amount</code> from the database.</p>\n<p>If product doesn't exist, then <code>if (product.isPresent()) </code> block is not executed but the function <code>getCartAmount</code> <strong>still returns normally</strong> i.e. <code>cart.setProductId</code> and <code>cart.setAmount</code> are not executed and hence are null in your feed.</p>\n<p>Try an else with this if block</p>\n<pre><code>else {\n// throw error\n}\n</code></pre>\n"}],"owner":{"user_id":10498869,"display_name":"Dadinho2000"},"view_count":32,"up_vote_count":2,"accepted_answer_id":75033787,"answer_count":1,"score":2,"creation_date":1673021973,"question_id":75033446,"body":"<p>So, my code runs just fine, but I'm now aware of something that is not supposed to happen.\nWhenever I create an order, with an unexisting product,like this :</p>\n<pre><code>{\n&quot;cartItems&quot;: [\n    {\n        &quot;productName&quot;: &quot;teste52&quot;,\n        &quot;quantity&quot;: 7\n    }\n],\n&quot;userEmail&quot;: &quot;nemsei@gmail22.com&quot;\n}\n</code></pre>\n<p>it just creates the order like this:</p>\n<pre><code>{\n&quot;id&quot;: 1,\n&quot;user&quot;: {\n    &quot;userId&quot;: 1,\n    &quot;userName&quot;: null,\n    &quot;email&quot;: &quot;nemsei@gmail22.com&quot;\n},\n&quot;cartItems&quot;: [\n    {\n        &quot;id&quot;: 1,\n        &quot;productId&quot;: null,\n        &quot;productName&quot;: &quot;teste52&quot;,\n        &quot;quantity&quot;: 7,\n        &quot;amount&quot;: 0.0\n    }\n],\n&quot;createdAt&quot;: &quot;2023-01-06&quot;\n}\n</code></pre>\n<p>It is supposed to give an error, because the product with the name &quot;teste52&quot; doesn't exist but instead, it's creating that order, even without that product.\nMy order.java</p>\n<pre><code>package com.proj.my.model;\nimport java.time.LocalDate;\nimport java.util.List;\n\nimport org.hibernate.annotations.CreationTimestamp;\nimport org.springframework.data.jpa.domain.support.AuditingEntityListener;\n\nimport com.fasterxml.jackson.annotation.JsonIgnoreProperties;\n\nimport jakarta.persistence.CascadeType;\nimport jakarta.persistence.Column;\nimport jakarta.persistence.Entity;\nimport jakarta.persistence.EntityListeners;\nimport jakarta.persistence.FetchType;\nimport jakarta.persistence.GeneratedValue;\nimport jakarta.persistence.GenerationType;\nimport jakarta.persistence.Id;\nimport jakarta.persistence.JoinColumn;\nimport jakarta.persistence.OneToMany;\nimport jakarta.persistence.OneToOne;\nimport jakarta.persistence.Table;\nimport lombok.ToString;\n\n@ToString\n@Entity\n@Table(name = &quot;myorder&quot;)\n@EntityListeners(AuditingEntityListener.class)\n@JsonIgnoreProperties(value = {&quot;createdAt&quot;}, \n    allowGetters = true)  \npublic class Order {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private int id;\n    \n    @OneToOne(cascade = CascadeType.MERGE)\n    @JoinColumn(name = &quot;userId&quot;)\n    private User user;\n\n\n    @OneToMany(fetch = FetchType.EAGER, cascade = CascadeType.ALL, targetEntity = ShoppingCart.class)\n    @JoinColumn(name = &quot;order_id&quot;)\n    private List&lt;ShoppingCart&gt; cartItems;\n    @CreationTimestamp\n    @Column(updatable = false, name = &quot;createdAt&quot;)\n    private LocalDate createdAt;\n\n    public LocalDate getCreatedAt() {\n        return createdAt;\n    }\n\n    public void setCreatedAt(LocalDate createdAt) {\n        this.createdAt = createdAt;\n    }\n\n    public Order() {\n    }\n\n    public Order(User user, LocalDate createdAt, List&lt;ShoppingCart&gt; cartItems) {\n        this.user = user;\n        this.cartItems = cartItems;\n        this.createdAt = createdAt;\n    }\n\n    public Order(int Id, LocalDate createdAt, List&lt;ShoppingCart&gt; cartItems) {\n        this.cartItems = cartItems;\n        this.createdAt =  createdAt;\n        this.id = Id;\n    }\n\n    public int getId() {\n        return id;\n    }\n\n    public void setId(int id) {\n        this.id = id;\n    }\n\n    public User getUser() {\n        return user;\n    }\n\n    public void setCustomer(User user) {\n        this.user = user;\n    }\n\n    public List&lt;ShoppingCart&gt; getCartItems() {\n        return cartItems;\n    }\n\n    public void setCartItems(List&lt;ShoppingCart&gt; cartItems) {\n        this.cartItems = cartItems;\n    }\n}\n\n</code></pre>\n<p>My orderService.java</p>\n<pre><code>package com.proj.my.service;\n\nimport com.proj.my.model.Order;\nimport com.proj.my.model.CloudProduct;\nimport com.proj.my.model.ShoppingCart;\nimport com.proj.my.repository.OrderRepository;\nimport com.proj.my.repository.CloudProductRepository;\n\nimport org.springframework.stereotype.Service;\n\nimport java.time.LocalDate;\nimport java.util.List;\nimport java.util.Optional;\n\n@Service\npublic class OrderService {\n\n    private OrderRepository orderRepository;\n    private CloudProductRepository cloudProductRepository;\n\n    public OrderService(OrderRepository orderRepository, CloudProductRepository cloudProductRepository) {\n        this.orderRepository = orderRepository;\n        this.cloudProductRepository = cloudProductRepository;\n    }\n\n    public Order getOrderDetail(int orderId) {\n        Optional&lt;Order&gt; order = this.orderRepository.findById(orderId);\n        return order.isPresent() ? order.get() : null;\n    }\n    \n   public List&lt;Order&gt; getAllOrderDetail(LocalDate yesterday, LocalDate today) {\n        today = LocalDate.now();\n        yesterday = today.minusDays(1);\n        return orderRepository.findAllByCreatedAtBetween(yesterday, today);\n    }\n\n    public float getCartAmount(List&lt;ShoppingCart&gt; shoppingCartList) {\n\n        float totalCartAmount = 0f;\n        float singleCartAmount = 0f;\n\n        for (ShoppingCart cart : shoppingCartList) {\n\n            String cloudProductName = cart.getProductName();\n            Optional&lt;CloudProduct&gt; product = cloudProductRepository.findByProductName(cloudProductName);\n            if (product.isPresent()) {\n                CloudProduct cloudproduct = product.get();\n                singleCartAmount = cart.getQuantity() * cloudproduct.getpriceInEuros();\n                \n                totalCartAmount = totalCartAmount + singleCartAmount;\n                cart.setProductId(cloudproduct.getProductId());\n                cart.setAmount(singleCartAmount);\n                cloudProductRepository.save(cloudproduct);\n            }\n        }\n        return totalCartAmount;\n    }\n\n    public Order saveOrder(Order order) {\n        return orderRepository.save(order);\n    }\n}\n\n</code></pre>\n<p>My orderDTO.java</p>\n<pre><code>package com.proj.my.dto;\n\nimport com.proj.my.model.ShoppingCart;\n\nimport java.util.List;\n\npublic class OrderDTO {\n\n    private List&lt;ShoppingCart&gt; cartItems;\n    private String userEmail;\n    private String userName;\n\n    public OrderDTO() {\n    }\n\n    public OrderDTO(List&lt;ShoppingCart&gt; cartItems, String userEmail, String userName) {\n        this.cartItems = cartItems;\n        this.userEmail = userEmail;\n        this.userName = userName;\n    }\n    public List&lt;ShoppingCart&gt; getCartItems() {\n        return cartItems;\n    }\n\n    public void setCartItems(List&lt;ShoppingCart&gt; cartItems) {\n        this.cartItems = cartItems;\n    }\n\n    public String getuserEmail() {\n        return userEmail;\n    }\n\n    public void setuserEmail(String userEmail) {\n        this.userEmail = userEmail;\n    }\n\n    public String getuserName() {\n        return userName;\n    }\n\n    public void setuserName(String userName) {\n        this.userName = userName;\n    }\n\n    @Override\n    public String toString() {\n        return &quot;OrderDTO{&quot; +\n                &quot;, cartItems=&quot; + cartItems +\n                &quot;, userEmail='&quot; + userEmail + '\\'' +\n                &quot;, userName='&quot; + userName + '\\'' +\n                '}';\n    }\n}\n\n</code></pre>\n<p>My orderController.java</p>\n<pre><code>package com.proj.my.controller;\n\nimport java.time.LocalDate;\nimport java.util.List;\nimport java.util.Optional;\n\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.http.HttpStatus;\nimport org.springframework.http.ResponseEntity;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.PathVariable;\nimport org.springframework.web.bind.annotation.PostMapping;\nimport org.springframework.web.bind.annotation.RequestBody;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RestController;\n\nimport com.proj.my.dto.OrderDTO;\nimport com.proj.my.dto.ResponseOrderDTO;\nimport com.proj.my.model.CloudProduct;\nimport com.proj.my.model.Order;\nimport com.proj.my.model.ShoppingCart;\nimport com.proj.my.model.User;\nimport com.proj.my.repository.CloudProductRepository;\nimport com.proj.my.service.CloudProductService;\nimport com.proj.my.service.OrderService;\nimport com.proj.my.service.UserService;\n\n@RestController\n@RequestMapping(&quot;/api&quot;)\npublic class OrderController {\n\n    private OrderService orderService;\n    private CloudProductService cloudProductService;\n    private UserService userService;\n    @Autowired\n    private CloudProductRepository cloudProductRepository;\n\n\n    public OrderController(OrderService orderService, CloudProductService cloudProductService, UserService userService) {\n        this.orderService = orderService;\n        this.cloudProductService = cloudProductService;\n        this.userService = userService;\n    }\n\n    @GetMapping(value = &quot;/getOrder/{orderId}&quot;)\n    public ResponseEntity&lt;Order&gt; getOrderDetails(@PathVariable int orderId) {\n\n        Order order = orderService.getOrderDetail(orderId);\n        return ResponseEntity.ok(order);\n    }\n\n    @GetMapping(value = &quot;/getOrders/{dataaa}&quot;)\n    public List&lt;Order&gt; getAllOrderDetails(@PathVariable LocalDate dataaa) {\n        return orderService.getAllOrderDetail(dataaa);\n    }\n\n    @PostMapping(&quot;/placeOrder&quot;)\n    public ResponseEntity&lt;String&gt; placeOrder(@RequestBody OrderDTO orderDTO) {\n\n        ResponseOrderDTO responseOrderDTO = new ResponseOrderDTO();\n        List&lt;ShoppingCart&gt; shoppingCartList = orderDTO.getCartItems();\n        ShoppingCart shoppingCart;\n        for (ShoppingCart cart : shoppingCartList) {\n            String cloudProductName = cart.getProductName();\n            Optional&lt;CloudProduct&gt; product = cloudProductRepository.findByProductName(cloudProductName);\n            if (product.isPresent()){\n                float amount = orderService.getCartAmount(orderDTO.getCartItems());\n\n                User user = new User(orderDTO.getuserEmail());\n                \n                Integer userIdFromDb = userService.isUserPresent(user);\n\n                if (userIdFromDb != null) {\n                    user.setUserId(userIdFromDb);\n                }else{\n                    user = userService.createUser(user);\n                }\n\n                LocalDate createdAt = LocalDate.now(); \n\n                Order order = new Order(user, createdAt, orderDTO.getCartItems());\n\n                order = orderService.saveOrder(order);\n\n                responseOrderDTO.setAmount(amount);\n\n                responseOrderDTO.setDate(com.proj.my.util.DateUtil.getCurrentDateTime());\n                \n                responseOrderDTO.setOrderId(order.getId());\n\n\n                return new ResponseEntity&lt;&gt;(&quot;Created&quot;, HttpStatus.OK);\n            }\n            else{\n                return new ResponseEntity&lt;&gt;(&quot;Can't&quot;, HttpStatus.OK);\n            }\n        }\n        return null;\n\n    }}\n</code></pre>\n<p>What can I do so that it gives an error instead of creating such order ?</p>\n"},{"tags":["java","spring","hibernate","rabbitmq"],"answers":[{"owner":{"user_id":4956336,"display_name":"p3consulting"},"up_vote_count":3,"is_accepted":true,"creation_date":1672945804,"answer_id":75023305,"body":"<p>The message is clear: you left autocommit to TRUE then you can't commit explicitly because it's done for you after each DML statement, you could turn it off with <code>hibernate.connection.autocommit=false</code> in your properties or calling <code>connection.setAutoCommit(false);</code></p>\n"}],"owner":{"user_id":896249,"display_name":"GameDroids"},"view_count":258,"up_vote_count":2,"accepted_answer_id":75023305,"answer_count":1,"score":2,"creation_date":1672937264,"question_id":75021769,"body":"<p>I am trying to develop a small Springboot application (using JHipster) that listens to a RabbitMQ queue, acknowledges the messages and then runs some operations on a hibernate repository. For now I can consume messages with no problem. But when I try to use the hibernate repository when receiving a message, it appears the TransactionManagers get mixed up and I get the Exception:</p>\n<pre><code>Caused by: org.hibernate.TransactionException: Unable to commit against JDBC Connection\n    at org.hibernate.resource.jdbc.internal.AbstractLogicalConnectionImplementor.commit(AbstractLogicalConnectionImplementor.java:92)\n    at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:282)\n ...\nCaused by: org.postgresql.util.PSQLException: Cannot commit when autoCommit is enabled.\n    at org.postgresql.jdbc.PgConnection.commit(PgConnection.java:872)\n</code></pre>\n<p>My Rabbit configuration is simplistic:</p>\n<pre><code>@Configuration\npublic class RabbitExchangeConfiguration {\n\n    @Bean\n    Queue queue() {\n        return new Queue(&quot;myQueue&quot;, false);\n    }\n}\n</code></pre>\n<p>Then there is my TestService, with a RabbitListener (<strong>listen</strong>) and a method that uses my database transaction manager to access the repository (<strong>test</strong>)</p>\n<pre><code>@Service\npublic class TestService {\n\n    public TestService(\n        MyRepository myRepository\n    ) {\n        this.myRepository= myRepository;\n    }\n\n    // My Listener to receive the messages\n    @RabbitListener(queues = &quot;datafactory&quot;)\n    public void listen(Message in) {\n        String messageBody = new String(in.getBody());       \n        test(messageBody);\n    }\n\n    // the method that should do stuff with the repository\n    @Transactional(transactionManager = &quot;myDatabaseTransactionManager&quot;)\n    public void test(String content) {\n        myRepository.findById(content).orElse(null);\n        ..\n    }\n}\n</code></pre>\n<p>Right now I don't care what the message contains, nor is it important if the entity can be found.</p>\n<p>When I comment out the call to <code>test(content)</code> then the message is received (I can see it in the logs). But when I try to call the function, then I get the Exception.</p>\n<p>Is there any way to end the RabbitMQ-transaction before entering the hibernate transaction context? Why is the listener trying to use the hibernate transaction?</p>\n<h1>solved</h1>\n<p>Thanks to the <a href=\"https://stackoverflow.com/a/75023305/896249\">answer of p3consulting</a>  I found that <code>jpa.properties.hibernate.connection.provider_disables_autocommit=true</code>  was set by default. It was configuered automatically by JHipster for me. I just had to make sure that autocommit was disabled for good:</p>\n<pre><code>spring.datasource.hikari.auto-commit=false  // disables auto commit\nspring.jpa.properties.hibernate.connection.provider_disables_autocommit=false   // makes sure it stays that way\n</code></pre>\n<p>So nothing to do with RabbitMQ...</p>\n"},{"tags":["java","spring","spring-boot","intellij-idea"],"comments":[{"owner":{"user_id":2696260,"display_name":"M. Deinum"},"edited":false,"comment_id":132379119,"body":"Spring Boot 3 requires JDK17. You only have JDK11 so that won&#39;t work. You need JDK17."}],"answers":[{"owner":{"user_id":3887145,"display_name":"Ralf Wagner"},"up_vote_count":2,"is_accepted":false,"creation_date":1672905337,"answer_id":75015321,"body":"<p>Spring Boot 3 requires Java 17 as a minimum Java version, so you need to install this on your machine. (If you need to use several Java versions in parallel on your machine, this can be done quite nicely with SDKMan (<a href=\"https://sdkman.io/\" rel=\"nofollow noreferrer\">https://sdkman.io/</a>).</p>\n<p>In IntelliJ, you need to add the new Java runtime to the known Java runtimes (File &gt; Project Settings &gt; SDKs) and the use it for your project (File &gt; Project Settings &gt; Project &gt; SDK).</p>\n"},{"owner":{"user_id":1438934,"display_name":"Anish Mittal"},"up_vote_count":1,"is_accepted":true,"creation_date":1672905513,"answer_id":75015348,"body":"<p>Spring Boot 3 requires Java 17 as minimum version. So just install Java 17 and update java runtime path in IntelliJ.</p>\n"}],"owner":{"user_id":1438934,"display_name":"Anish Mittal"},"view_count":92,"up_vote_count":2,"accepted_answer_id":75015348,"answer_count":2,"score":2,"creation_date":1672904334,"question_id":75015172,"body":"<p>I created a project from start.spring.io. No matter whether I choose Java 11 or Java 17 there, I get this error when I open this spring project in IntelliJ.</p>\n<p><strong>Error</strong>:</p>\n<pre><code>Could not resolve org.springframework.boot:spring-boot-gradle-plugin:3.0.1.\n     Required by:\n         project : &gt; org.springframework.boot:org.springframework.boot.gradle.plugin:3.0.1\n      &gt; No matching variant of org.springframework.boot:spring-boot-gradle-plugin:3.0.1 was found.\nIncompatible because this component declares an API of a component compatible with Java 17 and the consumer needed a runtime of a component compatible with Java 11.\n</code></pre>\n<p><strong>Note</strong>: I have installed Java 11 on my local machine.</p>\n<p>Why importing Java/Gradle project is so much errorneous in IntelliJ?</p>\n"},{"tags":["java","regex","performance","split"],"comments":[{"owner":{"user_id":4712734,"display_name":"DuncG"},"edited":false,"comment_id":134461975,"body":"Its better to not to speculate on performance, and only look at specific issues if they appear, remembering that different JDK implementations can dramatically change some tasks anyway.  <code>String.split()</code> does have a shortcut implementation for certain simple one or two character inputs, otherwise it delegates to regex. So for many apps there isn&#39;t a difference, and for other apps you may well not be able to tell the difference."}],"answers":[{"owner":{"user_id":1863229,"display_name":"Tim Biegeleisen"},"up_vote_count":2,"is_accepted":true,"creation_date":1684061865,"answer_id":76247108,"body":"<p>Using a split approach <em>might</em> typically be the more efficient approach.  We can split the input into components and then check each one to see if it be an long integer.</p>\n<pre class=\"lang-java prettyprint-override\"><code>String path = &quot;/good/312321312/bad/3213122131&quot;;\nString[] parts = path.split(&quot;/&quot;);\nList&lt;Long&gt; nums = new ArrayList&lt;&gt;();\nfor (String part : parts) {\n    try {\n        long num = Long.parseLong(part);\n        nums.add(num);\n    }\n    catch (NumberFormatException nfe) {\n    }\n}\n\nSystem.out.println(&quot;Found nums: &quot; + nums);\n</code></pre>\n<p>This prints:</p>\n<pre><code>Found nums: [312321312, 3213122131]\n</code></pre>\n<p>Any solution which only uses base string functions might outperform the cost of invoking a regex engine.</p>\n"},{"owner":{"user_id":2711488,"display_name":"Holger"},"up_vote_count":1,"is_accepted":false,"creation_date":1684244975,"answer_id":76263833,"body":"<p>Since creating a new string implies copying all characters, the implicit <code>substring</code> operations of <code>split</code> are the most expensive aspect here. Creating an array, to hold all the strings, adds to it, but is minuscule compared to the string creations. Still, we can avoid both.</p>\n<pre class=\"lang-java prettyprint-override\"><code>static final Pattern NUMBER = Pattern.compile(&quot;\\\\d+&quot;);\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>public static void main(String[] args) {\n    String s = &quot;/good/312321312/bad/3213122131&quot;;\n\n    long first = -1, second = -1;\n    Matcher m = NUMBER.matcher(s);\n    if(m.find()) {\n        first = Long.parseLong(s, m.start(), m.end(), 10);\n        if(m.find()) {\n            second = Long.parseLong(s, m.start(), m.end(), 10);\n        }\n    }\n\n    System.out.println(first + &quot;\\t&quot; + second);\n}\n</code></pre>\n<p>or</p>\n<pre class=\"lang-java prettyprint-override\"><code>public static void main(String[] args) {\n    String s = &quot;/good/312321312/bad/3213122131&quot;;\n\n    LongStream.Builder b = LongStream.builder();\n    Matcher m = NUMBER.matcher(s);\n    while(m.find()) b.add(Long.parseLong(s, m.start(), m.end(), 10));\n\n    long[] result = b.build().toArray();\n\n    System.out.println(Arrays.toString(result));\n}\n</code></pre>\n<p>When performance matters, it’s important to keep and reuse compiled <code>Pattern</code> instances instead of using convenience methods like <a href=\"https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/lang/String.html#split(java.lang.String)\" rel=\"nofollow noreferrer\"><code>String.split</code></a> which throw away the <code>Pattern</code> instance after the operation.</p>\n<p>Obviously, this only matters if the code is executed more than once. But when the code is executed only once, its performance wouldn’t matter anyway.</p>\n<p>The <a href=\"https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/lang/Long.html#parseLong(java.lang.CharSequence,int,int,int)\" rel=\"nofollow noreferrer\"><code>Long.parseLong</code></a> method that allows to skip the <code>substring</code> operation exists since Java 9. But even when you use <code>Long.parseLong(m.group())</code> here, you avoid creating strings for the non-numerical parts and retain the temporary strings as short as possible, which is optimizer-friendly.</p>\n"}],"owner":{"user_id":14473479,"display_name":"gutey"},"view_count":81,"up_vote_count":3,"accepted_answer_id":76247108,"answer_count":2,"score":2,"creation_date":1684061222,"question_id":76247049,"body":"<p>I have a string like this:</p>\n<pre><code>/good/312321312/bad/3213122131\n</code></pre>\n<p>I have to extract the two sets of digits from there.\nI thought about two solutions: either using the <code>split()</code> or simply writing a regex to match the digits.\nWhat would be the better solution performance wise?\nIf you have any other suggestion please tell me so.</p>\n"},{"tags":["java","spring-boot","controller","interceptor","endpoint"],"answers":[{"owner":{"user_id":8805742,"display_name":"mahfuj asif"},"up_vote_count":2,"is_accepted":false,"creation_date":1684057016,"answer_id":76246777,"body":"<p>I did the same using <code>@Arround</code> annotation. Here is the doc <a href=\"https://docs.spring.io/spring-framework/docs/2.0.x/reference/aop.html\" rel=\"nofollow noreferrer\">6.2.4.5. Around advice</a> (You need to search @around after going to the link). You can modify both the request and response.</p>\n<p>There is also <code>@Before</code> and <code>@After</code> advice you can use if required. If you only need to access the object BEFORE controller is invoked, <code>@Before</code> should be enough.</p>\n<pre><code>@Aspect\n@Component\npublic class RequestModifierAspect {\n    \n    @Around(&quot;execution(* com.example.YourController.methodName(..))&quot;)\n    public Object modifyRequest(ProceedingJoinPoint joinPoint) throws Throwable {\n        HttpServletRequest request = ((ServletRequestAttributes) RequestContextHolder.currentRequestAttributes()).getRequest();\n        \n        // Modify the request object here\n        // For example, change a parameter value\n        request.setParameter(&quot;yourParam&quot;, &quot;newValue&quot;);\n        \n        // Proceed with the modified request\n        Object result = joinPoint.proceed();\n        \n        // You can also modify the result returned by the controller method if needed\n        \n        return result;\n    }\n}\n</code></pre>\n"}],"owner":{"user_id":21895742,"display_name":"dankovsky"},"view_count":16,"up_vote_count":2,"answer_count":1,"score":2,"creation_date":1684055665,"question_id":76246694,"body":"<p>there any option to edit values with Interceptor before the request goes to the controller?</p>\n<p>I tried to wrap the HttpServletRequest and set the new body.</p>\n<p><strong>I have Post request in controller that looks like this :</strong></p>\n<pre><code>@PostMapping(&quot;/edit-via-interceptor&quot;)\npublic MyObject getNewObjectFromInterceptor(@RequestBody MyObject myObject){\n    return myObject;}\n</code></pre>\n<p><strong>The Object looks like this:</strong></p>\n<pre><code>@Data\npublic class MyObject implements Serializable {\n    private List&lt;String&gt; ids;\n}\n</code></pre>\n<p>The RequestBody has List of ids, and I want to add inside the interceptor 2 default id's to the current list.</p>\n<p><strong>The Interceptor looks like this:</strong></p>\n<pre><code>@Component\npublic class Interceptor extends HandlerInterceptorAdapter {\n\n    @Override\n    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {\n        HttpServletRequest httpRequest = request;\n\n        CustomHttpServletRequestWrapper wrapper = new CustomHttpServletRequestWrapper(httpRequest);\n        ObjectMapper objectMapper = new ObjectMapper();\n\n        MyObject newMyObject =  objectMapper.readValue(wrapper.getInputStream(), MyObject.class);\n        List&lt;String&gt; newIdsList = newMyObject.getIds();\n        newIdsList.add(&quot;123&quot;);\n        newIdsList.add(&quot;1234&quot;);\n        newMyObject.setIds(newIdsList);\n        byte[] data = SerializationUtils.serialize(newMyObject);\n        wrapper.setBody(data);\n\n        return super.preHandle(wrapper, response, handler);\n    }\n}\n</code></pre>\n<p><strong>CustomHttpServletRequestWrapper looks like this:</strong></p>\n<pre><code>public class CustomHttpServletRequestWrapper extends HttpServletRequestWrapper {\n    private byte[] body;\n\n    public CustomHttpServletRequestWrapper(HttpServletRequest request) {\n        super(request);\n        try {\n            body = IOUtils.toByteArray(request.getInputStream());\n        } catch (IOException ex) {\n            body = new byte[0];\n        }\n    }\n\n    public void setBody(byte[] body){\n        this.body = body;\n    }\n    @Override\n    public ServletInputStream getInputStream() throws IOException {\n        return new ServletInputStream() {\n            ByteArrayInputStream bais = new ByteArrayInputStream(body);\n\n            @Override\n            public int read() throws IOException {\n                return bais.read();\n            }\n\n            @Override\n            public boolean isFinished() {\n                return false;\n            }\n\n            @Override\n            public boolean isReady() {\n                return false;\n            }\n\n            @Override\n            public void setReadListener(ReadListener listener) {\n\n            }\n        };\n    }\n}\n</code></pre>\n<p><strong>The configuration on Interceptor pattern :</strong></p>\n<pre><code>@Configuration\npublic class AuthConfig implements WebMvcConfigurer {\n\n    @Autowired\n    private Interceptor controllerInterceptor;\n\n    @Override\n    public void addInterceptors(InterceptorRegistry registry) {\n        // The registration of /api/** must be in the end\n       \n        registry.addInterceptor(controllerInterceptor).addPathPatterns(&quot;/**&quot;);\n    }\n</code></pre>\n<p>After all that, When its comes to the Controller - MyObject is <strong>null</strong>.</p>\n"},{"tags":["java","sql","jdbc","h2"],"comments":[{"owner":{"user_id":53069,"display_name":"sproketboy"},"edited":false,"comment_id":134450908,"body":"@xerx593 The robot gave me a solution that I was working on already. Thanks anyway."},{"owner":{"user_id":11731987,"display_name":"Evgenij Ryazanov"},"edited":false,"comment_id":134451025,"body":"<code>USERS</code> is not a reserved word. (<code>USER</code> is.) Where exactly do you see these two tables? <code>INFORMATION_SCHEMA</code> is visible for everyone, you can&#39;t hide it. But it isn&#39;t included into schema search path by default."},{"owner":{"user_id":592355,"display_name":"xerx593"},"edited":false,"comment_id":134451572,"body":"Correct, actually not a &quot;reserved word&quot; ..but one of <a href=\"http://www.h2database.com/html/systemtables.html\" rel=\"nofollow noreferrer\">h2database.com/html/systemtables.html</a>"},{"owner":{"user_id":11731987,"display_name":"Evgenij Ryazanov"},"edited":false,"comment_id":134452007,"body":"<code>SELECT something FROM USERS</code> selects rows from <code>PUBLIC.USERS</code> table if this table exists, otherwise it throws an exception. <code>SELECT something FROM INFORMATION_SCHEMA.USERS</code> selects rows from <code>INFORMATION_SCHEMA.USERS</code> system table, you need to qualify names of tables when they don&#39;t belong to the current schema or any schema specified with <code>SCHEMA_SEARCH_PATH</code> if this setting was used."},{"owner":{"user_id":642706,"display_name":"Basil Bourque"},"edited":false,"comment_id":134453837,"body":"Tip: Append an underscore to every name (table, column, index, etc.) to avoid collision with keywords, reserved words, system names. The SQL standard explicitly promises to never use a trailing underscore."}],"answers":[{"owner":{"user_id":642706,"display_name":"Basil Bourque"},"up_vote_count":2,"is_accepted":false,"creation_date":1684010827,"answer_id":76244811,"body":"<h1>tl;dr</h1>\n<p>Unreproducible.</p>\n<p>The default schema in H2 is <code>PUBLIC</code>. If you create a table there named <code>USERS</code>, that table is found by default.</p>\n<p>Be aware of your current schema. The standard <code>INFORMATION_SCHEMA</code> schema contains a table named <code>USERS</code>.</p>\n<h1>Not reproducible</h1>\n<p>As noted in the Comments:</p>\n<ul>\n<li><code>USERS</code> is not a reserved word in H2 Database Engine.</li>\n<li>No table named <code>USERS</code> is available by default in H2.</li>\n<li>The default schema in H2 is <code>PUBLIC</code>. If you create a table there, and query on that table, it will be found by default.</li>\n</ul>\n<p>So the problem raised in your Question is not reproducible.</p>\n<p>I suspect you have changed the default schema to the SQL standard schema of <code>INFORMATION_SCHEMA</code>. See the <a href=\"http://www.h2database.com/html/systemtables.html#information_schema_users\" rel=\"nofollow noreferrer\"><em>System Tables</em></a> page in the documentation. There exits a table named <code>USERS</code>, <a href=\"http://www.h2database.com/html/systemtables.html#information_schema_users\" rel=\"nofollow noreferrer\">as documented</a>.</p>\n<p>Here is an example app that makes 3 attempts to query a table named <code>USERS</code> in:</p>\n<ul>\n<li>The schema named <code>INFORMATION_SCHEMA</code>.</li>\n<li>The schema named <code>PUBLIC</code>, explicitly.</li>\n<li>The default schema (which is <code>PUBLIC</code>, implicitly).</li>\n</ul>\n<p>The results are, respectively:</p>\n<ul>\n<li>Success. Table found in <code>INFORMATION_SCHEMA</code>.</li>\n<li>Failure. No such table in <code>PUBLIC</code>.</li>\n<li>Failure. No such table in default schema, <code>PUBLIC</code>.</li>\n</ul>\n<p>Next we create a table named exactly <code>USERS</code> in the default schema, <code>PUBLIC</code>. And we run our same 3 attempts above.</p>\n<p>The results are, respectively:</p>\n<ul>\n<li>Success. Table found in <code>INFORMATION_SCHEMA</code>.</li>\n<li>Success. Table found in <code>PUBLIC</code>.</li>\n<li>Success. Table found in default schema, <code>PUBLIC</code>.</li>\n</ul>\n<p>By the way, the name of the default schema in H2 is defined as a constant: <a href=\"https://www.h2database.com/javadoc/org/h2/engine/Constants.html#SCHEMA_MAIN\" rel=\"nofollow noreferrer\"><code>Constants.SCHEMA_MAIN</code></a>. That constant holds a value of <code>PUBLIC</code> as shown in this example code.</p>\n<h1>Example code</h1>\n<pre class=\"lang-java prettyprint-override\"><code>package work.basil.example.db;\n\nimport org.h2.jdbcx.JdbcDataSource;\n\nimport javax.sql.DataSource;\nimport java.sql.Connection;\nimport java.sql.ResultSet;\nimport java.sql.SQLException;\nimport java.sql.Statement;\n\npublic class UsersTableEx\n{\n    public static void main ( String[] args )\n    {\n        System.out.println ( &quot;org.h2.engine.Constants.SCHEMA_MAIN = &quot; + org.h2.engine.Constants.SCHEMA_MAIN + &quot;\\n---------------------&quot; );\n        UsersTableEx app = new UsersTableEx ( );\n        DataSource dataSource = app.obtainDataSource ( );\n\n        app.queryInformationSchemaUsers ( dataSource );\n        app.queryPublicUsers ( dataSource );\n        app.queryUsers ( dataSource );\n\n        app.createUsersTable(dataSource );\n\n        app.queryInformationSchemaUsers ( dataSource );\n        app.queryPublicUsers ( dataSource );\n        app.queryUsers ( dataSource );\n\n        System.out.println ( &quot;INFO - Demo done.&quot; );\n    }\n    \n    private void queryInformationSchemaUsers ( DataSource dataSource )\n    {\n        System.out.println ( &quot;INFO - Query for INFORMATION_SCHEMA.USERS.&quot; );\n        String sql = &quot;&quot;&quot;\n                SELECT *\n                FROM INFORMATION_SCHEMA.USERS\n                ;\n                &quot;&quot;&quot;;\n        try (\n                Connection conn = dataSource.getConnection ( ) ;\n                Statement statement = conn.createStatement ( ) ;\n        )\n        {\n            try (\n                    ResultSet resultSet = statement.executeQuery ( sql ) ;\n            )\n            {\n                while ( resultSet.next ( ) )\n                {\n                    System.out.println (\n                            &quot;USER_NAME = &quot; + resultSet.getString ( &quot;USER_NAME&quot; ) +\n                                    &quot; | IS_ADMIN = &quot; + resultSet.getBoolean ( &quot;IS_ADMIN&quot; ) +\n                                    &quot; | REMARKS = &quot; + resultSet.getString ( &quot;REMARKS&quot; ) +\n                                    &quot;\\n------------------&quot;\n                    );\n                }\n            }\n        }\n        catch ( SQLException e ) { throw new RuntimeException ( e ); }\n    }\n\n    private void queryPublicUsers ( DataSource dataSource )\n    {\n        System.out.println ( &quot;INFO - Query for PUBLIC.USERS.&quot; );\n        String sql = &quot;&quot;&quot;\n                SELECT *\n                FROM PUBLIC.USERS\n                ;\n                &quot;&quot;&quot;;\n        try (\n                Connection conn = dataSource.getConnection ( ) ;\n                Statement statement = conn.createStatement ( ) ;\n        )\n        {\n            try (\n                    ResultSet resultSet = statement.executeQuery ( sql ) ;\n            )\n            { while ( resultSet.next ( ) ) System.out.println ( &quot;Found row.&quot; ); }\n        }\n        catch ( org.h2.jdbc.JdbcSQLSyntaxErrorException e )\n        {\n            System.out.println ( &quot;ERROR - &quot; + e.getMessage ( ) + &quot;\\n--------------&quot; );\n        }\n        catch ( SQLException e ) { throw new RuntimeException ( e ); }\n    }\n\n    private void queryUsers ( DataSource dataSource )\n    {\n        System.out.println ( &quot;INFO - Query for USERS.&quot; );\n        String sql = &quot;&quot;&quot;\n                SELECT *\n                FROM USERS\n                ;\n                &quot;&quot;&quot;;\n        try (\n                Connection conn = dataSource.getConnection ( ) ;\n                Statement statement = conn.createStatement ( ) ;\n        )\n        {\n            try (\n                    ResultSet resultSet = statement.executeQuery ( sql ) ;\n            )\n            { while ( resultSet.next ( ) ) System.out.println ( &quot;Found row.&quot; ); }\n        }\n        catch ( org.h2.jdbc.JdbcSQLSyntaxErrorException e )\n        {\n            System.out.println ( &quot;ERROR - &quot; + e.getMessage ( ) + &quot;\\n--------------&quot; );\n        }\n        catch ( SQLException e ) { throw new RuntimeException ( e ); }\n    }\n\n    private void createUsersTable ( DataSource dataSource )\n    {\n        System.out.println ( &quot;INFO - Running `createUsersTable` method. \\n-----------------------------&quot; );\n        String sql = &quot;&quot;&quot;\n                CREATE TABLE IF NOT EXISTS USERS\n                (\n                    user_ TEXT NOT NULL ,\n                    id_ UUID NOT NULL DEFAULT RANDOM_UUID() ,\n                    CONSTRAINT history_pkey_ PRIMARY KEY ( id_ )\n                )\n                ;\n                &quot;&quot;&quot;;\n        try (\n                Connection conn = dataSource.getConnection ( ) ;\n                Statement stmt = conn.createStatement ( ) ;\n        )\n        {\n            stmt.executeUpdate ( sql );\n        } catch ( SQLException e ) { e.printStackTrace ( ); }\n    }\n\n    private DataSource obtainDataSource ( )\n    {\n        org.h2.jdbcx.JdbcDataSource ds = new JdbcDataSource ( );  // An implementation of `javax.sql.DataSource` bundled with H2.\n        ds.setURL ( &quot;jdbc:h2:mem:users_mystery_db;DB_CLOSE_DELAY=-1&quot; );\n        ds.setUser ( &quot;scott&quot; );\n        ds.setPassword ( &quot;tiger&quot; );\n        ds.setDescription ( &quot;An example database showing a query for table named `USERS`.&quot; );\n        return ds;\n    }\n}\n</code></pre>\n<p>When run:</p>\n<pre class=\"lang-none prettyprint-override\"><code>org.h2.engine.Constants.SCHEMA_MAIN = PUBLIC\n---------------------\nINFO - Query for INFORMATION_SCHEMA.USERS.\nUSER_NAME = SCOTT | IS_ADMIN = true | REMARKS = null\n------------------\nINFO - Query for PUBLIC.USERS.\nERROR - Table &quot;USERS&quot; not found (this database is empty); SQL statement:\nSELECT *\nFROM PUBLIC.USERS\n;\n [42104-214]\n--------------\nINFO - Query for USERS.\nERROR - Table &quot;USERS&quot; not found (this database is empty); SQL statement:\nSELECT *\nFROM USERS\n;\n [42104-214]\n--------------\nINFO - Running `createUsersTable` method. \n-----------------------------\nINFO - Query for INFORMATION_SCHEMA.USERS.\nUSER_NAME = SCOTT | IS_ADMIN = true | REMARKS = null\n------------------\nINFO - Query for PUBLIC.USERS.\nINFO - Query for USERS.\nINFO - Demo done.\n</code></pre>\n<h1>Trailing underscore avoids collisions</h1>\n<p>Tip: Append an underscore to every name (table, column, index, etc.) to avoid collision with keywords, reserved words, system names.</p>\n<p>The SQL standard explicitly promises to never use a trailing underscore in any of its names, keywords, reserved words, system tables, and such.</p>\n"}],"owner":{"user_id":53069,"display_name":"sproketboy"},"view_count":62,"up_vote_count":2,"answer_count":1,"score":2,"creation_date":1683971294,"question_id":76242077,"body":"<p>I'm upgrading my library to support H2 baseline 2.0 and I have tests that fail because I have a table called Users, but H2 now seems to see that as it's USERS table in INFORMATION_SCHEMA rather than in PUBLIC.</p>\n<p>I tried changing my URL to jdbc:h2:{$home}/pinf;SCHEMA=PUBLIC but I still see 2 copies of USERS. I don't want to see the tables in INFORMATION_SCHEMA.</p>\n<p>How do I have a user that would only see PUBLIC schema?</p>\n<p>This worked fine under H2 1.x.</p>\n<p>To clarify this is when using <code>con.getMetaData().getTables</code></p>\n<p>I 1st log in as sa then:</p>\n<pre><code>CREATE USER pinf PASSWORD 'pinf' ADMIN;\nGRANT SELECT, INSERT, UPDATE, DELETE ON SCHEMA PUBLIC TO pinf;\nREVOKE ALL ON SCHEMA INFORMATION_SCHEMA FROM pinf;\n</code></pre>\n<p>then I log in as 'pinf'</p>\n<p>iterating across meta data with getTables with null parameters for catalog, schema pattern and table name pattern includes the tables from INFORMATION_SCHEMA. This was not the case in 1.x version.</p>\n"},{"tags":["java","regex"],"comments":[{"owner":{"user_id":7582247,"display_name":"Ted Lyngmo"},"edited":false,"comment_id":134432584,"body":"It seems only Java and JavaScript are using regex engines that timesout when I tested this on regex101.com. All the other quickly concludes that there is no match. Perhaps you could use PCRE2 (if there are java bindings for it)?"},{"owner":{"user_id":21305238,"display_name":"InSync"},"edited":false,"comment_id":134432603,"body":"@TedLyngmo PCRE2 took ~713k steps before failing (check <i>Regex Debugger</i>)."},{"owner":{"user_id":21305238,"display_name":"InSync"},"edited":false,"comment_id":134432622,"body":"I don&#39;t know Java, but this seems to be related: <a href=\"https://stackoverflow.com/q/53048859\">Is Java ReDos vulnerable?</a>"},{"owner":{"user_id":179910,"display_name":"Jerry Coffin"},"edited":false,"comment_id":134432776,"body":"DFA-based regex engines can match patterns like this in linear time (at the expense of usually using more memory). If you want to support tagged subexpressions, you can use a TDFA (tagged DFA), but they&#39;re more complex still. You can also do some quick hacks by pre-processing the user&#39;s input for obvious problems like this one--since <code>.*</code> (once) can match an arbitrary amount of input, you can safely collapse <code>.*.*</code> down to a single <code>.*</code>. In your example case, that reduces the pattern to <code>.*b.*x</code>, which should be fast on essentially any regex engine."},{"owner":{"user_id":179910,"display_name":"Jerry Coffin"},"edited":false,"comment_id":134432798,"body":"A clever user can pretty easily outwit that simple-minded hack though. You can add more sophisticated hacks to make a DoS attack more difficult, but in the end, it probably makes more sense to just spawn the regex search into a separate process, and limit its resource usage, or use a <a href=\"https://github.com/marianobarrios/dregex\" rel=\"nofollow noreferrer\">DFA-based regex engine</a>."},{"owner":{"user_id":7582247,"display_name":"Ted Lyngmo"},"edited":false,"comment_id":134432799,"body":"@InSync Yes, I noticed but it did finish quickly. Unfortunately one can&#39;t check how many steps the other successful engines takes. I suggested PCRE2 because I think it has a lot of language bindings."}],"answers":[{"owner":{"user_id":1960027,"display_name":"Simon"},"up_vote_count":2,"is_accepted":false,"creation_date":1683841400,"answer_id":76231791,"body":"<p>According to <a href=\"https://www.oreilly.com/library/view/mastering-regular-expressions/0596528124/ch04.html\" rel=\"nofollow noreferrer\">Mastering Regular Expressions, 3rd Edition</a>, Java uses a Traditional NFA regex engine that supports lazy quantifiers but has the disadvantage that some patterns can take a very long time to match.</p>\n<p>DFA engines, being deterministic, don't suffer from that problem but are less powerful. In particular, lazy quantifiers are not possible with a DFA regex engine such as that found in &quot;awk (most versions), egrep (most versions), flex, lex&quot;.</p>\n<p>See also <a href=\"https://stackoverflow.com/questions/1963975/dfa-based-regular-expression-engines-for-java-with-capture\">DFA Based Regular Expression Engines for Java with Capture</a>.</p>\n"},{"owner":{"user_id":4222206,"display_name":"Queeg"},"up_vote_count":2,"is_accepted":false,"creation_date":1683842051,"answer_id":76231839,"body":"<p>SonarQube keeps alarming on regex like <code>.*something.*</code>. Even that must have bad performance, but compared to what?</p>\n<p>Coming back to your question: Apparently Sonar has the ability to inspect a regex and determine the risk. While I have not checked where in the code it would decide to alarm, it is open source and can be found at <a href=\"https://github.com/SonarSource/sonarqube\" rel=\"nofollow noreferrer\">https://github.com/SonarSource/sonarqube</a></p>\n<p>Edit: There seem to be multiple checks for regex patterns in this directory:\n<a href=\"https://github.com/SonarSource/sonar-java/tree/master/java-checks/src/main/java/org/sonar/java/checks/regex\" rel=\"nofollow noreferrer\">https://github.com/SonarSource/sonar-java/tree/master/java-checks/src/main/java/org/sonar/java/checks/regex</a></p>\n<p>Edit2: The code uses factored out common classes. Here is another promising specimen: <a href=\"https://github.com/SonarSource/sonar-analyzer-commons/blob/master/regex-parsing/src/main/java/org/sonarsource/analyzer/commons/regex/finders/RedosFinder.java\" rel=\"nofollow noreferrer\">https://github.com/SonarSource/sonar-analyzer-commons/blob/master/regex-parsing/src/main/java/org/sonarsource/analyzer/commons/regex/finders/RedosFinder.java</a></p>\n"}],"owner":{"user_id":638028,"display_name":"Klitos Kyriacou"},"view_count":59,"up_vote_count":3,"answer_count":2,"score":2,"creation_date":1683840529,"question_id":76231729,"body":"<p>The following program takes 1.5 seconds to run on my Intel Core i7 machine:</p>\n<pre><code>    public static void main(String[] args) {\n        String regex = &quot;.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*b.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*x&quot;;\n        long start = System.nanoTime();\n        boolean match = &quot;aaabccc&quot;.matches(regex);\n        long end = System.nanoTime();\n        System.out.println((end - start) / 1e9);\n    }\n</code></pre>\n<p>The regex consists of 30 times &quot;.*&quot; followed by a &quot;b&quot;, followed by another 30 times &quot;.*&quot; and finally an &quot;x&quot;. The time taken by <code>String.matches</code> to return is exponential on the number of &quot;.*&quot;, i.e. it's <em>O(eⁿ)</em>. If you replace 30 by 50, it will take more than a minute to return.</p>\n<p>This is concerning because I was thinking of having a public HTTP API where the user would be able to enter a regex. If the regex is coming from outside, it is possible that a malicious user could enter a regex that would cause very high CPU on my server for a long time.</p>\n<p>Is this a known issue in the Java API and does anyone know of a workaround, i.e. a way to inspect a regex to determine whether it is dangerous to use?</p>\n"},{"tags":["java","swing","graphics"],"comments":[{"owner":{"user_id":992484,"display_name":"MadProgrammer"},"edited":false,"comment_id":134433566,"body":"Couldn&#39;t you just create a new <code>BufferedImage</code> of the size of the original and simply paint the sub image into it?"},{"owner":{"user_id":992484,"display_name":"MadProgrammer"},"edited":false,"comment_id":134433842,"body":"You&#39;re not starting with a transparent image"}],"answers":[{"owner":{"user_id":992484,"display_name":"MadProgrammer"},"up_vote_count":2,"is_accepted":true,"creation_date":1683851983,"answer_id":76232444,"body":"<p>You're not starting with a transparent image (your source image is <code>jpg</code>, which doesn't tend to support transparency)</p>\n<p>So, instead, you need to create an intermediate transparent image, for example...</p>\n<pre><code>BufferedImage transparentSub = new BufferedImage(sub.getWidth(), sub.getHeight(), BufferedImage.TRANSLUCENT);\n\nGraphics2D g3d = transparentSub.createGraphics();\ng3d.drawImage(sub, 0, 0, null);\n</code></pre>\n<p>So, with this modification in your original code...</p>\n<pre><code>int rules[] = {\n    AlphaComposite.DST_IN, AlphaComposite.DST_OUT, AlphaComposite.DST_OVER,\n    AlphaComposite.SRC_IN, AlphaComposite.SRC_OVER, AlphaComposite.SRC_OUT,\n    AlphaComposite.CLEAR};\ntry {\n\n    int ac = rules[3];\n\n    // Any image of the right size will do here. I'm just using this as a demo.d\n    BufferedImage original = ImageIO.read(new URL(&quot;https://eskipaper.com/images/abstract-art-1.jpg&quot;));\n    BufferedImage sub = original.getSubimage(500, 400, 1050, 300);\n\n    Rectangle2D.Double r1 = new Rectangle2D.Double(0, 0, 1050, 300);\n    Area a1 = new Area(r1);\n    Ellipse2D.Double e1 = new Ellipse2D.Double(0, 0, 1050, 300);\n    Area a2 = new Area(e1);\n\n    BufferedImage transparentSub = new BufferedImage(sub.getWidth(), sub.getHeight(), BufferedImage.TRANSLUCENT);\n\n    Graphics2D g3d = transparentSub.createGraphics();\n    g3d.drawImage(sub, 0, 0, null);\n\n    g3d.setColor(new Color(0.0f, 0.0f, 0.0f, 0.0f));\n    a1.subtract(a2);\n    g3d.setComposite(AlphaComposite.getInstance(rules[3], 1.0f));\n    g3d.fill(a1);\n    g3d.dispose();\n\n    JOptionPane.showMessageDialog(null, new ImageIcon(transparentSub));\n\n} catch (IOException e) {\n    e.printStackTrace();\n}\n</code></pre>\n<p>It now outputs...</p>\n<p><a href=\"https://i.stack.imgur.com/gm3hI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gm3hI.png\" alt=\"enter image description here\" /></a></p>\n"}],"owner":{"user_id":17085543,"display_name":"Jeff Higgins"},"view_count":27,"up_vote_count":2,"accepted_answer_id":76232444,"answer_count":1,"score":2,"creation_date":1683834156,"question_id":76231128,"body":"<p>I have a BufferedImage(any will do). I extract a sub-image.\nNow I wish to define a region of interest within the sub-image,\nand save my sub-image to another BufferedImage with all but the\nregion of interest transparent.</p>\n<p><a href=\"https://i.stack.imgur.com/hB8z5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hB8z5.png\" alt=\"Sub image without transparent\" /></a></p>\n<p>So far I'm unable to make the region outside my region of\ninterest transparent. In the code below, the region I want\nto be transparent is Area a1.</p>\n<p>Any guidance will be greatly appreciated.</p>\n<pre><code>import java.awt.AlphaComposite;\nimport java.awt.Color;\nimport java.awt.Graphics2D;\nimport java.awt.geom.Area;\nimport java.awt.geom.Ellipse2D;\nimport java.awt.geom.Rectangle2D;\nimport java.awt.image.BufferedImage;\nimport java.io.File;\nimport java.io.IOException;\nimport java.net.URL;\n\nimport javax.imageio.ImageIO;\n\npublic class Image {\n\n  public static void main(String[] args) {\n    int rules[] = {\n        AlphaComposite.DST_IN, AlphaComposite.DST_OUT,  AlphaComposite.DST_OVER,\n        AlphaComposite.SRC_IN, AlphaComposite.SRC_OVER, AlphaComposite.SRC_OUT,\n        AlphaComposite.CLEAR };\n    try {      \n\n      int ac = rules[3];\n      \n      // Any image of the right size will do here. I'm just using this as a demo.d\n      BufferedImage original = ImageIO.read(new URL(&quot;https://eskipaper.com/images/abstract-art-1.jpg&quot;));\n      BufferedImage sub = original.getSubimage(500, 400, 1050, 300);\n      \n      Rectangle2D.Double r1 = new Rectangle2D.Double(0, 0, 1050, 300);\n      Area a1 = new Area(r1);\n      Ellipse2D.Double e1 = new Ellipse2D.Double(0, 0, 1050, 300);\n      Area a2 = new Area(e1);\n      \n      Graphics2D g3d = sub.createGraphics();\n      \n      g3d.setColor(new Color(0.0f, 0.0f, 0.0f, 0.0f));\n      a1.subtract(a2);\n      g3d.setComposite(AlphaComposite.getInstance(rules[3], 1.0f));\n      g3d.fill(a1);      \n      \n      ImageIO.write(sub, &quot;png&quot;, new File(&quot;abstract-art-out.png&quot;));\n      \n    } catch (IOException e) {\n      e.printStackTrace();\n    }\n  }\n}\n</code></pre>\n"},{"tags":["java","swing","alignment","jbutton"],"comments":[{"owner":{"user_id":131872,"display_name":"camickr"},"edited":false,"comment_id":134411655,"body":"Start by finding a reference for HTML syntax. Don&#39;t just guess. For example why do all your examples play with the Font tag? A Font is a style or size of the text. You can&#39;t assign an alignment to a Font. Why would you define the &quot;sup&quot; tag first? Logically it comes after the text, so define your HTML that way as well. For a basic test you can start with: <code>String secondContent = &quot;&lt;html&gt;Multi-line&lt;sup&gt;HTML&lt;&#47;sup&gt;&lt;&#47;html&gt;&quot;;</code>"},{"owner":{"user_id":2711488,"display_name":"Holger"},"edited":false,"comment_id":134412277,"body":"Don’t add <code>JLabel</code>s to a <code>JButton</code>; that’s not gonna work. Further, there’s no point in setting a <code>FlowLayout</code> on a freshly instantiated <code>JPanel</code>, as that’s the default anyway. camickr already told you how to do the html right, but note that there’s no payoff in writing the implied tags in such fragments, just <code>&quot;&lt;html&gt;Some text&lt;sup&gt;10&quot;</code> and <code>&quot;&lt;html&gt;Multi-line&lt;sup&gt;HTML&quot;</code> are enough… And as a side note, looking at your screenshot I’m wondering what this <code>RoundedBorder</code> is good for. It doesn’t seem to have any effect."},{"owner":{"user_id":300257,"display_name":"Gilbert Le Blanc"},"edited":false,"comment_id":134415022,"body":"Why not just create images as you did for the question, load the images, and display them on <code>JButtons</code>?"}],"answers":[{"owner":{"user_id":300257,"display_name":"Gilbert Le Blanc"},"up_vote_count":2,"is_accepted":true,"creation_date":1683745177,"answer_id":76221784,"body":"<p>Oracle has a helpful tutorial, <a href=\"https://docs.oracle.com/javase/tutorial/uiswing/index.html\" rel=\"nofollow noreferrer\">Creating a GUI With Swing</a>.  Skip the Learning Swing with the NetBeans IDE section.  Pay particular attention to the <a href=\"https://docs.oracle.com/javase/tutorial/uiswing/painting/index.html\" rel=\"nofollow noreferrer\">Performing Custom Painting</a> section.</p>\n<p>As I said in my comment, why not just create an image and place the image in a <code>JButton</code>.</p>\n<p>Here's the GUI I came up with.</p>\n<p><a href=\"https://i.stack.imgur.com/oI12A.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oI12A.png\" alt=\"Example\" /></a></p>\n<p>To create images for all your <code>JButtons</code>, just call the image creation method in a loop.</p>\n<p>Here's the complete runnable code.</p>\n<pre><code>import java.awt.BorderLayout;\nimport java.awt.Color;\nimport java.awt.FlowLayout;\nimport java.awt.Font;\nimport java.awt.FontMetrics;\nimport java.awt.Graphics2D;\nimport java.awt.Rectangle;\nimport java.awt.RenderingHints;\nimport java.awt.image.BufferedImage;\n\nimport javax.swing.BorderFactory;\nimport javax.swing.ImageIcon;\nimport javax.swing.JButton;\nimport javax.swing.JFrame;\nimport javax.swing.JPanel;\nimport javax.swing.SwingUtilities;\n\npublic class JButtonImageExample implements Runnable {\n\n    public static void main(String[] args) {\n        SwingUtilities.invokeLater(new JButtonImageExample());\n    }\n\n    private BufferedImage image;\n\n    public JButtonImageExample() {\n        Font font = new Font(Font.DIALOG, Font.PLAIN, 36);\n        this.image = createLetterImage(70, 70, font, 'G', 7);\n    }\n\n    @Override\n    public void run() {\n        JFrame frame = new JFrame(&quot;Example&quot;);\n        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\n\n        frame.add(createButtonPanel(), BorderLayout.CENTER);\n\n        frame.pack();\n        frame.setLocationByPlatform(true);\n        frame.setVisible(true);\n    }\n\n    private JPanel createButtonPanel() {\n        JPanel panel = new JPanel(new FlowLayout());\n        panel.setBorder(BorderFactory.createEmptyBorder(100, 100, 100, 100));\n\n        JButton button = new JButton(new ImageIcon(image));\n        panel.add(button);\n\n        return panel;\n    }\n\n    private BufferedImage createLetterImage(int width, int height, Font font,\n            char letter, int value) {\n        BufferedImage image = new BufferedImage(width, height,\n                BufferedImage.TYPE_INT_ARGB);\n        Graphics2D g2d = (Graphics2D) image.getGraphics();\n        g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING,\n                RenderingHints.VALUE_ANTIALIAS_ON);\n        g2d.setRenderingHint(RenderingHints.KEY_TEXT_ANTIALIASING,\n                RenderingHints.VALUE_TEXT_ANTIALIAS_ON);\n        g2d.setRenderingHint(RenderingHints.KEY_FRACTIONALMETRICS,\n                RenderingHints.VALUE_FRACTIONALMETRICS_ON);\n        g2d.setFont(font);\n\n        g2d.setColor(Color.WHITE);\n        g2d.fillRect(0, 0, width, height);\n\n        g2d.setColor(Color.BLACK);\n        String s = Character.toString(letter);\n        Rectangle rect = new Rectangle(0, 0, width, height);\n        drawCenteredString(g2d, s, rect, font);\n\n        g2d.setColor(Color.BLUE);\n        s = Integer.toString(value);\n        drawRightAlignedString(g2d, s, width, font);\n\n        g2d.dispose();\n\n        return image;\n    }\n\n    private void drawRightAlignedString(Graphics2D g2d, String text, int width,\n            Font font) {\n        int pointSize = font.getSize() / 2;\n        g2d.setFont(font.deriveFont((float) pointSize));\n        FontMetrics metrics = g2d.getFontMetrics(g2d.getFont());\n        int margin = 2;\n        int x = width - metrics.stringWidth(text) - margin;\n        int y = metrics.getAscent() - margin;\n        g2d.drawString(text, x, y);\n    }\n\n    private void drawCenteredString(Graphics2D g2d, String text, Rectangle rect,\n            Font font) {\n        FontMetrics metrics = g2d.getFontMetrics(font);\n        int x = rect.x + (rect.width - metrics.stringWidth(text)) / 2;\n        int y = rect.y + ((rect.height - metrics.getHeight()) / 2)\n                + metrics.getAscent();\n        g2d.setFont(font);\n        g2d.drawString(text, x, y);\n    }\n\n}\n</code></pre>\n"}],"owner":{"user_id":20845398,"display_name":"seened"},"view_count":45,"up_vote_count":2,"accepted_answer_id":76221784,"answer_count":1,"score":2,"creation_date":1683726510,"question_id":76219222,"body":"<p>I am trying to figure it out how to align some text in a JButton, but it seems to be more challenging than I thought it can be. In some ways I have tried to use HTML and JLabel, but had no luck with it. What I am trying to do, I want to simulate a keyboard key with letter centered and a digit on the right-top of it.</p>\n<p><a href=\"https://i.stack.imgur.com/dGnXx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dGnXx.png\" alt=\"https://i.stack.imgur.com/dGnXx.png\" /></a></p>\n<pre><code>JPanel panel = new JPanel();\nLayoutManager layout = new FlowLayout();\npanel.setLayout(layout);\n\nString htmlContent = &quot;&lt;html&gt;&lt;font align=right&gt;10&lt;/font&gt;&lt;br&gt;&lt;center&gt;&lt;font width=100&gt;Some text&lt;font&gt;&lt;/center&gt;&lt;br&gt;&lt;font height=20&gt;&lt;/font&gt;&lt;/html&gt;&quot;;\nString secondContent = &quot;&lt;html&gt;&lt;sup&gt;HTML&lt;/sup&gt;&lt;br&gt;&lt;font&gt;Multi-line&lt;/font&gt;&quot;;\n\nJButton nextButton = new JButton(htmlContent);\nnextButton.setForeground(new Color(0x000000));\nnextButton.setBackground(new Color(0xffffff));\nnextButton.setBorderPainted(false);\nnextButton.setFocusPainted(false);\nnextButton.setBounds(0, 0, 30, 25);\npanel.add(nextButton);\n\nJButton secondButton = new JButton(secondContent);\nsecondButton.setForeground(new Color(0xffffff));\nsecondButton.setBackground(new Color(0x0062ff));\nsecondButton.setBorderPainted(false);\nsecondButton.setFocusPainted(false);\npanel.add(secondButton);\n\nJLabel firstLabel = new JLabel(&quot;First&quot;);\nfirstLabel.setHorizontalTextPosition(JLabel.RIGHT);\nfirstLabel.setVerticalTextPosition(JLabel.TOP);\nfirstLabel.setSize(150,100);\nJLabel secondLabel = new JLabel(&quot;So much text&quot;);\nsecondLabel.setHorizontalTextPosition(JLabel.CENTER);\nsecondLabel.setVerticalTextPosition(JLabel.CENTER);\nsecondLabel.setSize(100,100);\n\nJButton thirdBtn = new JButton();\nthirdBtn.setForeground(new Color(0x000000));\nthirdBtn.setBackground(new Color(0xbdbdbd));\nthirdBtn.setBorderPainted(false);\nthirdBtn.setFocusPainted(false);\nthirdBtn.add(firstLabel);\nthirdBtn.add(secondLabel);\nthirdBtn.setPreferredSize(new Dimension(200, 80));\npanel.add(thirdBtn);\n\nframe.getContentPane().add(panel, BorderLayout.CENTER);\n</code></pre>\n<p>So far here is the code I have tried to use to achieve this, but I can see no result of what I need, just cannot align the text to right or make it flow to there. Also tried using double labeled button, it seems that the labels cannot be aligned regarding each other. Is there a way to do that?</p>\n<p>P.S. Forgot to mention, have tried to use align=right or align='right' or just 'right' in HTML tags, but none of these works</p>\n<p>Results:</p>\n<p><a href=\"https://i.stack.imgur.com/EQcX3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EQcX3.png\" alt=\"https://i.stack.imgur.com/EQcX3.png\" /></a></p>\n"},{"tags":["java","sql","database","postgresql","sql-execution-plan"],"comments":[{"owner":{"user_id":9679725,"display_name":"Joe DiNottra"},"edited":false,"comment_id":134411856,"body":"Unfortunately that solution is for a different use case. It seems the main answer there is hardcoding the parameter in the second call. That is not realistic for my use case. It can be a massive parameter or may not be rendered correctly as String (e.g. float value)."},{"owner":{"user_id":7070613,"display_name":"Adrian Klaver"},"edited":false,"comment_id":134412479,"body":"I don&#39;t use Java, but a little digging found this <a href=\"https://jdbc.postgresql.org/documentation/server-prepare/\" rel=\"nofollow noreferrer\">Server prepare</a> <i>Server Prepared Statements Motivation</i>. It seems you might need to do: <code>ps1 = conn.prepareStatement( &quot;select * from documents where content = ?&quot;);</code>"},{"owner":{"user_id":9679725,"display_name":"Joe DiNottra"},"edited":false,"comment_id":134412548,"body":"That&#39;s what I&#39;m doing (in the second call). The first one <b>must use $1</b> to create a PostgreSQL procedure. I don&#39;t understand why the question was closed. The related answer is for a different question."},{"owner":{"user_id":7070613,"display_name":"Adrian Klaver"},"edited":false,"comment_id":134412607,"body":"1) I voted to reopen the question as it is different. 2) That is not what you are doing, you are using <code>prepare</code> and it&#39;s placeholder <code>$1</code> in your version of the query. If I understand the docs correctly that taken care of for you by <code>PreparedStatement</code>."}],"answers":[{"owner":{"user_id":4808122,"display_name":"Marmite Bomber"},"up_vote_count":2,"is_accepted":false,"creation_date":1683802440,"answer_id":76226845,"body":"<p>You don't need to replace the <code>$1</code> with the <em>bind variable value</em>, but you can't apparently use the bind variable in the <code>explain execute</code> statement - here it must be stated.</p>\n<p>So this sequence works fine (pseudocode)</p>\n<pre><code>prep = con.prepareStatement(&quot;prepare x(integer) as select id, pad from jdbn.document where id = $1&quot;)\nprep.execute();\n\nstmt = con.prepareStatement(&quot;explain execute x (42)&quot;)\nrs = stmt.executeQuery()\n</code></pre>\n<p>As described in the previously marked as duplicated <a href=\"https://stackoverflow.com/a/44899432/4808122\">question</a> you get for first few execution a <em>custom plan</em> (i.e. you see the variable in the condition, here <code>id = 42</code>) and finaly a <em>generic plan</em> (i.e. with a predicate <code>id = $1</code>)</p>\n<p>Your <em>trick</em> with <code>null</code> fails as PostgreSql knows that  <code>id = null</code> returns nothing (I'm using vague formulation to avoid to be neither <em>true</em> nor <em>false</em>) and makes a <em>dummy</em> plan e.g. <code>One-Time Filter: false</code></p>\n<p>You may force to produce a <em>generic plan</em> with the <a href=\"https://www.postgresql.org/docs/current/runtime-config-query.html\" rel=\"nofollow noreferrer\"><code>plan_cache_mode</code></a> parameter</p>\n<pre><code>con.createStatement().execute(&quot;set plan_cache_mode = force_generic_plan&quot;)\n</code></pre>\n<p>in which case the the first explained plan is generic. It seem that with this setting the <code>null</code> parameter does not lead to a dummy plan (but I'm not sure if there are not other caveats).</p>\n<p>So I'd say you should always define the data type of the variable <code>prepare x(integer) ...</code>  but I'm not sure and have no experience if you can get a meaningfull execution plan with the combination of <code>force_generic_plan</code>  and passing <code>null</code> (similar to Oracle functionality) or if you realy must pass representation sample value(s) or the parameter(s).</p>\n<p><strong>Final Note</strong> all the discussion here is focused on <em>well designed prepared statements</em>, i.e. any possible value passed will lead to a single same excution plan. For <em>other</em> statements it is not meaningfull, as there is <em>no single execution plan</em>.</p>\n"}],"owner":{"user_id":9679725,"display_name":"Joe DiNottra"},"view_count":79,"up_vote_count":2,"answer_count":1,"score":2,"creation_date":1683725669,"question_id":76219095,"body":"<p>My application has a myriad of queries and I wanted to get the execution plan of some of them. Most if not\nall of the queries have multiple parameters and I can't find how to get the execution plan for any non-trivial query in PostgreSQL.</p>\n<p>The real cases are much more involved but here's a simple, representative case of a query (just one parameter for simplicity):</p>\n<pre class=\"lang-java prettyprint-override\"><code>Connection conn = DriverManager.getConnection(&quot;...&quot;, &quot;...&quot;, &quot;...&quot;);\n\nPreparedStatement ps1 = conn.prepareStatement(\n  &quot;prepare x as select * from documents where content = $1&quot;);\nps1.execute();\n\nPreparedStatement ps2 = conn.prepareStatement(\n  &quot;explain (format json) execute x (?)&quot;);\nps2.setString(1, &quot;Very long content here...&quot;); // Binds the parameter\nResultSet rs = ps2.executeQuery(); // Error here!\n\nwhile (rs.next()) {\n  System.out.println(rs.getString(1));\n}\n</code></pre>\n<p>When I run this, I get the error:</p>\n<blockquote>\n<p>ERROR: there is no parameter $1\nPosition: 34</p>\n</blockquote>\n<p>If I <strong>hardcode</strong> the parameter (e.g. replacing <code>$1</code> with <code>'a'</code>) everything works well and I get a plan. However, if I try to use a JDBC parameter it doesn't work. Hardcoding the parameter is not realistic for my use case since it can be a massive parameter or may not be rendered correctly as String (e.g. float value).</p>\n<p>I also tried using <code>null</code> instead of <code>?</code> and it doesn't crash, but\nit returns an execution plan that is wrong; it seems it somehow short-circuits the logic and returns something totally off reality.</p>\n<p>What am I doing wrong?</p>\n"},{"tags":["java","jvm","compiler-optimization","jit"],"comments":[{"owner":{"user_id":721855,"display_name":"aled"},"edited":false,"comment_id":134396149,"body":"What version and distribution of the JDK are you using? What are the arguments used to start it? Please share the full literal error message. Are you seeing it in the logs?"},{"owner":{"user_id":12232740,"display_name":"vkm"},"edited":false,"comment_id":134408249,"body":"@aled Zulu JDK 11 it is. Have enabled PrintCompilation and nothing specific to compilation. This particular message is thrown out by PrintCompilation.   5021138 1171   !   4       sample.SampleClass::sampleMethod (6090 bytes)   COMPILE SKIPPED: unsupported calling sequence (retry at different tier)"}],"answers":[{"owner":{"user_id":3448419,"display_name":"apangin"},"up_vote_count":2,"is_accepted":true,"creation_date":1683679100,"answer_id":76214192,"body":"<p>You may use <code>-XX:CompileCommand</code> to enable recording of replay data for the particular method:</p>\n<pre><code>java -XX:CompileCommand=option,ClassName::methodName,DumpReplay ...\n</code></pre>\n<p><code>ClassName</code> and/or <code>methodName</code> may be specified as a wildcard with <code>*</code>. E.g., to dump replay data for all <code>java.lang</code> classes, use</p>\n<pre><code>java -XX:CompileCommand=option,java.lang.*::*,DumpReplay ...\n</code></pre>\n<p>Replay data is also automatically saved if JVM crashes during JIT compilation. You may force JVM crash on the compilation failure with the following option:</p>\n<pre><code>java -XX:+UnlockDiagnosticVMOptions -XX:+AbortVMOnCompilationFailure ...\n</code></pre>\n"}],"owner":{"user_id":12232740,"display_name":"vkm"},"view_count":43,"up_vote_count":2,"accepted_answer_id":76214192,"answer_count":1,"score":2,"creation_date":1683636912,"question_id":76209595,"body":"<p>C2 compiler thread is allocating high memory(Confirmed with the help of Native memory tracking) while compiling a few methods. Issue is reproduced randomly and not able to replicate with a test code.</p>\n<p>The compilations are actually getting failed with: COMPILE SKIPPED: unsupported calling sequence (retry at different tier)</p>\n<p>How to record the state of JVM and dump the so called &quot;Compiler_replay_data&quot; file during this problematic compilation?</p>\n<p>In a few JDK bug reports on JVM crash, could see the replay file is very much helpful. How to generate one such for my high memory footprint case?</p>\n"},{"tags":["java","linux","shell"],"comments":[{"owner":{"user_id":1934428,"display_name":"user1934428"},"edited":false,"comment_id":134389519,"body":"From the screenshot, we see that the script is executed in both cases, so at least invoking it works fine, so the possible problems are most likely inside the script. It is strange that the first <code>echo</code> does not show in the output, where the parent process is your Java program. This makes me wonder whether you REALLY execute the very same script in both cases. For verifying this (and possibly see, what&#39;s going wrong), I suggest that you replace <code>-c</code> by <code>-xc</code> when invoking the script, and analyze the output you get."},{"owner":{"user_id":20962137,"display_name":"hannah"},"edited":false,"comment_id":134390848,"body":"it still works the same I so proceeded with armali&#39;s reply but thanks for commenting!! @user1934428"}],"answers":[{"owner":{"user_id":2413201,"display_name":"Armali"},"up_vote_count":2,"is_accepted":true,"creation_date":1683620403,"answer_id":76207232,"body":"<blockquote>\n<p>new Line not recognized</p>\n</blockquote>\n<p>The newline is well recognized, it's just that <a href=\"https://docs.oracle.com/javase/8/docs/api/java/io/BufferedReader.html#readLine--\" rel=\"nofollow noreferrer\"><code>readLine</code></a></p>\n<blockquote>\n<p>Returns:</p>\nA String containing the contents of the line, not including\n            any line-termination characters…\n</blockquote>\n<p>so you have to re-insert them if you want them in the result.<br />\nWhile you're at it, I suggest to shorten</p>\n<pre><code>            String line;\n            while ((line = reader.readLine()) != null) {\n                output.append(line);\n            }\n            if(output.toString().equals(&quot;&quot;)) {\n                result = &quot;success&quot;;\n            }else {\n                result = output.toString();\n            }\n</code></pre>\n<p>to</p>\n<pre><code>            result = reader.lines().collect(Collectors.joining(&quot;\\n&quot;));\n            if (result.equals(&quot;&quot;)) result = &quot;success&quot;;\n</code></pre>\n"}],"owner":{"user_id":20962137,"display_name":"hannah"},"view_count":45,"up_vote_count":2,"accepted_answer_id":76207232,"answer_count":1,"score":2,"creation_date":1683612274,"question_id":76206288,"body":"<p>I wrote a shell script on the Linux Ubuntu server.\nAnd I want to run a shell script on Java.</p>\n<p>Running the shell script inside the Linux server changes the way I wrote it, but not through Java.</p>\n<p>I'll show you Java code, shell script file, and capture screen.</p>\n<p><strong>Java</strong></p>\n<pre><code>public class ShellScriptApplication {\n\n    public static void main(String[] args) {\n\n        String start = &quot;start&quot;;\n        String stop = &quot;stop&quot;;\n        String name = &quot;&quot;;\n\n        Scanner sc = new Scanner(System.in);\n        System.out.print(&quot;start or stop? : &quot;);\n        String s = sc.nextLine();\n\n        if(s.equals(start)) {\n            System.out.print(&quot;시작하실 프로그램을 입력해주세요 [admin / ap / json / fixed] : &quot;);\n            name = sc.nextLine();\n            openShell(start, name);\n        } else if (s.equals(stop)) {\n            System.out.print(&quot;종료하실 프로그램을 입력해주세요 [admin / ap / json / fixed] : &quot;);\n            name = sc.nextLine();\n            openShell(stop, name);\n        } else {\n            System.out.println(&quot;wrong&quot;);\n        }\n\n    }\n\n    public static String openShell(String status, String name)  {\n        String result = &quot;&quot;;\n\n        String dir = &quot;/data/GSLinkIN/app&quot;;\n\n        String cdExec = &quot;cd &quot; + dir + &quot; &amp;&amp; ./&quot;+ name + &quot;-&quot; + status + &quot;.sh&quot;;\n\n        String [] command = {&quot;/bin/sh&quot;,&quot;-c&quot;, cdExec};\n        ProcessBuilder processBuilder = new ProcessBuilder();\n        processBuilder.command(command);\n\n        try {\n            // Run script\n            Process process = processBuilder.start();\n\n            // Read output\n            StringBuilder output = new StringBuilder();\n            BufferedReader reader = new BufferedReader( new InputStreamReader(process.getInputStream()));\n\n            String line;\n            while ((line = reader.readLine()) != null) {\n                output.append(line);\n            }\n            if(output.toString().equals(&quot;&quot;)) {\n                result = &quot;success&quot;;\n            }else {\n                result = output.toString();\n            }\n        } catch (Exception e) {\n            result = &quot;fail&quot;;\n        }\n        System.out.println(result);\n\n        return result;\n    }\n\n}\n</code></pre>\n<p><strong>stop.sh</strong></p>\n<pre><code>#!/bin/sh\n\nAPP_NAME=linkin-admin-www-2.0.war\nAPP_PID=$(ps -ef | grep $APP_NAME | grep -v grep | awk '{print $2}')\n\necho &quot;$APP_NAME (PID:$APP_PID)&quot;\nkill -9 $APP_PID\necho &quot;$APP_NAME stopped&quot;\n\n</code></pre>\n<p><strong>When running a shell script using Java</strong>\n<a href=\"https://i.stack.imgur.com/92YXW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/92YXW.png\" alt=\"When running a shell script using Java\" /></a></p>\n<p><strong>When running directly on a Linux server</strong></p>\n<p><a href=\"https://i.stack.imgur.com/PdWGL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PdWGL.png\" alt=\"When running directly on a Linux server\" /></a></p>\n<p>Even if I run a shell script over Java, I want to print the PID and then get a new line.</p>\n"},{"tags":["java","swing","user-interface"],"comments":[{"owner":{"user_id":992484,"display_name":"MadProgrammer"},"edited":false,"comment_id":134359502,"body":"First, you’re violating the paint requirements; prefer paintComponent over paint and call it’s super method"},{"owner":{"user_id":992484,"display_name":"MadProgrammer"},"edited":false,"comment_id":134359525,"body":"Second, your mouse handler should have a reference to the “controller”. The handler would pass the required information to the “controller” and it would then do what ever is required to update the ui (update model, trigger repaint). Avoid exposing the underlying component itself to tge handler and instead prefer to make use interfaces"}],"answers":[{"owner":{"user_id":522444,"display_name":"Hovercraft Full Of Eels"},"up_vote_count":2,"is_accepted":false,"creation_date":1683378671,"answer_id":76189081,"body":"<p>Creating a <em>new</em> Main instance is not going to solve your problem. The problem is that you are changing the state of the wrong instance, and instead you will need to change the state of the currently visible Main instance, not create a new one:</p>\n<pre><code>@Override\npublic void mouseClicked(MouseEvent e) {\n  \n    if (e.getButton() == MouseEvent.BUTTON1) {\n      x = e.getX();\n      y = e.getY();\n      \n      Shape shape = new Ellipse2D.Float(x, y, 60, 60);\n      Area area = new Area(shape);\n\n      Main main2 = new Main();  // not going to work\n      main2.repaint();\n    }\n}\n</code></pre>\n<p>So instead, if this is a very simple program, then perhaps pass an instance of Main into EventAdapter and change its state via a setter method.  If the program needs to scale up though, if it is a small part of a much larger and more complex program (or will be in the future), then this solution would be brittle, and instead you will want to separate model from view, a la Model-View-Controller, to allow for separation of concerns, easier testing of separate classes, and easier debugging.</p>\n<p>For example:</p>\n<pre><code>import java.awt.BasicStroke;\nimport java.awt.Color;\nimport java.awt.Dimension;\nimport java.awt.Graphics;\nimport java.awt.Graphics2D;\nimport java.awt.RenderingHints;\nimport java.awt.Stroke;\nimport java.awt.event.MouseAdapter;\nimport java.awt.event.MouseEvent;\nimport java.awt.geom.Ellipse2D;\nimport java.util.ArrayList;\nimport java.util.List;\n\nimport javax.swing.*;\n\npublic class PaintPanel extends JPanel {\n    private static final int PREF_W = 800;\n    private static final int PREF_H = 650;\n    private static final Color E_FILL_COLOR = Color.PINK;\n    private static final int E_RADIUS = 40;\n    private static final Stroke E_STROKE = new BasicStroke(4f);\n    private static final Color E_BORDER_COLOR = Color.RED.darker();\n    private List&lt;Ellipse2D&gt; ellipses = new ArrayList&lt;&gt;();\n\n    public PaintPanel() {\n        \n    }\n\n    @Override\n    public Dimension getPreferredSize() {\n        Dimension superSize = super.getPreferredSize();\n        int width = Math.max(superSize.width, PREF_W);\n        int height = Math.max(superSize.height, PREF_H);\n        return new Dimension(width, height);\n    }\n\n    @Override\n    protected void paintComponent(Graphics g) {\n        super.paintComponent(g);\n        Graphics2D g2 = (Graphics2D)g.create();\n        g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);\n        g2.setStroke(E_STROKE);\n        for (Ellipse2D ellipse2d : ellipses) {\n            g2.setColor(E_FILL_COLOR);\n            g2.fill(ellipse2d);\n            g2.setColor(E_BORDER_COLOR);\n            g2.draw(ellipse2d);\n        }\n        g2.dispose();\n    }\n\n    public void addEllipse(int x, int y) {\n        Ellipse2D ellipse = new Ellipse2D.Double(x - E_RADIUS, y - E_RADIUS, 2* E_RADIUS, 2* E_RADIUS);\n        ellipses.add(ellipse);\n        repaint();\n    }\n\n    public static void main(String[] args) {\n        SwingUtilities.invokeLater(() -&gt; {\n            PaintPanel mainPanel = new PaintPanel();\n            mainPanel.addMouseListener(new EventAdapter(mainPanel));\n\n            JFrame frame = new JFrame(&quot;PaintPanel&quot;);\n            frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\n            frame.getContentPane().add(mainPanel);\n            frame.pack();\n            frame.setLocationByPlatform(true);\n            frame.setVisible(true);\n        });\n    }\n\n}\n</code></pre>\n<pre><code>class EventAdapter extends MouseAdapter {\n    private PaintPanel paintPanel;\n\n    public EventAdapter(PaintPanel paintPanel) {\n        this.paintPanel = paintPanel;  // pass in the painting component\n    }\n\n    @Override\n    public void mousePressed(MouseEvent e) {\n        // change the state of the painting component\n        paintPanel.addEllipse(e.getX(), e.getY());\n    }\n}\n</code></pre>\n<p>Also note that</p>\n<ul>\n<li>The drawing is done within the paintComponent method of a JPanel</li>\n<li>The super painting method, here super.paintComponent is called within the override so that &quot;housekeeping&quot; painting can be done</li>\n<li>Avoid setting anythings size if possible and instead let components size themselves with hints given by the programmer.</li>\n<li>This code allows for the creating and drawing of multiple circles by holding and filling an ArrayList of Ellipse2D objects and then iterating through the list within the paintComponent method.</li>\n</ul>\n<hr />\n<p>As per MadProgrammer's suggestions, here is a more M-V-C version:</p>\n<pre><code>import java.awt.BasicStroke;\nimport java.awt.Color;\nimport java.awt.Dimension;\nimport java.awt.Graphics;\nimport java.awt.Graphics2D;\nimport java.awt.RenderingHints;\nimport java.awt.Stroke;\nimport java.awt.event.MouseAdapter;\nimport java.awt.event.MouseEvent;\nimport java.beans.PropertyChangeListener;\nimport java.util.ArrayList;\nimport java.util.List;\nimport javax.swing.*;\nimport javax.swing.event.SwingPropertyChangeSupport;\n\npublic class PaintPanelMain {\n\n    public static void main(String[] args) {\n        SwingUtilities.invokeLater(() -&gt; {\n            ConcretePpView view = new ConcretePpView();\n\n            PpModel model = new PpModel();\n            PpController controller = new PpController(view, model);\n            controller.setVisible(true);\n        });\n    }\n\n}\n</code></pre>\n<pre><code>class ConcretePpView implements PpView {\n    private static final int PREF_W = 800;\n    private static final int PREF_H = 650;\n    private static final Stroke E_STROKE = new BasicStroke(4f);\n    private JPanel paintPanel = new PaintPanel();\n    private PpModel model;\n\n    public ConcretePpView() {\n        \n    }\n\n    @Override\n    public void setModel(PpModel model) {\n        this.model = model;\n    }\n\n    public PpModel getModel() {\n        return model;\n    }\n\n    @Override\n    public void addEventAdapter(EventAdapter eventAdapter) {\n        paintPanel.addMouseListener(eventAdapter);\n    }\n\n    @Override\n    public void repaint() {\n        paintPanel.repaint();\n    }\n\n    @Override\n    public JComponent getViewComponent() {\n        return paintPanel;\n    }\n\n    private class PaintPanel extends JPanel {\n        @Override\n        public Dimension getPreferredSize() {\n            Dimension superSize = super.getPreferredSize();\n            int width = Math.max(superSize.width, PREF_W);\n            int height = Math.max(superSize.height, PREF_H);\n            return new Dimension(width, height);\n        }\n    \n        @Override\n        protected void paintComponent(Graphics g) {\n            super.paintComponent(g);\n            if (model != null) {\n                Graphics2D g2 = (Graphics2D) g.create();\n                g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);\n                g2.setStroke(E_STROKE);\n                for (ColorEllipse ellipse : model.getEllipses()) {\n                    g2.setColor(ellipse.getFillColor());\n                    int r = ellipse.getRadius();\n                    int x = ellipse.getX() - r;\n                    int y = ellipse.getY() - r;\n                    g2.fillOval(x, y, 2 * r, 2 * r);\n                    g2.setStroke(E_STROKE);\n                    g2.setColor(ellipse.getBorderColor());\n                    g2.drawOval(x, y, 2 * r, 2 * r);\n                }\n                g2.dispose();\n            }\n        }\n    }\n\n}\n</code></pre>\n<pre><code>class ColorEllipse {\n    private Color fillColor;\n    private Color borderColor;\n    private int radius;\n    private int x;\n    private int y;\n\n    public ColorEllipse(Color fillColor, Color borderColor, int radius, int x, int y) {\n        this.fillColor = fillColor;\n        this.borderColor = borderColor;\n        this.radius = radius;\n        this.x = x;\n        this.y = y;\n    }\n\n    public Color getFillColor() {\n        return fillColor;\n    }\n\n    public Color getBorderColor() {\n        return borderColor;\n    }\n\n    public int getRadius() {\n        return radius;\n    }\n\n    public int getX() {\n        return x;\n    }\n\n    public int getY() {\n        return y;\n    }\n\n}\n</code></pre>\n<pre><code>class PpModel {\n    public static final String ELLIPSE = &quot;ellipse&quot;;\n    private SwingPropertyChangeSupport pcSupport = new SwingPropertyChangeSupport(this);\n    private List&lt;ColorEllipse&gt; ellipses = new ArrayList&lt;&gt;();\n\n    public void addEllipse(ColorEllipse ellipse) {\n        ellipses.add(ellipse);\n        pcSupport.firePropertyChange(ELLIPSE, null, ellipse);\n    }\n\n    public List&lt;ColorEllipse&gt; getEllipses() {\n        return ellipses;\n    }\n\n    public void addPropertyChangeListener(String propertyName, PropertyChangeListener listener) {\n        pcSupport.addPropertyChangeListener(propertyName, listener);\n    }\n\n    public void removePropertyChangeListener(String propertyName, PropertyChangeListener listener) {\n        pcSupport.removePropertyChangeListener(propertyName, listener);\n    }\n\n}\n</code></pre>\n<pre><code>class PpController {\n    private PpView view;\n    private PpModel model;\n\n    public PpController(PpView view, PpModel model) {\n        this.view = view;\n        this.model = model;\n        view.setModel(model);\n        view.addEventAdapter(new EventAdapter(this));\n        model.addPropertyChangeListener(PpModel.ELLIPSE, e -&gt; view.repaint());\n    }\n\n    public void setVisible(boolean b) {\n        JFrame frame = new JFrame(&quot;PaintPanel&quot;);\n        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\n        frame.getContentPane().add(view.getViewComponent());\n        frame.pack();\n        frame.setLocationByPlatform(true);\n        frame.setVisible(true);\n    }\n\n    public void addEllipse(int x, int y) {\n        float h = (float) Math.random();\n        Color fillColor = Color.getHSBColor(h, 1f, 1f);\n        Color borderColor = fillColor.darker().darker();\n        int radius = 20 + (int) (Math.random() * 40);\n        model.addEllipse(new ColorEllipse(fillColor, borderColor, radius, x, y));\n    }\n\n}\n</code></pre>\n<pre><code>interface PpView {\n    void setModel(PpModel model);\n\n    void repaint();\n\n    void addEventAdapter(EventAdapter eventAdapter);\n\n    JComponent getViewComponent();\n}\n</code></pre>\n<pre><code>class EventAdapter extends MouseAdapter {\n    private PpController controller;\n\n    public EventAdapter(PpController ppController) {\n        this.controller = ppController;\n    }\n\n    @Override\n    public void mousePressed(MouseEvent e) {\n        controller.addEllipse(e.getX(), e.getY());\n    }\n}\n</code></pre>\n"}],"owner":{"user_id":20323350,"display_name":"Logolas"},"view_count":67,"up_vote_count":2,"answer_count":1,"score":2,"creation_date":1683378425,"question_id":76189063,"body":"<p>Let's say we have two classes - Main and EventAdapter. The question is how to implement a program that paints an Area object at the place where mouse cursor is clicked, if mouseClicked method is located in a different class.</p>\n<pre><code>public class Main extends JComponent{\n\n    Main() {\n        repaint();\n    }\n\n    public void paint(Graphics g) {\n        Graphics2D gr = (Graphics2D) g;\n      \n        // fill graphics object with an Area object obtained in mouseClicked method\n\n        gr.setPaint(Color.red);\n        if (area != null)\n          gr.fill(area);\n    }\n\n    private static void createAndShowGUI() {\n        JFrame jFrame = new JFrame(&quot;test&quot;);\n        jFrame.setSize(300, 350);\n        jFrame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\n\n        Main main = new Main();\n        main.addMouseListener(new EventAdapter());\n\n        label = new JLabel(&quot;&quot;);\n        label.setHorizontalAlignment(JLabel.CENTER);\n\n        jFrame.add(label, BorderLayout.NORTH);\n        jFrame.add(area, BorderLayout.CENTER);\n        jFrame.setVisible(true);\n    }\n\n    public static void main(String[] args) {\n        createAndShowGUI();\n    }\n\n}\n\nclass EventAdapter extends MouseAdapter {\n    private int x, y;\n  \n    @Override\n    public void mouseClicked(MouseEvent e) {\n      \n        if (e.getButton() == MouseEvent.BUTTON1) {\n          x = e.getX();\n          y = e.getY();\n          \n          Shape shape = new Ellipse2D.Float(x, y, 60, 60);\n          Area area = new Area(shape);\n\n          Main main2 = new Main();\n          main2.repaint();\n        }\n    }\n</code></pre>\n<p>I am familiar with OOP, yet the concept of graphical interfaces seems a bit different to me. I have read Oracle documentations, but haven't found any information based on calling repaint method from a different class, so I hope anyone here will help me figure this out.</p>\n"},{"tags":["java","spring","kubernetes","out-of-memory"],"answers":[{"owner":{"user_id":13067200,"display_name":"Kenan G&#252;ler"},"up_vote_count":2,"is_accepted":false,"creation_date":1683026063,"answer_id":76154295,"body":"<p>It is possible for CPU throttling to indirectly cause memory issues by making garbage collection in the JVM less efficient or escalate an already inefficient memory usage, as such it may result in slower response times for your application, leading to more requests being queued up and more memory being used making the application store more objects in memory while waiting for requests to be processed.</p>\n<p>The JVM flags that you have set are a good starting point. To further investigate any memory leaks you might want to use the followings to dump the heap on an OOM and analyze the dump with a tool like Java VisualVM to find the root cause.</p>\n<pre><code>-XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/path/to/heapdump.bin\n</code></pre>\n<blockquote>\n<p>Throttling is an expected behavior for peaks to slow down.</p>\n</blockquote>\n<p>Yes, but I would consider CPU throttling more of a handbrake here and not the only <em>solution</em>. Instead I would implement an appropriate mechanism (like rate limiting, request queuing, circuit breakers, or backpressure throttling) either in the application or at the load balancer/reverse proxy level to prevent queues from forming.</p>\n"}],"owner":{"user_id":5871863,"display_name":"Norbert Koch"},"view_count":88,"up_vote_count":2,"answer_count":1,"score":2,"creation_date":1683021867,"question_id":76153774,"body":"<p>My pod is running in k8s and restarts every 20-30 hours, caused by an <code>OOMKilled</code> error, here are the configured limits:</p>\n<pre><code>  limits:\n    cpu: 600m\n    memory: 1536Mi\n  requests:\n    cpu: 150m\n    memory: 1536Mi\n</code></pre>\n<p>In the container is a JVM (Spring Boot) running with the following Options:</p>\n<pre><code>-Xms256m -Xmx1G -Xdebug -XX:+UseG1GC -XX:MinHeapFreeRatio=15 -XX:MaxHeapFreeRatio=26\n</code></pre>\n<p><strong>Analysis of the JVM Metrics</strong></p>\n<p>From my point of view, I can see, that there is a load peak, but not high enough to reach the memory limits, however the CPU Usage increases rapidly:\n<a href=\"https://i.stack.imgur.com/SRbds.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SRbds.png\" alt=\"enter image description here\" /></a></p>\n<p><strong>Analysis of the Pod Metrics</strong></p>\n<p>Let me show you the metrics of the pod provided by k8s:\n<a href=\"https://i.stack.imgur.com/D8ZqM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/D8ZqM.png\" alt=\"enter image description here\" /></a></p>\n<p>Memory increases much more than in the JVM shows. CPU Throttling is active. But I do not find the root cause. It seems that the container reaches the Limits and not the JVM, but why? Can CPU throttling causes Memory issues? Throttling is an expected behavior for peaks to slow down. I do not expect any memory issues in that case.</p>\n"},{"tags":["java","timer"],"answers":[{"owner":{"user_id":642706,"display_name":"Basil Bourque"},"up_vote_count":2,"is_accepted":true,"creation_date":1682969421,"answer_id":76149661,"body":"<h1><code>ScheduledExecutorService</code></h1>\n<p>In modern Java, we rarely need to address <code>Thread</code> directly. Instead, use the Executor framework added to Java 5.</p>\n<p>Part of that framework is  <a href=\"https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/util/concurrent/ScheduledExecutorService.html\" rel=\"nofollow noreferrer\"><code>ScheduledExecutorService</code></a>. You can ask that a task should be executed repeatedly between a specified period of time.</p>\n<p>Some important points:</p>\n<ul>\n<li>Obviously your task’s code must be <em>very</em> brief, executing in less than a microsecond. This may well be unrealistic.</li>\n<li>You have a choice of two scheduling methods: <a href=\"https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/util/concurrent/ScheduledExecutorService.html#scheduleAtFixedRate(java.lang.Runnable,long,long,java.util.concurrent.TimeUnit)\" rel=\"nofollow noreferrer\"><code>scheduleAtFixedRate</code></a> and <a href=\"https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/util/concurrent/ScheduledExecutorService.html#scheduleWithFixedDelay(java.lang.Runnable,long,long,java.util.concurrent.TimeUnit)\" rel=\"nofollow noreferrer\"><code>scheduleWithFixedDelay</code></a>. I suspect you want the first. But study both to decide for yourself.</li>\n<li>The <strong>scheduling of your task will <em>not</em> be perfect</strong>. Both the host OS and the JVM may introduce delays. If you want perfect timing, you must use a <a href=\"https://en.wikipedia.org/wiki/Real_time_Java\" rel=\"nofollow noreferrer\">real-time system</a>.</li>\n<li>I suspect your desired timeframe of a microsecond is approaching the limit of the hardware clock and software scheduler. At that granularity of time, I do not know if this approach will satisfactorily meet your needs.</li>\n<li>You must be careful to shutdown your executor service. Otherwise its backing pool of threads may run indefinitely, like a zombie 🧟‍♂️. Here we use try-with-resources syntax to close automatically.</li>\n</ul>\n<p>Here is some example code in <a href=\"https://en.wikipedia.org/wiki/Java_version_history#Java_20\" rel=\"nofollow noreferrer\">Java 20</a>.</p>\n<pre class=\"lang-java prettyprint-override\"><code>AtomicLong count = new AtomicLong( 0L );\ntry (\n        ScheduledExecutorService ses = Executors.newSingleThreadScheduledExecutor() ;\n)\n{\n    Runnable task = count :: incrementAndGet;\n    ses.scheduleAtFixedRate( task , 0L , 1L , TimeUnit.MICROSECONDS ); // 1,000 nanos = 1 micro.\n    try { Thread.sleep( Duration.ofMillis( 10 ) ); } catch ( InterruptedException e ) { throw new RuntimeException( e ); }\n}\n// We expect around 1,000 per millisecond in our count.\nSystem.out.println( &quot;count = &quot; + count );\n</code></pre>\n<p>When run:</p>\n<blockquote>\n<p>count = 13226</p>\n</blockquote>\n<p>We expect about 1,000 count for every millisecond. For ten milliseconds, we would expect about 10,000 in our count. I am getting results of 10,xxx to 13,xxx in the count when run within IntelliJ in Java 20 on an <a href=\"https://en.wikipedia.org/wiki/Apple_M1\" rel=\"nofollow noreferrer\">Apple M1</a> MacBook Pro.</p>\n"}],"owner":{"user_id":1131828,"display_name":"Hamdi Douss"},"view_count":50,"up_vote_count":2,"accepted_answer_id":76149661,"answer_count":1,"score":2,"creation_date":1682951659,"question_id":76147758,"body":"<p>I want to simulate a clock that ticks on a high frequency in Java. We can think of it as a 1Mhz CPU clock for example. This can be achieved with this code:</p>\n<pre><code>    // 1000 nanoseconds between ticks.\n    final long period = 1000;\n    this.runnable = new Runnable() {\n        public void run() {\n            long last = System.nanoTime();\n            while (true) {\n                long now = System.nanoTime();\n                if (now - last &gt; period) {\n                    last = now;\n                    System.out.println(Thread.currentThread().getId() + &quot; ticked at:&quot; + now);\n                }\n            }\n\n        }\n    };\n    this.thread = new Thread(this.runnable);\n    this.thread.start();   \n</code></pre>\n<p>The problem with this code is that it is a high CPU consumer as the thread is running constantly. I want to make the thread to sleep for some time between subsequent time checks, something like the code below:</p>\n<pre><code>    // 1000 nanoseconds between ticks.\n    final long period = 1000;\n    this.runnable = new Runnable() {\n        public void run() {\n            long last = System.nanoTime();\n            while (true) {\n                long now = System.nanoTime();\n                if (now - last &gt; period) {\n                    last = now;\n                    System.out.println(Thread.currentThread().getId() + &quot; ticked at:&quot; + now);\n                }\n            }\n            // here 4 is arbitrary, it determines checks frequency\n            LockSupport.parkNanos(period / 4);\n        }\n    };\n    this.thread = new Thread(this.runnable);\n    this.thread.start();\n</code></pre>\n<p>The problem in this approach is that the thread is halted for too long (&gt; 1ms in windows). The same thing happens if I use <code>Thread.sleep(0, period / 4);</code>.\nI understand the <code>Thread.sleep</code> and <code>LockSupport.parkNanos</code> can only guarantee the minimum time to sleep/halt.\nIs there a way to achieve what I want, i.e: tick the lock at this frequency without making the thread to run constantly?</p>\n"},{"tags":["java","mysql","jdbc"],"comments":[{"owner":{"user_id":203657,"display_name":"kleopatra"},"edited":false,"comment_id":134275397,"body":"aside: stick to java naming conventions please (no underscores in identifiers)"}],"answers":[{"owner":{"user_id":642706,"display_name":"Basil Bourque"},"up_vote_count":1,"is_accepted":true,"creation_date":1682798372,"answer_id":76138159,"body":"<h1><code>RowSet</code></h1>\n<p>The <a href=\"https://docs.oracle.com/en/java/javase/20/docs/api/java.sql.rowset/javax/sql/rowset/package-summary.html\" rel=\"nofollow noreferrer\"><code>javax.sql.rowset</code></a> package extends <code>ResultSet</code>, adding various features.</p>\n<p>In particular, <a href=\"https://docs.oracle.com/en/java/javase/20/docs/api/java.sql.rowset/javax/sql/rowset/CachedRowSet.html\" rel=\"nofollow noreferrer\"><code>CachedRowSet</code></a> copies the rows’ data into memory. To quote the documentation:</p>\n<blockquote>\n<p>A <code>CachedRowSet</code> object is a container for rows of data that caches its rows in memory, which makes it possible to operate without always being connected to its data source.</p>\n<p>…</p>\n<p>A <code>CachedRowSet</code> object is a disconnected rowset, which means that it makes use of a connection to its data source only briefly.</p>\n</blockquote>\n<p>The trick is finding a capable concrete implementation of the interface. Oracle provides an open-source reference implementation from the days of Sun. But, as I recall (and I may be wrong), that implementation had some limitations or flaws that went unaddressed. Be sure to test thoroughly.</p>\n"},{"owner":{"user_id":9991282,"display_name":"SvenJu"},"up_vote_count":1,"is_accepted":false,"creation_date":1682802333,"answer_id":76138414,"body":"<p>To fill the blanks in your snippet with a minimalistic approach:</p>\n<pre><code>    final var rowLength =\n            result_set\n                .getMetaData()\n                .getColumnCount();\n\n    final var resultCache = Stream.&lt;Object[]&gt;builder();\n\n    while ( result_set.next() )\n    {\n        final var row = new Object[ rowLength ];\n        for ( int index=1; index&lt;=rowLength; index++ )\n        {\n            row[index] = result_set.getObject( index );\n        }\n        \n        resultCache.accept( row );\n    }\n\n    record MyData( Integer value, String text )\n    {\n        // ... transformation could be placed in here with alternative constructor\n    }\n        \n    final var results =\n            resultCache.build()\n                    .map( row -&gt; new MyData( (Integer) row[0],\n                                             (String)  row[1] ) )\n                    .toList();\n</code></pre>\n<p>This assumes you know the ordering in the returned data and the types to do the 'parsing' / etc later on.\nThinking about the computationtime needed for the 'parsing' and the memoryfootprint and so on is a good way to become familiar with the behavior of the framework. I recommend trying out diffent sizes of resultsets (in number and rows) and the complexity of the parsing/ transformation. Maybe a look at a jpa-implementation helps to understand the possible solutions.</p>\n<p>In this post more details regarding result-extraction can be found: <a href=\"https://stackoverflow.com/a/11826814/9991282\">How to fetch entire row as array of objects with JDBC</a></p>\n"},{"owner":{"user_id":642706,"display_name":"Basil Bourque"},"up_vote_count":0,"is_accepted":false,"creation_date":1682870889,"answer_id":76142249,"body":"<h1><code>record</code></h1>\n<p><a href=\"https://en.m.wikipedia.org/wiki/Java_version_history#Java_16\" rel=\"nofollow noreferrer\">Java 16</a> gained the important new feature of <a href=\"https://openjdk.org/jeps/395\" rel=\"nofollow noreferrer\">records</a>.</p>\n<p>When the main purpose of your class is to communicate data transparently and immutably, define that class as a <code>record</code>.</p>\n<p>A record is brief. At a minimum, you merely declare the name and type of each member field. The compiler implicitly creates the constructor, getters, <code>equals</code> &amp; <code>hashCode</code>, and <code>toString</code>.</p>\n<pre><code>record Person ( long id , String name ) {}\n</code></pre>\n<p>Conveniently, a record can be declared locally, within a method, as an alternative to declaring nested within a class or as a separate class. (Ditto for enums and interfaces now!)</p>\n<p>So as part of your JDBC code, you can define a <code>record</code> with fields to match the raw data of your rows returned by your <code>ResultSet</code>. Quickly loop the rows, passing the fields of the database row to the constructor of the Java <code>record</code>.</p>\n<p>Then close your <code>ResultSet</code>, to free up resources on the database server. Proceed with the work of processing the data of those Java <code>record</code> objects that now cache the data in memory of your <a href=\"https://en.m.wikipedia.org/wiki/Java_virtual_machine\" rel=\"nofollow noreferrer\">JVM</a>.</p>\n<p>In this example code, we use <a href=\"https://docs.oracle.com/javase/tutorial/essential/exceptions/tryResourceClose.html\" rel=\"nofollow noreferrer\">try-with-resources</a> syntax to automatically close the <code>ResultSet</code> object. Then we move on to process the data cached in <code>record</code> objects.</p>\n<pre class=\"lang-java prettyprint-override\"><code>List &lt; Person &gt; persons = new ArrayList&lt;&gt;() ;\ntry (\n    ResultSet resultSet = … ;  // A resource to be automatically closed.\n){\n    while( rs.next() ) \n    {\n        long id = resultSet.getLong( &quot;id_&quot; );\n        String name = resultSet.getString( &quot;name_&quot; );\n        Person person = new Person( id , name ) ;\n        persons.add( person ) ;\n    }\n}  \n// The `ResultSet` is implicitly closed by exiting the try-with-resources.\nthis.processPersons( persons ) ;  \n</code></pre>\n"}],"owner":{"user_id":19138273,"display_name":"mikrovalovna"},"view_count":67,"up_vote_count":2,"accepted_answer_id":76138159,"answer_count":3,"score":2,"creation_date":1682794359,"question_id":76137888,"body":"<p>When using JDBC to retrieve query results I use ResultSet like:\n<code>ResultSet result_set = statement.executeQuery(query);</code>\nIn documentation it says: &quot;A ResultSet object maintains a cursor pointing to its current row of data.&quot; meaning that if I do <code>result_set.close()</code> before I parse the query results I loose them. If I parse data in ResultSet right away I'am maintaining connection to the database during parsing process. I want to minimize time, I want to parse query result without being connected to the DB.</p>\n<p>Is there a way to store query data in such way that I can close connection to the database before I parse the results?</p>\n<p>for example something like this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>Connection connection = DriverManager.getConnection(url, username, password);\nStatement statement = connection.createStatement();\nResultSet result_set = statement.executeQuery(query);\n// store data retrieved from query\nresult_set.close();\nstatement.close();\nconnection.close();\n// do something with stored data\n</code></pre>\n"},{"tags":["java","vaadin"],"answers":[{"owner":{"user_id":2376954,"display_name":"Leif &#197;strand"},"up_vote_count":2,"is_accepted":false,"creation_date":1683017658,"answer_id":76153242,"body":"<p>In the case of playing and pausing, there are corresponding methods on the DOM element (inherited from <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement#instance_methods\" rel=\"nofollow noreferrer\"><code>HTMLMediaElement</code></a>). You can call such methods straight from the server-side <code>Element</code> API using the <code>callJsFunction</code> method, e.g. <code>getElement().callJsFunction(&quot;play&quot;)</code>.</p>\n"}],"owner":{"user_id":3048737,"display_name":"Vincent"},"view_count":31,"up_vote_count":2,"answer_count":1,"score":2,"creation_date":1682698780,"question_id":76131470,"body":"<p>I created a custom class annotated with @tag('video') in my vaadin application.\nNeeded attributes like poster, controls, autoplay, src, width etc. have been defined and all working perfectly.\nNow I need to define play() and pause() methods for the class, so I could use them programmatically.</p>\n<p>Note: the class serves as video like  in html.</p>\n<pre><code>@Tag(&quot;video&quot;)\npublic class Video extends Component implements ClickNotifier{\n\nprotected String getVideoSourceAttributeName() {\nreturn VideoAttributes.Source;\n}\n\npublic void setWidth(String width) {\nthis.getElement().setAttribute(VideoAttributes.Width, width);\n}\n\npublic void setHeight(String height) {\nthis.getElement().setAttribute(VideoAttributes.Height, height);\n}\n\nprivate interface VideoAttributes {\n    String Controls = &quot;controls&quot;;\n    String Source = &quot;src&quot;;\n    String CurrentTime = &quot;currentTime&quot;;\n    String AutoPlay = &quot;autoplay&quot;;\n    String Loop = &quot;loop&quot;;\n    String Preload = &quot;preload&quot;;\n    String Poster = &quot;poster&quot;;\n    String Width = &quot;width&quot;;\n    String Height = &quot;height&quot;;\n}\n\n\npublic interface functions {\n\n}\n\n}\n</code></pre>\n"},{"tags":["java","arrays","multidimensional-array","primitive","deepequals"],"answers":[{"owner":{"user_id":139985,"display_name":"Stephen C"},"up_vote_count":2,"is_accepted":true,"creation_date":1682635939,"answer_id":76125169,"body":"<p>The literal question asked is:</p>\n<blockquote>\n<p>Why does <code>Arrays.deepEquals(Object[] arr1, Object[] arr2)</code> work for primitive multidimensional arrays like <code>int[][]</code>, <code>float[][]</code> etc?</p>\n</blockquote>\n<p>The simple answer to that is &quot;because the javadoc says so&quot;.  See <a href=\"https://stackoverflow.com/a/76125227/139985\">@Old Dog Programmer's answer</a> for details.</p>\n<hr />\n<p>But the <strong>real</strong> question being asked (as I understand it) is:</p>\n<blockquote>\n<p>Why does it work for <code>int[][]</code>, <code>float[][]</code> etc but not for <code>int[]</code>, <code>float[]</code> etc?</p>\n</blockquote>\n<p>This is a consequence of the way that subtyping and multidimensional array types work in Java.  In Java there is really no such thing as a multidimensional array type<sup>1</sup>.  For example, the type <code>int[][]</code> is actually an &quot;array of arrays of <code>int</code>&quot;.   The &quot;array of <code>int</code>&quot; part is a primitive array type.</p>\n<p>According to the Java subtyping rules, all arrays (including 1-D primitive arrays such as <code>int[]</code>) are subtypes of <code>Object</code>.  That means that <code>int[][]</code> (&quot;array of arrays of <code>int</code>&quot;) is a subtype of <code>Object[]</code> (&quot;array of <code>Object</code>&quot;).</p>\n<p>By contrast an <code>int[]</code> is NOT a subtype of <code>Object[]</code> since <code>int</code> is not a subtype of <code>Object</code>.</p>\n<p>That means that <code>Arrays.deepEquals</code> doesn't work for primitive arrays (i.e. the method is not applicable to the arguments) but it does work for <em>arrays of</em> primitive arrays; i.e. multidimensional primitive arrays.  The practical solution is to use the <code>Arrays.equals</code> overloads when comparing 1-D primitive arrays.</p>\n<hr />\n<p><sup>1 - JLS Chapter 1 states: <em>&quot;The language supports arrays of arrays, rather than multidimensional arrays.&quot;</em>\n</sup></p>\n"},{"owner":{"user_id":5103317,"display_name":"Old Dog Programmer"},"up_vote_count":0,"is_accepted":false,"creation_date":1682636929,"answer_id":76125227,"body":"<p>It works because <code>Arrays.deepEquals</code> was written to work for 2D arrays of primitives. The <a href=\"https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Arrays.html#deepEquals(java.lang.Object%5B%5D,java.lang.Object%5B%5D)\" rel=\"nofollow noreferrer\">API</a> specifies it will work. Here is a quote, in which I emphasized the most relevant line:</p>\n<blockquote>\n<p>Two possibly null elements e1 and e2 are deeply equal if any of the following conditions hold:</p>\n</blockquote>\n<blockquote>\n<ul>\n<li>e1 and e2 are both arrays of object reference types, and Arrays.deepEquals(e1, e2) would return true</li>\n<li><strong>e1 and e2 are arrays of the same primitive type, and the appropriate overloading of Arrays.equals(e1, e2) would return true.</strong></li>\n<li>e1 == e2</li>\n<li>e1.equals(e2) would return true.\nNote that this definition permits null elements at any depth.</li>\n</ul>\n</blockquote>\n<p>How was it made to work? We can look at the <a href=\"https://developer.classpath.org/doc/java/util/Arrays-source.html\" rel=\"nofollow noreferrer\">source code</a> for the method. It contains an <code>if ... else</code> chain that checks if the parameters are each an<code>instanceof</code> the same type of primitive array.</p>\n<p>The code for the <code>deepToString</code> method contains a similar <code>if ... else</code> chain.</p>\n"}],"owner":{"user_id":13030693,"display_name":"Anand Pandey"},"view_count":68,"up_vote_count":2,"accepted_answer_id":76125169,"answer_count":2,"score":2,"creation_date":1682634725,"question_id":76125091,"body":"<p>From method signature it is very clear that method accepts the argument of type Object[] but still this method works perfectly fine for primitive multidimensional arrays ?(like int[][],float[][] etc)\n(However it shows error for primitive one dimensional array (like int[],float[] etc))</p>\n<p>Ex:</p>\n<pre><code>      int[][]arr=new int[2][3];\n      arr[0][0]=1;\n      arr[0][1]=2;\n      arr[0][2]=3;\n      arr[1][0]=4;\n      arr[1][1]=5;\n      arr[1][2]=6;\n      int[][]arr1=new int[2][3];\n      arr1[0][0]=1;\n      arr1[0][1]=2;\n      arr1[0][2]=3;\n      arr1[1][0]=4;\n      arr1[1][1]=5;\n      arr1[1][2]=6;\n\n      System.out.println(Arrays.deepEquals(arr,arr1));\n\n      Output: true\n\n\nEx:  \n     int[]arr={1,2,3,4,5};\n     int[]arr1={1,2,3,4,5};\n     System.out.println(Arrays.deepEquals(arr,arr1));//Error\n/*&quot;The method deepEquals(Object[], Object[]) in the type Arrays is not applicable for the arguments (int[], int[])&quot;*/\n\n</code></pre>\n<p>the same issue is with Arrays.deepToString(Object[]) From method signature it is very clear that this method too accepts the argument of type Object[] but still it works perfectly fine for primitive multidimensional arrays ?(like int[][],float[][] etc)(However it shows error for primitive one dimensional array (like int[],float[] etc))</p>\n<pre><code>  Ex:\n      int[][]arr=new int[2][3];\n      arr[0][0]=1;\n      arr[0][1]=2;\n      arr[0][2]=3;\n      arr[1][0]=4;\n      arr[1][1]=5;\n      arr[1][2]=6;\n\n      System.out.println(Arrays.deepToString(arr));\n\n      Output: [[1, 3, 0], [4, 5, 6]]\n\n\n Ex:\n\n     int[]arr={1,2,3,4,5}; \n     System.out.println(Arrays.deepToString(arr)); //Error\n    //&quot;The method deepToString(Object[]) in the type Arrays is not applicable for the arguments (int[])&quot;\n</code></pre>\n<p>Edit:</p>\n<p>I would also like to add few points from my end as well.</p>\n<p>1: Subtyping in Java :</p>\n<pre><code>What is subtyping?\n</code></pre>\n<p>=&gt;Subtyping is a key feature of object-oriented\nprogramming languages such as Java. In Java, Sis a subtype of T if S\nextends or implements T. Subtyping is transitive, meaning that if R is a\nsubtype of S, then R is also a subtype of T (T is the super type of both\nSand R).String is a subtype of Object, because the String class is a\nsubclass of the Object class.</p>\n<pre><code>int is not a subtype of Object, because none of Java's primitive types \nare subtypes of any reference type.\n\nStringBuilder is not a subtype of String, because the StringBuilder \nclass is not a subclass of the String class.\n\n HashMap&lt;Candidate,Double&gt; is a subtype of Map&lt;Candidate,Double&gt;, \n because the HashMap class implements the Map interface and the type \n parameters match.\n\n HashMap&lt;Candidate,Double&gt; is not a subtype of Map&lt;String,Ballot&gt;, even \n though the HashMap class implements the Map interface, because the type \n parameters do not match.\n</code></pre>\n<p>2:  Subtyping among Array Types :</p>\n<pre><code>The following rules define the direct supertype relation among array \ntypes:\n\nIf S and T are both reference types, then S[] &gt;1 T[] iff S &gt;1 T.\n\nObject &gt;1 Object[]\n\nCloneable &gt;1 Object[]\n\njava.io.Serializable &gt;1 Object[]\n\nIf P is a primitive type, then:\n\nObject &gt;1 P[]\n\nCloneable &gt;1 P[]\n\njava.io.Serializable &gt;1 P[]\n</code></pre>\n<p>3: The direct superclass of an array type is Object.</p>\n<p>4: Every array type implements the interfaces Cloneable and\njava.io.Serializable.</p>\n<p>5:In the Java programming language, arrays are objects , are dynamically\ncreated, and may be assigned to variables of type Object. All methods of\nclass Object may be invoked on an array.</p>\n<p>6: An object is a class instance or an array.</p>\n<p>7: The reference values (often just references) are pointers to these\nobjects, and a special null reference, which refers to no object.</p>\n<p>8: A class instance is explicitly created by a class instance\ncreation expression.</p>\n<p>9: An array is explicitly created by an array creation expression .</p>\n"},{"tags":["java","android-room"],"comments":[{"owner":{"user_id":1197251,"display_name":"dominicoder"},"edited":false,"comment_id":134231419,"body":"Primary keys should be non-null - try changing the type from <code>Integer</code> to <code>int</code>."},{"owner":{"user_id":1762224,"display_name":"Mr. Polywhirl"},"edited":false,"comment_id":134231436,"body":"Try <code>public Integer uid = null;</code> (note the <code>= null</code>) portion. See <a href=\"https://stackoverflow.com/a/71073465/1762224\"><i>&quot;How to auto generate primary id, without using &quot;autoGenerate = true&quot;&quot;</i></a>. As @dominicoder states, you can alternatively use the primitive <code>int</code>. The preferred type for a non-null primary ID key is typically <code>long</code>."},{"owner":{"user_id":20632784,"display_name":"kirialium"},"edited":false,"comment_id":134231927,"body":"I changed the data types. I tried int, Integer, long, Long. id is zero anyway. After all, I just need the data to be added to a new row in the table."},{"owner":{"user_id":466862,"display_name":"Mark Rotteveel"},"edited":false,"comment_id":134257230,"body":"@Mr.Polywhirl Explicit use of <code>= null</code> should be unnecessary, because that is already the default value of an Object field like <code>Integer</code>."}],"answers":[{"owner":{"user_id":4744514,"display_name":"MikeT"},"up_vote_count":2,"is_accepted":true,"creation_date":1682541877,"answer_id":76114943,"body":"<p>If using <strong>Integer</strong> then Room expects the uid to be <strong>null</strong> for a value to be generated. If a value, such as 0 is used then that value will be used for the uid.</p>\n<p>As the insertAll method doesn't specify an onConflict strategy, then the default strategy is ABORT. As such the use of 0, more than once will result in a crash due to the UNIQUE constraint conflict (the value as it is a Primary Key must be unique).</p>\n<ul>\n<li><p>an onConflict strategy of <strong>IGNORE</strong> (e.g. <code>@Insert(onConflict = OnConflictStrategy.IGNORE)</code>) will not result in a crash if there is a duplicate, but the row will not be inserted.</p>\n</li>\n<li><p>an onConflict strategy of <strong>REPLACE</strong> (e.g. <code>@Insert(onConflict = OnConflictStrategy.REPLACE)</code>), will replace the already existing row, by deleting the row and inserting another (as opposed to updating the row)</p>\n</li>\n<li><p>it is often useful to know what has been done. The <code>@Insert</code> function can return a long/Long value.</p>\n<ul>\n<li>If a row has been inserted then the value will be the <strong>rowid</strong> (for an integer type primary key, the column is  an alias of the special, normally hidden <strong>rowid</strong> column)</li>\n<li>If a row has not been inserted (i.e. ignored) then the value will be <strong>-1</strong> (note that it is in fact possible to specify -1 as a value, although )</li>\n</ul>\n</li>\n</ul>\n<blockquote>\n<p>As I understood from the documentation, @PrimaryKey(autoGenerate = true) should generate a new identifier for the uid.</p>\n</blockquote>\n<p>This documentation is misleading/false. If you were to use <code>autoGenerate  false</code> or as it is the default just <code>@PrimaryKey</code> then the uid will still be generated when a null uid is specified.</p>\n<p>However, there is a subtle difference in that when autoGenerate is true, the SQLite <strong><code>AUTOINCREMENT</code></strong> keyword is included in the table definition.</p>\n<p>The <strong><code>AUTOINCREMENT</code></strong> (<em><code>autoGenerate = true</code></em>) keyword adds a constraint(rule) that the generated value MUST be greater than any used value (even if the row with the highest value has been deleted). SQLite needs a way to keep a record of the highest ever used value, it does this by using a system table called <strong>sqlite_sequence</strong> which will be created by SQLite if required.</p>\n<p>The <strong>sqlite_sequence</strong> table will have a row per table that has AUTOINCREMENT and that is where the value is stored. There are overheads accessing and maintaining this additional table. In fact the SQLite documentation says <em><a href=\"https://www.sqlite.org/autoinc.html\" rel=\"nofollow noreferrer\">The AUTOINCREMENT keyword imposes extra CPU, memory, disk space, and disk I/O overhead and should be avoided if not strictly needed. It is usually not needed.</a></em></p>\n<p>I would suggest that the most efficient/correct option is to use:-</p>\n<pre><code>@Entity\npublic class User {\n    @PrimaryKey\n    public Long uid;\n\n    @ColumnInfo(name = &quot;first_name&quot;)\n    public String firstName;\n\n    @ColumnInfo(name = &quot;last_name&quot;)\n    public String lastName;\n}\n</code></pre>\n<ul>\n<li>Long as Integer does not have the capacity to hold a 64bit signed value, Long does.</li>\n</ul>\n<p>And to always ensure that the uid is null when inserting a new row.</p>\n<p><strong>Demonstration</strong></p>\n<p>Perhaps consider the following that demonstrates much of what has been stated. Noting that <code>autoGenerate</code> has been left to the default of <code>false</code> <em>(which is suggested as being better for majority of cases)</em></p>\n<p>As such the <strong>User</strong> class as above has been used throughout.</p>\n<p>However, the <strong>UserDao</strong> interface has been expanded to cater for using the 3 discussed/mentioned conflict strategies (ABORT, IGNORE and REPLACE):-</p>\n<pre><code>@Dao\npublic interface UserDao {\n    @Query(&quot;SELECT * FROM user&quot;)\n    List&lt;User&gt; getAll();\n\n    @Query(&quot;SELECT * FROM user WHERE uid IN (:userIds)&quot;)\n    List&lt;User&gt; loadAllByIds(int[] userIds);\n\n    @Query(&quot;SELECT * FROM user WHERE first_name LIKE :first AND &quot; +\n            &quot;last_name LIKE :last LIMIT 1&quot;)\n    User findByName(String first, String last);\n\n    @Insert\n    Long insertAll(User user);\n    @Insert(onConflict = OnConflictStrategy.REPLACE)\n    long insertAllWithReplace(User user);\n    @Insert(onConflict = OnConflictStrategy.IGNORE)\n    long insertAllWithIgnore(User user);\n\n    @Delete\n    void delete(User user);\n}\n</code></pre>\n<p>To facilitate using the above an <code>@Database</code> annotated abstract class <strong>TheDatabase</strong> :-</p>\n<pre><code>@Database(entities = {User.class}, exportSchema = false, version = 1)\nabstract class TheDatabase extends RoomDatabase {\n    abstract UserDao getUserDao();\n\n    private static volatile TheDatabase instance;\n    static TheDatabase getInstance(Context context) {\n        if (instance==null) {\n            instance= Room.databaseBuilder(context,TheDatabase.class,&quot;the_database.db&quot;)\n                    .allowMainThreadQueries()\n                    .build();\n        }\n        return instance;\n    }\n}\n</code></pre>\n<p>Lastly some activity code to demonstrate various inserts with functions to :-</p>\n<ul>\n<li>write the data currently in the database to the log <strong>logAllUsers</strong>, and</li>\n<li>to insert a row, specifying the conflict strategy and capturing any failure and also writing the result (returned rowid value) of the insert to the log.</li>\n</ul>\n<p><strong>MainActivity</strong> :-</p>\n<pre><code>public class MainActivity extends AppCompatActivity {\n\n    TheDatabase db;\n    UserDao dao;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_main);\n\n        /* Prepare to use the database and daos */\n        db = TheDatabase.getInstance(this);\n        dao = db.getUserDao();\n\n        /* Prepare the 1 User that will be used throughout */\n        User newUser = new User();\n        newUser.firstName=&quot;Fred&quot;;\n        newUser.lastName=&quot;Bloggs&quot;;\n\n        /* Stage 1 insert with generated uid and ABORT conflict strategy */\n        dao.insertAll(newUser);\n        logAllUsers(&quot;_STAGE1&quot;);\n\n        /* AS uid is null then the following will add 3 new rows */\n        for (int i = 0; i &lt; 3; i++ ) {\n            dao.insertAll(newUser);\n        }\n        logAllUsers(&quot;_STAGE2&quot;);\n\n        /* SHOULD NOT REALLY BE USED as the uid value will be 0*/\n        newUser.uid=0;\n        dao.insertAll(newUser);\n        logAllUsers(&quot;_STAGE3&quot;);\n\n\n        /* More in-depth debugging of inserts */\n        /* duplicate use of 0 uid with ABORT */\n        logAttemptedInsert(newUser,&quot;_STAGE4&quot;, OnConflictStrategy.ABORT);\n        /* duplicate use of 0 uid with REPLACE */\n        logAttemptedInsert(newUser,&quot;_STAGE5&quot;, OnConflictStrategy.REPLACE);\n        /* duplicate use of 0 uid with IGNORE */\n        logAttemptedInsert(newUser,&quot;_STAGE6&quot;, OnConflictStrategy.IGNORE);\n        /* Negative uid  ~~~ BEST TO NOT USE ~~~ */\n        newUser.uid = -100;\n        logAttemptedInsert(newUser,&quot;_STAGE_7&quot;,OnConflictStrategy.IGNORE);\n    }\n\n    void logAllUsers(String tagSuffix) {\n        for(User u: dao.getAll()) {\n            Log.d(&quot;DBINFO&quot; + tagSuffix,&quot;User ID is &quot; + u.uid + &quot; FirstName is &quot; + u.firstName + &quot; LastName is &quot; + u.lastName);\n        }\n    }\n\n    void logAttemptedInsert(User user, String tagSuffix, Integer onConflictStrategy) {\n        long insertedRowid= -888;\n        try {\n            switch(onConflictStrategy) {\n                case OnConflictStrategy.IGNORE:\n                    insertedRowid = dao.insertAllWithIgnore(user);\n                    break;\n                case OnConflictStrategy.REPLACE:\n                    insertedRowid = dao.insertAllWithReplace(user);\n                    break;\n                default:\n                    insertedRowid = dao.insertAll(user);\n                    break;\n            }\n        } catch (SQLiteException e) {\n            Log.d(&quot;DBINFO_&quot; + tagSuffix,&quot;SQLITE EXCEPTION TRAPPED. Exception Message=\\n\\t&quot; + e.getMessage());\n            insertedRowid = -999;\n        } finally {\n            Log.d(&quot;DBINFO&quot; + tagSuffix,&quot;INSERT RESULT for USER WITH ID as &quot; + user.uid + &quot; FIRSTNAME as &quot; + user.firstName + &quot; and LASTNAME as &quot; + user.lastName + &quot; WAS &quot; + insertedRowid);\n            logAllUsers(tagSuffix);\n        }\n    }\n}\n</code></pre>\n<ul>\n<li>Note that the above is designed to just be run the once.</li>\n</ul>\n<p><strong>Results of running the Demo</strong></p>\n<p>When run the output to the log includes:-</p>\n<pre><code>2023-04-27 11:02:00.108 D/DBINFO_STAGE1: User ID is 1 FirstName is Fred LastName is Bloggs\n\n\n2023-04-27 11:02:00.133 D/DBINFO_STAGE2: User ID is 1 FirstName is Fred LastName is Bloggs\n2023-04-27 11:02:00.134 D/DBINFO_STAGE2: User ID is 2 FirstName is Fred LastName is Bloggs\n2023-04-27 11:02:00.134 D/DBINFO_STAGE2: User ID is 3 FirstName is Fred LastName is Bloggs\n2023-04-27 11:02:00.134 D/DBINFO_STAGE2: User ID is 4 FirstName is Fred LastName is Bloggs\n\n\n2023-04-27 11:02:00.141 D/DBINFO_STAGE3: User ID is 0 FirstName is Fred LastName is Bloggs\n2023-04-27 11:02:00.141 D/DBINFO_STAGE3: User ID is 1 FirstName is Fred LastName is Bloggs\n2023-04-27 11:02:00.141 D/DBINFO_STAGE3: User ID is 2 FirstName is Fred LastName is Bloggs\n2023-04-27 11:02:00.141 D/DBINFO_STAGE3: User ID is 3 FirstName is Fred LastName is Bloggs\n2023-04-27 11:02:00.141 D/DBINFO_STAGE3: User ID is 4 FirstName is Fred LastName is Bloggs\n\n\n2023-04-27 11:02:00.144 D/DBINFO__STAGE4: SQLITE EXCEPTION TRAPPED. Exception Message=\n        UNIQUE constraint failed: User.uid (code 1555 SQLITE_CONSTRAINT_PRIMARYKEY)\n2023-04-27 11:02:00.144 D/DBINFO_STAGE4: INSERT RESULT for USER WITH ID as 0 FIRSTNAME as Fred and LASTNAME as Bloggs WAS -999\n2023-04-27 11:02:00.145 D/DBINFO_STAGE4: User ID is 0 FirstName is Fred LastName is Bloggs\n2023-04-27 11:02:00.145 D/DBINFO_STAGE4: User ID is 1 FirstName is Fred LastName is Bloggs\n2023-04-27 11:02:00.145 D/DBINFO_STAGE4: User ID is 2 FirstName is Fred LastName is Bloggs\n2023-04-27 11:02:00.145 D/DBINFO_STAGE4: User ID is 3 FirstName is Fred LastName is Bloggs\n2023-04-27 11:02:00.146 D/DBINFO_STAGE4: User ID is 4 FirstName is Fred LastName is Bloggs\n\n\n2023-04-27 11:02:00.148 D/DBINFO_STAGE5: INSERT RESULT for USER WITH ID as 0 FIRSTNAME as Fred and LASTNAME as Bloggs WAS 0\n2023-04-27 11:02:00.150 D/DBINFO_STAGE5: User ID is 0 FirstName is Fred LastName is Bloggs\n2023-04-27 11:02:00.150 D/DBINFO_STAGE5: User ID is 1 FirstName is Fred LastName is Bloggs\n2023-04-27 11:02:00.151 D/DBINFO_STAGE5: User ID is 2 FirstName is Fred LastName is Bloggs\n2023-04-27 11:02:00.151 D/DBINFO_STAGE5: User ID is 3 FirstName is Fred LastName is Bloggs\n2023-04-27 11:02:00.151 D/DBINFO_STAGE5: User ID is 4 FirstName is Fred LastName is Bloggs\n\n\n2023-04-27 11:02:00.153 D/DBINFO_STAGE6: INSERT RESULT for USER WITH ID as 0 FIRSTNAME as Fred and LASTNAME as Bloggs WAS -1\n2023-04-27 11:02:00.155 D/DBINFO_STAGE6: User ID is 0 FirstName is Fred LastName is Bloggs\n2023-04-27 11:02:00.155 D/DBINFO_STAGE6: User ID is 1 FirstName is Fred LastName is Bloggs\n2023-04-27 11:02:00.156 D/DBINFO_STAGE6: User ID is 2 FirstName is Fred LastName is Bloggs\n2023-04-27 11:02:00.156 D/DBINFO_STAGE6: User ID is 3 FirstName is Fred LastName is Bloggs\n2023-04-27 11:02:00.156 D/DBINFO_STAGE6: User ID is 4 FirstName is Fred LastName is Bloggs\n\n\n2023-04-27 11:02:00.157 D/DBINFO_STAGE_7: INSERT RESULT for USER WITH ID as -100 FIRSTNAME as Fred and LASTNAME as Bloggs WAS -100\n2023-04-27 11:02:00.160 D/DBINFO_STAGE_7: User ID is -100 FirstName is Fred LastName is Bloggs\n2023-04-27 11:02:00.161 D/DBINFO_STAGE_7: User ID is 0 FirstName is Fred LastName is Bloggs\n2023-04-27 11:02:00.161 D/DBINFO_STAGE_7: User ID is 1 FirstName is Fred LastName is Bloggs\n2023-04-27 11:02:00.161 D/DBINFO_STAGE_7: User ID is 2 FirstName is Fred LastName is Bloggs\n2023-04-27 11:02:00.161 D/DBINFO_STAGE_7: User ID is 3 FirstName is Fred LastName is Bloggs\n2023-04-27 11:02:00.161 D/DBINFO_STAGE_7: User ID is 4 FirstName is Fred LastName is Bloggs\n</code></pre>\n<ul>\n<li>Stage 1 has inserted the single row and the uid has been generated with a value of 1 as explained/expected.</li>\n<li>Stage 2 has inserted the additional 3 rows with generated uid values (2-4 inclusive), as explained/expected.</li>\n<li>Stage 3 has inserted another row with a specific uid value of 0, as explained/expected.</li>\n<li>Stage 4 has NOT inserted another row with 0 as the specified uid value, the default onConflict strategy of ABORT resulted in an exception which was trapped and reported on. The 4 existing rows (0-4 inclusive) are the only rows that exist, as per the code -999 was returned to indicate the trapped exception.</li>\n<li>Stage 5 has REPLACED row 0 returning 0 as the inserted rowid (note not -1 indicating nothing inserted). As such again all 5 rows exist.</li>\n<li>Stage 6 has IGNORED the insert as a row with a uid of 0 already exists. Unlike Stage 4 there was no underlying exception so -1 has been returned, typically indicating nothing inserted. Still just the 5 rows exist.</li>\n<li>Stage 6 has inserted a row with a negative value of -100 and is the value returned from the insert (if -1 were used then you would not know if the row were inserted or not according to the returned -1). 6 rows now exist.\n<strong>App Inspection</strong></li>\n</ul>\n<p>Using <strong>App Inspection</strong> then the end result appears to confirm the end result of 6 rows as per:-</p>\n<p><a href=\"https://i.stack.imgur.com/lig80.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lig80.png\" alt=\"enter image description here\" /></a></p>\n<p>using a New Query from App Inspection the absence of <strong>sqlite_master</strong> can be seen as per:-</p>\n<p><a href=\"https://i.stack.imgur.com/SAXUd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SAXUd.png\" alt=\"enter image description here\" /></a></p>\n<ul>\n<li><p>if <code>autoGenerate true</code> were used then the resource costly sqlite_squence table could be seen as per:-</p>\n</li>\n<li><p><a href=\"https://i.stack.imgur.com/loCqS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/loCqS.png\" alt=\"enter image description here\" /></a></p>\n</li>\n<li><p>slqite_sequence itself would contain:-</p>\n</li>\n<li><p><a href=\"https://i.stack.imgur.com/xv7wJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xv7wJ.png\" alt=\"enter image description here\" /></a></p>\n<ul>\n<li>i.e the highest ever used value of uid (4).</li>\n</ul>\n</li>\n</ul>\n<p>To show this hidden aliased <strong>rowid</strong> then:-\n<a href=\"https://i.stack.imgur.com/dMOgB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dMOgB.png\" alt=\"enter image description here\" /></a></p>\n<p><strong>Notes</strong></p>\n<ul>\n<li>With Room only tables with <strong>rowid</strong> are supported via annotations. However, SQLite does support <em><strong>WITHOUT ROWID tables</strong></em>, in which case <code>AUTOINCREMENT</code> cannot be used.</li>\n<li><code>AUTOINCREMENT</code> aka <code>autoGenerate=true</code>, due to the rule that a generated row MUST be greater than any existing row, will result in an SQLITE_FULL exception if the highest value allowable for the generated value (9223372036854775807), whilst without <code>AUTOINCREMENT</code> the algorithm will attempt to use an unused value (if a negative rowid has been used then this can be a negative value) thus it is unlikely that an SQLITE_FULL exception will result.\n<ul>\n<li><p>With current storage devices that number of rows is impossible. However, if 9223372036854775807 were specified as a value, even if there are only a few rows, then the exception, due to the rule, would eventuate if <code>AUTOINCREMENT</code> were used.</p>\n<ul>\n<li>e.g. :- <a href=\"https://i.stack.imgur.com/qOBst.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qOBst.png\" alt=\"enter image description here\" /></a></li>\n<li>and then:- <a href=\"https://i.stack.imgur.com/S6QEv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/S6QEv.png\" alt=\"![enter image description here\" /></a></li>\n<li>with the Event Log showing <em>11:48 am    Database Inspector: An error occurred while running the statement: database or disk is full (code 13 SQLITE_FULL)</em>, even though there are only 7 rows</li>\n<li>Without <code>AUTOINCREMENT</code> then using the same 2 queries results in:-</li>\n<li><a href=\"https://i.stack.imgur.com/cQlWf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cQlWf.png\" alt=\"enter image description here\" /></a></li>\n<li>As can be seen an 8th row with New as the first_name and ASIF as the last name has been inserted with an available unused generated value rather than crashing.</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n"}],"owner":{"user_id":20632784,"display_name":"kirialium"},"view_count":50,"up_vote_count":3,"accepted_answer_id":76114943,"answer_count":1,"score":2,"creation_date":1682525377,"question_id":76112918,"body":"<p>User Code:</p>\n<pre><code>@Entity\npublic class User {\n    @PrimaryKey(autoGenerate = true)\n    public Integer uid;\n\n    @ColumnInfo(name = &quot;first_name&quot;)\n    public String firstName;\n\n    @ColumnInfo(name = &quot;last_name&quot;)\n    public String lastName;\n}\n</code></pre>\n<p>Dao:</p>\n<pre><code>@Dao\npublic interface UserDao {\n    @Query(&quot;SELECT * FROM user&quot;)\n    List&lt;User&gt; getAll();\n\n    @Query(&quot;SELECT * FROM user WHERE uid IN (:userIds)&quot;)\n    List&lt;User&gt; loadAllByIds(int[] userIds);\n\n    @Query(&quot;SELECT * FROM user WHERE first_name LIKE :first AND &quot; +\n        &quot;last_name LIKE :last LIMIT 1&quot;)\n    User findByName(String first, String last);\n\n    @Insert\n    void insertAll(User user);\n\n    @Delete\n    void delete(User user);\n}\n</code></pre>\n<p>Activity:</p>\n<pre><code>    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_main);\n\n        DataBase db = Room.databaseBuilder(getApplicationContext(), DataBase.class, &quot;DB&quot;)\n                .allowMainThreadQueries().build();\n\n        User user = new User();\n        user.firstName = &quot;Ste&quot;;\n        user.lastName = &quot;Kor&quot;;\n\n        UserDao userDao = db.userDao();\n        userDao.insertAll(user);\n    }\n}\n</code></pre>\n<p>As I understood from the documentation, @PrimaryKey(autoGenerate = true) should generate a new identifier for the uid. But when I add a new object, it is assigned the ID 0 and the application crashes.</p>\n<p>If you set the value manually, then everything works, but I need it to be set by itself</p>\n"},{"tags":["java","wildfly","log4j2","jboss-logging"],"comments":[{"owner":{"user_id":721855,"display_name":"aled"},"edited":false,"comment_id":134226464,"body":"Does this answer your question? <a href=\"https://stackoverflow.com/questions/59469499/log-message-as-json-format-in-wildfly-logs\">Log message as json format in wildfly logs</a>"},{"owner":{"user_id":21742499,"display_name":"Ferdi"},"edited":false,"comment_id":134227948,"body":"Thank you, but no it doesn&#39;t answer my question. In your referenced link the problem is about &quot;how to log in json format with wildfly&quot;. My current setup (see last sub-title of my question) already does that much, but when it appends also my java-application-json-logs, it escapes my java-application-json-log turning those logs into non-json."},{"owner":{"user_id":152794,"display_name":"James R. Perkins"},"edited":false,"comment_id":134228653,"body":"Do you need to use a log4j configuration file?"},{"owner":{"user_id":21742499,"display_name":"Ferdi"},"edited":false,"comment_id":134228933,"body":"Hi James, yes on java application side I have to use log4j2, I cannot swap it with another logging lib."}],"answers":[{"owner":{"user_id":152794,"display_name":"James R. Perkins"},"up_vote_count":2,"is_accepted":true,"creation_date":1682518171,"answer_id":76111775,"body":"<p>You're using both the logging configuration in WildFly and including a logging configuration in your deployment with a handler which is writing to <code>System.out</code>. WildFly wraps <code>System.out</code> and <code>System.err</code> in a logger. When another log manager writes to one of the standard streams, then it's processed through the log manager.</p>\n<p>With JSON logging you've got three options.</p>\n<ol>\n<li>You can accept the JSON output that WildFly outputs and remove your logging configuration from your deployment. Note that this will be the most consistent output and include logs from WildFly.</li>\n<li>You can set the <a href=\"https://logging.apache.org/log4j/2.x/manual/appenders.html#ConsoleAppender\" rel=\"nofollow noreferrer\"><code>direct</code></a> configuration parameter to <code>true</code>. Do note the remarks there of how messages could still be interwined.</li>\n<li>Write your JSON output to a file instead of the console.</li>\n</ol>\n<p>Do note with the second option you may end up with two different JSON formats.</p>\n"}],"owner":{"user_id":21742499,"display_name":"Ferdi"},"view_count":47,"up_vote_count":2,"accepted_answer_id":76111775,"answer_count":1,"score":2,"creation_date":1682502929,"question_id":76109417,"body":"<h2>Context is:</h2>\n<p>I have switched from logging to file as text towards logging to stdout as json, to send the log messages as parsable json-logs to the elastic stack with kibana.</p>\n<p>The wildfly server (version 22.0.1.Final or 26.1.3.Final) uses the jboss logger which I also switched from Textbased logging to structured parsable json logs writing them also to stdout.</p>\n<p>The jboss logger takes the logs from our java application (with log4j2) and wraps them into it's own log message enriching it with more context.</p>\n<h2>Problem is:</h2>\n<p>the application json-logs are getting escaped by the jboss logger before appending it, therefore breaking the json format and making it unparsable for the rest of our workflow.</p>\n<p>This is the result with the setting jboss-logger in json format &amp; log4j2 in json format - see the key 'message' where quotation marks are escaped like <code>\\&quot;log.level\\&quot;: \\&quot;INFO\\&quot;</code> instead of <code>&quot;log.level&quot;: &quot;INFO&quot;</code></p>\n<pre><code>{\n    &quot;timestamp&quot;: &quot;2023-04-26T09:01:50.489+02:00&quot;,\n    &quot;sequence&quot;: 295,\n    &quot;loggerClassName&quot;: &quot;org.jboss.logmanager.Logger&quot;,\n    &quot;loggerName&quot;: &quot;stdout&quot;,\n    &quot;level&quot;: &quot;INFO&quot;,\n    &quot;message&quot;: &quot;{\\&quot;@timestamp\\&quot;:\\&quot;2023-04-25T12:01:50.488Z\\&quot;,\\&quot;log.level\\&quot;: \\&quot;INFO\\&quot;,\\&quot;message\\&quot;:\\&quot;creating a new account for userid 146\\&quot;, \\&quot;ecs.version\\&quot;: \\&quot;1.2.0\\&quot;,\\&quot;service.name\\&quot;:\\&quot;my_project_x\\&quot;,\\&quot;service.version\\&quot;:\\&quot;5.67\\&quot;,\\&quot;event.dataset\\&quot;:\\&quot;my_project_x.log\\&quot;,\\&quot;process.thread.name\\&quot;:\\&quot;default task-2\\&quot;,\\&quot;log.logger\\&quot;:\\&quot;org.my_project_x.logic.AccountImpl\\&quot;,\\&quot;hostname\\&quot;:\\&quot;Lenovo\\&quot;,\\&quot;environment\\&quot;:\\&quot;develop\\&quot;,\\&quot;user.id\\&quot;:\\&quot;146\\&quot;,\\&quot;log\\&quot;:{\\&quot;origin\\&quot;:{\\&quot;file\\&quot;:{\\&quot;name\\&quot;:\\&quot;AccountImpl.java\\&quot;,\\&quot;line\\&quot;:720},\\&quot;function\\&quot;:\\&quot;addAccount\\&quot;}}}&quot;,\n    &quot;threadName&quot;: &quot;default task-2&quot;,\n    &quot;threadId&quot;: 183,\n    &quot;mdc&quot;: {},\n    &quot;ndc&quot;: &quot;&quot;,\n    &quot;hostName&quot;: &quot;lenovo-p14s&quot;,\n    &quot;processName&quot;: &quot;jboss-modules.jar&quot;,\n    &quot;processId&quot;: 64672\n}\n</code></pre>\n<p>then I tried turning the jboss logger back to Text format while leaving the application logs as json in log4j2.\nLike this the application logs stay correctly in the json format:</p>\n<pre><code>2023-04-26 10:49:59,407 INFO  [stdout] (default task-6) {&quot;@timestamp&quot;:&quot;2023-04-26T10:49:59,407Z&quot;,&quot;log.level&quot;: &quot;INFO&quot;,&quot;message&quot;:&quot;creating a new account for userid 166.&quot;, &quot;ecs.version&quot;: &quot;1.2.0&quot;,&quot;service.name&quot;:&quot;my_project_x&quot;,&quot;service.version&quot;:&quot;5.67&quot;,&quot;event.dataset&quot;:&quot;my_project_x.log&quot;,&quot;process.thread.name&quot;:&quot;default task-6&quot;,&quot;log.logger&quot;:&quot;org.my_project_x.logic.AccountImpl&quot;,&quot;hostname&quot;:&quot;Lenovo&quot;,&quot;environment&quot;:&quot;develop&quot;,&quot;user.id&quot;:&quot;166&quot;,&quot;log&quot;:{&quot;origin&quot;:{&quot;file&quot;:{&quot;name&quot;:&quot;AccountImpl.java&quot;,&quot;line&quot;:720},&quot;function&quot;:&quot;addAccount&quot;}}}\n</code></pre>\n<p>but I would like to have the jboss logs also in the json format, while leaving my application logs in valid json format.</p>\n<h1>Question is:</h1>\n<p>I could not find any way to disable the escaping of the application logs when turning on the json format for the jboss logger. Is there any way to have our application logs in correct json format, while also having the jboss logs in json, resulting in a valid json (application log4j2) in json (jboss log).</p>\n<p>Any help will be appreciated.</p>\n<p>Regards,</p>\n<h3>ps: my setup if needed</h3>\n<p>for wildfly / jboss logger</p>\n<pre><code>&lt;subsystem xmlns=&quot;urn:jboss:domain:logging:8.0&quot;&gt;\n    &lt;console-handler name=&quot;CONSOLE&quot;&gt;\n        &lt;level name=&quot;INFO&quot;/&gt;\n        &lt;formatter&gt;\n            &lt;named-formatter name=&quot;JSON&quot;/&gt;\n        &lt;/formatter&gt;\n    &lt;/console-handler&gt;\n    &lt;periodic-rotating-file-handler name=&quot;FILE&quot; autoflush=&quot;true&quot;&gt;\n        &lt;formatter&gt;\n            &lt;named-formatter name=&quot;PATTERN&quot;/&gt;\n        &lt;/formatter&gt;\n        &lt;file relative-to=&quot;jboss.server.log.dir&quot; path=&quot;server.log&quot;/&gt;\n        &lt;suffix value=&quot;.yyyy-MM-dd&quot;/&gt;\n        &lt;append value=&quot;true&quot;/&gt;\n    &lt;/periodic-rotating-file-handler&gt;\n    &lt;logger category=&quot;com.arjuna&quot;&gt;\n        &lt;level name=&quot;WARN&quot;/&gt;\n    &lt;/logger&gt;\n    &lt;logger category=&quot;io.jaegertracing.Configuration&quot;&gt;\n        &lt;level name=&quot;WARN&quot;/&gt;\n    &lt;/logger&gt;\n    &lt;logger category=&quot;org.jboss.as.config&quot;&gt;\n        &lt;level name=&quot;DEBUG&quot;/&gt;\n    &lt;/logger&gt;\n    &lt;logger category=&quot;sun.rmi&quot;&gt;\n        &lt;level name=&quot;WARN&quot;/&gt;\n    &lt;/logger&gt;\n    &lt;root-logger&gt;\n        &lt;level name=&quot;INFO&quot;/&gt;\n        &lt;handlers&gt;\n            &lt;handler name=&quot;CONSOLE&quot;/&gt;\n            &lt;handler name=&quot;FILE&quot;/&gt;\n        &lt;/handlers&gt;\n    &lt;/root-logger&gt;\n    &lt;formatter name=&quot;PATTERN&quot;&gt;\n        &lt;pattern-formatter pattern=&quot;%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p [%c] (%t) %s%e%n&quot;/&gt;\n    &lt;/formatter&gt;\n    &lt;formatter name=&quot;COLOR-PATTERN&quot;&gt;\n        &lt;pattern-formatter pattern=&quot;%K{level}%d{HH:mm:ss,SSS} %-5p [%c] (%t) %s%e%n&quot;/&gt;\n    &lt;/formatter&gt;\n    &lt;formatter name=&quot;JSON&quot;&gt;\n        &lt;json-formatter/&gt;\n    &lt;/formatter&gt;\n&lt;/subsystem&gt;\n</code></pre>\n<p>for log4j2 (version 2.19.0) in the java application:</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;Configuration packages=&quot;org.my_project_x.logging&quot; status=&quot;WARN&quot; strict=&quot;true&quot; verbose=&quot;true&quot;&gt;\n    &lt;Appenders&gt;\n        &lt;Console name=&quot;myConsoleLog&quot;&gt;\n            &lt;IgnoreExceptions&gt;false&lt;/IgnoreExceptions&gt;\n            &lt;EcsLayout serviceName=&quot;my_project_x&quot; serviceVersion=&quot;${serverVersion}&quot; includeOrigin=&quot;true&quot; eventDataset=&quot;my_project_x.log&quot;&gt;\n                &lt;KeyValuePair key=&quot;hostname&quot; value=&quot;%hostname&quot;/&gt;\n                &lt;KeyValuePair key=&quot;environment&quot; value=&quot;develop&quot;/&gt;\n                &lt;KeyValuePair key=&quot;user.id&quot; value=&quot;%userId&quot;/&gt;\n            &lt;/EcsLayout&gt;\n        &lt;/Console&gt;\n    &lt;/Appenders&gt;\n\n    &lt;Loggers&gt;\n        &lt;Logger name=&quot;org.my_project_x&quot;&gt;\n            &lt;Level&gt;INFO&lt;/Level&gt;\n        &lt;/Logger&gt;\n        \n        &lt;Root&gt;\n            &lt;AppenderRef ref=&quot;myConsoleLog&quot;/&gt;\n            &lt;Level&gt;WARN&lt;/Level&gt;\n        &lt;/Root&gt;\n    &lt;/Loggers&gt;\n&lt;/Configuration&gt;\n</code></pre>\n"},{"tags":["java","kotlin","android-jetpack-compose","android-livedata","lazycolumn"],"comments":[{"owner":{"user_id":916225,"display_name":"seenukarthi"},"edited":false,"comment_id":134221373,"body":"Please post the relevant code as part of the post. Posting link to the app&#39;s GitHub page is not enough since we wont know which part of the code has the issue."}],"answers":[{"owner":{"user_id":17293779,"display_name":"MohammadBaqer"},"up_vote_count":2,"is_accepted":true,"creation_date":1682504566,"answer_id":76109669,"body":"<p>Jetpack Compose does a lot in Debug mode.\nyou can just simply test your code on Release mode to see power of Jetpack Compose</p>\n"}],"owner":{"user_id":21740932,"display_name":"&#194;n Trọng"},"view_count":62,"up_vote_count":2,"accepted_answer_id":76109669,"answer_count":1,"score":2,"creation_date":1682480016,"question_id":76106992,"body":"<p>I just learned jetpack compose and I switched from recycle to lazy column but when I do it it lags much more than recycle</p>\n<p>after adding about 100 items to the application the app is lagging, is there any way to reduce the lag for the lazy column?\nI have set the id for the item and used R8 to build\nthis is code:<a href=\"https://github.com/trongan123/TODOAPP\" rel=\"nofollow noreferrer\">https://github.com/trongan123/TODOAPP</a></p>\n<pre><code> val tabs: MutableList&lt;TabItem&gt; = ArrayList&lt;TabItem&gt;().toMutableList()\ntabs += TabItem(&quot;All&quot;) {\n    AllItemScreen(\n        listAll, openUpdateItemScreen = {\n            openUpdateItemScreen()\n        }, viewModel = viewModel\n    )\n}\ntabs += TabItem(&quot;Pending&quot;) {\n    PendingItemScreen(listAll.filter { it.status.equals(&quot;pending&quot;) }, openUpdateItemScreen = {\n        openUpdateItemScreen()\n    }, viewModel = viewModel)\n}\ntabs += TabItem(&quot;Completed&quot;) {\n    CompletedItemScreen(\n        listAll.filter { it.status.equals(&quot;completed&quot;) },\n        openUpdateItemScreen = {\n            openUpdateItemScreen()\n        }, viewModel = viewModel\n    )\n}\nval pagerState = rememberPagerState()\nScaffold(\n    floatingActionButton = {\n        FloatingActionButton(\n            onClick = { openAddItemScreen() }\n        ) {\n            Icon(Icons.Filled.Add, &quot;&quot;)\n        }\n    }\n) { padding -&gt;\n    val textState = remember { mutableStateOf(TextFieldValue(&quot;&quot;)) }\n    Column(\n        modifier = Modifier\n            .padding(padding)\n    ) {\n        SearchView(state = textState, viewModel)\n        Spacer(modifier = Modifier.size(16.dp))\n        Tabs(\n            tabs = tabs, pagerState = pagerState,\n            viewModel = viewModel\n        )\n        TabsContent(tabs = tabs, pagerState = pagerState)\n    }\n}\n</code></pre>\n<p>AllItemScreen</p>\n<pre><code> Column(\n    modifier = Modifier\n        .fillMaxSize()\n\n) {\n    LazyColumn() {\n\n        items(listAll) { i -&gt;\n            ItemList(\n                i,\n                openUpdateItemScreen = {\n                    openUpdateItemScreen()\n                }, viewModel\n            )\n        }\n    }\n}\n</code></pre>\n<p>ItemList</p>\n<pre><code> val isChecked = remember { mutableStateOf(false) }\nCard(\n    modifier = Modifier\n        .fillMaxWidth()\n        .padding(5.dp)\n        .clickable {\n            if (isChecked.value == true) {\n                isChecked.value = false\n                viewModel.setClearAll(i.id, false)\n                viewModel.setCheckData(i.id, false)\n            } else {\n                isChecked.value = true\n                viewModel.setClearAll(i.id, true)\n                viewModel.setCheckData(i.id, true)\n            }\n        },\n    elevation = 5.dp\n) {\n    Column(\n        modifier = Modifier.fillMaxSize(),\n        verticalArrangement = Arrangement.Center\n    ) {\n        Spacer(modifier = Modifier.size(16.dp))\n        Row {\n            val check: List&lt;Int&gt;? = viewModel.getListMutableCheck().value as List&lt;Int&gt;\n            if (check != null) {\n                isChecked.value = check.contains(i.id)\n            }\n            Checkbox(\n                checked = isChecked.value,\n                onCheckedChange = {\n                    isChecked.value = it\n                    viewModel.setClearAll(i.id, it)\n                    viewModel.setCheckData(i.id, it)\n                }\n            )\n            Spacer(modifier = Modifier.size(16.dp))\n            if (!isChecked.value) {\n                Text(\n                    i.title, modifier = Modifier\n                        .padding(top = 10.dp)\n                )\n            } else Text(\n                i.title,\n                modifier = Modifier\n                    .padding(top = 10.dp),\n                style = TextStyle(textDecoration = TextDecoration.LineThrough)\n            )\n            Spacer(\n                Modifier\n                    .weight(1f)\n                    .fillMaxHeight()\n            )\n            Image(painter = painterResource(id = R.drawable.ellipsis),\n                contentDescription = null,\n\n                modifier = Modifier\n                    .clickable {\n                        todoItem = i\n                        openUpdateItemScreen()\n                    }\n                    .size(30.dp))\n            Spacer(modifier = Modifier.size(10.dp))\n        }\n\n    }\n}\n</code></pre>\n"},{"tags":["java","spring","spring-boot","h2"],"answers":[{"owner":{"user_id":14235751,"display_name":"Vladislav Syropyatov"},"up_vote_count":2,"is_accepted":true,"creation_date":1682255769,"answer_id":76085061,"body":"<p>I have reproduced your problem and solved it just adding <code>spring-boot-starter-data-jpa</code> dependency and an entity. I think you are getting &quot;Database “mem:testdb” not found&quot; because there aren't any entities to create.</p>\n"}],"owner":{"user_id":10863855,"display_name":"sergio rodriguez"},"view_count":95,"up_vote_count":3,"accepted_answer_id":76085061,"answer_count":1,"score":2,"creation_date":1682254399,"question_id":76084954,"body":"<p>When I try to connect to H2 console, I get this error:</p>\n<blockquote>\n<p>Database <code>“mem:testdb” not found</code>, either pre-create it or allow\nremote database creation.</p>\n</blockquote>\n<p>I have read in other similar questions to copy the JDBC URL that appears in the console, but I don't have that message in the console:</p>\n<p><a href=\"https://i.stack.imgur.com/HUonr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HUonr.png\" alt=\"enter image description here\" /></a></p>\n<p>This is the <code>aplication.properties</code>:</p>\n<p><a href=\"https://i.stack.imgur.com/I6dC7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/I6dC7.png\" alt=\"enter image description here\" /></a></p>\n<p>I have also tried to add the line without result</p>\n<pre><code>spring.datasource.generate-unique-name=false\n</code></pre>\n<p>I have checked the <code>POM</code> and the dependencies are well added also the devtools. I have used the Spring initializr:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n    xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;2.7.11&lt;/version&gt;\n        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;\n    &lt;/parent&gt;\n    &lt;groupId&gt;com.qindel&lt;/groupId&gt;\n    &lt;artifactId&gt;test&lt;/artifactId&gt;\n    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n    &lt;name&gt;test&lt;/name&gt;\n    &lt;description&gt;Prueba técnica Plataforma&lt;/description&gt;\n    &lt;properties&gt;\n        &lt;java.version&gt;11&lt;/java.version&gt;\n    &lt;/properties&gt;\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;\n            &lt;optional&gt;true&lt;/optional&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.h2database&lt;/groupId&gt;\n            &lt;artifactId&gt;h2&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;\n            &lt;artifactId&gt;lombok&lt;/artifactId&gt;\n            &lt;optional&gt;true&lt;/optional&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n                &lt;configuration&gt;\n                    &lt;excludes&gt;\n                        &lt;exclude&gt;\n                            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;\n                            &lt;artifactId&gt;lombok&lt;/artifactId&gt;\n                        &lt;/exclude&gt;\n                    &lt;/excludes&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n\n&lt;/project&gt;\n</code></pre>\n<p>Any idea?</p>\n"},{"tags":["java","comments","javadoc","multiline"],"comments":[{"owner":{"user_id":4125191,"display_name":"RealSkeptic"},"edited":false,"comment_id":134181871,"body":"Write your inner comments using one-line <code>&#47;&#47; this is a comment</code> syntax."},{"owner":{"user_id":16320675,"display_name":"user16320675"},"edited":false,"comment_id":134182139,"body":"maybe the answers to <a href=\"https://stackoverflow.com/q/541920/16320675\">Multiple line code example in Javadoc comment</a> can help (different problem, but some ideas) || also check <a href=\"https://openjdk.org/jeps/413\" rel=\"nofollow noreferrer\">JEP 413</a>, introducing <code>@snippet</code> (Java 18)"},{"owner":{"user_id":4288506,"display_name":"Marcono1234"},"edited":false,"comment_id":134430679,"body":"Looks like this will become a bit easier with JDK 21, see <a href=\"https://bugs.openjdk.org/browse/JDK-8301294\" rel=\"nofollow noreferrer\">JDK-8301294</a>. The specification there explicitly mentions <code>*@&#47;</code> as solution for writing <code>*&#47;</code>, but it also mentions that this will not work for any tags which treat their content literally, such as <code>{@code ...}</code>."}],"answers":[{"owner":{"user_id":1831987,"display_name":"VGR"},"up_vote_count":2,"is_accepted":true,"creation_date":1682253389,"answer_id":76084877,"body":"<p>I personally would remove <code>{@code</code> and would just use HTML entities where necessary:</p>\n<pre><code>/**\n * Sample is a utility for doing interesting stuff.\n * For example, you might use it this way:\n * \n * &lt;pre&gt;\n * /**\n *  * We write an Example class\n *  *&amp;#x2f;\n * class Example {\n *     /**\n *      * This function does something.\n *      *&amp;#x2f;\n *     void foo() {\n *         // ...\n *     }\n * \n *     /**\n *      * This one does something else\n *      *&amp;#x2f;\n *     void bar() {\n *         // ...\n *     }\n * \n *     /**\n *      * now I'm gonna demonstrate something by calling foo() and bar() in this main method\n *      *&amp;#x2f;\n *     public static void main(String[] args) {\n *         // ...\n *         foo();\n *         // ...\n *         bar();\n *         // ...\n *         // and now the kicker:\n *         Sample.baz();\n *         // everyone stands up and claps\n *         // ...\n *     }\n * }\n * &lt;/pre&gt;\n */\n</code></pre>\n<p>This will also require escaping <code>@</code>, <code>&lt;</code>, <code>&gt;</code>, and <code>&amp;</code> as well, if they appear in your example javadoc.  <code>@</code> would be escaped as <code>&amp;#x40;</code>, <code>&lt;</code> is <code>&amp;lt;</code>, <code>&gt;</code> is <code>&amp;gt;</code>, and <code>&amp;</code> is <code>&amp;amp;</code>.</p>\n"}],"owner":{"user_id":8409679,"display_name":"Noam Bechhofer"},"view_count":40,"up_vote_count":2,"accepted_answer_id":76084877,"answer_count":1,"score":2,"creation_date":1682244108,"question_id":76084209,"body":"<p>I want to nest javadoc in order to demonstrate some code functionality. However, the end of the inner javadoc comment block ends the outer comment block too.</p>\n<h1>Sample use case</h1>\n<pre><code>/**\n * Sample is a utility for doing interesting stuff.\n * For example, you might use it this way:\n * \n * &lt;pre&gt;{@code\n * /**\n *  * We write an Example class\n *  */\n * class Example {\n *     /**\n *      * This function does something.\n *      */\n *     void foo() {\n *         // ...\n *     }\n * \n *     /**\n *      * This one does something else\n *      */\n *     void bar() {\n *         // ...\n *     }\n * \n *     /**\n *      * now I'm gonna demonstrate something by calling foo() and bar() in this main method\n *      */\n *     public static void main(String[] args) {\n *         // ...\n *         foo();\n *         // ...\n *         bar();\n *         // ...\n *         // and now the kicker:\n *         Sample.baz();\n *         // everyone stands up and claps\n *         // ...\n *     }\n * }\n * }&lt;/pre&gt;\n */\npublic class Sample {\n    /**\n     * Really cool thing that Sample does\n     */\n    static void baz() {\n        // ...\n    }\n}\n</code></pre>\n<h1>subpar solution</h1>\n<p>So I could try escaping the offending closing tags, but that shows up in the javadoc which is pretty ugly.</p>\n<pre><code>/**\n * outer doc\n * &lt;pre&gt;{@code\n * /**\n *  * inner doc\n *  *\\/\n * }\n * &lt;/pre&gt;\n */\npublic class Sample {\n    public static void main(String[] args) {\n        System.out.println(&quot;Hello, world!&quot;);\n    }\n}\n</code></pre>\n<p>yields</p>\n<pre><code>outer doc\n\n /**\n  * inner doc\n  *\\/\n</code></pre>\n"},{"tags":["java","multithreading","completable-future"],"comments":[{"owner":{"user_id":6650475,"display_name":"Andrew S"},"edited":false,"comment_id":134151993,"body":"Speculating, but possibly related to <code>main</code> ending (so the whole program ends) before the <code>CompleteFuture</code> has a chance to run.  It might also depends on if the thread pool creates the workers as a daemon or non-daemon thread."},{"owner":{"user_id":6395627,"display_name":"Slaw"},"edited":false,"comment_id":134152047,"body":"The duplicate addresses the <i>code</i> in your question. I&#39;m not sure if it will address the problem in your real project. Let me know one way or the other, please."}],"answers":[{"owner":{"user_id":13515974,"display_name":"Zufar Sunagatov"},"up_vote_count":2,"is_accepted":true,"creation_date":1682008673,"answer_id":76066441,"body":"<p>Try this code</p>\n<pre><code>import java.util.concurrent.CompletableFuture;\nimport java.util.concurrent.ExecutorService;\nimport java.util.concurrent.Executors;\nimport java.util.function.Consumer;\n\npublic class Main {\n\n    private static final ExecutorService executor = Executors.newCachedThreadPool();\n\n    public static void main(String[] args) {\n        for (int i = 0; i &lt; 10; i++) {\n            Consumer&lt;Integer&gt; consumer = result -&gt; System.out.println(&quot;Result: &quot; + result);\n            doSomething(i)\n                    .thenAcceptAsync(consumer, executor);\n        }\n        System.out.println(&quot;Main thread is not blocked&quot;);\n    }\n\n    private static CompletableFuture&lt;Integer&gt; doSomething(final int i) {\n        return CompletableFuture.supplyAsync(() -&gt; {\n            try {\n                Thread.sleep(2500);\n            } catch (InterruptedException interruptedException) {\n                interruptedException.printStackTrace();\n            }\n            return i * 3;\n        }, executor);\n    }\n}\n</code></pre>\n"}],"owner":{"user_id":1870194,"display_name":"Hasham Rasheed"},"view_count":69,"up_vote_count":2,"accepted_answer_id":76066441,"answer_count":1,"score":2,"creation_date":1682008054,"question_id":76066356,"body":"<p>I'm having a very weird problem with CompletableFuture</p>\n<pre><code>import java.util.concurrent.CompletableFuture;\nimport java.util.concurrent.ExecutorService;\nimport java.util.concurrent.Executors;\n\npublic class Main {\n\n    final static ExecutorService executor = Executors.newCachedThreadPool();\n\n    public static void main(String[] args) {\n        for (int i = 0; i &lt; 10; i++) {\n            final CompletableFuture withoutExecutor = doSomethingOne(i);\n//      final CompletableFuture withExecutor = doSomethingTwo(i);\n        }\n    }\n\n    private static CompletableFuture doSomethingOne(final int i) {\n        return CompletableFuture.runAsync(() -&gt; {\n            System.out.println(&quot;Without Executor &quot; + i);\n        });\n    }\n\n    private static CompletableFuture doSomethingTwo(final int i) {\n        return CompletableFuture.runAsync(() -&gt; {\n            System.out.println(&quot;With Executor &quot; + i);\n        }, executor);\n    }\n}\n</code></pre>\n<p>When <code>main</code> is executed, it doesn't print anything (the <code>withoutExecutor</code> CompletableFuture doesn't even get executed). But when I uncomment the <code>withExecutor</code>, both CompletableFutures work as expected. What am I missing?</p>\n<p>I have similar problem in my personal project, but the overall idea is the same. I am currently using an executor with my CompletableFutures in the project, and they only run for a certain amount of time, then they stop running completely (Even debugger doesn't hit a breakpoint within CompletableFuture). I need an async background task, waiting is not an option since CompletableFuture is triggered via a REST API in my project, and I have to return result of storing the Story as soon as possible.</p>\n"},{"tags":["java","oracle","maven","weblogic"],"answers":[{"owner":{"user_id":4337682,"display_name":"krzysiek"},"up_vote_count":1,"is_accepted":false,"creation_date":1681932770,"answer_id":76058200,"body":"<p>Unfortunately, the solution won't be easy. The libraries you're looking for have probably disappeared from the Oracle Maven repository. It happens quite often that old Oracle libraries or plugins for jDeveloper are removed. I had the same problem with the Oracle WebCenter plugin for JDeveloper 11g. The only solution was to recover these files from another computer.</p>\n<p>I've unpacked and searched recursively all jars from WebLogic installation 10.3.6, and definitely the libraries you mentioned aren't there, neither in JDeveloper nor in Integrated WebLogic. Which makes sense since you have said that the project connects to maven.oracle.com for these dependencies.</p>\n<p>I've connected to Oracle Maven, and these libraries don't exist there anymore. They were quite old, so they were probably deleted.</p>\n<p>I see a few possible workarounds:</p>\n<ol>\n<li>Locate the war of the built project and unpack the libraries. I don't know what this project is, but if these are not WebLogic libraries but dependencies, they should be in war (or ear).</li>\n<li>Maybe someone has configured the whole environment for this project so you can copy libraries.</li>\n<li>If you have paid support, you can create a ticket to Oracle.</li>\n<li>Try to get help on the Oracle forum at <a href=\"https://community.oracle.com\" rel=\"nofollow noreferrer\">https://community.oracle.com</a>. Maybe you'll find someone who can help you.</li>\n<li>Check if you really need these libraries. Maybe if you exclude them from the pom, everything will work. If problem happens during deployment, maybe it's enough to add missing libraries. Trying newer versions of these libraries if some are available is also possible.</li>\n</ol>\n"},{"owner":{"user_id":11961036,"display_name":"Marco Frag Delle Monache"},"up_vote_count":1,"is_accepted":true,"creation_date":1681978504,"answer_id":76061934,"body":"<p>Turns out I was pointing to a wrong WebLogic product! I discovered that the native <code>pom.xml</code> of the project has to work with WebLogic Portal 10.3.6 instead of WebLogic Server 10.3.6! It took me some time to find out a link to download this Portal (since it's in EOL) but here it is:</p>\n<ol>\n<li>Go to <a href=\"https://edelivery.oracle.com/osdc/faces/SoftwareDelivery\" rel=\"nofollow noreferrer\">this link</a></li>\n<li>Prompt <code>WebLogic Portal</code> (do NOT click on the suggestion, either it will show a lot more stuff)</li>\n<li>Oracle WebLogic Portal 10.3.6.0.0, download it</li>\n<li>It will download an <code>.exe</code> that will download the <code>.zip</code> wherever you want</li>\n<li>Extract</li>\n<li>Run the <code>.jar</code> with Java 7 and follow the guided installation procedure</li>\n</ol>\n<p>It will contain everything, both <code>p13n</code> and <code>netuix</code> libraries, plus an installation of WebLogic Server!</p>\n"}],"owner":{"user_id":11961036,"display_name":"Marco Frag Delle Monache"},"view_count":67,"up_vote_count":2,"accepted_answer_id":76061934,"answer_count":2,"score":2,"creation_date":1681893232,"question_id":76052349,"body":"<p>I have to recreate the local environment of a Maven project. Along other dependencies, it manually pulls some Oracle libraries from a local installation of WebLogic, using <code>truezip-maven-plugin</code> and <code>maven-install-plugin</code>, to put them into <code>.m2</code>.</p>\n<p>For example, in my <code>pom.xml</code>:</p>\n<pre><code>&lt;plugin&gt;\n    &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;\n    &lt;artifactId&gt;truezip-maven-plugin&lt;/artifactId&gt;\n    &lt;version&gt;1.2&lt;/version&gt;\n    &lt;configuration&gt;\n    &lt;/configuration&gt;\n    &lt;executions&gt;\n        &lt;execution&gt;\n            &lt;id&gt;copy-weblogic-libs&lt;/id&gt;\n            &lt;configuration&gt;\n                &lt;files&gt;\n                    &lt;file&gt;\n                        &lt;source&gt;${WL_HOME}/wlserver/server/lib/consoleapp/APP-INF/lib/p13n_system.jar&lt;/source&gt;\n                        &lt;outputDirectory&gt;${project.build.directory}/temp/com.bea.p13n/p13n-app-lib-base&lt;/outputDirectory&gt;\n                    &lt;/file&gt;\n                &lt;/files&gt;\n            &lt;/configuration&gt;\n            &lt;goals&gt;\n                &lt;goal&gt;copy&lt;/goal&gt;\n            &lt;/goals&gt;\n            &lt;phase&gt;install&lt;/phase&gt;\n        &lt;/execution&gt;\n    &lt;/executions&gt;\n&lt;/plugin&gt;\n\n&lt;plugin&gt;\n    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n    &lt;artifactId&gt;maven-install-plugin&lt;/artifactId&gt;\n    &lt;version&gt;2.5.2&lt;/version&gt;\n    &lt;configuration&gt;\n        &lt;packaging&gt;jar&lt;/packaging&gt;\n        &lt;generatePom&gt;true&lt;/generatePom&gt;\n    &lt;/configuration&gt;\n    &lt;executions&gt;\n        &lt;execution&gt;\n            &lt;id&gt;install-com-bea-p13n-app-lib-base-p13n-system&lt;/id&gt;\n            &lt;configuration&gt;\n                &lt;file&gt;\n                    ${project.build.directory}/temp/com.bea.p13n/p13n-app-lib-base/p13n_system.jar\n                &lt;/file&gt;\n                &lt;groupId&gt;com.bea.p13n.p13n-app-lib-base&lt;/groupId&gt;\n                &lt;artifactId&gt;p13n_system&lt;/artifactId&gt;\n                &lt;version&gt;10.3.6&lt;/version&gt;\n            &lt;/configuration&gt;\n            &lt;goals&gt;\n                &lt;goal&gt;install-file&lt;/goal&gt;\n            &lt;/goals&gt;\n            &lt;phase&gt;install&lt;/phase&gt;            \n        &lt;/execution&gt;\n    &lt;/executions&gt;\n&lt;/plugin&gt;\n</code></pre>\n<p>This works fine.</p>\n<br>\n<p>But the project requires other <code>.jars</code>, that don't seem to exist. Specifically, <code>p13n_app.jar</code>, <code>p13n_ejb.jar</code> and <code>netuix.jar</code> (all under <code>com.bea</code> domain). The project is setup to connect to <code>maven.oracle.com</code> through <code>settings.xml</code>. I tried searching for a manual download of these <code>.jars</code> but without success. <br> This is all I could find:</p>\n<ul>\n<li><p>Manually browsing the Maven repository</p>\n<p><a href=\"https://repo.maven.apache.org/maven2/com/bea/\" rel=\"nofollow noreferrer\">https://repo.maven.apache.org/maven2/com/bea/</a></p>\n<p><a href=\"https://mvnrepository.com/artifact/com.bea.p13n\" rel=\"nofollow noreferrer\">https://mvnrepository.com/artifact/com.bea.p13n</a></p>\n</li>\n</ul>\n<p>Dead end, since neither <code>netuix</code> nor <code>p13n</code> packages exist (even though there are results in <code>mvnrepository.com</code>).</p>\n<br>\n<ul>\n<li><p>Manually browsing other repositories, like:</p>\n<p><a href=\"http://www.java2s.com/Code/Jar/c/com.bea.htm\" rel=\"nofollow noreferrer\">http://www.java2s.com/Code/Jar/c/com.bea.htm</a></p>\n</li>\n</ul>\n<p>Again, dead end for the same reason.</p>\n<pre><code>https://maven.oracle.com/com/bea/p13n/p13n-app-lib-base/p13n_app/10.3.6/p13n_app-10.3.6.pom\n</code></pre>\n<p>This is the link Maven tries to connect to download the dependency. It says <code>Not found</code></p>\n<pre><code>http://nexus.emergya.es/nexus/index.html#nexus-search;quick~com.bea.p13n\n</code></pre>\n<p>It actually has some results, but when clicking the Download button it leads to <a href=\"http://nexus.emergya.es/nexus/service/local/artifact/maven/redirect?r=nexus-nuxeo&amp;g=com.bea.p13n&amp;a=ejb&amp;v=10.3.2&amp;e=jar\" rel=\"nofollow noreferrer\">this page</a>.</p>\n<ul>\n<li><p>Installing a different WebLogic package. I installed a development version, so I thought it could miss something, but even after installing the standard WebLogic they are missing</p>\n</li>\n<li><p>Browsing existing WebLogic installments, like test environments from other projects</p>\n</li>\n</ul>\n<p>Should I keep searching for these libraries or are they deprecated? Can I extract these libraries from a <code>war</code> already build with it? They seem to have been deleted anywhere. In this case I should search for a newer library (with the risk of incompatibilities with the code already written). Any help is highly appreciated!</p>\n"},{"tags":["java","html","spring-boot","web","spring-restcontroller"],"answers":[{"owner":{"user_id":3764965,"display_name":"Nikolas Charalambidis"},"up_vote_count":1,"is_accepted":false,"creation_date":1681817693,"answer_id":76044078,"body":"<p>To return the HTML page (view), you have to use Spring MVC, i.e. <code>@Controller</code> instead of <code>@RestController</code> and return <code>ModelAndView</code> with <code>index</code> as a view name:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Controller\n@AllArgsConstructor\n@RequestMapping(&quot;/webpage&quot;)\npublic class IndexController {\n\n    @GetMapping(path = {&quot;mainpage&quot;})\n    public ModelAndView index() {\n        final var modelAndView = new ModelAndView();\n        modelAndView.setViewName(&quot;index&quot;);\n        return modelAndView;\n    }\n\n    // other methods\n}\n</code></pre>\n"},{"owner":{"user_id":19986323,"display_name":"Johnson Jayaraj"},"up_vote_count":1,"is_accepted":true,"creation_date":1681817965,"answer_id":76044123,"body":"<p>Please note that your class IndexController shall not have <code>@RestController</code> if you need to show an HTML page. It shall only have <code>@Controller</code>.</p>\n<p>In simple terms <code>@RestController = @Controller + @ResponseBody</code></p>\n<p>In your case, the <code>@RestController</code> annotation you used makes all the methods within it <code>@ResponseBody</code> by default, and you don't have to explicitly mention</p>\n<p><code>@ResponseBody</code> annotation doesn't show the view instead it sends a String response.</p>\n<p>Steps to fix this issue:</p>\n<ol>\n<li>Change <code>@RestController</code> annotation to <code>@Controller</code> in class level</li>\n<li>Remove <code>@ResponseBody</code> from the method in which you're planning to show the HTML</li>\n</ol>\n<p>So your code will be</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Controller\n@AllArgsConstructor\n@RequestMapping(path = &quot;/webpage&quot;)\npublic class IndexController {\n\n    @GetMapping(path = {&quot;mainpage&quot;})\n    public String index(){\n        return &quot;Index&quot;;\n    }\n\n   //Other methods\n    \n}\n</code></pre>\n<p>Just make sure you have <code>spring-boot-starter-thymeleaf</code> dependency in your POM.xml</p>\n<p>Thanks.</p>\n"}],"owner":{"user_id":20879521,"display_name":"Al3x21"},"view_count":55,"up_vote_count":2,"accepted_answer_id":76044123,"answer_count":2,"score":2,"creation_date":1681817186,"question_id":76043996,"body":"<p>I am trying to get the HTML page that I created. This is the structure of my project:</p>\n<p><a href=\"https://i.stack.imgur.com/Wvmus.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Wvmus.png\" alt=\"enter image description here\" /></a></p>\n<p>This is the &quot;IndexController&quot; class:</p>\n<pre><code>@RestController\n@AllArgsConstructor\n@RequestMapping(path = &quot;/webpage&quot;)\npublic class IndexController {\n\n        @GetMapping(path = {&quot;mainpage&quot;})\n        @ResponseBody\n        public String index(){\n            return &quot;Index&quot;;\n        }\n    \n        @PostMapping(&quot;/check&quot;)\n        public String CheckDataset(@ModelAttribute CheckModel checkModel){\n            System.out.println(checkModel);\n            return null;\n        }\n    \n    }\n</code></pre>\n<p>When I open the HTML webpage directly from intellij:</p>\n<p><a href=\"https://i.stack.imgur.com/DB1gD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DB1gD.png\" alt=\"enter image description here\" /></a></p>\n<p>Is opening perfectly, but when I am trying to open the HTML from Spring Boot is returning just the &quot;Index&quot; String.</p>\n<p>Do you have any idea how to solve this?</p>\n"}],"has_more":true,"quota_max":300,"quota_remaining":182}